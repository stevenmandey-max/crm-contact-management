(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();function TS(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var V0={exports:{}},sl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w1;function ES(){if(w1)return sl;w1=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(i,l,u){var f=null;if(u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),"key"in l){u={};for(var h in l)h!=="key"&&(u[h]=l[h])}else u=l;return l=u.ref,{$$typeof:a,type:i,key:f,ref:l!==void 0?l:null,props:u}}return sl.Fragment=n,sl.jsx=t,sl.jsxs=t,sl}var b1;function _S(){return b1||(b1=1,V0.exports=ES()),V0.exports}var o=_S(),Y0={exports:{}},ll={},X0={exports:{}},q0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N1;function wS(){return N1||(N1=1,(function(a){function n(ee,ge){var ke=ee.length;ee.push(ge);e:for(;0<ke;){var Ne=ke-1>>>1,Le=ee[Ne];if(0<l(Le,ge))ee[Ne]=ge,ee[ke]=Le,ke=Ne;else break e}}function t(ee){return ee.length===0?null:ee[0]}function i(ee){if(ee.length===0)return null;var ge=ee[0],ke=ee.pop();if(ke!==ge){ee[0]=ke;e:for(var Ne=0,Le=ee.length,H=Le>>>1;Ne<H;){var j=2*(Ne+1)-1,V=ee[j],P=j+1,Y=ee[P];if(0>l(V,ke))P<Le&&0>l(Y,V)?(ee[Ne]=Y,ee[P]=ke,Ne=P):(ee[Ne]=V,ee[j]=ke,Ne=j);else if(P<Le&&0>l(Y,ke))ee[Ne]=Y,ee[P]=ke,Ne=P;else break e}}return ge}function l(ee,ge){var ke=ee.sortIndex-ge.sortIndex;return ke!==0?ke:ee.id-ge.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;a.unstable_now=function(){return u.now()}}else{var f=Date,h=f.now();a.unstable_now=function(){return f.now()-h}}var g=[],v=[],p=1,S=null,x=3,C=!1,T=!1,y=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function N(ee){for(var ge=t(v);ge!==null;){if(ge.callback===null)i(v);else if(ge.startTime<=ee)i(v),ge.sortIndex=ge.expirationTime,n(g,ge);else break;ge=t(v)}}function K(ee){if(y=!1,N(ee),!T)if(t(g)!==null)T=!0,J||(J=!0,z());else{var ge=t(v);ge!==null&&Se(K,ge.startTime-ee)}}var J=!1,B=-1,Z=5,L=-1;function X(){return _?!0:!(a.unstable_now()-L<Z)}function D(){if(_=!1,J){var ee=a.unstable_now();L=ee;var ge=!0;try{e:{T=!1,y&&(y=!1,k(B),B=-1),C=!0;var ke=x;try{t:{for(N(ee),S=t(g);S!==null&&!(S.expirationTime>ee&&X());){var Ne=S.callback;if(typeof Ne=="function"){S.callback=null,x=S.priorityLevel;var Le=Ne(S.expirationTime<=ee);if(ee=a.unstable_now(),typeof Le=="function"){S.callback=Le,N(ee),ge=!0;break t}S===t(g)&&i(g),N(ee)}else i(g);S=t(g)}if(S!==null)ge=!0;else{var H=t(v);H!==null&&Se(K,H.startTime-ee),ge=!1}}break e}finally{S=null,x=ke,C=!1}ge=void 0}}finally{ge?z():J=!1}}}var z;if(typeof M=="function")z=function(){M(D)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,be=ue.port2;ue.port1.onmessage=D,z=function(){be.postMessage(null)}}else z=function(){w(D,0)};function Se(ee,ge){B=w(function(){ee(a.unstable_now())},ge)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(ee){ee.callback=null},a.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<ee?Math.floor(1e3/ee):5},a.unstable_getCurrentPriorityLevel=function(){return x},a.unstable_next=function(ee){switch(x){case 1:case 2:case 3:var ge=3;break;default:ge=x}var ke=x;x=ge;try{return ee()}finally{x=ke}},a.unstable_requestPaint=function(){_=!0},a.unstable_runWithPriority=function(ee,ge){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ke=x;x=ee;try{return ge()}finally{x=ke}},a.unstable_scheduleCallback=function(ee,ge,ke){var Ne=a.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?Ne+ke:Ne):ke=Ne,ee){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ke+Le,ee={id:p++,callback:ge,priorityLevel:ee,startTime:ke,expirationTime:Le,sortIndex:-1},ke>Ne?(ee.sortIndex=ke,n(v,ee),t(g)===null&&ee===t(v)&&(y?(k(B),B=-1):y=!0,Se(K,ke-Ne))):(ee.sortIndex=Le,n(g,ee),T||C||(T=!0,J||(J=!0,z()))),ee},a.unstable_shouldYield=X,a.unstable_wrapCallback=function(ee){var ge=x;return function(){var ke=x;x=ge;try{return ee.apply(this,arguments)}finally{x=ke}}}})(q0)),q0}var A1;function bS(){return A1||(A1=1,X0.exports=wS()),X0.exports}var J0={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D1;function NS(){if(D1)return Pe;D1=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),x=Symbol.iterator;function C(H){return H===null||typeof H!="object"?null:(H=x&&H[x]||H["@@iterator"],typeof H=="function"?H:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function w(H,j,V){this.props=H,this.context=j,this.refs=_,this.updater=V||T}w.prototype.isReactComponent={},w.prototype.setState=function(H,j){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,j,"setState")},w.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function k(){}k.prototype=w.prototype;function M(H,j,V){this.props=H,this.context=j,this.refs=_,this.updater=V||T}var N=M.prototype=new k;N.constructor=M,y(N,w.prototype),N.isPureReactComponent=!0;var K=Array.isArray;function J(){}var B={H:null,A:null,T:null,S:null},Z=Object.prototype.hasOwnProperty;function L(H,j,V){var P=V.ref;return{$$typeof:a,type:H,key:j,ref:P!==void 0?P:null,props:V}}function X(H,j){return L(H.type,j,H.props)}function D(H){return typeof H=="object"&&H!==null&&H.$$typeof===a}function z(H){var j={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(V){return j[V]})}var ue=/\/+/g;function be(H,j){return typeof H=="object"&&H!==null&&H.key!=null?z(""+H.key):j.toString(36)}function Se(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(J,J):(H.status="pending",H.then(function(j){H.status==="pending"&&(H.status="fulfilled",H.value=j)},function(j){H.status==="pending"&&(H.status="rejected",H.reason=j)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function ee(H,j,V,P,Y){var ce=typeof H;(ce==="undefined"||ce==="boolean")&&(H=null);var Ce=!1;if(H===null)Ce=!0;else switch(ce){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch(H.$$typeof){case a:case n:Ce=!0;break;case p:return Ce=H._init,ee(Ce(H._payload),j,V,P,Y)}}if(Ce)return Y=Y(H),Ce=P===""?"."+be(H,0):P,K(Y)?(V="",Ce!=null&&(V=Ce.replace(ue,"$&/")+"/"),ee(Y,j,V,"",function(Ae){return Ae})):Y!=null&&(D(Y)&&(Y=X(Y,V+(Y.key==null||H&&H.key===Y.key?"":(""+Y.key).replace(ue,"$&/")+"/")+Ce)),j.push(Y)),1;Ce=0;var je=P===""?".":P+":";if(K(H))for(var we=0;we<H.length;we++)P=H[we],ce=je+be(P,we),Ce+=ee(P,j,V,ce,Y);else if(we=C(H),typeof we=="function")for(H=we.call(H),we=0;!(P=H.next()).done;)P=P.value,ce=je+be(P,we++),Ce+=ee(P,j,V,ce,Y);else if(ce==="object"){if(typeof H.then=="function")return ee(Se(H),j,V,P,Y);throw j=String(H),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function ge(H,j,V){if(H==null)return H;var P=[],Y=0;return ee(H,P,"","",function(ce){return j.call(V,ce,Y++)}),P}function ke(H){if(H._status===-1){var j=H._result;j=j(),j.then(function(V){(H._status===0||H._status===-1)&&(H._status=1,H._result=V)},function(V){(H._status===0||H._status===-1)&&(H._status=2,H._result=V)}),H._status===-1&&(H._status=0,H._result=j)}if(H._status===1)return H._result.default;throw H._result}var Ne=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Le={map:ge,forEach:function(H,j,V){ge(H,function(){j.apply(this,arguments)},V)},count:function(H){var j=0;return ge(H,function(){j++}),j},toArray:function(H){return ge(H,function(j){return j})||[]},only:function(H){if(!D(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Pe.Activity=S,Pe.Children=Le,Pe.Component=w,Pe.Fragment=t,Pe.Profiler=l,Pe.PureComponent=M,Pe.StrictMode=i,Pe.Suspense=g,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(H){return B.H.useMemoCache(H)}},Pe.cache=function(H){return function(){return H.apply(null,arguments)}},Pe.cacheSignal=function(){return null},Pe.cloneElement=function(H,j,V){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var P=y({},H.props),Y=H.key;if(j!=null)for(ce in j.key!==void 0&&(Y=""+j.key),j)!Z.call(j,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&j.ref===void 0||(P[ce]=j[ce]);var ce=arguments.length-2;if(ce===1)P.children=V;else if(1<ce){for(var Ce=Array(ce),je=0;je<ce;je++)Ce[je]=arguments[je+2];P.children=Ce}return L(H.type,Y,P)},Pe.createContext=function(H){return H={$$typeof:f,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:u,_context:H},H},Pe.createElement=function(H,j,V){var P,Y={},ce=null;if(j!=null)for(P in j.key!==void 0&&(ce=""+j.key),j)Z.call(j,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(Y[P]=j[P]);var Ce=arguments.length-2;if(Ce===1)Y.children=V;else if(1<Ce){for(var je=Array(Ce),we=0;we<Ce;we++)je[we]=arguments[we+2];Y.children=je}if(H&&H.defaultProps)for(P in Ce=H.defaultProps,Ce)Y[P]===void 0&&(Y[P]=Ce[P]);return L(H,ce,Y)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(H){return{$$typeof:h,render:H}},Pe.isValidElement=D,Pe.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:ke}},Pe.memo=function(H,j){return{$$typeof:v,type:H,compare:j===void 0?null:j}},Pe.startTransition=function(H){var j=B.T,V={};B.T=V;try{var P=H(),Y=B.S;Y!==null&&Y(V,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(J,Ne)}catch(ce){Ne(ce)}finally{j!==null&&V.types!==null&&(j.types=V.types),B.T=j}},Pe.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Pe.use=function(H){return B.H.use(H)},Pe.useActionState=function(H,j,V){return B.H.useActionState(H,j,V)},Pe.useCallback=function(H,j){return B.H.useCallback(H,j)},Pe.useContext=function(H){return B.H.useContext(H)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(H,j){return B.H.useDeferredValue(H,j)},Pe.useEffect=function(H,j){return B.H.useEffect(H,j)},Pe.useEffectEvent=function(H){return B.H.useEffectEvent(H)},Pe.useId=function(){return B.H.useId()},Pe.useImperativeHandle=function(H,j,V){return B.H.useImperativeHandle(H,j,V)},Pe.useInsertionEffect=function(H,j){return B.H.useInsertionEffect(H,j)},Pe.useLayoutEffect=function(H,j){return B.H.useLayoutEffect(H,j)},Pe.useMemo=function(H,j){return B.H.useMemo(H,j)},Pe.useOptimistic=function(H,j){return B.H.useOptimistic(H,j)},Pe.useReducer=function(H,j,V){return B.H.useReducer(H,j,V)},Pe.useRef=function(H){return B.H.useRef(H)},Pe.useState=function(H){return B.H.useState(H)},Pe.useSyncExternalStore=function(H,j,V){return B.H.useSyncExternalStore(H,j,V)},Pe.useTransition=function(){return B.H.useTransition()},Pe.version="19.2.0",Pe}var M1;function gf(){return M1||(M1=1,J0.exports=NS()),J0.exports}var $0={exports:{}},ra={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j1;function AS(){if(j1)return ra;j1=1;var a=gf();function n(g){var v="https://react.dev/errors/"+g;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)v+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+g+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,v,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:S==null?null:""+S,children:g,containerInfo:v,implementation:p}}var f=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(g,v){if(g==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return ra.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ra.createPortal=function(g,v){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(n(299));return u(g,v,null,p)},ra.flushSync=function(g){var v=f.T,p=i.p;try{if(f.T=null,i.p=2,g)return g()}finally{f.T=v,i.p=p,i.d.f()}},ra.preconnect=function(g,v){typeof g=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,i.d.C(g,v))},ra.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ra.preinit=function(g,v){if(typeof g=="string"&&v&&typeof v.as=="string"){var p=v.as,S=h(p,v.crossOrigin),x=typeof v.integrity=="string"?v.integrity:void 0,C=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;p==="style"?i.d.S(g,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:S,integrity:x,fetchPriority:C}):p==="script"&&i.d.X(g,{crossOrigin:S,integrity:x,fetchPriority:C,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},ra.preinitModule=function(g,v){if(typeof g=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var p=h(v.as,v.crossOrigin);i.d.M(g,{crossOrigin:p,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&i.d.M(g)},ra.preload=function(g,v){if(typeof g=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var p=v.as,S=h(p,v.crossOrigin);i.d.L(g,p,{crossOrigin:S,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},ra.preloadModule=function(g,v){if(typeof g=="string")if(v){var p=h(v.as,v.crossOrigin);i.d.m(g,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:p,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else i.d.m(g)},ra.requestFormReset=function(g){i.d.r(g)},ra.unstable_batchedUpdates=function(g,v){return g(v)},ra.useFormState=function(g,v,p){return f.H.useFormState(g,v,p)},ra.useFormStatus=function(){return f.H.useHostTransitionStatus()},ra.version="19.2.0",ra}var k1;function DS(){if(k1)return $0.exports;k1=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),$0.exports=AS(),$0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U1;function MS(){if(U1)return ll;U1=1;var a=bS(),n=gf(),t=DS();function i(e){var r="https://react.dev/errors/"+e;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)r+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var r=e,s=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,(r.flags&4098)!==0&&(s=r.return),e=r.return;while(e)}return r.tag===3?s:null}function f(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function h(e){if(e.tag===31){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function g(e){if(u(e)!==e)throw Error(i(188))}function v(e){var r=e.alternate;if(!r){if(r=u(e),r===null)throw Error(i(188));return r!==e?null:e}for(var s=e,c=r;;){var d=s.return;if(d===null)break;var m=d.alternate;if(m===null){if(c=d.return,c!==null){s=c;continue}break}if(d.child===m.child){for(m=d.child;m;){if(m===s)return g(d),e;if(m===c)return g(d),r;m=m.sibling}throw Error(i(188))}if(s.return!==c.return)s=d,c=m;else{for(var E=!1,A=d.child;A;){if(A===s){E=!0,s=d,c=m;break}if(A===c){E=!0,c=d,s=m;break}A=A.sibling}if(!E){for(A=m.child;A;){if(A===s){E=!0,s=m,c=d;break}if(A===c){E=!0,c=m,s=d;break}A=A.sibling}if(!E)throw Error(i(189))}}if(s.alternate!==c)throw Error(i(190))}if(s.tag!==3)throw Error(i(188));return s.stateNode.current===s?e:r}function p(e){var r=e.tag;if(r===5||r===26||r===27||r===6)return e;for(e=e.child;e!==null;){if(r=p(e),r!==null)return r;e=e.sibling}return null}var S=Object.assign,x=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),M=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function z(e){return e===null||typeof e!="object"?null:(e=D&&e[D]||e["@@iterator"],typeof e=="function"?e:null)}var ue=Symbol.for("react.client.reference");function be(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ue?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case y:return"Fragment";case w:return"Profiler";case _:return"StrictMode";case K:return"Suspense";case J:return"SuspenseList";case L:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case T:return"Portal";case M:return e.displayName||"Context";case k:return(e._context.displayName||"Context")+".Consumer";case N:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case B:return r=e.displayName||null,r!==null?r:be(e.type)||"Memo";case Z:r=e._payload,e=e._init;try{return be(e(r))}catch{}}return null}var Se=Array.isArray,ee=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ke={pending:!1,data:null,method:null,action:null},Ne=[],Le=-1;function H(e){return{current:e}}function j(e){0>Le||(e.current=Ne[Le],Ne[Le]=null,Le--)}function V(e,r){Le++,Ne[Le]=e.current,e.current=r}var P=H(null),Y=H(null),ce=H(null),Ce=H(null);function je(e,r){switch(V(ce,r),V(Y,e),V(P,null),r.nodeType){case 9:case 11:e=(e=r.documentElement)&&(e=e.namespaceURI)?Xm(e):0;break;default:if(e=r.tagName,r=r.namespaceURI)r=Xm(r),e=qm(r,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}j(P),V(P,e)}function we(){j(P),j(Y),j(ce)}function Ae(e){e.memoizedState!==null&&V(Ce,e);var r=P.current,s=qm(r,e.type);r!==s&&(V(Y,e),V(P,s))}function Qe(e){Y.current===e&&(j(P),j(Y)),Ce.current===e&&(j(Ce),al._currentValue=ke)}var Ve,Kt;function We(e){if(Ve===void 0)try{throw Error()}catch(s){var r=s.stack.trim().match(/\n( *(at )?)/);Ve=r&&r[1]||"",Kt=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ve+e+Kt}var _a=!1;function vt(e,r){if(!e||_a)return"";_a=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(oe){var se=oe}Reflect.construct(e,[],ve)}else{try{ve.call()}catch(oe){se=oe}e.call(ve.prototype)}}else{try{throw Error()}catch(oe){se=oe}(ve=e())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(oe){if(oe&&se&&typeof oe.stack=="string")return[oe.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),E=m[0],A=m[1];if(E&&A){var W=E.split(`
`),ae=A.split(`
`);for(d=c=0;c<W.length&&!W[c].includes("DetermineComponentFrameRoot");)c++;for(;d<ae.length&&!ae[d].includes("DetermineComponentFrameRoot");)d++;if(c===W.length||d===ae.length)for(c=W.length-1,d=ae.length-1;1<=c&&0<=d&&W[c]!==ae[d];)d--;for(;1<=c&&0<=d;c--,d--)if(W[c]!==ae[d]){if(c!==1||d!==1)do if(c--,d--,0>d||W[c]!==ae[d]){var de=`
`+W[c].replace(" at new "," at ");return e.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",e.displayName)),de}while(1<=c&&0<=d);break}}}finally{_a=!1,Error.prepareStackTrace=s}return(s=e?e.displayName||e.name:"")?We(s):""}function Ue(e,r){switch(e.tag){case 26:case 27:case 5:return We(e.type);case 16:return We("Lazy");case 13:return e.child!==r&&r!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return vt(e.type,!1);case 11:return vt(e.type.render,!1);case 1:return vt(e.type,!0);case 31:return We("Activity");default:return""}}function ca(e){try{var r="",s=null;do r+=Ue(e,s),s=e,e=e.return;while(e);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var wa=Object.prototype.hasOwnProperty,en=a.unstable_scheduleCallback,hn=a.unstable_cancelCallback,Ul=a.unstable_shouldYield,hs=a.unstable_requestPaint,Ct=a.unstable_now,li=a.unstable_getCurrentPriorityLevel,ci=a.unstable_ImmediatePriority,oi=a.unstable_UserBlockingPriority,La=a.unstable_NormalPriority,Io=a.unstable_LowPriority,ms=a.unstable_IdlePriority,Ol=a.log,Il=a.unstable_setDisableYieldValue,qn=null,na=null;function tn(e){if(typeof Ol=="function"&&Il(e),na&&typeof na.setStrictMode=="function")try{na.setStrictMode(qn,e)}catch{}}var oa=Math.clz32?Math.clz32:Fl,Ro=Math.log,Rl=Math.LN2;function Fl(e){return e>>>=0,e===0?32:31-(Ro(e)/Rl|0)|0}var Dr=256,ui=262144,fi=4194304;function Ba(e){var r=e&42;if(r!==0)return r;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function di(e,r,s){var c=e.pendingLanes;if(c===0)return 0;var d=0,m=e.suspendedLanes,E=e.pingedLanes;e=e.warmLanes;var A=c&134217727;return A!==0?(c=A&~m,c!==0?d=Ba(c):(E&=A,E!==0?d=Ba(E):s||(s=A&~e,s!==0&&(d=Ba(s))))):(A=c&~m,A!==0?d=Ba(A):E!==0?d=Ba(E):s||(s=c&~e,s!==0&&(d=Ba(s)))),d===0?0:r!==0&&r!==d&&(r&m)===0&&(m=d&-d,s=r&-r,m>=s||m===32&&(s&4194048)!==0)?r:d}function Mr(e,r){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&r)===0}function Fo(e,r){switch(e){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ll(){var e=fi;return fi<<=1,(fi&62914560)===0&&(fi=4194304),e}function vs(e){for(var r=[],s=0;31>s;s++)r.push(e);return r}function jr(e,r){e.pendingLanes|=r,r!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Lo(e,r,s,c,d,m){var E=e.pendingLanes;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=s,e.entangledLanes&=s,e.errorRecoveryDisabledLanes&=s,e.shellSuspendCounter=0;var A=e.entanglements,W=e.expirationTimes,ae=e.hiddenUpdates;for(s=E&~s;0<s;){var de=31-oa(s),ve=1<<de;A[de]=0,W[de]=-1;var se=ae[de];if(se!==null)for(ae[de]=null,de=0;de<se.length;de++){var oe=se[de];oe!==null&&(oe.lane&=-536870913)}s&=~ve}c!==0&&Bl(e,c,0),m!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=m&~(E&~r))}function Bl(e,r,s){e.pendingLanes|=r,e.suspendedLanes&=~r;var c=31-oa(r);e.entangledLanes|=r,e.entanglements[c]=e.entanglements[c]|1073741824|s&261930}function hi(e,r){var s=e.entangledLanes|=r;for(e=e.entanglements;s;){var c=31-oa(s),d=1<<c;d&r|e[c]&r&&(e[c]|=r),s&=~d}}function Kl(e,r){var s=r&-r;return s=(s&42)!==0?1:gs(s),(s&(e.suspendedLanes|r))!==0?0:s}function gs(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ps(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function b(){var e=ge.p;return e!==0?e:(e=window.event,e===void 0?32:x1(e.type))}function R(e,r){var s=ge.p;try{return ge.p=e,r()}finally{ge.p=s}}var U=Math.random().toString(36).slice(2),O="__reactFiber$"+U,I="__reactProps$"+U,F="__reactContainer$"+U,ne="__reactEvents$"+U,he="__reactListeners$"+U,re="__reactHandles$"+U,ie="__reactResources$"+U,le="__reactMarker$"+U;function xe(e){delete e[O],delete e[I],delete e[ne],delete e[he],delete e[re]}function Te(e){var r=e[O];if(r)return r;for(var s=e.parentNode;s;){if(r=s[F]||s[O]){if(s=r.alternate,r.child!==null||s!==null&&s.child!==null)for(e=a1(e);e!==null;){if(s=e[O])return s;e=a1(e)}return r}e=s,s=e.parentNode}return null}function Me(e){if(e=e[O]||e[F]){var r=e.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return e}return null}function ye(e){var r=e.tag;if(r===5||r===26||r===27||r===6)return e.stateNode;throw Error(i(33))}function De(e){var r=e[ie];return r||(r=e[ie]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Ie(e){e[le]=!0}var gt=new Set,pt={};function Tt(e,r){Ka(e,r),Ka(e+"Capture",r)}function Ka(e,r){for(pt[e]=r,e=0;e<r.length;e++)gt.add(r[e])}var kr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jn={},mn={};function xs(e){return wa.call(mn,e)?!0:wa.call(Jn,e)?!1:kr.test(e)?mn[e]=!0:(Jn[e]=!0,!1)}function ma(e,r,s){if(xs(r))if(s===null)e.removeAttribute(r);else{switch(typeof s){case"undefined":case"function":case"symbol":e.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(r);return}}e.setAttribute(r,""+s)}}function Pl(e,r,s){if(s===null)e.removeAttribute(r);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttribute(r,""+s)}}function En(e,r,s,c){if(c===null)e.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttributeNS(r,s,""+c)}}function Pa(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Kf(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function vp(e,r,s){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,r);if(!e.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var d=c.get,m=c.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return d.call(this)},set:function(E){s=""+E,m.call(this,E)}}),Object.defineProperty(e,r,{enumerable:c.enumerable}),{getValue:function(){return s},setValue:function(E){s=""+E},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function Bo(e){if(!e._valueTracker){var r=Kf(e)?"checked":"value";e._valueTracker=vp(e,r,""+e[r])}}function Pf(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var s=r.getValue(),c="";return e&&(c=Kf(e)?e.checked?"true":"false":e.value),e=c,e!==s?(r.setValue(e),!0):!1}function zl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var gp=/[\n"\\]/g;function za(e){return e.replace(gp,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ko(e,r,s,c,d,m,E,A){e.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.type=E:e.removeAttribute("type"),r!=null?E==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+Pa(r)):e.value!==""+Pa(r)&&(e.value=""+Pa(r)):E!=="submit"&&E!=="reset"||e.removeAttribute("value"),r!=null?Po(e,E,Pa(r)):s!=null?Po(e,E,Pa(s)):c!=null&&e.removeAttribute("value"),d==null&&m!=null&&(e.defaultChecked=!!m),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?e.name=""+Pa(A):e.removeAttribute("name")}function zf(e,r,s,c,d,m,E,A){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.type=m),r!=null||s!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Bo(e);return}s=s!=null?""+Pa(s):"",r=r!=null?""+Pa(r):s,A||r===e.value||(e.value=r),e.defaultValue=r}c=c??d,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=A?e.checked:!!c,e.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(e.name=E),Bo(e)}function Po(e,r,s){r==="number"&&zl(e.ownerDocument)===e||e.defaultValue===""+s||(e.defaultValue=""+s)}function mi(e,r,s,c){if(e=e.options,r){r={};for(var d=0;d<s.length;d++)r["$"+s[d]]=!0;for(s=0;s<e.length;s++)d=r.hasOwnProperty("$"+e[s].value),e[s].selected!==d&&(e[s].selected=d),d&&c&&(e[s].defaultSelected=!0)}else{for(s=""+Pa(s),r=null,d=0;d<e.length;d++){if(e[d].value===s){e[d].selected=!0,c&&(e[d].defaultSelected=!0);return}r!==null||e[d].disabled||(r=e[d])}r!==null&&(r.selected=!0)}}function Hf(e,r,s){if(r!=null&&(r=""+Pa(r),r!==e.value&&(e.value=r),s==null)){e.defaultValue!==r&&(e.defaultValue=r);return}e.defaultValue=s!=null?""+Pa(s):""}function Gf(e,r,s,c){if(r==null){if(c!=null){if(s!=null)throw Error(i(92));if(Se(c)){if(1<c.length)throw Error(i(93));c=c[0]}s=c}s==null&&(s=""),r=s}s=Pa(r),e.defaultValue=s,c=e.textContent,c===s&&c!==""&&c!==null&&(e.value=c),Bo(e)}function vi(e,r){if(r){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=r;return}}e.textContent=r}var pp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Wf(e,r,s){var c=r.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?c?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="":c?e.setProperty(r,s):typeof s!="number"||s===0||pp.has(r)?r==="float"?e.cssFloat=s:e[r]=(""+s).trim():e[r]=s+"px"}function Vf(e,r,s){if(r!=null&&typeof r!="object")throw Error(i(62));if(e=e.style,s!=null){for(var c in s)!s.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var d in r)c=r[d],r.hasOwnProperty(d)&&s[d]!==c&&Wf(e,d,c)}else for(var m in r)r.hasOwnProperty(m)&&Wf(e,m,r[m])}function zo(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hl(e){return Sp.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function _n(){}var Ho=null;function Go(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gi=null,pi=null;function Yf(e){var r=Me(e);if(r&&(e=r.stateNode)){var s=e[I]||null;e:switch(e=r.stateNode,r.type){case"input":if(Ko(e,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),r=s.name,s.type==="radio"&&r!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+za(""+r)+'"][type="radio"]'),r=0;r<s.length;r++){var c=s[r];if(c!==e&&c.form===e.form){var d=c[I]||null;if(!d)throw Error(i(90));Ko(c,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(r=0;r<s.length;r++)c=s[r],c.form===e.form&&Pf(c)}break e;case"textarea":Hf(e,s.value,s.defaultValue);break e;case"select":r=s.value,r!=null&&mi(e,!!s.multiple,r,!1)}}}var Wo=!1;function Xf(e,r,s){if(Wo)return e(r,s);Wo=!0;try{var c=e(r);return c}finally{if(Wo=!1,(gi!==null||pi!==null)&&(Mc(),gi&&(r=gi,e=pi,pi=gi=null,Yf(r),e)))for(r=0;r<e.length;r++)Yf(e[r])}}function Ss(e,r){var s=e.stateNode;if(s===null)return null;var c=s[I]||null;if(c===null)return null;s=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(i(231,r,typeof s));return s}var wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vo=!1;if(wn)try{var ys={};Object.defineProperty(ys,"passive",{get:function(){Vo=!0}}),window.addEventListener("test",ys,ys),window.removeEventListener("test",ys,ys)}catch{Vo=!1}var $n=null,Yo=null,Gl=null;function qf(){if(Gl)return Gl;var e,r=Yo,s=r.length,c,d="value"in $n?$n.value:$n.textContent,m=d.length;for(e=0;e<s&&r[e]===d[e];e++);var E=s-e;for(c=1;c<=E&&r[s-c]===d[m-c];c++);return Gl=d.slice(e,1<c?1-c:void 0)}function Wl(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function Vl(){return!0}function Jf(){return!1}function va(e){function r(s,c,d,m,E){this._reactName=s,this._targetInst=d,this.type=c,this.nativeEvent=m,this.target=E,this.currentTarget=null;for(var A in e)e.hasOwnProperty(A)&&(s=e[A],this[A]=s?s(m):m[A]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Vl:Jf,this.isPropagationStopped=Jf,this}return S(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Vl)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Vl)},persist:function(){},isPersistent:Vl}),r}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yl=va(Ur),Cs=S({},Ur,{view:0,detail:0}),yp=va(Cs),Xo,qo,Ts,Xl=S({},Cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$o,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ts&&(Ts&&e.type==="mousemove"?(Xo=e.screenX-Ts.screenX,qo=e.screenY-Ts.screenY):qo=Xo=0,Ts=e),Xo)},movementY:function(e){return"movementY"in e?e.movementY:qo}}),$f=va(Xl),Cp=S({},Xl,{dataTransfer:0}),Tp=va(Cp),Ep=S({},Cs,{relatedTarget:0}),Jo=va(Ep),_p=S({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),wp=va(_p),bp=S({},Ur,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Np=va(bp),Ap=S({},Ur,{data:0}),Qf=va(Ap),Dp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kp(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=jp[e])?!!r[e]:!1}function $o(){return kp}var Up=S({},Cs,{key:function(e){if(e.key){var r=Dp[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=Wl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$o,charCode:function(e){return e.type==="keypress"?Wl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Wl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Op=va(Up),Ip=S({},Xl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zf=va(Ip),Rp=S({},Cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$o}),Fp=va(Rp),Lp=S({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bp=va(Lp),Kp=S({},Xl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pp=va(Kp),zp=S({},Ur,{newState:0,oldState:0}),Hp=va(zp),Gp=[9,13,27,32],Qo=wn&&"CompositionEvent"in window,Es=null;wn&&"documentMode"in document&&(Es=document.documentMode);var Wp=wn&&"TextEvent"in window&&!Es,ed=wn&&(!Qo||Es&&8<Es&&11>=Es),td=" ",ad=!1;function nd(e,r){switch(e){case"keyup":return Gp.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xi=!1;function Vp(e,r){switch(e){case"compositionend":return rd(r);case"keypress":return r.which!==32?null:(ad=!0,td);case"textInput":return e=r.data,e===td&&ad?null:e;default:return null}}function Yp(e,r){if(xi)return e==="compositionend"||!Qo&&nd(e,r)?(e=qf(),Gl=Yo=$n=null,xi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ed&&r.locale!=="ko"?null:r.data;default:return null}}var Xp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function id(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!Xp[e.type]:r==="textarea"}function sd(e,r,s,c){gi?pi?pi.push(c):pi=[c]:gi=c,r=Fc(r,"onChange"),0<r.length&&(s=new Yl("onChange","change",null,s,c),e.push({event:s,listeners:r}))}var _s=null,ws=null;function qp(e){zm(e,0)}function ql(e){var r=ye(e);if(Pf(r))return e}function ld(e,r){if(e==="change")return r}var cd=!1;if(wn){var Zo;if(wn){var eu="oninput"in document;if(!eu){var od=document.createElement("div");od.setAttribute("oninput","return;"),eu=typeof od.oninput=="function"}Zo=eu}else Zo=!1;cd=Zo&&(!document.documentMode||9<document.documentMode)}function ud(){_s&&(_s.detachEvent("onpropertychange",fd),ws=_s=null)}function fd(e){if(e.propertyName==="value"&&ql(ws)){var r=[];sd(r,ws,e,Go(e)),Xf(qp,r)}}function Jp(e,r,s){e==="focusin"?(ud(),_s=r,ws=s,_s.attachEvent("onpropertychange",fd)):e==="focusout"&&ud()}function $p(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ql(ws)}function Qp(e,r){if(e==="click")return ql(r)}function Zp(e,r){if(e==="input"||e==="change")return ql(r)}function ex(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var ba=typeof Object.is=="function"?Object.is:ex;function bs(e,r){if(ba(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var s=Object.keys(e),c=Object.keys(r);if(s.length!==c.length)return!1;for(c=0;c<s.length;c++){var d=s[c];if(!wa.call(r,d)||!ba(e[d],r[d]))return!1}return!0}function dd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hd(e,r){var s=dd(e);e=0;for(var c;s;){if(s.nodeType===3){if(c=e+s.textContent.length,e<=r&&c>=r)return{node:s,offset:r-e};e=c}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=dd(s)}}function md(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?md(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function vd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var r=zl(e.document);r instanceof e.HTMLIFrameElement;){try{var s=typeof r.contentWindow.location.href=="string"}catch{s=!1}if(s)e=r.contentWindow;else break;r=zl(e.document)}return r}function tu(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}var tx=wn&&"documentMode"in document&&11>=document.documentMode,Si=null,au=null,Ns=null,nu=!1;function gd(e,r,s){var c=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;nu||Si==null||Si!==zl(c)||(c=Si,"selectionStart"in c&&tu(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ns&&bs(Ns,c)||(Ns=c,c=Fc(au,"onSelect"),0<c.length&&(r=new Yl("onSelect","select",null,r,s),e.push({event:r,listeners:c}),r.target=Si)))}function Or(e,r){var s={};return s[e.toLowerCase()]=r.toLowerCase(),s["Webkit"+e]="webkit"+r,s["Moz"+e]="moz"+r,s}var yi={animationend:Or("Animation","AnimationEnd"),animationiteration:Or("Animation","AnimationIteration"),animationstart:Or("Animation","AnimationStart"),transitionrun:Or("Transition","TransitionRun"),transitionstart:Or("Transition","TransitionStart"),transitioncancel:Or("Transition","TransitionCancel"),transitionend:Or("Transition","TransitionEnd")},ru={},pd={};wn&&(pd=document.createElement("div").style,"AnimationEvent"in window||(delete yi.animationend.animation,delete yi.animationiteration.animation,delete yi.animationstart.animation),"TransitionEvent"in window||delete yi.transitionend.transition);function Ir(e){if(ru[e])return ru[e];if(!yi[e])return e;var r=yi[e],s;for(s in r)if(r.hasOwnProperty(s)&&s in pd)return ru[e]=r[s];return e}var xd=Ir("animationend"),Sd=Ir("animationiteration"),yd=Ir("animationstart"),ax=Ir("transitionrun"),nx=Ir("transitionstart"),rx=Ir("transitioncancel"),Cd=Ir("transitionend"),Td=new Map,iu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");iu.push("scrollEnd");function an(e,r){Td.set(e,r),Tt(r,[e])}var Jl=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ha=[],Ci=0,su=0;function $l(){for(var e=Ci,r=su=Ci=0;r<e;){var s=Ha[r];Ha[r++]=null;var c=Ha[r];Ha[r++]=null;var d=Ha[r];Ha[r++]=null;var m=Ha[r];if(Ha[r++]=null,c!==null&&d!==null){var E=c.pending;E===null?d.next=d:(d.next=E.next,E.next=d),c.pending=d}m!==0&&Ed(s,d,m)}}function Ql(e,r,s,c){Ha[Ci++]=e,Ha[Ci++]=r,Ha[Ci++]=s,Ha[Ci++]=c,su|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function lu(e,r,s,c){return Ql(e,r,s,c),Zl(e)}function Rr(e,r){return Ql(e,null,null,r),Zl(e)}function Ed(e,r,s){e.lanes|=s;var c=e.alternate;c!==null&&(c.lanes|=s);for(var d=!1,m=e.return;m!==null;)m.childLanes|=s,c=m.alternate,c!==null&&(c.childLanes|=s),m.tag===22&&(e=m.stateNode,e===null||e._visibility&1||(d=!0)),e=m,m=m.return;return e.tag===3?(m=e.stateNode,d&&r!==null&&(d=31-oa(s),e=m.hiddenUpdates,c=e[d],c===null?e[d]=[r]:c.push(r),r.lane=s|536870912),m):null}function Zl(e){if(50<qs)throw qs=0,g0=null,Error(i(185));for(var r=e.return;r!==null;)e=r,r=e.return;return e.tag===3?e.stateNode:null}var Ti={};function ix(e,r,s,c){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Na(e,r,s,c){return new ix(e,r,s,c)}function cu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bn(e,r){var s=e.alternate;return s===null?(s=Na(e.tag,r,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=r,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&65011712,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,r=e.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s.refCleanup=e.refCleanup,s}function _d(e,r){e.flags&=65011714;var s=e.alternate;return s===null?(e.childLanes=0,e.lanes=r,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=s.childLanes,e.lanes=s.lanes,e.child=s.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=s.memoizedProps,e.memoizedState=s.memoizedState,e.updateQueue=s.updateQueue,e.type=s.type,r=s.dependencies,e.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),e}function ec(e,r,s,c,d,m){var E=0;if(c=e,typeof e=="function")cu(e)&&(E=1);else if(typeof e=="string")E=uS(e,s,P.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case L:return e=Na(31,s,r,d),e.elementType=L,e.lanes=m,e;case y:return Fr(s.children,d,m,r);case _:E=8,d|=24;break;case w:return e=Na(12,s,r,d|2),e.elementType=w,e.lanes=m,e;case K:return e=Na(13,s,r,d),e.elementType=K,e.lanes=m,e;case J:return e=Na(19,s,r,d),e.elementType=J,e.lanes=m,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:E=10;break e;case k:E=9;break e;case N:E=11;break e;case B:E=14;break e;case Z:E=16,c=null;break e}E=29,s=Error(i(130,e===null?"null":typeof e,"")),c=null}return r=Na(E,s,r,d),r.elementType=e,r.type=c,r.lanes=m,r}function Fr(e,r,s,c){return e=Na(7,e,c,r),e.lanes=s,e}function ou(e,r,s){return e=Na(6,e,null,r),e.lanes=s,e}function wd(e){var r=Na(18,null,null,0);return r.stateNode=e,r}function uu(e,r,s){return r=Na(4,e.children!==null?e.children:[],e.key,r),r.lanes=s,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}var bd=new WeakMap;function Ga(e,r){if(typeof e=="object"&&e!==null){var s=bd.get(e);return s!==void 0?s:(r={value:e,source:r,stack:ca(r)},bd.set(e,r),r)}return{value:e,source:r,stack:ca(r)}}var Ei=[],_i=0,tc=null,As=0,Wa=[],Va=0,Qn=null,vn=1,gn="";function Nn(e,r){Ei[_i++]=As,Ei[_i++]=tc,tc=e,As=r}function Nd(e,r,s){Wa[Va++]=vn,Wa[Va++]=gn,Wa[Va++]=Qn,Qn=e;var c=vn;e=gn;var d=32-oa(c)-1;c&=~(1<<d),s+=1;var m=32-oa(r)+d;if(30<m){var E=d-d%5;m=(c&(1<<E)-1).toString(32),c>>=E,d-=E,vn=1<<32-oa(r)+d|s<<d|c,gn=m+e}else vn=1<<m|s<<d|c,gn=e}function fu(e){e.return!==null&&(Nn(e,1),Nd(e,1,0))}function du(e){for(;e===tc;)tc=Ei[--_i],Ei[_i]=null,As=Ei[--_i],Ei[_i]=null;for(;e===Qn;)Qn=Wa[--Va],Wa[Va]=null,gn=Wa[--Va],Wa[Va]=null,vn=Wa[--Va],Wa[Va]=null}function Ad(e,r){Wa[Va++]=vn,Wa[Va++]=gn,Wa[Va++]=Qn,vn=r.id,gn=r.overflow,Qn=e}var Yt=null,xt=null,$e=!1,Zn=null,Ya=!1,hu=Error(i(519));function er(e){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ds(Ga(r,e)),hu}function Dd(e){var r=e.stateNode,s=e.type,c=e.memoizedProps;switch(r[O]=e,r[I]=c,s){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(s=0;s<$s.length;s++)Xe($s[s],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":Xe("invalid",r),zf(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Xe("invalid",r);break;case"textarea":Xe("invalid",r),Gf(r,c.value,c.defaultValue,c.children)}s=c.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||r.textContent===""+s||c.suppressHydrationWarning===!0||Vm(r.textContent,s)?(c.popover!=null&&(Xe("beforetoggle",r),Xe("toggle",r)),c.onScroll!=null&&Xe("scroll",r),c.onScrollEnd!=null&&Xe("scrollend",r),c.onClick!=null&&(r.onclick=_n),r=!0):r=!1,r||er(e,!0)}function Md(e){for(Yt=e.return;Yt;)switch(Yt.tag){case 5:case 31:case 13:Ya=!1;return;case 27:case 3:Ya=!0;return;default:Yt=Yt.return}}function wi(e){if(e!==Yt)return!1;if(!$e)return Md(e),$e=!0,!1;var r=e.tag,s;if((s=r!==3&&r!==27)&&((s=r===5)&&(s=e.type,s=!(s!=="form"&&s!=="button")||j0(e.type,e.memoizedProps)),s=!s),s&&xt&&er(e),Md(e),r===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));xt=t1(e)}else if(r===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));xt=t1(e)}else r===27?(r=xt,mr(e.type)?(e=R0,R0=null,xt=e):xt=r):xt=Yt?qa(e.stateNode.nextSibling):null;return!0}function Lr(){xt=Yt=null,$e=!1}function mu(){var e=Zn;return e!==null&&(Sa===null?Sa=e:Sa.push.apply(Sa,e),Zn=null),e}function Ds(e){Zn===null?Zn=[e]:Zn.push(e)}var vu=H(null),Br=null,An=null;function tr(e,r,s){V(vu,r._currentValue),r._currentValue=s}function Dn(e){e._currentValue=vu.current,j(vu)}function gu(e,r,s){for(;e!==null;){var c=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),e===s)break;e=e.return}}function pu(e,r,s,c){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var m=d.dependencies;if(m!==null){var E=d.child;m=m.firstContext;e:for(;m!==null;){var A=m;m=d;for(var W=0;W<r.length;W++)if(A.context===r[W]){m.lanes|=s,A=m.alternate,A!==null&&(A.lanes|=s),gu(m.return,s,e),c||(E=null);break e}m=A.next}}else if(d.tag===18){if(E=d.return,E===null)throw Error(i(341));E.lanes|=s,m=E.alternate,m!==null&&(m.lanes|=s),gu(E,s,e),E=null}else E=d.child;if(E!==null)E.return=d;else for(E=d;E!==null;){if(E===e){E=null;break}if(d=E.sibling,d!==null){d.return=E.return,E=d;break}E=E.return}d=E}}function bi(e,r,s,c){e=null;for(var d=r,m=!1;d!==null;){if(!m){if((d.flags&524288)!==0)m=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var E=d.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var A=d.type;ba(d.pendingProps.value,E.value)||(e!==null?e.push(A):e=[A])}}else if(d===Ce.current){if(E=d.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(al):e=[al])}d=d.return}e!==null&&pu(r,e,s,c),r.flags|=262144}function ac(e){for(e=e.firstContext;e!==null;){if(!ba(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Kr(e){Br=e,An=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Xt(e){return jd(Br,e)}function nc(e,r){return Br===null&&Kr(e),jd(e,r)}function jd(e,r){var s=r._currentValue;if(r={context:r,memoizedValue:s,next:null},An===null){if(e===null)throw Error(i(308));An=r,e.dependencies={lanes:0,firstContext:r},e.flags|=524288}else An=An.next=r;return s}var sx=typeof AbortController<"u"?AbortController:function(){var e=[],r=this.signal={aborted:!1,addEventListener:function(s,c){e.push(c)}};this.abort=function(){r.aborted=!0,e.forEach(function(s){return s()})}},lx=a.unstable_scheduleCallback,cx=a.unstable_NormalPriority,Mt={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xu(){return{controller:new sx,data:new Map,refCount:0}}function Ms(e){e.refCount--,e.refCount===0&&lx(cx,function(){e.controller.abort()})}var js=null,Su=0,Ni=0,Ai=null;function ox(e,r){if(js===null){var s=js=[];Su=0,Ni=T0(),Ai={status:"pending",value:void 0,then:function(c){s.push(c)}}}return Su++,r.then(kd,kd),r}function kd(){if(--Su===0&&js!==null){Ai!==null&&(Ai.status="fulfilled");var e=js;js=null,Ni=0,Ai=null;for(var r=0;r<e.length;r++)(0,e[r])()}}function ux(e,r){var s=[],c={status:"pending",value:null,reason:null,then:function(d){s.push(d)}};return e.then(function(){c.status="fulfilled",c.value=r;for(var d=0;d<s.length;d++)(0,s[d])(r)},function(d){for(c.status="rejected",c.reason=d,d=0;d<s.length;d++)(0,s[d])(void 0)}),c}var Ud=ee.S;ee.S=function(e,r){gm=Ct(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&ox(e,r),Ud!==null&&Ud(e,r)};var Pr=H(null);function yu(){var e=Pr.current;return e!==null?e:mt.pooledCache}function rc(e,r){r===null?V(Pr,Pr.current):V(Pr,r.pool)}function Od(){var e=yu();return e===null?null:{parent:Mt._currentValue,pool:e}}var Di=Error(i(460)),Cu=Error(i(474)),ic=Error(i(542)),sc={then:function(){}};function Id(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Rd(e,r,s){switch(s=e[s],s===void 0?e.push(r):s!==r&&(r.then(_n,_n),r=s),r.status){case"fulfilled":return r.value;case"rejected":throw e=r.reason,Ld(e),e;default:if(typeof r.status=="string")r.then(_n,_n);else{if(e=mt,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=r,e.status="pending",e.then(function(c){if(r.status==="pending"){var d=r;d.status="fulfilled",d.value=c}},function(c){if(r.status==="pending"){var d=r;d.status="rejected",d.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw e=r.reason,Ld(e),e}throw Hr=r,Di}}function zr(e){try{var r=e._init;return r(e._payload)}catch(s){throw s!==null&&typeof s=="object"&&typeof s.then=="function"?(Hr=s,Di):s}}var Hr=null;function Fd(){if(Hr===null)throw Error(i(459));var e=Hr;return Hr=null,e}function Ld(e){if(e===Di||e===ic)throw Error(i(483))}var Mi=null,ks=0;function lc(e){var r=ks;return ks+=1,Mi===null&&(Mi=[]),Rd(Mi,e,r)}function Us(e,r){r=r.props.ref,e.ref=r!==void 0?r:null}function cc(e,r){throw r.$$typeof===x?Error(i(525)):(e=Object.prototype.toString.call(r),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)))}function Bd(e){function r(Q,q){if(e){var te=Q.deletions;te===null?(Q.deletions=[q],Q.flags|=16):te.push(q)}}function s(Q,q){if(!e)return null;for(;q!==null;)r(Q,q),q=q.sibling;return null}function c(Q){for(var q=new Map;Q!==null;)Q.key!==null?q.set(Q.key,Q):q.set(Q.index,Q),Q=Q.sibling;return q}function d(Q,q){return Q=bn(Q,q),Q.index=0,Q.sibling=null,Q}function m(Q,q,te){return Q.index=te,e?(te=Q.alternate,te!==null?(te=te.index,te<q?(Q.flags|=67108866,q):te):(Q.flags|=67108866,q)):(Q.flags|=1048576,q)}function E(Q){return e&&Q.alternate===null&&(Q.flags|=67108866),Q}function A(Q,q,te,me){return q===null||q.tag!==6?(q=ou(te,Q.mode,me),q.return=Q,q):(q=d(q,te),q.return=Q,q)}function W(Q,q,te,me){var Fe=te.type;return Fe===y?de(Q,q,te.props.children,me,te.key):q!==null&&(q.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===Z&&zr(Fe)===q.type)?(q=d(q,te.props),Us(q,te),q.return=Q,q):(q=ec(te.type,te.key,te.props,null,Q.mode,me),Us(q,te),q.return=Q,q)}function ae(Q,q,te,me){return q===null||q.tag!==4||q.stateNode.containerInfo!==te.containerInfo||q.stateNode.implementation!==te.implementation?(q=uu(te,Q.mode,me),q.return=Q,q):(q=d(q,te.children||[]),q.return=Q,q)}function de(Q,q,te,me,Fe){return q===null||q.tag!==7?(q=Fr(te,Q.mode,me,Fe),q.return=Q,q):(q=d(q,te),q.return=Q,q)}function ve(Q,q,te){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=ou(""+q,Q.mode,te),q.return=Q,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case C:return te=ec(q.type,q.key,q.props,null,Q.mode,te),Us(te,q),te.return=Q,te;case T:return q=uu(q,Q.mode,te),q.return=Q,q;case Z:return q=zr(q),ve(Q,q,te)}if(Se(q)||z(q))return q=Fr(q,Q.mode,te,null),q.return=Q,q;if(typeof q.then=="function")return ve(Q,lc(q),te);if(q.$$typeof===M)return ve(Q,nc(Q,q),te);cc(Q,q)}return null}function se(Q,q,te,me){var Fe=q!==null?q.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Fe!==null?null:A(Q,q,""+te,me);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case C:return te.key===Fe?W(Q,q,te,me):null;case T:return te.key===Fe?ae(Q,q,te,me):null;case Z:return te=zr(te),se(Q,q,te,me)}if(Se(te)||z(te))return Fe!==null?null:de(Q,q,te,me,null);if(typeof te.then=="function")return se(Q,q,lc(te),me);if(te.$$typeof===M)return se(Q,q,nc(Q,te),me);cc(Q,te)}return null}function oe(Q,q,te,me,Fe){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Q=Q.get(te)||null,A(q,Q,""+me,Fe);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case C:return Q=Q.get(me.key===null?te:me.key)||null,W(q,Q,me,Fe);case T:return Q=Q.get(me.key===null?te:me.key)||null,ae(q,Q,me,Fe);case Z:return me=zr(me),oe(Q,q,te,me,Fe)}if(Se(me)||z(me))return Q=Q.get(te)||null,de(q,Q,me,Fe,null);if(typeof me.then=="function")return oe(Q,q,te,lc(me),Fe);if(me.$$typeof===M)return oe(Q,q,te,nc(q,me),Fe);cc(q,me)}return null}function Oe(Q,q,te,me){for(var Fe=null,Ze=null,Re=q,He=q=0,Je=null;Re!==null&&He<te.length;He++){Re.index>He?(Je=Re,Re=null):Je=Re.sibling;var et=se(Q,Re,te[He],me);if(et===null){Re===null&&(Re=Je);break}e&&Re&&et.alternate===null&&r(Q,Re),q=m(et,q,He),Ze===null?Fe=et:Ze.sibling=et,Ze=et,Re=Je}if(He===te.length)return s(Q,Re),$e&&Nn(Q,He),Fe;if(Re===null){for(;He<te.length;He++)Re=ve(Q,te[He],me),Re!==null&&(q=m(Re,q,He),Ze===null?Fe=Re:Ze.sibling=Re,Ze=Re);return $e&&Nn(Q,He),Fe}for(Re=c(Re);He<te.length;He++)Je=oe(Re,Q,He,te[He],me),Je!==null&&(e&&Je.alternate!==null&&Re.delete(Je.key===null?He:Je.key),q=m(Je,q,He),Ze===null?Fe=Je:Ze.sibling=Je,Ze=Je);return e&&Re.forEach(function(Sr){return r(Q,Sr)}),$e&&Nn(Q,He),Fe}function Be(Q,q,te,me){if(te==null)throw Error(i(151));for(var Fe=null,Ze=null,Re=q,He=q=0,Je=null,et=te.next();Re!==null&&!et.done;He++,et=te.next()){Re.index>He?(Je=Re,Re=null):Je=Re.sibling;var Sr=se(Q,Re,et.value,me);if(Sr===null){Re===null&&(Re=Je);break}e&&Re&&Sr.alternate===null&&r(Q,Re),q=m(Sr,q,He),Ze===null?Fe=Sr:Ze.sibling=Sr,Ze=Sr,Re=Je}if(et.done)return s(Q,Re),$e&&Nn(Q,He),Fe;if(Re===null){for(;!et.done;He++,et=te.next())et=ve(Q,et.value,me),et!==null&&(q=m(et,q,He),Ze===null?Fe=et:Ze.sibling=et,Ze=et);return $e&&Nn(Q,He),Fe}for(Re=c(Re);!et.done;He++,et=te.next())et=oe(Re,Q,He,et.value,me),et!==null&&(e&&et.alternate!==null&&Re.delete(et.key===null?He:et.key),q=m(et,q,He),Ze===null?Fe=et:Ze.sibling=et,Ze=et);return e&&Re.forEach(function(CS){return r(Q,CS)}),$e&&Nn(Q,He),Fe}function dt(Q,q,te,me){if(typeof te=="object"&&te!==null&&te.type===y&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case C:e:{for(var Fe=te.key;q!==null;){if(q.key===Fe){if(Fe=te.type,Fe===y){if(q.tag===7){s(Q,q.sibling),me=d(q,te.props.children),me.return=Q,Q=me;break e}}else if(q.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===Z&&zr(Fe)===q.type){s(Q,q.sibling),me=d(q,te.props),Us(me,te),me.return=Q,Q=me;break e}s(Q,q);break}else r(Q,q);q=q.sibling}te.type===y?(me=Fr(te.props.children,Q.mode,me,te.key),me.return=Q,Q=me):(me=ec(te.type,te.key,te.props,null,Q.mode,me),Us(me,te),me.return=Q,Q=me)}return E(Q);case T:e:{for(Fe=te.key;q!==null;){if(q.key===Fe)if(q.tag===4&&q.stateNode.containerInfo===te.containerInfo&&q.stateNode.implementation===te.implementation){s(Q,q.sibling),me=d(q,te.children||[]),me.return=Q,Q=me;break e}else{s(Q,q);break}else r(Q,q);q=q.sibling}me=uu(te,Q.mode,me),me.return=Q,Q=me}return E(Q);case Z:return te=zr(te),dt(Q,q,te,me)}if(Se(te))return Oe(Q,q,te,me);if(z(te)){if(Fe=z(te),typeof Fe!="function")throw Error(i(150));return te=Fe.call(te),Be(Q,q,te,me)}if(typeof te.then=="function")return dt(Q,q,lc(te),me);if(te.$$typeof===M)return dt(Q,q,nc(Q,te),me);cc(Q,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,q!==null&&q.tag===6?(s(Q,q.sibling),me=d(q,te),me.return=Q,Q=me):(s(Q,q),me=ou(te,Q.mode,me),me.return=Q,Q=me),E(Q)):s(Q,q)}return function(Q,q,te,me){try{ks=0;var Fe=dt(Q,q,te,me);return Mi=null,Fe}catch(Re){if(Re===Di||Re===ic)throw Re;var Ze=Na(29,Re,null,Q.mode);return Ze.lanes=me,Ze.return=Q,Ze}finally{}}}var Gr=Bd(!0),Kd=Bd(!1),ar=!1;function Tu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Eu(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function nr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function rr(e,r,s){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(at&2)!==0){var d=c.pending;return d===null?r.next=r:(r.next=d.next,d.next=r),c.pending=r,r=Zl(e),Ed(e,null,s),r}return Ql(e,c,r,s),Zl(e)}function Os(e,r,s){if(r=r.updateQueue,r!==null&&(r=r.shared,(s&4194048)!==0)){var c=r.lanes;c&=e.pendingLanes,s|=c,r.lanes=s,hi(e,s)}}function _u(e,r){var s=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,s===c)){var d=null,m=null;if(s=s.firstBaseUpdate,s!==null){do{var E={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};m===null?d=m=E:m=m.next=E,s=s.next}while(s!==null);m===null?d=m=r:m=m.next=r}else d=m=r;s={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=r:e.next=r,s.lastBaseUpdate=r}var wu=!1;function Is(){if(wu){var e=Ai;if(e!==null)throw e}}function Rs(e,r,s,c){wu=!1;var d=e.updateQueue;ar=!1;var m=d.firstBaseUpdate,E=d.lastBaseUpdate,A=d.shared.pending;if(A!==null){d.shared.pending=null;var W=A,ae=W.next;W.next=null,E===null?m=ae:E.next=ae,E=W;var de=e.alternate;de!==null&&(de=de.updateQueue,A=de.lastBaseUpdate,A!==E&&(A===null?de.firstBaseUpdate=ae:A.next=ae,de.lastBaseUpdate=W))}if(m!==null){var ve=d.baseState;E=0,de=ae=W=null,A=m;do{var se=A.lane&-536870913,oe=se!==A.lane;if(oe?(qe&se)===se:(c&se)===se){se!==0&&se===Ni&&(wu=!0),de!==null&&(de=de.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Oe=e,Be=A;se=r;var dt=s;switch(Be.tag){case 1:if(Oe=Be.payload,typeof Oe=="function"){ve=Oe.call(dt,ve,se);break e}ve=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Be.payload,se=typeof Oe=="function"?Oe.call(dt,ve,se):Oe,se==null)break e;ve=S({},ve,se);break e;case 2:ar=!0}}se=A.callback,se!==null&&(e.flags|=64,oe&&(e.flags|=8192),oe=d.callbacks,oe===null?d.callbacks=[se]:oe.push(se))}else oe={lane:se,tag:A.tag,payload:A.payload,callback:A.callback,next:null},de===null?(ae=de=oe,W=ve):de=de.next=oe,E|=se;if(A=A.next,A===null){if(A=d.shared.pending,A===null)break;oe=A,A=oe.next,oe.next=null,d.lastBaseUpdate=oe,d.shared.pending=null}}while(!0);de===null&&(W=ve),d.baseState=W,d.firstBaseUpdate=ae,d.lastBaseUpdate=de,m===null&&(d.shared.lanes=0),or|=E,e.lanes=E,e.memoizedState=ve}}function Pd(e,r){if(typeof e!="function")throw Error(i(191,e));e.call(r)}function zd(e,r){var s=e.callbacks;if(s!==null)for(e.callbacks=null,e=0;e<s.length;e++)Pd(s[e],r)}var ji=H(null),oc=H(0);function Hd(e,r){e=Ln,V(oc,e),V(ji,r),Ln=e|r.baseLanes}function bu(){V(oc,Ln),V(ji,ji.current)}function Nu(){Ln=oc.current,j(ji),j(oc)}var Aa=H(null),Xa=null;function ir(e){var r=e.alternate;V(At,At.current&1),V(Aa,e),Xa===null&&(r===null||ji.current!==null||r.memoizedState!==null)&&(Xa=e)}function Au(e){V(At,At.current),V(Aa,e),Xa===null&&(Xa=e)}function Gd(e){e.tag===22?(V(At,At.current),V(Aa,e),Xa===null&&(Xa=e)):sr()}function sr(){V(At,At.current),V(Aa,Aa.current)}function Da(e){j(Aa),Xa===e&&(Xa=null),j(At)}var At=H(0);function uc(e){for(var r=e;r!==null;){if(r.tag===13){var s=r.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||O0(s)||I0(s)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Mn=0,ze=null,ut=null,jt=null,fc=!1,ki=!1,Wr=!1,dc=0,Fs=0,Ui=null,fx=0;function _t(){throw Error(i(321))}function Du(e,r){if(r===null)return!1;for(var s=0;s<r.length&&s<e.length;s++)if(!ba(e[s],r[s]))return!1;return!0}function Mu(e,r,s,c,d,m){return Mn=m,ze=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ee.H=e===null||e.memoizedState===null?Nh:Wu,Wr=!1,m=s(c,d),Wr=!1,ki&&(m=Vd(r,s,c,d)),Wd(e),m}function Wd(e){ee.H=Ks;var r=ut!==null&&ut.next!==null;if(Mn=0,jt=ut=ze=null,fc=!1,Fs=0,Ui=null,r)throw Error(i(300));e===null||kt||(e=e.dependencies,e!==null&&ac(e)&&(kt=!0))}function Vd(e,r,s,c){ze=e;var d=0;do{if(ki&&(Ui=null),Fs=0,ki=!1,25<=d)throw Error(i(301));if(d+=1,jt=ut=null,e.updateQueue!=null){var m=e.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}ee.H=Ah,m=r(s,c)}while(ki);return m}function dx(){var e=ee.H,r=e.useState()[0];return r=typeof r.then=="function"?Ls(r):r,e=e.useState()[0],(ut!==null?ut.memoizedState:null)!==e&&(ze.flags|=1024),r}function ju(){var e=dc!==0;return dc=0,e}function ku(e,r,s){r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~s}function Uu(e){if(fc){for(e=e.memoizedState;e!==null;){var r=e.queue;r!==null&&(r.pending=null),e=e.next}fc=!1}Mn=0,jt=ut=ze=null,ki=!1,Fs=dc=0,Ui=null}function ua(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?ze.memoizedState=jt=e:jt=jt.next=e,jt}function Dt(){if(ut===null){var e=ze.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var r=jt===null?ze.memoizedState:jt.next;if(r!==null)jt=r,ut=e;else{if(e===null)throw ze.alternate===null?Error(i(467)):Error(i(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},jt===null?ze.memoizedState=jt=e:jt=jt.next=e}return jt}function hc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ls(e){var r=Fs;return Fs+=1,Ui===null&&(Ui=[]),e=Rd(Ui,e,r),r=ze,(jt===null?r.memoizedState:jt.next)===null&&(r=r.alternate,ee.H=r===null||r.memoizedState===null?Nh:Wu),e}function mc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ls(e);if(e.$$typeof===M)return Xt(e)}throw Error(i(438,String(e)))}function Ou(e){var r=null,s=ze.updateQueue;if(s!==null&&(r=s.memoCache),r==null){var c=ze.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(d){return d.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),s===null&&(s=hc(),ze.updateQueue=s),s.memoCache=r,s=r.data[r.index],s===void 0)for(s=r.data[r.index]=Array(e),c=0;c<e;c++)s[c]=X;return r.index++,s}function jn(e,r){return typeof r=="function"?r(e):r}function vc(e){var r=Dt();return Iu(r,ut,e)}function Iu(e,r,s){var c=e.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=s;var d=e.baseQueue,m=c.pending;if(m!==null){if(d!==null){var E=d.next;d.next=m.next,m.next=E}r.baseQueue=d=m,c.pending=null}if(m=e.baseState,d===null)e.memoizedState=m;else{r=d.next;var A=E=null,W=null,ae=r,de=!1;do{var ve=ae.lane&-536870913;if(ve!==ae.lane?(qe&ve)===ve:(Mn&ve)===ve){var se=ae.revertLane;if(se===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),ve===Ni&&(de=!0);else if((Mn&se)===se){ae=ae.next,se===Ni&&(de=!0);continue}else ve={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},W===null?(A=W=ve,E=m):W=W.next=ve,ze.lanes|=se,or|=se;ve=ae.action,Wr&&s(m,ve),m=ae.hasEagerState?ae.eagerState:s(m,ve)}else se={lane:ve,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},W===null?(A=W=se,E=m):W=W.next=se,ze.lanes|=ve,or|=ve;ae=ae.next}while(ae!==null&&ae!==r);if(W===null?E=m:W.next=A,!ba(m,e.memoizedState)&&(kt=!0,de&&(s=Ai,s!==null)))throw s;e.memoizedState=m,e.baseState=E,e.baseQueue=W,c.lastRenderedState=m}return d===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function Ru(e){var r=Dt(),s=r.queue;if(s===null)throw Error(i(311));s.lastRenderedReducer=e;var c=s.dispatch,d=s.pending,m=r.memoizedState;if(d!==null){s.pending=null;var E=d=d.next;do m=e(m,E.action),E=E.next;while(E!==d);ba(m,r.memoizedState)||(kt=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),s.lastRenderedState=m}return[m,c]}function Yd(e,r,s){var c=ze,d=Dt(),m=$e;if(m){if(s===void 0)throw Error(i(407));s=s()}else s=r();var E=!ba((ut||d).memoizedState,s);if(E&&(d.memoizedState=s,kt=!0),d=d.queue,Bu(Jd.bind(null,c,d,e),[e]),d.getSnapshot!==r||E||jt!==null&&jt.memoizedState.tag&1){if(c.flags|=2048,Oi(9,{destroy:void 0},qd.bind(null,c,d,s,r),null),mt===null)throw Error(i(349));m||(Mn&127)!==0||Xd(c,r,s)}return s}function Xd(e,r,s){e.flags|=16384,e={getSnapshot:r,value:s},r=ze.updateQueue,r===null?(r=hc(),ze.updateQueue=r,r.stores=[e]):(s=r.stores,s===null?r.stores=[e]:s.push(e))}function qd(e,r,s,c){r.value=s,r.getSnapshot=c,$d(r)&&Qd(e)}function Jd(e,r,s){return s(function(){$d(r)&&Qd(e)})}function $d(e){var r=e.getSnapshot;e=e.value;try{var s=r();return!ba(e,s)}catch{return!0}}function Qd(e){var r=Rr(e,2);r!==null&&ya(r,e,2)}function Fu(e){var r=ua();if(typeof e=="function"){var s=e;if(e=s(),Wr){tn(!0);try{s()}finally{tn(!1)}}}return r.memoizedState=r.baseState=e,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:e},r}function Zd(e,r,s,c){return e.baseState=s,Iu(e,ut,typeof c=="function"?c:jn)}function hx(e,r,s,c,d){if(xc(e))throw Error(i(485));if(e=r.action,e!==null){var m={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){m.listeners.push(E)}};ee.T!==null?s(!0):m.isTransition=!1,c(m),s=r.pending,s===null?(m.next=r.pending=m,eh(r,m)):(m.next=s.next,r.pending=s.next=m)}}function eh(e,r){var s=r.action,c=r.payload,d=e.state;if(r.isTransition){var m=ee.T,E={};ee.T=E;try{var A=s(d,c),W=ee.S;W!==null&&W(E,A),th(e,r,A)}catch(ae){Lu(e,r,ae)}finally{m!==null&&E.types!==null&&(m.types=E.types),ee.T=m}}else try{m=s(d,c),th(e,r,m)}catch(ae){Lu(e,r,ae)}}function th(e,r,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(c){ah(e,r,c)},function(c){return Lu(e,r,c)}):ah(e,r,s)}function ah(e,r,s){r.status="fulfilled",r.value=s,nh(r),e.state=s,r=e.pending,r!==null&&(s=r.next,s===r?e.pending=null:(s=s.next,r.next=s,eh(e,s)))}function Lu(e,r,s){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=s,nh(r),r=r.next;while(r!==c)}e.action=null}function nh(e){e=e.listeners;for(var r=0;r<e.length;r++)(0,e[r])()}function rh(e,r){return r}function ih(e,r){if($e){var s=mt.formState;if(s!==null){e:{var c=ze;if($e){if(xt){t:{for(var d=xt,m=Ya;d.nodeType!==8;){if(!m){d=null;break t}if(d=qa(d.nextSibling),d===null){d=null;break t}}m=d.data,d=m==="F!"||m==="F"?d:null}if(d){xt=qa(d.nextSibling),c=d.data==="F!";break e}}er(c)}c=!1}c&&(r=s[0])}}return s=ua(),s.memoizedState=s.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rh,lastRenderedState:r},s.queue=c,s=_h.bind(null,ze,c),c.dispatch=s,c=Fu(!1),m=Gu.bind(null,ze,!1,c.queue),c=ua(),d={state:r,dispatch:null,action:e,pending:null},c.queue=d,s=hx.bind(null,ze,d,m,s),d.dispatch=s,c.memoizedState=e,[r,s,!1]}function sh(e){var r=Dt();return lh(r,ut,e)}function lh(e,r,s){if(r=Iu(e,r,rh)[0],e=vc(jn)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Ls(r)}catch(E){throw E===Di?ic:E}else c=r;r=Dt();var d=r.queue,m=d.dispatch;return s!==r.memoizedState&&(ze.flags|=2048,Oi(9,{destroy:void 0},mx.bind(null,d,s),null)),[c,m,e]}function mx(e,r){e.action=r}function ch(e){var r=Dt(),s=ut;if(s!==null)return lh(r,s,e);Dt(),r=r.memoizedState,s=Dt();var c=s.queue.dispatch;return s.memoizedState=e,[r,c,!1]}function Oi(e,r,s,c){return e={tag:e,create:s,deps:c,inst:r,next:null},r=ze.updateQueue,r===null&&(r=hc(),ze.updateQueue=r),s=r.lastEffect,s===null?r.lastEffect=e.next=e:(c=s.next,s.next=e,e.next=c,r.lastEffect=e),e}function oh(){return Dt().memoizedState}function gc(e,r,s,c){var d=ua();ze.flags|=e,d.memoizedState=Oi(1|r,{destroy:void 0},s,c===void 0?null:c)}function pc(e,r,s,c){var d=Dt();c=c===void 0?null:c;var m=d.memoizedState.inst;ut!==null&&c!==null&&Du(c,ut.memoizedState.deps)?d.memoizedState=Oi(r,m,s,c):(ze.flags|=e,d.memoizedState=Oi(1|r,m,s,c))}function uh(e,r){gc(8390656,8,e,r)}function Bu(e,r){pc(2048,8,e,r)}function vx(e){ze.flags|=4;var r=ze.updateQueue;if(r===null)r=hc(),ze.updateQueue=r,r.events=[e];else{var s=r.events;s===null?r.events=[e]:s.push(e)}}function fh(e){var r=Dt().memoizedState;return vx({ref:r,nextImpl:e}),function(){if((at&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function dh(e,r){return pc(4,2,e,r)}function hh(e,r){return pc(4,4,e,r)}function mh(e,r){if(typeof r=="function"){e=e();var s=r(e);return function(){typeof s=="function"?s():r(null)}}if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function vh(e,r,s){s=s!=null?s.concat([e]):null,pc(4,4,mh.bind(null,r,e),s)}function Ku(){}function gh(e,r){var s=Dt();r=r===void 0?null:r;var c=s.memoizedState;return r!==null&&Du(r,c[1])?c[0]:(s.memoizedState=[e,r],e)}function ph(e,r){var s=Dt();r=r===void 0?null:r;var c=s.memoizedState;if(r!==null&&Du(r,c[1]))return c[0];if(c=e(),Wr){tn(!0);try{e()}finally{tn(!1)}}return s.memoizedState=[c,r],c}function Pu(e,r,s){return s===void 0||(Mn&1073741824)!==0&&(qe&261930)===0?e.memoizedState=r:(e.memoizedState=s,e=xm(),ze.lanes|=e,or|=e,s)}function xh(e,r,s,c){return ba(s,r)?s:ji.current!==null?(e=Pu(e,s,c),ba(e,r)||(kt=!0),e):(Mn&42)===0||(Mn&1073741824)!==0&&(qe&261930)===0?(kt=!0,e.memoizedState=s):(e=xm(),ze.lanes|=e,or|=e,r)}function Sh(e,r,s,c,d){var m=ge.p;ge.p=m!==0&&8>m?m:8;var E=ee.T,A={};ee.T=A,Gu(e,!1,r,s);try{var W=d(),ae=ee.S;if(ae!==null&&ae(A,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var de=ux(W,c);Bs(e,r,de,ka(e))}else Bs(e,r,c,ka(e))}catch(ve){Bs(e,r,{then:function(){},status:"rejected",reason:ve},ka())}finally{ge.p=m,E!==null&&A.types!==null&&(E.types=A.types),ee.T=E}}function gx(){}function zu(e,r,s,c){if(e.tag!==5)throw Error(i(476));var d=yh(e).queue;Sh(e,d,r,ke,s===null?gx:function(){return Ch(e),s(c)})}function yh(e){var r=e.memoizedState;if(r!==null)return r;r={memoizedState:ke,baseState:ke,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:ke},next:null};var s={};return r.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:s},next:null},e.memoizedState=r,e=e.alternate,e!==null&&(e.memoizedState=r),r}function Ch(e){var r=yh(e);r.next===null&&(r=e.alternate.memoizedState),Bs(e,r.next.queue,{},ka())}function Hu(){return Xt(al)}function Th(){return Dt().memoizedState}function Eh(){return Dt().memoizedState}function px(e){for(var r=e.return;r!==null;){switch(r.tag){case 24:case 3:var s=ka();e=nr(s);var c=rr(r,e,s);c!==null&&(ya(c,r,s),Os(c,r,s)),r={cache:xu()},e.payload=r;return}r=r.return}}function xx(e,r,s){var c=ka();s={lane:c,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},xc(e)?wh(r,s):(s=lu(e,r,s,c),s!==null&&(ya(s,e,c),bh(s,r,c)))}function _h(e,r,s){var c=ka();Bs(e,r,s,c)}function Bs(e,r,s,c){var d={lane:c,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null};if(xc(e))wh(r,d);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var E=r.lastRenderedState,A=m(E,s);if(d.hasEagerState=!0,d.eagerState=A,ba(A,E))return Ql(e,r,d,0),mt===null&&$l(),!1}catch{}finally{}if(s=lu(e,r,d,c),s!==null)return ya(s,e,c),bh(s,r,c),!0}return!1}function Gu(e,r,s,c){if(c={lane:2,revertLane:T0(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xc(e)){if(r)throw Error(i(479))}else r=lu(e,s,c,2),r!==null&&ya(r,e,2)}function xc(e){var r=e.alternate;return e===ze||r!==null&&r===ze}function wh(e,r){ki=fc=!0;var s=e.pending;s===null?r.next=r:(r.next=s.next,s.next=r),e.pending=r}function bh(e,r,s){if((s&4194048)!==0){var c=r.lanes;c&=e.pendingLanes,s|=c,r.lanes=s,hi(e,s)}}var Ks={readContext:Xt,use:mc,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useLayoutEffect:_t,useInsertionEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useSyncExternalStore:_t,useId:_t,useHostTransitionStatus:_t,useFormState:_t,useActionState:_t,useOptimistic:_t,useMemoCache:_t,useCacheRefresh:_t};Ks.useEffectEvent=_t;var Nh={readContext:Xt,use:mc,useCallback:function(e,r){return ua().memoizedState=[e,r===void 0?null:r],e},useContext:Xt,useEffect:uh,useImperativeHandle:function(e,r,s){s=s!=null?s.concat([e]):null,gc(4194308,4,mh.bind(null,r,e),s)},useLayoutEffect:function(e,r){return gc(4194308,4,e,r)},useInsertionEffect:function(e,r){gc(4,2,e,r)},useMemo:function(e,r){var s=ua();r=r===void 0?null:r;var c=e();if(Wr){tn(!0);try{e()}finally{tn(!1)}}return s.memoizedState=[c,r],c},useReducer:function(e,r,s){var c=ua();if(s!==void 0){var d=s(r);if(Wr){tn(!0);try{s(r)}finally{tn(!1)}}}else d=r;return c.memoizedState=c.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},c.queue=e,e=e.dispatch=xx.bind(null,ze,e),[c.memoizedState,e]},useRef:function(e){var r=ua();return e={current:e},r.memoizedState=e},useState:function(e){e=Fu(e);var r=e.queue,s=_h.bind(null,ze,r);return r.dispatch=s,[e.memoizedState,s]},useDebugValue:Ku,useDeferredValue:function(e,r){var s=ua();return Pu(s,e,r)},useTransition:function(){var e=Fu(!1);return e=Sh.bind(null,ze,e.queue,!0,!1),ua().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,r,s){var c=ze,d=ua();if($e){if(s===void 0)throw Error(i(407));s=s()}else{if(s=r(),mt===null)throw Error(i(349));(qe&127)!==0||Xd(c,r,s)}d.memoizedState=s;var m={value:s,getSnapshot:r};return d.queue=m,uh(Jd.bind(null,c,m,e),[e]),c.flags|=2048,Oi(9,{destroy:void 0},qd.bind(null,c,m,s,r),null),s},useId:function(){var e=ua(),r=mt.identifierPrefix;if($e){var s=gn,c=vn;s=(c&~(1<<32-oa(c)-1)).toString(32)+s,r="_"+r+"R_"+s,s=dc++,0<s&&(r+="H"+s.toString(32)),r+="_"}else s=fx++,r="_"+r+"r_"+s.toString(32)+"_";return e.memoizedState=r},useHostTransitionStatus:Hu,useFormState:ih,useActionState:ih,useOptimistic:function(e){var r=ua();r.memoizedState=r.baseState=e;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=s,r=Gu.bind(null,ze,!0,s),s.dispatch=r,[e,r]},useMemoCache:Ou,useCacheRefresh:function(){return ua().memoizedState=px.bind(null,ze)},useEffectEvent:function(e){var r=ua(),s={impl:e};return r.memoizedState=s,function(){if((at&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}},Wu={readContext:Xt,use:mc,useCallback:gh,useContext:Xt,useEffect:Bu,useImperativeHandle:vh,useInsertionEffect:dh,useLayoutEffect:hh,useMemo:ph,useReducer:vc,useRef:oh,useState:function(){return vc(jn)},useDebugValue:Ku,useDeferredValue:function(e,r){var s=Dt();return xh(s,ut.memoizedState,e,r)},useTransition:function(){var e=vc(jn)[0],r=Dt().memoizedState;return[typeof e=="boolean"?e:Ls(e),r]},useSyncExternalStore:Yd,useId:Th,useHostTransitionStatus:Hu,useFormState:sh,useActionState:sh,useOptimistic:function(e,r){var s=Dt();return Zd(s,ut,e,r)},useMemoCache:Ou,useCacheRefresh:Eh};Wu.useEffectEvent=fh;var Ah={readContext:Xt,use:mc,useCallback:gh,useContext:Xt,useEffect:Bu,useImperativeHandle:vh,useInsertionEffect:dh,useLayoutEffect:hh,useMemo:ph,useReducer:Ru,useRef:oh,useState:function(){return Ru(jn)},useDebugValue:Ku,useDeferredValue:function(e,r){var s=Dt();return ut===null?Pu(s,e,r):xh(s,ut.memoizedState,e,r)},useTransition:function(){var e=Ru(jn)[0],r=Dt().memoizedState;return[typeof e=="boolean"?e:Ls(e),r]},useSyncExternalStore:Yd,useId:Th,useHostTransitionStatus:Hu,useFormState:ch,useActionState:ch,useOptimistic:function(e,r){var s=Dt();return ut!==null?Zd(s,ut,e,r):(s.baseState=e,[e,s.queue.dispatch])},useMemoCache:Ou,useCacheRefresh:Eh};Ah.useEffectEvent=fh;function Vu(e,r,s,c){r=e.memoizedState,s=s(c,r),s=s==null?r:S({},r,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Yu={enqueueSetState:function(e,r,s){e=e._reactInternals;var c=ka(),d=nr(c);d.payload=r,s!=null&&(d.callback=s),r=rr(e,d,c),r!==null&&(ya(r,e,c),Os(r,e,c))},enqueueReplaceState:function(e,r,s){e=e._reactInternals;var c=ka(),d=nr(c);d.tag=1,d.payload=r,s!=null&&(d.callback=s),r=rr(e,d,c),r!==null&&(ya(r,e,c),Os(r,e,c))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var s=ka(),c=nr(s);c.tag=2,r!=null&&(c.callback=r),r=rr(e,c,s),r!==null&&(ya(r,e,s),Os(r,e,s))}};function Dh(e,r,s,c,d,m,E){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,m,E):r.prototype&&r.prototype.isPureReactComponent?!bs(s,c)||!bs(d,m):!0}function Mh(e,r,s,c){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(s,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(s,c),r.state!==e&&Yu.enqueueReplaceState(r,r.state,null)}function Vr(e,r){var s=r;if("ref"in r){s={};for(var c in r)c!=="ref"&&(s[c]=r[c])}if(e=e.defaultProps){s===r&&(s=S({},s));for(var d in e)s[d]===void 0&&(s[d]=e[d])}return s}function jh(e){Jl(e)}function kh(e){console.error(e)}function Uh(e){Jl(e)}function Sc(e,r){try{var s=e.onUncaughtError;s(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Oh(e,r,s){try{var c=e.onCaughtError;c(s.value,{componentStack:s.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Xu(e,r,s){return s=nr(s),s.tag=3,s.payload={element:null},s.callback=function(){Sc(e,r)},s}function Ih(e){return e=nr(e),e.tag=3,e}function Rh(e,r,s,c){var d=s.type.getDerivedStateFromError;if(typeof d=="function"){var m=c.value;e.payload=function(){return d(m)},e.callback=function(){Oh(r,s,c)}}var E=s.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(e.callback=function(){Oh(r,s,c),typeof d!="function"&&(ur===null?ur=new Set([this]):ur.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})})}function Sx(e,r,s,c,d){if(s.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=s.alternate,r!==null&&bi(r,s,d,!0),s=Aa.current,s!==null){switch(s.tag){case 31:case 13:return Xa===null?jc():s.alternate===null&&wt===0&&(wt=3),s.flags&=-257,s.flags|=65536,s.lanes=d,c===sc?s.flags|=16384:(r=s.updateQueue,r===null?s.updateQueue=new Set([c]):r.add(c),S0(e,c,d)),!1;case 22:return s.flags|=65536,c===sc?s.flags|=16384:(r=s.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},s.updateQueue=r):(s=r.retryQueue,s===null?r.retryQueue=new Set([c]):s.add(c)),S0(e,c,d)),!1}throw Error(i(435,s.tag))}return S0(e,c,d),jc(),!1}if($e)return r=Aa.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=d,c!==hu&&(e=Error(i(422),{cause:c}),Ds(Ga(e,s)))):(c!==hu&&(r=Error(i(423),{cause:c}),Ds(Ga(r,s))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,c=Ga(c,s),d=Xu(e.stateNode,c,d),_u(e,d),wt!==4&&(wt=2)),!1;var m=Error(i(520),{cause:c});if(m=Ga(m,s),Xs===null?Xs=[m]:Xs.push(m),wt!==4&&(wt=2),r===null)return!0;c=Ga(c,s),s=r;do{switch(s.tag){case 3:return s.flags|=65536,e=d&-d,s.lanes|=e,e=Xu(s.stateNode,c,e),_u(s,e),!1;case 1:if(r=s.type,m=s.stateNode,(s.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ur===null||!ur.has(m))))return s.flags|=65536,d&=-d,s.lanes|=d,d=Ih(d),Rh(d,e,s,c),_u(s,d),!1}s=s.return}while(s!==null);return!1}var qu=Error(i(461)),kt=!1;function qt(e,r,s,c){r.child=e===null?Kd(r,null,s,c):Gr(r,e.child,s,c)}function Fh(e,r,s,c,d){s=s.render;var m=r.ref;if("ref"in c){var E={};for(var A in c)A!=="ref"&&(E[A]=c[A])}else E=c;return Kr(r),c=Mu(e,r,s,E,m,d),A=ju(),e!==null&&!kt?(ku(e,r,d),kn(e,r,d)):($e&&A&&fu(r),r.flags|=1,qt(e,r,c,d),r.child)}function Lh(e,r,s,c,d){if(e===null){var m=s.type;return typeof m=="function"&&!cu(m)&&m.defaultProps===void 0&&s.compare===null?(r.tag=15,r.type=m,Bh(e,r,m,c,d)):(e=ec(s.type,null,c,r,r.mode,d),e.ref=r.ref,e.return=r,r.child=e)}if(m=e.child,!n0(e,d)){var E=m.memoizedProps;if(s=s.compare,s=s!==null?s:bs,s(E,c)&&e.ref===r.ref)return kn(e,r,d)}return r.flags|=1,e=bn(m,c),e.ref=r.ref,e.return=r,r.child=e}function Bh(e,r,s,c,d){if(e!==null){var m=e.memoizedProps;if(bs(m,c)&&e.ref===r.ref)if(kt=!1,r.pendingProps=c=m,n0(e,d))(e.flags&131072)!==0&&(kt=!0);else return r.lanes=e.lanes,kn(e,r,d)}return Ju(e,r,s,c,d)}function Kh(e,r,s,c){var d=c.children,m=e!==null?e.memoizedState:null;if(e===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|s:s,e!==null){for(c=r.child=e.child,d=0;c!==null;)d=d|c.lanes|c.childLanes,c=c.sibling;c=d&~m}else c=0,r.child=null;return Ph(e,r,m,s,c)}if((s&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},e!==null&&rc(r,m!==null?m.cachePool:null),m!==null?Hd(r,m):bu(),Gd(r);else return c=r.lanes=536870912,Ph(e,r,m!==null?m.baseLanes|s:s,s,c)}else m!==null?(rc(r,m.cachePool),Hd(r,m),sr(),r.memoizedState=null):(e!==null&&rc(r,null),bu(),sr());return qt(e,r,d,s),r.child}function Ps(e,r){return e!==null&&e.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Ph(e,r,s,c,d){var m=yu();return m=m===null?null:{parent:Mt._currentValue,pool:m},r.memoizedState={baseLanes:s,cachePool:m},e!==null&&rc(r,null),bu(),Gd(r),e!==null&&bi(e,r,c,!0),r.childLanes=d,null}function yc(e,r){return r=Tc({mode:r.mode,children:r.children},e.mode),r.ref=e.ref,e.child=r,r.return=e,r}function zh(e,r,s){return Gr(r,e.child,null,s),e=yc(r,r.pendingProps),e.flags|=2,Da(r),r.memoizedState=null,e}function yx(e,r,s){var c=r.pendingProps,d=(r.flags&128)!==0;if(r.flags&=-129,e===null){if($e){if(c.mode==="hidden")return e=yc(r,c),r.lanes=536870912,Ps(null,e);if(Au(r),(e=xt)?(e=e1(e,Ya),e=e!==null&&e.data==="&"?e:null,e!==null&&(r.memoizedState={dehydrated:e,treeContext:Qn!==null?{id:vn,overflow:gn}:null,retryLane:536870912,hydrationErrors:null},s=wd(e),s.return=r,r.child=s,Yt=r,xt=null)):e=null,e===null)throw er(r);return r.lanes=536870912,null}return yc(r,c)}var m=e.memoizedState;if(m!==null){var E=m.dehydrated;if(Au(r),d)if(r.flags&256)r.flags&=-257,r=zh(e,r,s);else if(r.memoizedState!==null)r.child=e.child,r.flags|=128,r=null;else throw Error(i(558));else if(kt||bi(e,r,s,!1),d=(s&e.childLanes)!==0,kt||d){if(c=mt,c!==null&&(E=Kl(c,s),E!==0&&E!==m.retryLane))throw m.retryLane=E,Rr(e,E),ya(c,e,E),qu;jc(),r=zh(e,r,s)}else e=m.treeContext,xt=qa(E.nextSibling),Yt=r,$e=!0,Zn=null,Ya=!1,e!==null&&Ad(r,e),r=yc(r,c),r.flags|=4096;return r}return e=bn(e.child,{mode:c.mode,children:c.children}),e.ref=r.ref,r.child=e,e.return=r,e}function Cc(e,r){var s=r.ref;if(s===null)e!==null&&e.ref!==null&&(r.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(i(284));(e===null||e.ref!==s)&&(r.flags|=4194816)}}function Ju(e,r,s,c,d){return Kr(r),s=Mu(e,r,s,c,void 0,d),c=ju(),e!==null&&!kt?(ku(e,r,d),kn(e,r,d)):($e&&c&&fu(r),r.flags|=1,qt(e,r,s,d),r.child)}function Hh(e,r,s,c,d,m){return Kr(r),r.updateQueue=null,s=Vd(r,c,s,d),Wd(e),c=ju(),e!==null&&!kt?(ku(e,r,m),kn(e,r,m)):($e&&c&&fu(r),r.flags|=1,qt(e,r,s,m),r.child)}function Gh(e,r,s,c,d){if(Kr(r),r.stateNode===null){var m=Ti,E=s.contextType;typeof E=="object"&&E!==null&&(m=Xt(E)),m=new s(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Yu,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},Tu(r),E=s.contextType,m.context=typeof E=="object"&&E!==null?Xt(E):Ti,m.state=r.memoizedState,E=s.getDerivedStateFromProps,typeof E=="function"&&(Vu(r,s,E,c),m.state=r.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(E=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),E!==m.state&&Yu.enqueueReplaceState(m,m.state,null),Rs(r,c,m,d),Is(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(e===null){m=r.stateNode;var A=r.memoizedProps,W=Vr(s,A);m.props=W;var ae=m.context,de=s.contextType;E=Ti,typeof de=="object"&&de!==null&&(E=Xt(de));var ve=s.getDerivedStateFromProps;de=typeof ve=="function"||typeof m.getSnapshotBeforeUpdate=="function",A=r.pendingProps!==A,de||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(A||ae!==E)&&Mh(r,m,c,E),ar=!1;var se=r.memoizedState;m.state=se,Rs(r,c,m,d),Is(),ae=r.memoizedState,A||se!==ae||ar?(typeof ve=="function"&&(Vu(r,s,ve,c),ae=r.memoizedState),(W=ar||Dh(r,s,W,c,se,ae,E))?(de||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ae),m.props=c,m.state=ae,m.context=E,c=W):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,Eu(e,r),E=r.memoizedProps,de=Vr(s,E),m.props=de,ve=r.pendingProps,se=m.context,ae=s.contextType,W=Ti,typeof ae=="object"&&ae!==null&&(W=Xt(ae)),A=s.getDerivedStateFromProps,(ae=typeof A=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E!==ve||se!==W)&&Mh(r,m,c,W),ar=!1,se=r.memoizedState,m.state=se,Rs(r,c,m,d),Is();var oe=r.memoizedState;E!==ve||se!==oe||ar||e!==null&&e.dependencies!==null&&ac(e.dependencies)?(typeof A=="function"&&(Vu(r,s,A,c),oe=r.memoizedState),(de=ar||Dh(r,s,de,c,se,oe,W)||e!==null&&e.dependencies!==null&&ac(e.dependencies))?(ae||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,oe,W),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,oe,W)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||E===e.memoizedProps&&se===e.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&se===e.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=oe),m.props=c,m.state=oe,m.context=W,c=de):(typeof m.componentDidUpdate!="function"||E===e.memoizedProps&&se===e.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&se===e.memoizedState||(r.flags|=1024),c=!1)}return m=c,Cc(e,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,s=c&&typeof s.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,e!==null&&c?(r.child=Gr(r,e.child,null,d),r.child=Gr(r,null,s,d)):qt(e,r,s,d),r.memoizedState=m.state,e=r.child):e=kn(e,r,d),e}function Wh(e,r,s,c){return Lr(),r.flags|=256,qt(e,r,s,c),r.child}var $u={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qu(e){return{baseLanes:e,cachePool:Od()}}function Zu(e,r,s){return e=e!==null?e.childLanes&~s:0,r&&(e|=ja),e}function Vh(e,r,s){var c=r.pendingProps,d=!1,m=(r.flags&128)!==0,E;if((E=m)||(E=e!==null&&e.memoizedState===null?!1:(At.current&2)!==0),E&&(d=!0,r.flags&=-129),E=(r.flags&32)!==0,r.flags&=-33,e===null){if($e){if(d?ir(r):sr(),(e=xt)?(e=e1(e,Ya),e=e!==null&&e.data!=="&"?e:null,e!==null&&(r.memoizedState={dehydrated:e,treeContext:Qn!==null?{id:vn,overflow:gn}:null,retryLane:536870912,hydrationErrors:null},s=wd(e),s.return=r,r.child=s,Yt=r,xt=null)):e=null,e===null)throw er(r);return I0(e)?r.lanes=32:r.lanes=536870912,null}var A=c.children;return c=c.fallback,d?(sr(),d=r.mode,A=Tc({mode:"hidden",children:A},d),c=Fr(c,d,s,null),A.return=r,c.return=r,A.sibling=c,r.child=A,c=r.child,c.memoizedState=Qu(s),c.childLanes=Zu(e,E,s),r.memoizedState=$u,Ps(null,c)):(ir(r),e0(r,A))}var W=e.memoizedState;if(W!==null&&(A=W.dehydrated,A!==null)){if(m)r.flags&256?(ir(r),r.flags&=-257,r=t0(e,r,s)):r.memoizedState!==null?(sr(),r.child=e.child,r.flags|=128,r=null):(sr(),A=c.fallback,d=r.mode,c=Tc({mode:"visible",children:c.children},d),A=Fr(A,d,s,null),A.flags|=2,c.return=r,A.return=r,c.sibling=A,r.child=c,Gr(r,e.child,null,s),c=r.child,c.memoizedState=Qu(s),c.childLanes=Zu(e,E,s),r.memoizedState=$u,r=Ps(null,c));else if(ir(r),I0(A)){if(E=A.nextSibling&&A.nextSibling.dataset,E)var ae=E.dgst;E=ae,c=Error(i(419)),c.stack="",c.digest=E,Ds({value:c,source:null,stack:null}),r=t0(e,r,s)}else if(kt||bi(e,r,s,!1),E=(s&e.childLanes)!==0,kt||E){if(E=mt,E!==null&&(c=Kl(E,s),c!==0&&c!==W.retryLane))throw W.retryLane=c,Rr(e,c),ya(E,e,c),qu;O0(A)||jc(),r=t0(e,r,s)}else O0(A)?(r.flags|=192,r.child=e.child,r=null):(e=W.treeContext,xt=qa(A.nextSibling),Yt=r,$e=!0,Zn=null,Ya=!1,e!==null&&Ad(r,e),r=e0(r,c.children),r.flags|=4096);return r}return d?(sr(),A=c.fallback,d=r.mode,W=e.child,ae=W.sibling,c=bn(W,{mode:"hidden",children:c.children}),c.subtreeFlags=W.subtreeFlags&65011712,ae!==null?A=bn(ae,A):(A=Fr(A,d,s,null),A.flags|=2),A.return=r,c.return=r,c.sibling=A,r.child=c,Ps(null,c),c=r.child,A=e.child.memoizedState,A===null?A=Qu(s):(d=A.cachePool,d!==null?(W=Mt._currentValue,d=d.parent!==W?{parent:W,pool:W}:d):d=Od(),A={baseLanes:A.baseLanes|s,cachePool:d}),c.memoizedState=A,c.childLanes=Zu(e,E,s),r.memoizedState=$u,Ps(e.child,c)):(ir(r),s=e.child,e=s.sibling,s=bn(s,{mode:"visible",children:c.children}),s.return=r,s.sibling=null,e!==null&&(E=r.deletions,E===null?(r.deletions=[e],r.flags|=16):E.push(e)),r.child=s,r.memoizedState=null,s)}function e0(e,r){return r=Tc({mode:"visible",children:r},e.mode),r.return=e,e.child=r}function Tc(e,r){return e=Na(22,e,null,r),e.lanes=0,e}function t0(e,r,s){return Gr(r,e.child,null,s),e=e0(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function Yh(e,r,s){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r),gu(e.return,r,s)}function a0(e,r,s,c,d,m){var E=e.memoizedState;E===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:s,tailMode:d,treeForkCount:m}:(E.isBackwards=r,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=s,E.tailMode=d,E.treeForkCount=m)}function Xh(e,r,s){var c=r.pendingProps,d=c.revealOrder,m=c.tail;c=c.children;var E=At.current,A=(E&2)!==0;if(A?(E=E&1|2,r.flags|=128):E&=1,V(At,E),qt(e,r,c,s),c=$e?As:0,!A&&e!==null&&(e.flags&128)!==0)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Yh(e,s,r);else if(e.tag===19)Yh(e,s,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(s=r.child,d=null;s!==null;)e=s.alternate,e!==null&&uc(e)===null&&(d=s),s=s.sibling;s=d,s===null?(d=r.child,r.child=null):(d=s.sibling,s.sibling=null),a0(r,!1,d,s,m,c);break;case"backwards":case"unstable_legacy-backwards":for(s=null,d=r.child,r.child=null;d!==null;){if(e=d.alternate,e!==null&&uc(e)===null){r.child=d;break}e=d.sibling,d.sibling=s,s=d,d=e}a0(r,!0,s,null,m,c);break;case"together":a0(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function kn(e,r,s){if(e!==null&&(r.dependencies=e.dependencies),or|=r.lanes,(s&r.childLanes)===0)if(e!==null){if(bi(e,r,s,!1),(s&r.childLanes)===0)return null}else return null;if(e!==null&&r.child!==e.child)throw Error(i(153));if(r.child!==null){for(e=r.child,s=bn(e,e.pendingProps),r.child=s,s.return=r;e.sibling!==null;)e=e.sibling,s=s.sibling=bn(e,e.pendingProps),s.return=r;s.sibling=null}return r.child}function n0(e,r){return(e.lanes&r)!==0?!0:(e=e.dependencies,!!(e!==null&&ac(e)))}function Cx(e,r,s){switch(r.tag){case 3:je(r,r.stateNode.containerInfo),tr(r,Mt,e.memoizedState.cache),Lr();break;case 27:case 5:Ae(r);break;case 4:je(r,r.stateNode.containerInfo);break;case 10:tr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Au(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(ir(r),r.flags|=128,null):(s&r.child.childLanes)!==0?Vh(e,r,s):(ir(r),e=kn(e,r,s),e!==null?e.sibling:null);ir(r);break;case 19:var d=(e.flags&128)!==0;if(c=(s&r.childLanes)!==0,c||(bi(e,r,s,!1),c=(s&r.childLanes)!==0),d){if(c)return Xh(e,r,s);r.flags|=128}if(d=r.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),V(At,At.current),c)break;return null;case 22:return r.lanes=0,Kh(e,r,s,r.pendingProps);case 24:tr(r,Mt,e.memoizedState.cache)}return kn(e,r,s)}function qh(e,r,s){if(e!==null)if(e.memoizedProps!==r.pendingProps)kt=!0;else{if(!n0(e,s)&&(r.flags&128)===0)return kt=!1,Cx(e,r,s);kt=(e.flags&131072)!==0}else kt=!1,$e&&(r.flags&1048576)!==0&&Nd(r,As,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(e=zr(r.elementType),r.type=e,typeof e=="function")cu(e)?(c=Vr(e,c),r.tag=1,r=Gh(null,r,e,c,s)):(r.tag=0,r=Ju(null,r,e,c,s));else{if(e!=null){var d=e.$$typeof;if(d===N){r.tag=11,r=Fh(null,r,e,c,s);break e}else if(d===B){r.tag=14,r=Lh(null,r,e,c,s);break e}}throw r=be(e)||e,Error(i(306,r,""))}}return r;case 0:return Ju(e,r,r.type,r.pendingProps,s);case 1:return c=r.type,d=Vr(c,r.pendingProps),Gh(e,r,c,d,s);case 3:e:{if(je(r,r.stateNode.containerInfo),e===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;d=m.element,Eu(e,r),Rs(r,c,null,s);var E=r.memoizedState;if(c=E.cache,tr(r,Mt,c),c!==m.cache&&pu(r,[Mt],s,!0),Is(),c=E.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:E.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=Wh(e,r,c,s);break e}else if(c!==d){d=Ga(Error(i(424)),r),Ds(d),r=Wh(e,r,c,s);break e}else{switch(e=r.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(xt=qa(e.firstChild),Yt=r,$e=!0,Zn=null,Ya=!0,s=Kd(r,null,c,s),r.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling}else{if(Lr(),c===d){r=kn(e,r,s);break e}qt(e,r,c,s)}r=r.child}return r;case 26:return Cc(e,r),e===null?(s=s1(r.type,null,r.pendingProps,null))?r.memoizedState=s:$e||(s=r.type,e=r.pendingProps,c=Lc(ce.current).createElement(s),c[O]=r,c[I]=e,Jt(c,s,e),Ie(c),r.stateNode=c):r.memoizedState=s1(r.type,e.memoizedProps,r.pendingProps,e.memoizedState),null;case 27:return Ae(r),e===null&&$e&&(c=r.stateNode=n1(r.type,r.pendingProps,ce.current),Yt=r,Ya=!0,d=xt,mr(r.type)?(R0=d,xt=qa(c.firstChild)):xt=d),qt(e,r,r.pendingProps.children,s),Cc(e,r),e===null&&(r.flags|=4194304),r.child;case 5:return e===null&&$e&&((d=c=xt)&&(c=$x(c,r.type,r.pendingProps,Ya),c!==null?(r.stateNode=c,Yt=r,xt=qa(c.firstChild),Ya=!1,d=!0):d=!1),d||er(r)),Ae(r),d=r.type,m=r.pendingProps,E=e!==null?e.memoizedProps:null,c=m.children,j0(d,m)?c=null:E!==null&&j0(d,E)&&(r.flags|=32),r.memoizedState!==null&&(d=Mu(e,r,dx,null,null,s),al._currentValue=d),Cc(e,r),qt(e,r,c,s),r.child;case 6:return e===null&&$e&&((e=s=xt)&&(s=Qx(s,r.pendingProps,Ya),s!==null?(r.stateNode=s,Yt=r,xt=null,e=!0):e=!1),e||er(r)),null;case 13:return Vh(e,r,s);case 4:return je(r,r.stateNode.containerInfo),c=r.pendingProps,e===null?r.child=Gr(r,null,c,s):qt(e,r,c,s),r.child;case 11:return Fh(e,r,r.type,r.pendingProps,s);case 7:return qt(e,r,r.pendingProps,s),r.child;case 8:return qt(e,r,r.pendingProps.children,s),r.child;case 12:return qt(e,r,r.pendingProps.children,s),r.child;case 10:return c=r.pendingProps,tr(r,r.type,c.value),qt(e,r,c.children,s),r.child;case 9:return d=r.type._context,c=r.pendingProps.children,Kr(r),d=Xt(d),c=c(d),r.flags|=1,qt(e,r,c,s),r.child;case 14:return Lh(e,r,r.type,r.pendingProps,s);case 15:return Bh(e,r,r.type,r.pendingProps,s);case 19:return Xh(e,r,s);case 31:return yx(e,r,s);case 22:return Kh(e,r,s,r.pendingProps);case 24:return Kr(r),c=Xt(Mt),e===null?(d=yu(),d===null&&(d=mt,m=xu(),d.pooledCache=m,m.refCount++,m!==null&&(d.pooledCacheLanes|=s),d=m),r.memoizedState={parent:c,cache:d},Tu(r),tr(r,Mt,d)):((e.lanes&s)!==0&&(Eu(e,r),Rs(r,null,null,s),Is()),d=e.memoizedState,m=r.memoizedState,d.parent!==c?(d={parent:c,cache:c},r.memoizedState=d,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=d),tr(r,Mt,c)):(c=m.cache,tr(r,Mt,c),c!==d.cache&&pu(r,[Mt],s,!0))),qt(e,r,r.pendingProps.children,s),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Un(e){e.flags|=4}function r0(e,r,s,c,d){if((r=(e.mode&32)!==0)&&(r=!1),r){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(Tm())e.flags|=8192;else throw Hr=sc,Cu}else e.flags&=-16777217}function Jh(e,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!f1(r))if(Tm())e.flags|=8192;else throw Hr=sc,Cu}function Ec(e,r){r!==null&&(e.flags|=4),e.flags&16384&&(r=e.tag!==22?Ll():536870912,e.lanes|=r,Li|=r)}function zs(e,r){if(!$e)switch(e.tailMode){case"hidden":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function St(e){var r=e.alternate!==null&&e.alternate.child===e.child,s=0,c=0;if(r)for(var d=e.child;d!==null;)s|=d.lanes|d.childLanes,c|=d.subtreeFlags&65011712,c|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)s|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=c,e.childLanes=s,r}function Tx(e,r,s){var c=r.pendingProps;switch(du(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(r),null;case 1:return St(r),null;case 3:return s=r.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Dn(Mt),we(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(wi(r)?Un(r):e===null||e.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,mu())),St(r),null;case 26:var d=r.type,m=r.memoizedState;return e===null?(Un(r),m!==null?(St(r),Jh(r,m)):(St(r),r0(r,d,null,c,s))):m?m!==e.memoizedState?(Un(r),St(r),Jh(r,m)):(St(r),r.flags&=-16777217):(e=e.memoizedProps,e!==c&&Un(r),St(r),r0(r,d,e,c,s)),null;case 27:if(Qe(r),s=ce.current,d=r.type,e!==null&&r.stateNode!=null)e.memoizedProps!==c&&Un(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return St(r),null}e=P.current,wi(r)?Dd(r):(e=n1(d,c,s),r.stateNode=e,Un(r))}return St(r),null;case 5:if(Qe(r),d=r.type,e!==null&&r.stateNode!=null)e.memoizedProps!==c&&Un(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return St(r),null}if(m=P.current,wi(r))Dd(r);else{var E=Lc(ce.current);switch(m){case 1:m=E.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:m=E.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":m=E.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":m=E.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":m=E.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?E.createElement(d,{is:c.is}):E.createElement(d)}}m[O]=r,m[I]=c;e:for(E=r.child;E!==null;){if(E.tag===5||E.tag===6)m.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===r)break e;for(;E.sibling===null;){if(E.return===null||E.return===r)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}r.stateNode=m;e:switch(Jt(m,d,c),d){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Un(r)}}return St(r),r0(r,r.type,e===null?null:e.memoizedProps,r.pendingProps,s),null;case 6:if(e&&r.stateNode!=null)e.memoizedProps!==c&&Un(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(e=ce.current,wi(r)){if(e=r.stateNode,s=r.memoizedProps,c=null,d=Yt,d!==null)switch(d.tag){case 27:case 5:c=d.memoizedProps}e[O]=r,e=!!(e.nodeValue===s||c!==null&&c.suppressHydrationWarning===!0||Vm(e.nodeValue,s)),e||er(r,!0)}else e=Lc(e).createTextNode(c),e[O]=r,r.stateNode=e}return St(r),null;case 31:if(s=r.memoizedState,e===null||e.memoizedState!==null){if(c=wi(r),s!==null){if(e===null){if(!c)throw Error(i(318));if(e=r.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[O]=r}else Lr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;St(r),e=!1}else s=mu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=s),e=!0;if(!e)return r.flags&256?(Da(r),r):(Da(r),null);if((r.flags&128)!==0)throw Error(i(558))}return St(r),null;case 13:if(c=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=wi(r),c!==null&&c.dehydrated!==null){if(e===null){if(!d)throw Error(i(318));if(d=r.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));d[O]=r}else Lr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;St(r),d=!1}else d=mu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return r.flags&256?(Da(r),r):(Da(r),null)}return Da(r),(r.flags&128)!==0?(r.lanes=s,r):(s=c!==null,e=e!==null&&e.memoizedState!==null,s&&(c=r.child,d=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(d=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==d&&(c.flags|=2048)),s!==e&&s&&(r.child.flags|=8192),Ec(r,r.updateQueue),St(r),null);case 4:return we(),e===null&&b0(r.stateNode.containerInfo),St(r),null;case 10:return Dn(r.type),St(r),null;case 19:if(j(At),c=r.memoizedState,c===null)return St(r),null;if(d=(r.flags&128)!==0,m=c.rendering,m===null)if(d)zs(c,!1);else{if(wt!==0||e!==null&&(e.flags&128)!==0)for(e=r.child;e!==null;){if(m=uc(e),m!==null){for(r.flags|=128,zs(c,!1),e=m.updateQueue,r.updateQueue=e,Ec(r,e),r.subtreeFlags=0,e=s,s=r.child;s!==null;)_d(s,e),s=s.sibling;return V(At,At.current&1|2),$e&&Nn(r,c.treeForkCount),r.child}e=e.sibling}c.tail!==null&&Ct()>Ac&&(r.flags|=128,d=!0,zs(c,!1),r.lanes=4194304)}else{if(!d)if(e=uc(m),e!==null){if(r.flags|=128,d=!0,e=e.updateQueue,r.updateQueue=e,Ec(r,e),zs(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!$e)return St(r),null}else 2*Ct()-c.renderingStartTime>Ac&&s!==536870912&&(r.flags|=128,d=!0,zs(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(e=c.last,e!==null?e.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=Ct(),e.sibling=null,s=At.current,V(At,d?s&1|2:s&1),$e&&Nn(r,c.treeForkCount),e):(St(r),null);case 22:case 23:return Da(r),Nu(),c=r.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(s&536870912)!==0&&(r.flags&128)===0&&(St(r),r.subtreeFlags&6&&(r.flags|=8192)):St(r),s=r.updateQueue,s!==null&&Ec(r,s.retryQueue),s=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==s&&(r.flags|=2048),e!==null&&j(Pr),null;case 24:return s=null,e!==null&&(s=e.memoizedState.cache),r.memoizedState.cache!==s&&(r.flags|=2048),Dn(Mt),St(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function Ex(e,r){switch(du(r),r.tag){case 1:return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Dn(Mt),we(),e=r.flags,(e&65536)!==0&&(e&128)===0?(r.flags=e&-65537|128,r):null;case 26:case 27:case 5:return Qe(r),null;case 31:if(r.memoizedState!==null){if(Da(r),r.alternate===null)throw Error(i(340));Lr()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 13:if(Da(r),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Lr()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return j(At),null;case 4:return we(),null;case 10:return Dn(r.type),null;case 22:case 23:return Da(r),Nu(),e!==null&&j(Pr),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 24:return Dn(Mt),null;case 25:return null;default:return null}}function $h(e,r){switch(du(r),r.tag){case 3:Dn(Mt),we();break;case 26:case 27:case 5:Qe(r);break;case 4:we();break;case 31:r.memoizedState!==null&&Da(r);break;case 13:Da(r);break;case 19:j(At);break;case 10:Dn(r.type);break;case 22:case 23:Da(r),Nu(),e!==null&&j(Pr);break;case 24:Dn(Mt)}}function Hs(e,r){try{var s=r.updateQueue,c=s!==null?s.lastEffect:null;if(c!==null){var d=c.next;s=d;do{if((s.tag&e)===e){c=void 0;var m=s.create,E=s.inst;c=m(),E.destroy=c}s=s.next}while(s!==d)}}catch(A){it(r,r.return,A)}}function lr(e,r,s){try{var c=r.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var m=d.next;c=m;do{if((c.tag&e)===e){var E=c.inst,A=E.destroy;if(A!==void 0){E.destroy=void 0,d=r;var W=s,ae=A;try{ae()}catch(de){it(d,W,de)}}}c=c.next}while(c!==m)}}catch(de){it(r,r.return,de)}}function Qh(e){var r=e.updateQueue;if(r!==null){var s=e.stateNode;try{zd(r,s)}catch(c){it(e,e.return,c)}}}function Zh(e,r,s){s.props=Vr(e.type,e.memoizedProps),s.state=e.memoizedState;try{s.componentWillUnmount()}catch(c){it(e,r,c)}}function Gs(e,r){try{var s=e.ref;if(s!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof s=="function"?e.refCleanup=s(c):s.current=c}}catch(d){it(e,r,d)}}function pn(e,r){var s=e.ref,c=e.refCleanup;if(s!==null)if(typeof c=="function")try{c()}catch(d){it(e,r,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(d){it(e,r,d)}else s.current=null}function em(e){var r=e.type,s=e.memoizedProps,c=e.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":s.autoFocus&&c.focus();break e;case"img":s.src?c.src=s.src:s.srcSet&&(c.srcset=s.srcSet)}}catch(d){it(e,e.return,d)}}function i0(e,r,s){try{var c=e.stateNode;Wx(c,e.type,s,r),c[I]=r}catch(d){it(e,e.return,d)}}function tm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&mr(e.type)||e.tag===4}function s0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||tm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&mr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function l0(e,r,s){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(e,r):(r=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,r.appendChild(e),s=s._reactRootContainer,s!=null||r.onclick!==null||(r.onclick=_n));else if(c!==4&&(c===27&&mr(e.type)&&(s=e.stateNode,r=null),e=e.child,e!==null))for(l0(e,r,s),e=e.sibling;e!==null;)l0(e,r,s),e=e.sibling}function _c(e,r,s){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?s.insertBefore(e,r):s.appendChild(e);else if(c!==4&&(c===27&&mr(e.type)&&(s=e.stateNode),e=e.child,e!==null))for(_c(e,r,s),e=e.sibling;e!==null;)_c(e,r,s),e=e.sibling}function am(e){var r=e.stateNode,s=e.memoizedProps;try{for(var c=e.type,d=r.attributes;d.length;)r.removeAttributeNode(d[0]);Jt(r,c,s),r[O]=e,r[I]=s}catch(m){it(e,e.return,m)}}var On=!1,Ut=!1,c0=!1,nm=typeof WeakSet=="function"?WeakSet:Set,Pt=null;function _x(e,r){if(e=e.containerInfo,D0=Wc,e=vd(e),tu(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var c=s.getSelection&&s.getSelection();if(c&&c.rangeCount!==0){s=c.anchorNode;var d=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{s.nodeType,m.nodeType}catch{s=null;break e}var E=0,A=-1,W=-1,ae=0,de=0,ve=e,se=null;t:for(;;){for(var oe;ve!==s||d!==0&&ve.nodeType!==3||(A=E+d),ve!==m||c!==0&&ve.nodeType!==3||(W=E+c),ve.nodeType===3&&(E+=ve.nodeValue.length),(oe=ve.firstChild)!==null;)se=ve,ve=oe;for(;;){if(ve===e)break t;if(se===s&&++ae===d&&(A=E),se===m&&++de===c&&(W=E),(oe=ve.nextSibling)!==null)break;ve=se,se=ve.parentNode}ve=oe}s=A===-1||W===-1?null:{start:A,end:W}}else s=null}s=s||{start:0,end:0}}else s=null;for(M0={focusedElem:e,selectionRange:s},Wc=!1,Pt=r;Pt!==null;)if(r=Pt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Pt=e;else for(;Pt!==null;){switch(r=Pt,m=r.alternate,e=r.flags,r.tag){case 0:if((e&4)!==0&&(e=r.updateQueue,e=e!==null?e.events:null,e!==null))for(s=0;s<e.length;s++)d=e[s],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&m!==null){e=void 0,s=r,d=m.memoizedProps,m=m.memoizedState,c=s.stateNode;try{var Oe=Vr(s.type,d);e=c.getSnapshotBeforeUpdate(Oe,m),c.__reactInternalSnapshotBeforeUpdate=e}catch(Be){it(s,s.return,Be)}}break;case 3:if((e&1024)!==0){if(e=r.stateNode.containerInfo,s=e.nodeType,s===9)U0(e);else if(s===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":U0(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=r.sibling,e!==null){e.return=r.return,Pt=e;break}Pt=r.return}}function rm(e,r,s){var c=s.flags;switch(s.tag){case 0:case 11:case 15:Rn(e,s),c&4&&Hs(5,s);break;case 1:if(Rn(e,s),c&4)if(e=s.stateNode,r===null)try{e.componentDidMount()}catch(E){it(s,s.return,E)}else{var d=Vr(s.type,r.memoizedProps);r=r.memoizedState;try{e.componentDidUpdate(d,r,e.__reactInternalSnapshotBeforeUpdate)}catch(E){it(s,s.return,E)}}c&64&&Qh(s),c&512&&Gs(s,s.return);break;case 3:if(Rn(e,s),c&64&&(e=s.updateQueue,e!==null)){if(r=null,s.child!==null)switch(s.child.tag){case 27:case 5:r=s.child.stateNode;break;case 1:r=s.child.stateNode}try{zd(e,r)}catch(E){it(s,s.return,E)}}break;case 27:r===null&&c&4&&am(s);case 26:case 5:Rn(e,s),r===null&&c&4&&em(s),c&512&&Gs(s,s.return);break;case 12:Rn(e,s);break;case 31:Rn(e,s),c&4&&lm(e,s);break;case 13:Rn(e,s),c&4&&cm(e,s),c&64&&(e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(s=Ux.bind(null,s),Zx(e,s))));break;case 22:if(c=s.memoizedState!==null||On,!c){r=r!==null&&r.memoizedState!==null||Ut,d=On;var m=Ut;On=c,(Ut=r)&&!m?Fn(e,s,(s.subtreeFlags&8772)!==0):Rn(e,s),On=d,Ut=m}break;case 30:break;default:Rn(e,s)}}function im(e){var r=e.alternate;r!==null&&(e.alternate=null,im(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&xe(r)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Et=null,ga=!1;function In(e,r,s){for(s=s.child;s!==null;)sm(e,r,s),s=s.sibling}function sm(e,r,s){if(na&&typeof na.onCommitFiberUnmount=="function")try{na.onCommitFiberUnmount(qn,s)}catch{}switch(s.tag){case 26:Ut||pn(s,r),In(e,r,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:Ut||pn(s,r);var c=Et,d=ga;mr(s.type)&&(Et=s.stateNode,ga=!1),In(e,r,s),Zs(s.stateNode),Et=c,ga=d;break;case 5:Ut||pn(s,r);case 6:if(c=Et,d=ga,Et=null,In(e,r,s),Et=c,ga=d,Et!==null)if(ga)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(s.stateNode)}catch(m){it(s,r,m)}else try{Et.removeChild(s.stateNode)}catch(m){it(s,r,m)}break;case 18:Et!==null&&(ga?(e=Et,Qm(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,s.stateNode),Vi(e)):Qm(Et,s.stateNode));break;case 4:c=Et,d=ga,Et=s.stateNode.containerInfo,ga=!0,In(e,r,s),Et=c,ga=d;break;case 0:case 11:case 14:case 15:lr(2,s,r),Ut||lr(4,s,r),In(e,r,s);break;case 1:Ut||(pn(s,r),c=s.stateNode,typeof c.componentWillUnmount=="function"&&Zh(s,r,c)),In(e,r,s);break;case 21:In(e,r,s);break;case 22:Ut=(c=Ut)||s.memoizedState!==null,In(e,r,s),Ut=c;break;default:In(e,r,s)}}function lm(e,r){if(r.memoizedState===null&&(e=r.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Vi(e)}catch(s){it(r,r.return,s)}}}function cm(e,r){if(r.memoizedState===null&&(e=r.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Vi(e)}catch(s){it(r,r.return,s)}}function wx(e){switch(e.tag){case 31:case 13:case 19:var r=e.stateNode;return r===null&&(r=e.stateNode=new nm),r;case 22:return e=e.stateNode,r=e._retryCache,r===null&&(r=e._retryCache=new nm),r;default:throw Error(i(435,e.tag))}}function wc(e,r){var s=wx(e);r.forEach(function(c){if(!s.has(c)){s.add(c);var d=Ox.bind(null,e,c);c.then(d,d)}})}function pa(e,r){var s=r.deletions;if(s!==null)for(var c=0;c<s.length;c++){var d=s[c],m=e,E=r,A=E;e:for(;A!==null;){switch(A.tag){case 27:if(mr(A.type)){Et=A.stateNode,ga=!1;break e}break;case 5:Et=A.stateNode,ga=!1;break e;case 3:case 4:Et=A.stateNode.containerInfo,ga=!0;break e}A=A.return}if(Et===null)throw Error(i(160));sm(m,E,d),Et=null,ga=!1,m=d.alternate,m!==null&&(m.return=null),d.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)om(r,e),r=r.sibling}var nn=null;function om(e,r){var s=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:pa(r,e),xa(e),c&4&&(lr(3,e,e.return),Hs(3,e),lr(5,e,e.return));break;case 1:pa(r,e),xa(e),c&512&&(Ut||s===null||pn(s,s.return)),c&64&&On&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(s=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=s===null?c:s.concat(c))));break;case 26:var d=nn;if(pa(r,e),xa(e),c&512&&(Ut||s===null||pn(s,s.return)),c&4){var m=s!==null?s.memoizedState:null;if(c=e.memoizedState,s===null)if(c===null)if(e.stateNode===null){e:{c=e.type,s=e.memoizedProps,d=d.ownerDocument||d;t:switch(c){case"title":m=d.getElementsByTagName("title")[0],(!m||m[le]||m[O]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=d.createElement(c),d.head.insertBefore(m,d.querySelector("head > title"))),Jt(m,c,s),m[O]=e,Ie(m),c=m;break e;case"link":var E=o1("link","href",d).get(c+(s.href||""));if(E){for(var A=0;A<E.length;A++)if(m=E[A],m.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&m.getAttribute("rel")===(s.rel==null?null:s.rel)&&m.getAttribute("title")===(s.title==null?null:s.title)&&m.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){E.splice(A,1);break t}}m=d.createElement(c),Jt(m,c,s),d.head.appendChild(m);break;case"meta":if(E=o1("meta","content",d).get(c+(s.content||""))){for(A=0;A<E.length;A++)if(m=E[A],m.getAttribute("content")===(s.content==null?null:""+s.content)&&m.getAttribute("name")===(s.name==null?null:s.name)&&m.getAttribute("property")===(s.property==null?null:s.property)&&m.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&m.getAttribute("charset")===(s.charSet==null?null:s.charSet)){E.splice(A,1);break t}}m=d.createElement(c),Jt(m,c,s),d.head.appendChild(m);break;default:throw Error(i(468,c))}m[O]=e,Ie(m),c=m}e.stateNode=c}else u1(d,e.type,e.stateNode);else e.stateNode=c1(d,c,e.memoizedProps);else m!==c?(m===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):m.count--,c===null?u1(d,e.type,e.stateNode):c1(d,c,e.memoizedProps)):c===null&&e.stateNode!==null&&i0(e,e.memoizedProps,s.memoizedProps)}break;case 27:pa(r,e),xa(e),c&512&&(Ut||s===null||pn(s,s.return)),s!==null&&c&4&&i0(e,e.memoizedProps,s.memoizedProps);break;case 5:if(pa(r,e),xa(e),c&512&&(Ut||s===null||pn(s,s.return)),e.flags&32){d=e.stateNode;try{vi(d,"")}catch(Oe){it(e,e.return,Oe)}}c&4&&e.stateNode!=null&&(d=e.memoizedProps,i0(e,d,s!==null?s.memoizedProps:d)),c&1024&&(c0=!0);break;case 6:if(pa(r,e),xa(e),c&4){if(e.stateNode===null)throw Error(i(162));c=e.memoizedProps,s=e.stateNode;try{s.nodeValue=c}catch(Oe){it(e,e.return,Oe)}}break;case 3:if(Pc=null,d=nn,nn=Bc(r.containerInfo),pa(r,e),nn=d,xa(e),c&4&&s!==null&&s.memoizedState.isDehydrated)try{Vi(r.containerInfo)}catch(Oe){it(e,e.return,Oe)}c0&&(c0=!1,um(e));break;case 4:c=nn,nn=Bc(e.stateNode.containerInfo),pa(r,e),xa(e),nn=c;break;case 12:pa(r,e),xa(e);break;case 31:pa(r,e),xa(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,wc(e,c)));break;case 13:pa(r,e),xa(e),e.child.flags&8192&&e.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(Nc=Ct()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,wc(e,c)));break;case 22:d=e.memoizedState!==null;var W=s!==null&&s.memoizedState!==null,ae=On,de=Ut;if(On=ae||d,Ut=de||W,pa(r,e),Ut=de,On=ae,xa(e),c&8192)e:for(r=e.stateNode,r._visibility=d?r._visibility&-2:r._visibility|1,d&&(s===null||W||On||Ut||Yr(e)),s=null,r=e;;){if(r.tag===5||r.tag===26){if(s===null){W=s=r;try{if(m=W.stateNode,d)E=m.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{A=W.stateNode;var ve=W.memoizedProps.style,se=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;A.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Oe){it(W,W.return,Oe)}}}else if(r.tag===6){if(s===null){W=r;try{W.stateNode.nodeValue=d?"":W.memoizedProps}catch(Oe){it(W,W.return,Oe)}}}else if(r.tag===18){if(s===null){W=r;try{var oe=W.stateNode;d?Zm(oe,!0):Zm(W.stateNode,!1)}catch(Oe){it(W,W.return,Oe)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===e)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;s===r&&(s=null),r=r.return}s===r&&(s=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=e.updateQueue,c!==null&&(s=c.retryQueue,s!==null&&(c.retryQueue=null,wc(e,s))));break;case 19:pa(r,e),xa(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,wc(e,c)));break;case 30:break;case 21:break;default:pa(r,e),xa(e)}}function xa(e){var r=e.flags;if(r&2){try{for(var s,c=e.return;c!==null;){if(tm(c)){s=c;break}c=c.return}if(s==null)throw Error(i(160));switch(s.tag){case 27:var d=s.stateNode,m=s0(e);_c(e,m,d);break;case 5:var E=s.stateNode;s.flags&32&&(vi(E,""),s.flags&=-33);var A=s0(e);_c(e,A,E);break;case 3:case 4:var W=s.stateNode.containerInfo,ae=s0(e);l0(e,ae,W);break;default:throw Error(i(161))}}catch(de){it(e,e.return,de)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function um(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var r=e;um(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),e=e.sibling}}function Rn(e,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)rm(e,r.alternate,r),r=r.sibling}function Yr(e){for(e=e.child;e!==null;){var r=e;switch(r.tag){case 0:case 11:case 14:case 15:lr(4,r,r.return),Yr(r);break;case 1:pn(r,r.return);var s=r.stateNode;typeof s.componentWillUnmount=="function"&&Zh(r,r.return,s),Yr(r);break;case 27:Zs(r.stateNode);case 26:case 5:pn(r,r.return),Yr(r);break;case 22:r.memoizedState===null&&Yr(r);break;case 30:Yr(r);break;default:Yr(r)}e=e.sibling}}function Fn(e,r,s){for(s=s&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,d=e,m=r,E=m.flags;switch(m.tag){case 0:case 11:case 15:Fn(d,m,s),Hs(4,m);break;case 1:if(Fn(d,m,s),c=m,d=c.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(ae){it(c,c.return,ae)}if(c=m,d=c.updateQueue,d!==null){var A=c.stateNode;try{var W=d.shared.hiddenCallbacks;if(W!==null)for(d.shared.hiddenCallbacks=null,d=0;d<W.length;d++)Pd(W[d],A)}catch(ae){it(c,c.return,ae)}}s&&E&64&&Qh(m),Gs(m,m.return);break;case 27:am(m);case 26:case 5:Fn(d,m,s),s&&c===null&&E&4&&em(m),Gs(m,m.return);break;case 12:Fn(d,m,s);break;case 31:Fn(d,m,s),s&&E&4&&lm(d,m);break;case 13:Fn(d,m,s),s&&E&4&&cm(d,m);break;case 22:m.memoizedState===null&&Fn(d,m,s),Gs(m,m.return);break;case 30:break;default:Fn(d,m,s)}r=r.sibling}}function o0(e,r){var s=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),e=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(e=r.memoizedState.cachePool.pool),e!==s&&(e!=null&&e.refCount++,s!=null&&Ms(s))}function u0(e,r){e=null,r.alternate!==null&&(e=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==e&&(r.refCount++,e!=null&&Ms(e))}function rn(e,r,s,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)fm(e,r,s,c),r=r.sibling}function fm(e,r,s,c){var d=r.flags;switch(r.tag){case 0:case 11:case 15:rn(e,r,s,c),d&2048&&Hs(9,r);break;case 1:rn(e,r,s,c);break;case 3:rn(e,r,s,c),d&2048&&(e=null,r.alternate!==null&&(e=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==e&&(r.refCount++,e!=null&&Ms(e)));break;case 12:if(d&2048){rn(e,r,s,c),e=r.stateNode;try{var m=r.memoizedProps,E=m.id,A=m.onPostCommit;typeof A=="function"&&A(E,r.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(W){it(r,r.return,W)}}else rn(e,r,s,c);break;case 31:rn(e,r,s,c);break;case 13:rn(e,r,s,c);break;case 23:break;case 22:m=r.stateNode,E=r.alternate,r.memoizedState!==null?m._visibility&2?rn(e,r,s,c):Ws(e,r):m._visibility&2?rn(e,r,s,c):(m._visibility|=2,Ii(e,r,s,c,(r.subtreeFlags&10256)!==0||!1)),d&2048&&o0(E,r);break;case 24:rn(e,r,s,c),d&2048&&u0(r.alternate,r);break;default:rn(e,r,s,c)}}function Ii(e,r,s,c,d){for(d=d&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=e,E=r,A=s,W=c,ae=E.flags;switch(E.tag){case 0:case 11:case 15:Ii(m,E,A,W,d),Hs(8,E);break;case 23:break;case 22:var de=E.stateNode;E.memoizedState!==null?de._visibility&2?Ii(m,E,A,W,d):Ws(m,E):(de._visibility|=2,Ii(m,E,A,W,d)),d&&ae&2048&&o0(E.alternate,E);break;case 24:Ii(m,E,A,W,d),d&&ae&2048&&u0(E.alternate,E);break;default:Ii(m,E,A,W,d)}r=r.sibling}}function Ws(e,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var s=e,c=r,d=c.flags;switch(c.tag){case 22:Ws(s,c),d&2048&&o0(c.alternate,c);break;case 24:Ws(s,c),d&2048&&u0(c.alternate,c);break;default:Ws(s,c)}r=r.sibling}}var Vs=8192;function Ri(e,r,s){if(e.subtreeFlags&Vs)for(e=e.child;e!==null;)dm(e,r,s),e=e.sibling}function dm(e,r,s){switch(e.tag){case 26:Ri(e,r,s),e.flags&Vs&&e.memoizedState!==null&&fS(s,nn,e.memoizedState,e.memoizedProps);break;case 5:Ri(e,r,s);break;case 3:case 4:var c=nn;nn=Bc(e.stateNode.containerInfo),Ri(e,r,s),nn=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=Vs,Vs=16777216,Ri(e,r,s),Vs=c):Ri(e,r,s));break;default:Ri(e,r,s)}}function hm(e){var r=e.alternate;if(r!==null&&(e=r.child,e!==null)){r.child=null;do r=e.sibling,e.sibling=null,e=r;while(e!==null)}}function Ys(e){var r=e.deletions;if((e.flags&16)!==0){if(r!==null)for(var s=0;s<r.length;s++){var c=r[s];Pt=c,vm(c,e)}hm(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)mm(e),e=e.sibling}function mm(e){switch(e.tag){case 0:case 11:case 15:Ys(e),e.flags&2048&&lr(9,e,e.return);break;case 3:Ys(e);break;case 12:Ys(e);break;case 22:var r=e.stateNode;e.memoizedState!==null&&r._visibility&2&&(e.return===null||e.return.tag!==13)?(r._visibility&=-3,bc(e)):Ys(e);break;default:Ys(e)}}function bc(e){var r=e.deletions;if((e.flags&16)!==0){if(r!==null)for(var s=0;s<r.length;s++){var c=r[s];Pt=c,vm(c,e)}hm(e)}for(e=e.child;e!==null;){switch(r=e,r.tag){case 0:case 11:case 15:lr(8,r,r.return),bc(r);break;case 22:s=r.stateNode,s._visibility&2&&(s._visibility&=-3,bc(r));break;default:bc(r)}e=e.sibling}}function vm(e,r){for(;Pt!==null;){var s=Pt;switch(s.tag){case 0:case 11:case 15:lr(8,s,r);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var c=s.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ms(s.memoizedState.cache)}if(c=s.child,c!==null)c.return=s,Pt=c;else e:for(s=e;Pt!==null;){c=Pt;var d=c.sibling,m=c.return;if(im(c),c===s){Pt=null;break e}if(d!==null){d.return=m,Pt=d;break e}Pt=m}}}var bx={getCacheForType:function(e){var r=Xt(Mt),s=r.data.get(e);return s===void 0&&(s=e(),r.data.set(e,s)),s},cacheSignal:function(){return Xt(Mt).controller.signal}},Nx=typeof WeakMap=="function"?WeakMap:Map,at=0,mt=null,Ye=null,qe=0,rt=0,Ma=null,cr=!1,Fi=!1,f0=!1,Ln=0,wt=0,or=0,Xr=0,d0=0,ja=0,Li=0,Xs=null,Sa=null,h0=!1,Nc=0,gm=0,Ac=1/0,Dc=null,ur=null,Ft=0,fr=null,Bi=null,Bn=0,m0=0,v0=null,pm=null,qs=0,g0=null;function ka(){return(at&2)!==0&&qe!==0?qe&-qe:ee.T!==null?T0():b()}function xm(){if(ja===0)if((qe&536870912)===0||$e){var e=ui;ui<<=1,(ui&3932160)===0&&(ui=262144),ja=e}else ja=536870912;return e=Aa.current,e!==null&&(e.flags|=32),ja}function ya(e,r,s){(e===mt&&(rt===2||rt===9)||e.cancelPendingCommit!==null)&&(Ki(e,0),dr(e,qe,ja,!1)),jr(e,s),((at&2)===0||e!==mt)&&(e===mt&&((at&2)===0&&(Xr|=s),wt===4&&dr(e,qe,ja,!1)),xn(e))}function Sm(e,r,s){if((at&6)!==0)throw Error(i(327));var c=!s&&(r&127)===0&&(r&e.expiredLanes)===0||Mr(e,r),d=c?Mx(e,r):x0(e,r,!0),m=c;do{if(d===0){Fi&&!c&&dr(e,r,0,!1);break}else{if(s=e.current.alternate,m&&!Ax(s)){d=x0(e,r,!1),m=!1;continue}if(d===2){if(m=r,e.errorRecoveryDisabledLanes&m)var E=0;else E=e.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){r=E;e:{var A=e;d=Xs;var W=A.current.memoizedState.isDehydrated;if(W&&(Ki(A,E).flags|=256),E=x0(A,E,!1),E!==2){if(f0&&!W){A.errorRecoveryDisabledLanes|=m,Xr|=m,d=4;break e}m=Sa,Sa=d,m!==null&&(Sa===null?Sa=m:Sa.push.apply(Sa,m))}d=E}if(m=!1,d!==2)continue}}if(d===1){Ki(e,0),dr(e,r,0,!0);break}e:{switch(c=e,m=d,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:dr(c,r,ja,!cr);break e;case 2:Sa=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(d=Nc+300-Ct(),10<d)){if(dr(c,r,ja,!cr),di(c,0,!0)!==0)break e;Bn=r,c.timeoutHandle=Jm(ym.bind(null,c,s,Sa,Dc,h0,r,ja,Xr,Li,cr,m,"Throttled",-0,0),d);break e}ym(c,s,Sa,Dc,h0,r,ja,Xr,Li,cr,m,null,-0,0)}}break}while(!0);xn(e)}function ym(e,r,s,c,d,m,E,A,W,ae,de,ve,se,oe){if(e.timeoutHandle=-1,ve=r.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_n},dm(r,m,ve);var Oe=(m&62914560)===m?Nc-Ct():(m&4194048)===m?gm-Ct():0;if(Oe=dS(ve,Oe),Oe!==null){Bn=m,e.cancelPendingCommit=Oe(Am.bind(null,e,r,m,s,c,d,E,A,W,de,ve,null,se,oe)),dr(e,m,E,!ae);return}}Am(e,r,m,s,c,d,E,A,W)}function Ax(e){for(var r=e;;){var s=r.tag;if((s===0||s===11||s===15)&&r.flags&16384&&(s=r.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var c=0;c<s.length;c++){var d=s[c],m=d.getSnapshot;d=d.value;try{if(!ba(m(),d))return!1}catch{return!1}}if(s=r.child,r.subtreeFlags&16384&&s!==null)s.return=r,r=s;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function dr(e,r,s,c){r&=~d0,r&=~Xr,e.suspendedLanes|=r,e.pingedLanes&=~r,c&&(e.warmLanes|=r),c=e.expirationTimes;for(var d=r;0<d;){var m=31-oa(d),E=1<<m;c[m]=-1,d&=~E}s!==0&&Bl(e,s,r)}function Mc(){return(at&6)===0?(Js(0),!1):!0}function p0(){if(Ye!==null){if(rt===0)var e=Ye.return;else e=Ye,An=Br=null,Uu(e),Mi=null,ks=0,e=Ye;for(;e!==null;)$h(e.alternate,e),e=e.return;Ye=null}}function Ki(e,r){var s=e.timeoutHandle;s!==-1&&(e.timeoutHandle=-1,Xx(s)),s=e.cancelPendingCommit,s!==null&&(e.cancelPendingCommit=null,s()),Bn=0,p0(),mt=e,Ye=s=bn(e.current,null),qe=r,rt=0,Ma=null,cr=!1,Fi=Mr(e,r),f0=!1,Li=ja=d0=Xr=or=wt=0,Sa=Xs=null,h0=!1,(r&8)!==0&&(r|=r&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=r;0<c;){var d=31-oa(c),m=1<<d;r|=e[d],c&=~m}return Ln=r,$l(),s}function Cm(e,r){ze=null,ee.H=Ks,r===Di||r===ic?(r=Fd(),rt=3):r===Cu?(r=Fd(),rt=4):rt=r===qu?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ma=r,Ye===null&&(wt=1,Sc(e,Ga(r,e.current)))}function Tm(){var e=Aa.current;return e===null?!0:(qe&4194048)===qe?Xa===null:(qe&62914560)===qe||(qe&536870912)!==0?e===Xa:!1}function Em(){var e=ee.H;return ee.H=Ks,e===null?Ks:e}function _m(){var e=ee.A;return ee.A=bx,e}function jc(){wt=4,cr||(qe&4194048)!==qe&&Aa.current!==null||(Fi=!0),(or&134217727)===0&&(Xr&134217727)===0||mt===null||dr(mt,qe,ja,!1)}function x0(e,r,s){var c=at;at|=2;var d=Em(),m=_m();(mt!==e||qe!==r)&&(Dc=null,Ki(e,r)),r=!1;var E=wt;e:do try{if(rt!==0&&Ye!==null){var A=Ye,W=Ma;switch(rt){case 8:p0(),E=6;break e;case 3:case 2:case 9:case 6:Aa.current===null&&(r=!0);var ae=rt;if(rt=0,Ma=null,Pi(e,A,W,ae),s&&Fi){E=0;break e}break;default:ae=rt,rt=0,Ma=null,Pi(e,A,W,ae)}}Dx(),E=wt;break}catch(de){Cm(e,de)}while(!0);return r&&e.shellSuspendCounter++,An=Br=null,at=c,ee.H=d,ee.A=m,Ye===null&&(mt=null,qe=0,$l()),E}function Dx(){for(;Ye!==null;)wm(Ye)}function Mx(e,r){var s=at;at|=2;var c=Em(),d=_m();mt!==e||qe!==r?(Dc=null,Ac=Ct()+500,Ki(e,r)):Fi=Mr(e,r);e:do try{if(rt!==0&&Ye!==null){r=Ye;var m=Ma;t:switch(rt){case 1:rt=0,Ma=null,Pi(e,r,m,1);break;case 2:case 9:if(Id(m)){rt=0,Ma=null,bm(r);break}r=function(){rt!==2&&rt!==9||mt!==e||(rt=7),xn(e)},m.then(r,r);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:Id(m)?(rt=0,Ma=null,bm(r)):(rt=0,Ma=null,Pi(e,r,m,7));break;case 5:var E=null;switch(Ye.tag){case 26:E=Ye.memoizedState;case 5:case 27:var A=Ye;if(E?f1(E):A.stateNode.complete){rt=0,Ma=null;var W=A.sibling;if(W!==null)Ye=W;else{var ae=A.return;ae!==null?(Ye=ae,kc(ae)):Ye=null}break t}}rt=0,Ma=null,Pi(e,r,m,5);break;case 6:rt=0,Ma=null,Pi(e,r,m,6);break;case 8:p0(),wt=6;break e;default:throw Error(i(462))}}jx();break}catch(de){Cm(e,de)}while(!0);return An=Br=null,ee.H=c,ee.A=d,at=s,Ye!==null?0:(mt=null,qe=0,$l(),wt)}function jx(){for(;Ye!==null&&!Ul();)wm(Ye)}function wm(e){var r=qh(e.alternate,e,Ln);e.memoizedProps=e.pendingProps,r===null?kc(e):Ye=r}function bm(e){var r=e,s=r.alternate;switch(r.tag){case 15:case 0:r=Hh(s,r,r.pendingProps,r.type,void 0,qe);break;case 11:r=Hh(s,r,r.pendingProps,r.type.render,r.ref,qe);break;case 5:Uu(r);default:$h(s,r),r=Ye=_d(r,Ln),r=qh(s,r,Ln)}e.memoizedProps=e.pendingProps,r===null?kc(e):Ye=r}function Pi(e,r,s,c){An=Br=null,Uu(r),Mi=null,ks=0;var d=r.return;try{if(Sx(e,d,r,s,qe)){wt=1,Sc(e,Ga(s,e.current)),Ye=null;return}}catch(m){if(d!==null)throw Ye=d,m;wt=1,Sc(e,Ga(s,e.current)),Ye=null;return}r.flags&32768?($e||c===1?e=!0:Fi||(qe&536870912)!==0?e=!1:(cr=e=!0,(c===2||c===9||c===3||c===6)&&(c=Aa.current,c!==null&&c.tag===13&&(c.flags|=16384))),Nm(r,e)):kc(r)}function kc(e){var r=e;do{if((r.flags&32768)!==0){Nm(r,cr);return}e=r.return;var s=Tx(r.alternate,r,Ln);if(s!==null){Ye=s;return}if(r=r.sibling,r!==null){Ye=r;return}Ye=r=e}while(r!==null);wt===0&&(wt=5)}function Nm(e,r){do{var s=Ex(e.alternate,e);if(s!==null){s.flags&=32767,Ye=s;return}if(s=e.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!r&&(e=e.sibling,e!==null)){Ye=e;return}Ye=e=s}while(e!==null);wt=6,Ye=null}function Am(e,r,s,c,d,m,E,A,W){e.cancelPendingCommit=null;do Uc();while(Ft!==0);if((at&6)!==0)throw Error(i(327));if(r!==null){if(r===e.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=su,Lo(e,s,m,E,A,W),e===mt&&(Ye=mt=null,qe=0),Bi=r,fr=e,Bn=s,m0=m,v0=d,pm=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ix(La,function(){return Um(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=ee.T,ee.T=null,d=ge.p,ge.p=2,E=at,at|=4;try{_x(e,r,s)}finally{at=E,ge.p=d,ee.T=c}}Ft=1,Dm(),Mm(),jm()}}function Dm(){if(Ft===1){Ft=0;var e=fr,r=Bi,s=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||s){s=ee.T,ee.T=null;var c=ge.p;ge.p=2;var d=at;at|=4;try{om(r,e);var m=M0,E=vd(e.containerInfo),A=m.focusedElem,W=m.selectionRange;if(E!==A&&A&&A.ownerDocument&&md(A.ownerDocument.documentElement,A)){if(W!==null&&tu(A)){var ae=W.start,de=W.end;if(de===void 0&&(de=ae),"selectionStart"in A)A.selectionStart=ae,A.selectionEnd=Math.min(de,A.value.length);else{var ve=A.ownerDocument||document,se=ve&&ve.defaultView||window;if(se.getSelection){var oe=se.getSelection(),Oe=A.textContent.length,Be=Math.min(W.start,Oe),dt=W.end===void 0?Be:Math.min(W.end,Oe);!oe.extend&&Be>dt&&(E=dt,dt=Be,Be=E);var Q=hd(A,Be),q=hd(A,dt);if(Q&&q&&(oe.rangeCount!==1||oe.anchorNode!==Q.node||oe.anchorOffset!==Q.offset||oe.focusNode!==q.node||oe.focusOffset!==q.offset)){var te=ve.createRange();te.setStart(Q.node,Q.offset),oe.removeAllRanges(),Be>dt?(oe.addRange(te),oe.extend(q.node,q.offset)):(te.setEnd(q.node,q.offset),oe.addRange(te))}}}}for(ve=[],oe=A;oe=oe.parentNode;)oe.nodeType===1&&ve.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<ve.length;A++){var me=ve[A];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}Wc=!!D0,M0=D0=null}finally{at=d,ge.p=c,ee.T=s}}e.current=r,Ft=2}}function Mm(){if(Ft===2){Ft=0;var e=fr,r=Bi,s=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||s){s=ee.T,ee.T=null;var c=ge.p;ge.p=2;var d=at;at|=4;try{rm(e,r.alternate,r)}finally{at=d,ge.p=c,ee.T=s}}Ft=3}}function jm(){if(Ft===4||Ft===3){Ft=0,hs();var e=fr,r=Bi,s=Bn,c=pm;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ft=5:(Ft=0,Bi=fr=null,km(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(ur=null),ps(s),r=r.stateNode,na&&typeof na.onCommitFiberRoot=="function")try{na.onCommitFiberRoot(qn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=ee.T,d=ge.p,ge.p=2,ee.T=null;try{for(var m=e.onRecoverableError,E=0;E<c.length;E++){var A=c[E];m(A.value,{componentStack:A.stack})}}finally{ee.T=r,ge.p=d}}(Bn&3)!==0&&Uc(),xn(e),d=e.pendingLanes,(s&261930)!==0&&(d&42)!==0?e===g0?qs++:(qs=0,g0=e):qs=0,Js(0)}}function km(e,r){(e.pooledCacheLanes&=r)===0&&(r=e.pooledCache,r!=null&&(e.pooledCache=null,Ms(r)))}function Uc(){return Dm(),Mm(),jm(),Um()}function Um(){if(Ft!==5)return!1;var e=fr,r=m0;m0=0;var s=ps(Bn),c=ee.T,d=ge.p;try{ge.p=32>s?32:s,ee.T=null,s=v0,v0=null;var m=fr,E=Bn;if(Ft=0,Bi=fr=null,Bn=0,(at&6)!==0)throw Error(i(331));var A=at;if(at|=4,mm(m.current),fm(m,m.current,E,s),at=A,Js(0,!1),na&&typeof na.onPostCommitFiberRoot=="function")try{na.onPostCommitFiberRoot(qn,m)}catch{}return!0}finally{ge.p=d,ee.T=c,km(e,r)}}function Om(e,r,s){r=Ga(s,r),r=Xu(e.stateNode,r,2),e=rr(e,r,2),e!==null&&(jr(e,2),xn(e))}function it(e,r,s){if(e.tag===3)Om(e,e,s);else for(;r!==null;){if(r.tag===3){Om(r,e,s);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ur===null||!ur.has(c))){e=Ga(s,e),s=Ih(2),c=rr(r,s,2),c!==null&&(Rh(s,c,r,e),jr(c,2),xn(c));break}}r=r.return}}function S0(e,r,s){var c=e.pingCache;if(c===null){c=e.pingCache=new Nx;var d=new Set;c.set(r,d)}else d=c.get(r),d===void 0&&(d=new Set,c.set(r,d));d.has(s)||(f0=!0,d.add(s),e=kx.bind(null,e,r,s),r.then(e,e))}function kx(e,r,s){var c=e.pingCache;c!==null&&c.delete(r),e.pingedLanes|=e.suspendedLanes&s,e.warmLanes&=~s,mt===e&&(qe&s)===s&&(wt===4||wt===3&&(qe&62914560)===qe&&300>Ct()-Nc?(at&2)===0&&Ki(e,0):d0|=s,Li===qe&&(Li=0)),xn(e)}function Im(e,r){r===0&&(r=Ll()),e=Rr(e,r),e!==null&&(jr(e,r),xn(e))}function Ux(e){var r=e.memoizedState,s=0;r!==null&&(s=r.retryLane),Im(e,s)}function Ox(e,r){var s=0;switch(e.tag){case 31:case 13:var c=e.stateNode,d=e.memoizedState;d!==null&&(s=d.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Im(e,s)}function Ix(e,r){return en(e,r)}var Oc=null,zi=null,y0=!1,Ic=!1,C0=!1,hr=0;function xn(e){e!==zi&&e.next===null&&(zi===null?Oc=zi=e:zi=zi.next=e),Ic=!0,y0||(y0=!0,Fx())}function Js(e,r){if(!C0&&Ic){C0=!0;do for(var s=!1,c=Oc;c!==null;){if(e!==0){var d=c.pendingLanes;if(d===0)var m=0;else{var E=c.suspendedLanes,A=c.pingedLanes;m=(1<<31-oa(42|e)+1)-1,m&=d&~(E&~A),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(s=!0,Bm(c,m))}else m=qe,m=di(c,c===mt?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Mr(c,m)||(s=!0,Bm(c,m));c=c.next}while(s);C0=!1}}function Rx(){Rm()}function Rm(){Ic=y0=!1;var e=0;hr!==0&&Yx()&&(e=hr);for(var r=Ct(),s=null,c=Oc;c!==null;){var d=c.next,m=Fm(c,r);m===0?(c.next=null,s===null?Oc=d:s.next=d,d===null&&(zi=s)):(s=c,(e!==0||(m&3)!==0)&&(Ic=!0)),c=d}Ft!==0&&Ft!==5||Js(e),hr!==0&&(hr=0)}function Fm(e,r){for(var s=e.suspendedLanes,c=e.pingedLanes,d=e.expirationTimes,m=e.pendingLanes&-62914561;0<m;){var E=31-oa(m),A=1<<E,W=d[E];W===-1?((A&s)===0||(A&c)!==0)&&(d[E]=Fo(A,r)):W<=r&&(e.expiredLanes|=A),m&=~A}if(r=mt,s=qe,s=di(e,e===r?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,s===0||e===r&&(rt===2||rt===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&hn(c),e.callbackNode=null,e.callbackPriority=0;if((s&3)===0||Mr(e,s)){if(r=s&-s,r===e.callbackPriority)return r;switch(c!==null&&hn(c),ps(s)){case 2:case 8:s=oi;break;case 32:s=La;break;case 268435456:s=ms;break;default:s=La}return c=Lm.bind(null,e),s=en(s,c),e.callbackPriority=r,e.callbackNode=s,r}return c!==null&&c!==null&&hn(c),e.callbackPriority=2,e.callbackNode=null,2}function Lm(e,r){if(Ft!==0&&Ft!==5)return e.callbackNode=null,e.callbackPriority=0,null;var s=e.callbackNode;if(Uc()&&e.callbackNode!==s)return null;var c=qe;return c=di(e,e===mt?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(Sm(e,c,r),Fm(e,Ct()),e.callbackNode!=null&&e.callbackNode===s?Lm.bind(null,e):null)}function Bm(e,r){if(Uc())return null;Sm(e,r,!0)}function Fx(){qx(function(){(at&6)!==0?en(ci,Rx):Rm()})}function T0(){if(hr===0){var e=Ni;e===0&&(e=Dr,Dr<<=1,(Dr&261888)===0&&(Dr=256)),hr=e}return hr}function Km(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Hl(""+e)}function Pm(e,r){var s=r.ownerDocument.createElement("input");return s.name=r.name,s.value=r.value,e.id&&s.setAttribute("form",e.id),r.parentNode.insertBefore(s,r),e=new FormData(e),s.parentNode.removeChild(s),e}function Lx(e,r,s,c,d){if(r==="submit"&&s&&s.stateNode===d){var m=Km((d[I]||null).action),E=c.submitter;E&&(r=(r=E[I]||null)?Km(r.formAction):E.getAttribute("formAction"),r!==null&&(m=r,E=null));var A=new Yl("action","action",null,c,d);e.push({event:A,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(hr!==0){var W=E?Pm(d,E):new FormData(d);zu(s,{pending:!0,data:W,method:d.method,action:m},null,W)}}else typeof m=="function"&&(A.preventDefault(),W=E?Pm(d,E):new FormData(d),zu(s,{pending:!0,data:W,method:d.method,action:m},m,W))},currentTarget:d}]})}}for(var E0=0;E0<iu.length;E0++){var _0=iu[E0],Bx=_0.toLowerCase(),Kx=_0[0].toUpperCase()+_0.slice(1);an(Bx,"on"+Kx)}an(xd,"onAnimationEnd"),an(Sd,"onAnimationIteration"),an(yd,"onAnimationStart"),an("dblclick","onDoubleClick"),an("focusin","onFocus"),an("focusout","onBlur"),an(ax,"onTransitionRun"),an(nx,"onTransitionStart"),an(rx,"onTransitionCancel"),an(Cd,"onTransitionEnd"),Ka("onMouseEnter",["mouseout","mouseover"]),Ka("onMouseLeave",["mouseout","mouseover"]),Ka("onPointerEnter",["pointerout","pointerover"]),Ka("onPointerLeave",["pointerout","pointerover"]),Tt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Tt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Tt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Tt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Tt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Tt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $s="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Px=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($s));function zm(e,r){r=(r&4)!==0;for(var s=0;s<e.length;s++){var c=e[s],d=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var E=c.length-1;0<=E;E--){var A=c[E],W=A.instance,ae=A.currentTarget;if(A=A.listener,W!==m&&d.isPropagationStopped())break e;m=A,d.currentTarget=ae;try{m(d)}catch(de){Jl(de)}d.currentTarget=null,m=W}else for(E=0;E<c.length;E++){if(A=c[E],W=A.instance,ae=A.currentTarget,A=A.listener,W!==m&&d.isPropagationStopped())break e;m=A,d.currentTarget=ae;try{m(d)}catch(de){Jl(de)}d.currentTarget=null,m=W}}}}function Xe(e,r){var s=r[ne];s===void 0&&(s=r[ne]=new Set);var c=e+"__bubble";s.has(c)||(Hm(r,e,2,!1),s.add(c))}function w0(e,r,s){var c=0;r&&(c|=4),Hm(s,e,c,r)}var Rc="_reactListening"+Math.random().toString(36).slice(2);function b0(e){if(!e[Rc]){e[Rc]=!0,gt.forEach(function(s){s!=="selectionchange"&&(Px.has(s)||w0(s,!1,e),w0(s,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[Rc]||(r[Rc]=!0,w0("selectionchange",!1,r))}}function Hm(e,r,s,c){switch(x1(r)){case 2:var d=vS;break;case 8:d=gS;break;default:d=P0}s=d.bind(null,r,s,e),d=void 0,!Vo||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(d=!0),c?d!==void 0?e.addEventListener(r,s,{capture:!0,passive:d}):e.addEventListener(r,s,!0):d!==void 0?e.addEventListener(r,s,{passive:d}):e.addEventListener(r,s,!1)}function N0(e,r,s,c,d){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var A=c.stateNode.containerInfo;if(A===d)break;if(E===4)for(E=c.return;E!==null;){var W=E.tag;if((W===3||W===4)&&E.stateNode.containerInfo===d)return;E=E.return}for(;A!==null;){if(E=Te(A),E===null)return;if(W=E.tag,W===5||W===6||W===26||W===27){c=m=E;continue e}A=A.parentNode}}c=c.return}Xf(function(){var ae=m,de=Go(s),ve=[];e:{var se=Td.get(e);if(se!==void 0){var oe=Yl,Oe=e;switch(e){case"keypress":if(Wl(s)===0)break e;case"keydown":case"keyup":oe=Op;break;case"focusin":Oe="focus",oe=Jo;break;case"focusout":Oe="blur",oe=Jo;break;case"beforeblur":case"afterblur":oe=Jo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=$f;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=Tp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=Fp;break;case xd:case Sd:case yd:oe=wp;break;case Cd:oe=Bp;break;case"scroll":case"scrollend":oe=yp;break;case"wheel":oe=Pp;break;case"copy":case"cut":case"paste":oe=Np;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Zf;break;case"toggle":case"beforetoggle":oe=Hp}var Be=(r&4)!==0,dt=!Be&&(e==="scroll"||e==="scrollend"),Q=Be?se!==null?se+"Capture":null:se;Be=[];for(var q=ae,te;q!==null;){var me=q;if(te=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||te===null||Q===null||(me=Ss(q,Q),me!=null&&Be.push(Qs(q,me,te))),dt)break;q=q.return}0<Be.length&&(se=new oe(se,Oe,null,s,de),ve.push({event:se,listeners:Be}))}}if((r&7)===0){e:{if(se=e==="mouseover"||e==="pointerover",oe=e==="mouseout"||e==="pointerout",se&&s!==Ho&&(Oe=s.relatedTarget||s.fromElement)&&(Te(Oe)||Oe[F]))break e;if((oe||se)&&(se=de.window===de?de:(se=de.ownerDocument)?se.defaultView||se.parentWindow:window,oe?(Oe=s.relatedTarget||s.toElement,oe=ae,Oe=Oe?Te(Oe):null,Oe!==null&&(dt=u(Oe),Be=Oe.tag,Oe!==dt||Be!==5&&Be!==27&&Be!==6)&&(Oe=null)):(oe=null,Oe=ae),oe!==Oe)){if(Be=$f,me="onMouseLeave",Q="onMouseEnter",q="mouse",(e==="pointerout"||e==="pointerover")&&(Be=Zf,me="onPointerLeave",Q="onPointerEnter",q="pointer"),dt=oe==null?se:ye(oe),te=Oe==null?se:ye(Oe),se=new Be(me,q+"leave",oe,s,de),se.target=dt,se.relatedTarget=te,me=null,Te(de)===ae&&(Be=new Be(Q,q+"enter",Oe,s,de),Be.target=te,Be.relatedTarget=dt,me=Be),dt=me,oe&&Oe)t:{for(Be=zx,Q=oe,q=Oe,te=0,me=Q;me;me=Be(me))te++;me=0;for(var Fe=q;Fe;Fe=Be(Fe))me++;for(;0<te-me;)Q=Be(Q),te--;for(;0<me-te;)q=Be(q),me--;for(;te--;){if(Q===q||q!==null&&Q===q.alternate){Be=Q;break t}Q=Be(Q),q=Be(q)}Be=null}else Be=null;oe!==null&&Gm(ve,se,oe,Be,!1),Oe!==null&&dt!==null&&Gm(ve,dt,Oe,Be,!0)}}e:{if(se=ae?ye(ae):window,oe=se.nodeName&&se.nodeName.toLowerCase(),oe==="select"||oe==="input"&&se.type==="file")var Ze=ld;else if(id(se))if(cd)Ze=Zp;else{Ze=$p;var Re=Jp}else oe=se.nodeName,!oe||oe.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ae&&zo(ae.elementType)&&(Ze=ld):Ze=Qp;if(Ze&&(Ze=Ze(e,ae))){sd(ve,Ze,s,de);break e}Re&&Re(e,se,ae),e==="focusout"&&ae&&se.type==="number"&&ae.memoizedProps.value!=null&&Po(se,"number",se.value)}switch(Re=ae?ye(ae):window,e){case"focusin":(id(Re)||Re.contentEditable==="true")&&(Si=Re,au=ae,Ns=null);break;case"focusout":Ns=au=Si=null;break;case"mousedown":nu=!0;break;case"contextmenu":case"mouseup":case"dragend":nu=!1,gd(ve,s,de);break;case"selectionchange":if(tx)break;case"keydown":case"keyup":gd(ve,s,de)}var He;if(Qo)e:{switch(e){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else xi?nd(e,s)&&(Je="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(Je="onCompositionStart");Je&&(ed&&s.locale!=="ko"&&(xi||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&xi&&(He=qf()):($n=de,Yo="value"in $n?$n.value:$n.textContent,xi=!0)),Re=Fc(ae,Je),0<Re.length&&(Je=new Qf(Je,e,null,s,de),ve.push({event:Je,listeners:Re}),He?Je.data=He:(He=rd(s),He!==null&&(Je.data=He)))),(He=Wp?Vp(e,s):Yp(e,s))&&(Je=Fc(ae,"onBeforeInput"),0<Je.length&&(Re=new Qf("onBeforeInput","beforeinput",null,s,de),ve.push({event:Re,listeners:Je}),Re.data=He)),Lx(ve,e,ae,s,de)}zm(ve,r)})}function Qs(e,r,s){return{instance:e,listener:r,currentTarget:s}}function Fc(e,r){for(var s=r+"Capture",c=[];e!==null;){var d=e,m=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||m===null||(d=Ss(e,s),d!=null&&c.unshift(Qs(e,d,m)),d=Ss(e,r),d!=null&&c.push(Qs(e,d,m))),e.tag===3)return c;e=e.return}return[]}function zx(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Gm(e,r,s,c,d){for(var m=r._reactName,E=[];s!==null&&s!==c;){var A=s,W=A.alternate,ae=A.stateNode;if(A=A.tag,W!==null&&W===c)break;A!==5&&A!==26&&A!==27||ae===null||(W=ae,d?(ae=Ss(s,m),ae!=null&&E.unshift(Qs(s,ae,W))):d||(ae=Ss(s,m),ae!=null&&E.push(Qs(s,ae,W)))),s=s.return}E.length!==0&&e.push({event:r,listeners:E})}var Hx=/\r\n?/g,Gx=/\u0000|\uFFFD/g;function Wm(e){return(typeof e=="string"?e:""+e).replace(Hx,`
`).replace(Gx,"")}function Vm(e,r){return r=Wm(r),Wm(e)===r}function ft(e,r,s,c,d,m){switch(s){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||vi(e,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&vi(e,""+c);break;case"className":Pl(e,"class",c);break;case"tabIndex":Pl(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Pl(e,s,c);break;case"style":Vf(e,c,m);break;case"data":if(r!=="object"){Pl(e,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||s!=="href")){e.removeAttribute(s);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(s);break}c=Hl(""+c),e.setAttribute(s,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(s==="formAction"?(r!=="input"&&ft(e,r,"name",d.name,d,null),ft(e,r,"formEncType",d.formEncType,d,null),ft(e,r,"formMethod",d.formMethod,d,null),ft(e,r,"formTarget",d.formTarget,d,null)):(ft(e,r,"encType",d.encType,d,null),ft(e,r,"method",d.method,d,null),ft(e,r,"target",d.target,d,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(s);break}c=Hl(""+c),e.setAttribute(s,c);break;case"onClick":c!=null&&(e.onclick=_n);break;case"onScroll":c!=null&&Xe("scroll",e);break;case"onScrollEnd":c!=null&&Xe("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(s=c.__html,s!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=s}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}s=Hl(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(s,""+c):e.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(s,""):e.removeAttribute(s);break;case"capture":case"download":c===!0?e.setAttribute(s,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(s,c):e.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(s,c):e.removeAttribute(s);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(s):e.setAttribute(s,c);break;case"popover":Xe("beforetoggle",e),Xe("toggle",e),ma(e,"popover",c);break;case"xlinkActuate":En(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":En(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":En(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":En(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":En(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":En(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":En(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":En(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":En(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ma(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=xp.get(s)||s,ma(e,s,c))}}function A0(e,r,s,c,d,m){switch(s){case"style":Vf(e,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(s=c.__html,s!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=s}}break;case"children":typeof c=="string"?vi(e,c):(typeof c=="number"||typeof c=="bigint")&&vi(e,""+c);break;case"onScroll":c!=null&&Xe("scroll",e);break;case"onScrollEnd":c!=null&&Xe("scrollend",e);break;case"onClick":c!=null&&(e.onclick=_n);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pt.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(d=s.endsWith("Capture"),r=s.slice(2,d?s.length-7:void 0),m=e[I]||null,m=m!=null?m[s]:null,typeof m=="function"&&e.removeEventListener(r,m,d),typeof c=="function")){typeof m!="function"&&m!==null&&(s in e?e[s]=null:e.hasAttribute(s)&&e.removeAttribute(s)),e.addEventListener(r,c,d);break e}s in e?e[s]=c:c===!0?e.setAttribute(s,""):ma(e,s,c)}}}function Jt(e,r,s){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xe("error",e),Xe("load",e);var c=!1,d=!1,m;for(m in s)if(s.hasOwnProperty(m)){var E=s[m];if(E!=null)switch(m){case"src":c=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:ft(e,r,m,E,s,null)}}d&&ft(e,r,"srcSet",s.srcSet,s,null),c&&ft(e,r,"src",s.src,s,null);return;case"input":Xe("invalid",e);var A=m=E=d=null,W=null,ae=null;for(c in s)if(s.hasOwnProperty(c)){var de=s[c];if(de!=null)switch(c){case"name":d=de;break;case"type":E=de;break;case"checked":W=de;break;case"defaultChecked":ae=de;break;case"value":m=de;break;case"defaultValue":A=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:ft(e,r,c,de,s,null)}}zf(e,m,A,W,ae,E,d,!1);return;case"select":Xe("invalid",e),c=E=m=null;for(d in s)if(s.hasOwnProperty(d)&&(A=s[d],A!=null))switch(d){case"value":m=A;break;case"defaultValue":E=A;break;case"multiple":c=A;default:ft(e,r,d,A,s,null)}r=m,s=E,e.multiple=!!c,r!=null?mi(e,!!c,r,!1):s!=null&&mi(e,!!c,s,!0);return;case"textarea":Xe("invalid",e),m=d=c=null;for(E in s)if(s.hasOwnProperty(E)&&(A=s[E],A!=null))switch(E){case"value":c=A;break;case"defaultValue":d=A;break;case"children":m=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:ft(e,r,E,A,s,null)}Gf(e,c,d,m);return;case"option":for(W in s)if(s.hasOwnProperty(W)&&(c=s[W],c!=null))switch(W){case"selected":e.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:ft(e,r,W,c,s,null)}return;case"dialog":Xe("beforetoggle",e),Xe("toggle",e),Xe("cancel",e),Xe("close",e);break;case"iframe":case"object":Xe("load",e);break;case"video":case"audio":for(c=0;c<$s.length;c++)Xe($s[c],e);break;case"image":Xe("error",e),Xe("load",e);break;case"details":Xe("toggle",e);break;case"embed":case"source":case"link":Xe("error",e),Xe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in s)if(s.hasOwnProperty(ae)&&(c=s[ae],c!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:ft(e,r,ae,c,s,null)}return;default:if(zo(r)){for(de in s)s.hasOwnProperty(de)&&(c=s[de],c!==void 0&&A0(e,r,de,c,s,void 0));return}}for(A in s)s.hasOwnProperty(A)&&(c=s[A],c!=null&&ft(e,r,A,c,s,null))}function Wx(e,r,s,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,m=null,E=null,A=null,W=null,ae=null,de=null;for(oe in s){var ve=s[oe];if(s.hasOwnProperty(oe)&&ve!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":W=ve;default:c.hasOwnProperty(oe)||ft(e,r,oe,null,c,ve)}}for(var se in c){var oe=c[se];if(ve=s[se],c.hasOwnProperty(se)&&(oe!=null||ve!=null))switch(se){case"type":m=oe;break;case"name":d=oe;break;case"checked":ae=oe;break;case"defaultChecked":de=oe;break;case"value":E=oe;break;case"defaultValue":A=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,r));break;default:oe!==ve&&ft(e,r,se,oe,c,ve)}}Ko(e,E,A,W,ae,de,m,d);return;case"select":oe=E=A=se=null;for(m in s)if(W=s[m],s.hasOwnProperty(m)&&W!=null)switch(m){case"value":break;case"multiple":oe=W;default:c.hasOwnProperty(m)||ft(e,r,m,null,c,W)}for(d in c)if(m=c[d],W=s[d],c.hasOwnProperty(d)&&(m!=null||W!=null))switch(d){case"value":se=m;break;case"defaultValue":A=m;break;case"multiple":E=m;default:m!==W&&ft(e,r,d,m,c,W)}r=A,s=E,c=oe,se!=null?mi(e,!!s,se,!1):!!c!=!!s&&(r!=null?mi(e,!!s,r,!0):mi(e,!!s,s?[]:"",!1));return;case"textarea":oe=se=null;for(A in s)if(d=s[A],s.hasOwnProperty(A)&&d!=null&&!c.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:ft(e,r,A,null,c,d)}for(E in c)if(d=c[E],m=s[E],c.hasOwnProperty(E)&&(d!=null||m!=null))switch(E){case"value":se=d;break;case"defaultValue":oe=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(i(91));break;default:d!==m&&ft(e,r,E,d,c,m)}Hf(e,se,oe);return;case"option":for(var Oe in s)if(se=s[Oe],s.hasOwnProperty(Oe)&&se!=null&&!c.hasOwnProperty(Oe))switch(Oe){case"selected":e.selected=!1;break;default:ft(e,r,Oe,null,c,se)}for(W in c)if(se=c[W],oe=s[W],c.hasOwnProperty(W)&&se!==oe&&(se!=null||oe!=null))switch(W){case"selected":e.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:ft(e,r,W,se,c,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in s)se=s[Be],s.hasOwnProperty(Be)&&se!=null&&!c.hasOwnProperty(Be)&&ft(e,r,Be,null,c,se);for(ae in c)if(se=c[ae],oe=s[ae],c.hasOwnProperty(ae)&&se!==oe&&(se!=null||oe!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:ft(e,r,ae,se,c,oe)}return;default:if(zo(r)){for(var dt in s)se=s[dt],s.hasOwnProperty(dt)&&se!==void 0&&!c.hasOwnProperty(dt)&&A0(e,r,dt,void 0,c,se);for(de in c)se=c[de],oe=s[de],!c.hasOwnProperty(de)||se===oe||se===void 0&&oe===void 0||A0(e,r,de,se,c,oe);return}}for(var Q in s)se=s[Q],s.hasOwnProperty(Q)&&se!=null&&!c.hasOwnProperty(Q)&&ft(e,r,Q,null,c,se);for(ve in c)se=c[ve],oe=s[ve],!c.hasOwnProperty(ve)||se===oe||se==null&&oe==null||ft(e,r,ve,se,c,oe)}function Ym(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Vx(){if(typeof performance.getEntriesByType=="function"){for(var e=0,r=0,s=performance.getEntriesByType("resource"),c=0;c<s.length;c++){var d=s[c],m=d.transferSize,E=d.initiatorType,A=d.duration;if(m&&A&&Ym(E)){for(E=0,A=d.responseEnd,c+=1;c<s.length;c++){var W=s[c],ae=W.startTime;if(ae>A)break;var de=W.transferSize,ve=W.initiatorType;de&&Ym(ve)&&(W=W.responseEnd,E+=de*(W<A?1:(A-ae)/(W-ae)))}if(--c,r+=8*(m+E)/(d.duration/1e3),e++,10<e)break}}if(0<e)return r/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var D0=null,M0=null;function Lc(e){return e.nodeType===9?e:e.ownerDocument}function Xm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qm(e,r){if(e===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&r==="foreignObject"?0:e}function j0(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var k0=null;function Yx(){var e=window.event;return e&&e.type==="popstate"?e===k0?!1:(k0=e,!0):(k0=null,!1)}var Jm=typeof setTimeout=="function"?setTimeout:void 0,Xx=typeof clearTimeout=="function"?clearTimeout:void 0,$m=typeof Promise=="function"?Promise:void 0,qx=typeof queueMicrotask=="function"?queueMicrotask:typeof $m<"u"?function(e){return $m.resolve(null).then(e).catch(Jx)}:Jm;function Jx(e){setTimeout(function(){throw e})}function mr(e){return e==="head"}function Qm(e,r){var s=r,c=0;do{var d=s.nextSibling;if(e.removeChild(s),d&&d.nodeType===8)if(s=d.data,s==="/$"||s==="/&"){if(c===0){e.removeChild(d),Vi(r);return}c--}else if(s==="$"||s==="$?"||s==="$~"||s==="$!"||s==="&")c++;else if(s==="html")Zs(e.ownerDocument.documentElement);else if(s==="head"){s=e.ownerDocument.head,Zs(s);for(var m=s.firstChild;m;){var E=m.nextSibling,A=m.nodeName;m[le]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&m.rel.toLowerCase()==="stylesheet"||s.removeChild(m),m=E}}else s==="body"&&Zs(e.ownerDocument.body);s=d}while(s);Vi(r)}function Zm(e,r){var s=e;e=0;do{var c=s.nextSibling;if(s.nodeType===1?r?(s._stashedDisplay=s.style.display,s.style.display="none"):(s.style.display=s._stashedDisplay||"",s.getAttribute("style")===""&&s.removeAttribute("style")):s.nodeType===3&&(r?(s._stashedText=s.nodeValue,s.nodeValue=""):s.nodeValue=s._stashedText||""),c&&c.nodeType===8)if(s=c.data,s==="/$"){if(e===0)break;e--}else s!=="$"&&s!=="$?"&&s!=="$~"&&s!=="$!"||e++;s=c}while(s)}function U0(e){var r=e.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var s=r;switch(r=r.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":U0(s),xe(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}e.removeChild(s)}}function $x(e,r,s,c){for(;e.nodeType===1;){var d=s;if(e.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[le])switch(r){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(m=e.getAttribute("rel"),m==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(m!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(m=e.getAttribute("src"),(m!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&m&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(r==="input"&&e.type==="hidden"){var m=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===m)return e}else return e;if(e=qa(e.nextSibling),e===null)break}return null}function Qx(e,r,s){if(r==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!s||(e=qa(e.nextSibling),e===null))return null;return e}function e1(e,r){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=qa(e.nextSibling),e===null))return null;return e}function O0(e){return e.data==="$?"||e.data==="$~"}function I0(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Zx(e,r){var s=e.ownerDocument;if(e.data==="$~")e._reactRetry=r;else if(e.data!=="$?"||s.readyState!=="loading")r();else{var c=function(){r(),s.removeEventListener("DOMContentLoaded",c)};s.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function qa(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return e}var R0=null;function t1(e){e=e.nextSibling;for(var r=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"||s==="/&"){if(r===0)return qa(e.nextSibling);r--}else s!=="$"&&s!=="$!"&&s!=="$?"&&s!=="$~"&&s!=="&"||r++}e=e.nextSibling}return null}function a1(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"){if(r===0)return e;r--}else s!=="/$"&&s!=="/&"||r++}e=e.previousSibling}return null}function n1(e,r,s){switch(r=Lc(s),e){case"html":if(e=r.documentElement,!e)throw Error(i(452));return e;case"head":if(e=r.head,!e)throw Error(i(453));return e;case"body":if(e=r.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Zs(e){for(var r=e.attributes;r.length;)e.removeAttributeNode(r[0]);xe(e)}var Ja=new Map,r1=new Set;function Bc(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Kn=ge.d;ge.d={f:eS,r:tS,D:aS,C:nS,L:rS,m:iS,X:lS,S:sS,M:cS};function eS(){var e=Kn.f(),r=Mc();return e||r}function tS(e){var r=Me(e);r!==null&&r.tag===5&&r.type==="form"?Ch(r):Kn.r(e)}var Hi=typeof document>"u"?null:document;function i1(e,r,s){var c=Hi;if(c&&typeof r=="string"&&r){var d=za(r);d='link[rel="'+e+'"][href="'+d+'"]',typeof s=="string"&&(d+='[crossorigin="'+s+'"]'),r1.has(d)||(r1.add(d),e={rel:e,crossOrigin:s,href:r},c.querySelector(d)===null&&(r=c.createElement("link"),Jt(r,"link",e),Ie(r),c.head.appendChild(r)))}}function aS(e){Kn.D(e),i1("dns-prefetch",e,null)}function nS(e,r){Kn.C(e,r),i1("preconnect",e,r)}function rS(e,r,s){Kn.L(e,r,s);var c=Hi;if(c&&e&&r){var d='link[rel="preload"][as="'+za(r)+'"]';r==="image"&&s&&s.imageSrcSet?(d+='[imagesrcset="'+za(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(d+='[imagesizes="'+za(s.imageSizes)+'"]')):d+='[href="'+za(e)+'"]';var m=d;switch(r){case"style":m=Gi(e);break;case"script":m=Wi(e)}Ja.has(m)||(e=S({rel:"preload",href:r==="image"&&s&&s.imageSrcSet?void 0:e,as:r},s),Ja.set(m,e),c.querySelector(d)!==null||r==="style"&&c.querySelector(el(m))||r==="script"&&c.querySelector(tl(m))||(r=c.createElement("link"),Jt(r,"link",e),Ie(r),c.head.appendChild(r)))}}function iS(e,r){Kn.m(e,r);var s=Hi;if(s&&e){var c=r&&typeof r.as=="string"?r.as:"script",d='link[rel="modulepreload"][as="'+za(c)+'"][href="'+za(e)+'"]',m=d;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Wi(e)}if(!Ja.has(m)&&(e=S({rel:"modulepreload",href:e},r),Ja.set(m,e),s.querySelector(d)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(tl(m)))return}c=s.createElement("link"),Jt(c,"link",e),Ie(c),s.head.appendChild(c)}}}function sS(e,r,s){Kn.S(e,r,s);var c=Hi;if(c&&e){var d=De(c).hoistableStyles,m=Gi(e);r=r||"default";var E=d.get(m);if(!E){var A={loading:0,preload:null};if(E=c.querySelector(el(m)))A.loading=5;else{e=S({rel:"stylesheet",href:e,"data-precedence":r},s),(s=Ja.get(m))&&F0(e,s);var W=E=c.createElement("link");Ie(W),Jt(W,"link",e),W._p=new Promise(function(ae,de){W.onload=ae,W.onerror=de}),W.addEventListener("load",function(){A.loading|=1}),W.addEventListener("error",function(){A.loading|=2}),A.loading|=4,Kc(E,r,c)}E={type:"stylesheet",instance:E,count:1,state:A},d.set(m,E)}}}function lS(e,r){Kn.X(e,r);var s=Hi;if(s&&e){var c=De(s).hoistableScripts,d=Wi(e),m=c.get(d);m||(m=s.querySelector(tl(d)),m||(e=S({src:e,async:!0},r),(r=Ja.get(d))&&L0(e,r),m=s.createElement("script"),Ie(m),Jt(m,"link",e),s.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(d,m))}}function cS(e,r){Kn.M(e,r);var s=Hi;if(s&&e){var c=De(s).hoistableScripts,d=Wi(e),m=c.get(d);m||(m=s.querySelector(tl(d)),m||(e=S({src:e,async:!0,type:"module"},r),(r=Ja.get(d))&&L0(e,r),m=s.createElement("script"),Ie(m),Jt(m,"link",e),s.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(d,m))}}function s1(e,r,s,c){var d=(d=ce.current)?Bc(d):null;if(!d)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(r=Gi(s.href),s=De(d).hoistableStyles,c=s.get(r),c||(c={type:"style",instance:null,count:0,state:null},s.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){e=Gi(s.href);var m=De(d).hoistableStyles,E=m.get(e);if(E||(d=d.ownerDocument||d,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(e,E),(m=d.querySelector(el(e)))&&!m._p&&(E.instance=m,E.state.loading=5),Ja.has(e)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},Ja.set(e,s),m||oS(d,e,s,E.state))),r&&c===null)throw Error(i(528,""));return E}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=s.async,s=s.src,typeof s=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Wi(s),s=De(d).hoistableScripts,c=s.get(r),c||(c={type:"script",instance:null,count:0,state:null},s.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Gi(e){return'href="'+za(e)+'"'}function el(e){return'link[rel="stylesheet"]['+e+"]"}function l1(e){return S({},e,{"data-precedence":e.precedence,precedence:null})}function oS(e,r,s,c){e.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=e.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Jt(r,"link",s),Ie(r),e.head.appendChild(r))}function Wi(e){return'[src="'+za(e)+'"]'}function tl(e){return"script[async]"+e}function c1(e,r,s){if(r.count++,r.instance===null)switch(r.type){case"style":var c=e.querySelector('style[data-href~="'+za(s.href)+'"]');if(c)return r.instance=c,Ie(c),c;var d=S({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),Ie(c),Jt(c,"style",d),Kc(c,s.precedence,e),r.instance=c;case"stylesheet":d=Gi(s.href);var m=e.querySelector(el(d));if(m)return r.state.loading|=4,r.instance=m,Ie(m),m;c=l1(s),(d=Ja.get(d))&&F0(c,d),m=(e.ownerDocument||e).createElement("link"),Ie(m);var E=m;return E._p=new Promise(function(A,W){E.onload=A,E.onerror=W}),Jt(m,"link",c),r.state.loading|=4,Kc(m,s.precedence,e),r.instance=m;case"script":return m=Wi(s.src),(d=e.querySelector(tl(m)))?(r.instance=d,Ie(d),d):(c=s,(d=Ja.get(m))&&(c=S({},s),L0(c,d)),e=e.ownerDocument||e,d=e.createElement("script"),Ie(d),Jt(d,"link",c),e.head.appendChild(d),r.instance=d);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Kc(c,s.precedence,e));return r.instance}function Kc(e,r,s){for(var c=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=c.length?c[c.length-1]:null,m=d,E=0;E<c.length;E++){var A=c[E];if(A.dataset.precedence===r)m=A;else if(m!==d)break}m?m.parentNode.insertBefore(e,m.nextSibling):(r=s.nodeType===9?s.head:s,r.insertBefore(e,r.firstChild))}function F0(e,r){e.crossOrigin==null&&(e.crossOrigin=r.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=r.referrerPolicy),e.title==null&&(e.title=r.title)}function L0(e,r){e.crossOrigin==null&&(e.crossOrigin=r.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=r.referrerPolicy),e.integrity==null&&(e.integrity=r.integrity)}var Pc=null;function o1(e,r,s){if(Pc===null){var c=new Map,d=Pc=new Map;d.set(s,c)}else d=Pc,c=d.get(s),c||(c=new Map,d.set(s,c));if(c.has(e))return c;for(c.set(e,null),s=s.getElementsByTagName(e),d=0;d<s.length;d++){var m=s[d];if(!(m[le]||m[O]||e==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var E=m.getAttribute(r)||"";E=e+E;var A=c.get(E);A?A.push(m):c.set(E,[m])}}return c}function u1(e,r,s){e=e.ownerDocument||e,e.head.insertBefore(s,r==="title"?e.querySelector("head > title"):null)}function uS(e,r,s){if(s===1||r.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return e=r.disabled,typeof r.precedence=="string"&&e==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function f1(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function fS(e,r,s,c){if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var d=Gi(c.href),m=r.querySelector(el(d));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(e.count++,e=zc.bind(e),r.then(e,e)),s.state.loading|=4,s.instance=m,Ie(m);return}m=r.ownerDocument||r,c=l1(c),(d=Ja.get(d))&&F0(c,d),m=m.createElement("link"),Ie(m);var E=m;E._p=new Promise(function(A,W){E.onload=A,E.onerror=W}),Jt(m,"link",c),s.instance=m}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(s,r),(r=s.state.preload)&&(s.state.loading&3)===0&&(e.count++,s=zc.bind(e),r.addEventListener("load",s),r.addEventListener("error",s))}}var B0=0;function dS(e,r){return e.stylesheets&&e.count===0&&Gc(e,e.stylesheets),0<e.count||0<e.imgCount?function(s){var c=setTimeout(function(){if(e.stylesheets&&Gc(e,e.stylesheets),e.unsuspend){var m=e.unsuspend;e.unsuspend=null,m()}},6e4+r);0<e.imgBytes&&B0===0&&(B0=62500*Vx());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Gc(e,e.stylesheets),e.unsuspend)){var m=e.unsuspend;e.unsuspend=null,m()}},(e.imgBytes>B0?50:800)+r);return e.unsuspend=s,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(d)}}:null}function zc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Hc=null;function Gc(e,r){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Hc=new Map,r.forEach(hS,e),Hc=null,zc.call(e))}function hS(e,r){if(!(r.state.loading&4)){var s=Hc.get(e);if(s)var c=s.get(null);else{s=new Map,Hc.set(e,s);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<d.length;m++){var E=d[m];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(s.set(E.dataset.precedence,E),c=E)}c&&s.set(null,c)}d=r.instance,E=d.getAttribute("data-precedence"),m=s.get(E)||c,m===c&&s.set(null,d),s.set(E,d),this.count++,c=zc.bind(this),d.addEventListener("load",c),d.addEventListener("error",c),m?m.parentNode.insertBefore(d,m.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),r.state.loading|=4}}var al={$$typeof:M,Provider:null,Consumer:null,_currentValue:ke,_currentValue2:ke,_threadCount:0};function mS(e,r,s,c,d,m,E,A,W){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vs(0),this.hiddenUpdates=vs(null),this.identifierPrefix=c,this.onUncaughtError=d,this.onCaughtError=m,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function d1(e,r,s,c,d,m,E,A,W,ae,de,ve){return e=new mS(e,r,s,E,W,ae,de,ve,A),r=1,m===!0&&(r|=24),m=Na(3,null,null,r),e.current=m,m.stateNode=e,r=xu(),r.refCount++,e.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:s,cache:r},Tu(m),e}function h1(e){return e?(e=Ti,e):Ti}function m1(e,r,s,c,d,m){d=h1(d),c.context===null?c.context=d:c.pendingContext=d,c=nr(r),c.payload={element:s},m=m===void 0?null:m,m!==null&&(c.callback=m),s=rr(e,c,r),s!==null&&(ya(s,e,r),Os(s,e,r))}function v1(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<r?s:r}}function K0(e,r){v1(e,r),(e=e.alternate)&&v1(e,r)}function g1(e){if(e.tag===13||e.tag===31){var r=Rr(e,67108864);r!==null&&ya(r,e,67108864),K0(e,67108864)}}function p1(e){if(e.tag===13||e.tag===31){var r=ka();r=gs(r);var s=Rr(e,r);s!==null&&ya(s,e,r),K0(e,r)}}var Wc=!0;function vS(e,r,s,c){var d=ee.T;ee.T=null;var m=ge.p;try{ge.p=2,P0(e,r,s,c)}finally{ge.p=m,ee.T=d}}function gS(e,r,s,c){var d=ee.T;ee.T=null;var m=ge.p;try{ge.p=8,P0(e,r,s,c)}finally{ge.p=m,ee.T=d}}function P0(e,r,s,c){if(Wc){var d=z0(c);if(d===null)N0(e,r,c,Vc,s),S1(e,c);else if(xS(d,e,r,s,c))c.stopPropagation();else if(S1(e,c),r&4&&-1<pS.indexOf(e)){for(;d!==null;){var m=Me(d);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var E=Ba(m.pendingLanes);if(E!==0){var A=m;for(A.pendingLanes|=2,A.entangledLanes|=2;E;){var W=1<<31-oa(E);A.entanglements[1]|=W,E&=~W}xn(m),(at&6)===0&&(Ac=Ct()+500,Js(0))}}break;case 31:case 13:A=Rr(m,2),A!==null&&ya(A,m,2),Mc(),K0(m,2)}if(m=z0(c),m===null&&N0(e,r,c,Vc,s),m===d)break;d=m}d!==null&&c.stopPropagation()}else N0(e,r,c,null,s)}}function z0(e){return e=Go(e),H0(e)}var Vc=null;function H0(e){if(Vc=null,e=Te(e),e!==null){var r=u(e);if(r===null)e=null;else{var s=r.tag;if(s===13){if(e=f(r),e!==null)return e;e=null}else if(s===31){if(e=h(r),e!==null)return e;e=null}else if(s===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null)}}return Vc=e,null}function x1(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(li()){case ci:return 2;case oi:return 8;case La:case Io:return 32;case ms:return 268435456;default:return 32}default:return 32}}var G0=!1,vr=null,gr=null,pr=null,nl=new Map,rl=new Map,xr=[],pS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function S1(e,r){switch(e){case"focusin":case"focusout":vr=null;break;case"dragenter":case"dragleave":gr=null;break;case"mouseover":case"mouseout":pr=null;break;case"pointerover":case"pointerout":nl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":rl.delete(r.pointerId)}}function il(e,r,s,c,d,m){return e===null||e.nativeEvent!==m?(e={blockedOn:r,domEventName:s,eventSystemFlags:c,nativeEvent:m,targetContainers:[d]},r!==null&&(r=Me(r),r!==null&&g1(r)),e):(e.eventSystemFlags|=c,r=e.targetContainers,d!==null&&r.indexOf(d)===-1&&r.push(d),e)}function xS(e,r,s,c,d){switch(r){case"focusin":return vr=il(vr,e,r,s,c,d),!0;case"dragenter":return gr=il(gr,e,r,s,c,d),!0;case"mouseover":return pr=il(pr,e,r,s,c,d),!0;case"pointerover":var m=d.pointerId;return nl.set(m,il(nl.get(m)||null,e,r,s,c,d)),!0;case"gotpointercapture":return m=d.pointerId,rl.set(m,il(rl.get(m)||null,e,r,s,c,d)),!0}return!1}function y1(e){var r=Te(e.target);if(r!==null){var s=u(r);if(s!==null){if(r=s.tag,r===13){if(r=f(s),r!==null){e.blockedOn=r,R(e.priority,function(){p1(s)});return}}else if(r===31){if(r=h(s),r!==null){e.blockedOn=r,R(e.priority,function(){p1(s)});return}}else if(r===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yc(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var s=z0(e.nativeEvent);if(s===null){s=e.nativeEvent;var c=new s.constructor(s.type,s);Ho=c,s.target.dispatchEvent(c),Ho=null}else return r=Me(s),r!==null&&g1(r),e.blockedOn=s,!1;r.shift()}return!0}function C1(e,r,s){Yc(e)&&s.delete(r)}function SS(){G0=!1,vr!==null&&Yc(vr)&&(vr=null),gr!==null&&Yc(gr)&&(gr=null),pr!==null&&Yc(pr)&&(pr=null),nl.forEach(C1),rl.forEach(C1)}function Xc(e,r){e.blockedOn===r&&(e.blockedOn=null,G0||(G0=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,SS)))}var qc=null;function T1(e){qc!==e&&(qc=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){qc===e&&(qc=null);for(var r=0;r<e.length;r+=3){var s=e[r],c=e[r+1],d=e[r+2];if(typeof c!="function"){if(H0(c||s)===null)continue;break}var m=Me(s);m!==null&&(e.splice(r,3),r-=3,zu(m,{pending:!0,data:d,method:s.method,action:c},c,d))}}))}function Vi(e){function r(W){return Xc(W,e)}vr!==null&&Xc(vr,e),gr!==null&&Xc(gr,e),pr!==null&&Xc(pr,e),nl.forEach(r),rl.forEach(r);for(var s=0;s<xr.length;s++){var c=xr[s];c.blockedOn===e&&(c.blockedOn=null)}for(;0<xr.length&&(s=xr[0],s.blockedOn===null);)y1(s),s.blockedOn===null&&xr.shift();if(s=(e.ownerDocument||e).$$reactFormReplay,s!=null)for(c=0;c<s.length;c+=3){var d=s[c],m=s[c+1],E=d[I]||null;if(typeof m=="function")E||T1(s);else if(E){var A=null;if(m&&m.hasAttribute("formAction")){if(d=m,E=m[I]||null)A=E.formAction;else if(H0(d)!==null)continue}else A=E.action;typeof A=="function"?s[c+1]=A:(s.splice(c,3),c-=3),T1(s)}}}function E1(){function e(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(E){return d=E})},focusReset:"manual",scroll:"manual"})}function r(){d!==null&&(d(),d=null),c||setTimeout(s,20)}function s(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(s,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),d!==null&&(d(),d=null)}}}function W0(e){this._internalRoot=e}Jc.prototype.render=W0.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(i(409));var s=r.current,c=ka();m1(s,c,e,r,null,null)},Jc.prototype.unmount=W0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;m1(e.current,2,null,e,null,null),Mc(),r[F]=null}};function Jc(e){this._internalRoot=e}Jc.prototype.unstable_scheduleHydration=function(e){if(e){var r=b();e={blockedOn:null,target:e,priority:r};for(var s=0;s<xr.length&&r!==0&&r<xr[s].priority;s++);xr.splice(s,0,e),s===0&&y1(e)}};var _1=n.version;if(_1!=="19.2.0")throw Error(i(527,_1,"19.2.0"));ge.findDOMNode=function(e){var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=v(r),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var yS={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{qn=$c.inject(yS),na=$c}catch{}}return ll.createRoot=function(e,r){if(!l(e))throw Error(i(299));var s=!1,c="",d=jh,m=kh,E=Uh;return r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(d=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError)),r=d1(e,1,!1,null,null,s,c,null,d,m,E,E1),e[F]=r.current,b0(e),new W0(r)},ll.hydrateRoot=function(e,r,s){if(!l(e))throw Error(i(299));var c=!1,d="",m=jh,E=kh,A=Uh,W=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(E=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError),s.formState!==void 0&&(W=s.formState)),r=d1(e,1,!0,r,s??null,c,d,W,m,E,A,E1),r.context=h1(null),s=r.current,c=ka(),c=gs(c),d=nr(c),d.callback=null,rr(s,d,c),s=c,r.current.lanes=s,jr(r,s),xn(r),e[F]=r.current,b0(e),new Jc(r)},ll.version="19.2.0",ll}var O1;function jS(){if(O1)return Y0.exports;O1=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),Y0.exports=MS(),Y0.exports}var kS=jS(),G=gf();const US=TS(G),OS="modulepreload",IS=function(a){return"/"+a},I1={},RS=function(n,t,i){let l=Promise.resolve();if(t&&t.length>0){let v=function(p){return Promise.all(p.map(S=>Promise.resolve(S).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};var f=v;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),g=h?.nonce||h?.getAttribute("nonce");l=v(t.map(p=>{if(p=IS(p),p in I1)return;I1[p]=!0;const S=p.endsWith(".css"),x=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${x}`))return;const C=document.createElement("link");if(C.rel=S?"stylesheet":OS,S||(C.as="script"),C.crossOrigin="",C.href=p,g&&C.setAttribute("nonce",g),document.head.appendChild(C),S)return new Promise((T,y)=>{C.addEventListener("load",T),C.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(h){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=h,window.dispatchEvent(g),!g.defaultPrevented)throw h}return l.then(h=>{for(const g of h||[])g.status==="rejected"&&u(g.reason);return n().catch(u)})},Tr=["New Contact","In Progress","Follow Up","Completed"],FS=["Islam","Protestan","Katolik","Hindu","Buddha","Konghucu","Advent"],LS=["Gereja Kristen Indonesia  GKI","Gereja Kristen Jawa  GKJ","Gereja Bethel Indonesia  GBI","Gereja Pantekosta di Indonesia  GPdI","Gereja Protestan di Indonesia bagian Barat  GPIB","Gereja Protestan Maluku  GPM","Huria Kristen Batak Protestan  HKBP","Gereja Huria Kristen Indonesia  HKI","Gereja Methodis Indonesia  GMI","Gereja Sidang-Sidang Jemaat Allah di Indonesia  GSJA","Gereja Reformed Injili Indonesia  GRII","Gereja Kristen Bethel Indonesia  GKBI","Gereja Kristen Nazarene Indonesia  GKNI","Gereja Isa Almasih  GIA","Gereja Kristen Protestan Simalungun  GKPS","Gereja Kristen Protestan Angkola  GKPA","Gereja Kristen Protestan Indonesia  GKPI","Gereja Toraja  GT","Gereja Toraja Mamasa  GTM","Gereja Kristen Sulawesi Tengah  GKST","Gereja Kristen Celebes  GKC","Gereja Kristen Kalimantan Barat  GKKB","Gereja Kalimantan Evangelis  GKE","Gereja Kristen Indonesia di Tanah Papua  GKI Papua","Gereja Kemah Injil Indonesia  GKII","Gereja Bala Keselamatan  BK","Gereja Kristen Indonesia Jawa Barat  GKI Jabar","Gereja Kristen Jawa Tengah  GKJT","Gereja Kristen Jawa Wetan  GKJW","Gereja Kristen Baptis Indonesia  GKBI atau GKBI Baptis","Gereja Baptis Indonesia  GBI Baptis","Gereja Pantekosta Serikat Indonesia  GPSI","Gereja Pantekosta Tabernakel  GPT","Gereja Masehi Injili di Timor  GMIT","Gereja Masehi Injili di Minahasa  GMIM","Gereja Masehi Injili di Halmahera  GMIH","Gereja Masehi Injili Sangihe Talaud  GMIST","Gereja Masehi Injili di Bolaang Mongondow  GMIBM","Gereja Masehi Injili di Talaud  GMITa","Gereja Kristen Oikoumene di Indonesia  GKOI","Gereja Persekutuan Kristen Alkitab Indonesia  GPKAI","Gereja Pentakosta Pusat Surabaya  GPPS","Gereja Kristen Setia Indonesia  GKSI","Gereja Sidang Jemaat Kristus  GSJK","Gereja Kristen Anugerah Indonesia  GKAI","Gereja Alkitab Anugerah  GAA","Gereja Kristen Kerasulan Baru  GKNB","Gereja Pantekosta Isa Almasih  GPIA"],Nv=["Laki-laki","Perempuan"],Av=["Rendah","Sedang","Tinggi","Urgent"],Dv=["Parabola","IndiHome","Youtube","Facebook","Instagram","Website","Search Engine","Layanan Doa"],BS=["Menikah","Tidak Menikah"],KS=["WhatsApp Chat","WhatsApp Call","Telepon","SMS"],Cr={maxDurationPerSession:480,maxDurationPerDay:960,maxFutureDate:0,maxPastDate:365},PS=[{label:"15 min",value:15},{label:"30 min",value:30},{label:"1 hour",value:60},{label:"2 hours",value:120}],Qc={SERVICES:"crm_services",SERVICE_METRICS:"crm_service_metrics"},sn={CONTACTS:"crm_contacts",USERS:"crm_users",SETTINGS:"crm_settings",CURRENT_USER:"crm_current_user"},cl=["id","createdAt","nama","nomorTelepon","jenisKelamin","alamat","provinsi","agama","subAgama","alasanMenghubungi","sumber","prioritas","statusKontak","updatedAt","createdBy"],Q0="1.0.0",Qi=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),zn=a=>{if(!a||isNaN(a.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch(n){return console.error("Error formatting date:",n,a),"Invalid Date"}},Z0=a=>{if(!a||isNaN(a.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch(n){return console.error("Error formatting date:",n,a),"Invalid Date"}},on=a=>a.toISOString().split("T")[0],zS=(a,n)=>a.filter(t=>{try{if(n.dateRange){const i=new Date(t.createdAt),l=new Date(n.dateRange.startDate),u=new Date(n.dateRange.endDate);if(i<l||i>u)return!1}if(n.globalSearch){const i=n.globalSearch.toLowerCase(),l=t.nama?.toLowerCase().includes(i)||!1,u=t.nomorTelepon?.toLowerCase().includes(i)||!1;if(!l&&!u)return!1}if(!n.globalSearch&&(n.nama&&t.nama&&!t.nama.toLowerCase().includes(n.nama.toLowerCase())||n.nomorTelepon&&t.nomorTelepon&&!t.nomorTelepon.toLowerCase().includes(n.nomorTelepon.toLowerCase()))||n.alamat&&t.alamat&&!t.alamat.toLowerCase().includes(n.alamat.toLowerCase())||n.agama&&t.agama&&!t.agama.toLowerCase().includes(n.agama.toLowerCase())||n.alasanMenghubungi&&t.alasanMenghubungi&&!t.alasanMenghubungi.toLowerCase().includes(n.alasanMenghubungi.toLowerCase()))return!1}catch(i){return console.error("Error filtering contact:",i,t),!0}return!(n.statusKontak&&n.statusKontak.length>0&&!n.statusKontak.includes(t.statusKontak))}),HS=a=>[...a].sort((n,t)=>{try{const i=new Date(n.createdAt),l=new Date(t.createdAt);return isNaN(i.getTime())&&isNaN(l.getTime())?0:isNaN(i.getTime())?1:isNaN(l.getTime())?-1:l.getTime()-i.getTime()}catch(i){return console.error("Error sorting contacts by date:",i),0}}),GS=(a,n)=>{let t;return(...i)=>{clearTimeout(t),t=setTimeout(()=>a(...i),n)}},WS=a=>{const n=[];return(!a.nama||a.nama.trim()==="")&&n.push("Nama is required"),(!a.nomorTelepon||a.nomorTelepon.trim()==="")&&n.push("Nomor telepon is required"),a.jenisKelamin?Nv.includes(a.jenisKelamin)||n.push("Invalid jenis kelamin"):n.push("Jenis kelamin is required"),(!a.alamat||a.alamat.trim()==="")&&n.push("Alamat is required"),(!a.agama||a.agama.trim()==="")&&n.push("Agama is required"),(!a.alasanMenghubungi||a.alasanMenghubungi.trim()==="")&&n.push("Alasan menghubungi is required"),a.sumber?Dv.includes(a.sumber)||n.push("Invalid sumber"):n.push("Sumber is required"),a.prioritas?Av.includes(a.prioritas)||n.push("Invalid prioritas"):n.push("Prioritas is required"),a.statusKontak?Tr.includes(a.statusKontak)||n.push("Invalid status kontak"):n.push("Status kontak is required"),a.nama&&a.nama.length>100&&n.push("Nama must be less than 100 characters"),a.nomorTelepon&&a.nomorTelepon.length>20&&n.push("Nomor telepon must be less than 20 characters"),a.alamat&&a.alamat.length>200&&n.push("Alamat must be less than 200 characters"),a.agama&&a.agama.length>50&&n.push("Agama must be less than 50 characters"),a.alasanMenghubungi&&a.alasanMenghubungi.length>500&&n.push("Alasan menghubungi must be less than 500 characters"),{isValid:n.length===0,errors:n}};class es{id;createdAt;nama;nomorTelepon;jenisKelamin;usia;profesi;statusPernikahan;mediaKomunikasi;mission;alamat;provinsi;kabKota;uni;agama;subAgama;alasanMenghubungi;sumber;prioritas;statusKontak;updatedAt;createdBy;history;constructor(n,t,i,l,u,f,h,g,v,p,S,x,C,T,y,_,w,k,M,N,K,J,B){this.id=N||Qi(),this.nama=n.trim(),this.nomorTelepon=t.trim(),this.jenisKelamin=i,this.usia=x,this.profesi=C?.trim(),this.statusPernikahan=T,this.mediaKomunikasi=y,this.mission=_,this.alamat=l.trim(),this.provinsi=u.trim(),this.kabKota=k?.trim(),this.uni=M?.trim(),this.agama=f.trim(),this.subAgama=w?.trim(),this.alasanMenghubungi=h.trim(),this.sumber=g,this.prioritas=v,this.statusKontak=p,this.createdBy=S,this.createdAt=K||new Date,this.updatedAt=J||new Date,this.history=B||[{id:Qi(),timestamp:this.createdAt,action:"created",updatedBy:S,notes:"Contact created"}]}static validate(n){return WS(n)}static fromObject(n){const t=n.history?n.history.map(i=>({...i,timestamp:new Date(i.timestamp)})):void 0;return new es(n.nama||"",n.nomorTelepon||"",n.jenisKelamin||"Laki-laki",n.alamat||"",n.provinsi||"",n.agama||"",n.alasanMenghubungi||"",n.sumber||"Parabola",n.prioritas||"Urgent",n.statusKontak||"New Contact",n.createdBy||"",n.usia,n.profesi,n.statusPernikahan,n.mediaKomunikasi,n.mission,n.subAgama,n.kabKota,n.uni,n.id,n.createdAt?new Date(n.createdAt):void 0,n.updatedAt?new Date(n.updatedAt):void 0,t)}static fromJSON(n){try{const t=JSON.parse(n);return es.fromObject(t)}catch{throw new Error("Invalid JSON format for Contact")}}validate(){return es.validate(this)}update(n,t){const i=[];n.nama!==void 0&&n.nama.trim()!==this.nama&&(i.push({field:"nama",oldValue:this.nama,newValue:n.nama.trim()}),this.nama=n.nama.trim()),n.nomorTelepon!==void 0&&n.nomorTelepon.trim()!==this.nomorTelepon&&(i.push({field:"nomorTelepon",oldValue:this.nomorTelepon,newValue:n.nomorTelepon.trim()}),this.nomorTelepon=n.nomorTelepon.trim()),n.jenisKelamin!==void 0&&n.jenisKelamin!==this.jenisKelamin&&(i.push({field:"jenisKelamin",oldValue:this.jenisKelamin,newValue:n.jenisKelamin}),this.jenisKelamin=n.jenisKelamin),n.usia!==void 0&&n.usia!==this.usia&&(i.push({field:"usia",oldValue:String(this.usia||""),newValue:String(n.usia)}),this.usia=n.usia),n.profesi!==void 0&&n.profesi?.trim()!==this.profesi&&(i.push({field:"profesi",oldValue:this.profesi||"",newValue:n.profesi.trim()}),this.profesi=n.profesi.trim()),n.statusPernikahan!==void 0&&n.statusPernikahan!==this.statusPernikahan&&(i.push({field:"statusPernikahan",oldValue:this.statusPernikahan||"",newValue:n.statusPernikahan}),this.statusPernikahan=n.statusPernikahan),n.mediaKomunikasi!==void 0&&n.mediaKomunikasi!==this.mediaKomunikasi&&(i.push({field:"mediaKomunikasi",oldValue:this.mediaKomunikasi||"",newValue:n.mediaKomunikasi}),this.mediaKomunikasi=n.mediaKomunikasi),n.mission!==void 0&&n.mission!==this.mission&&(i.push({field:"mission",oldValue:this.mission||"",newValue:n.mission}),this.mission=n.mission),n.alamat!==void 0&&n.alamat.trim()!==this.alamat&&(i.push({field:"alamat",oldValue:this.alamat,newValue:n.alamat.trim()}),this.alamat=n.alamat.trim()),n.provinsi!==void 0&&n.provinsi.trim()!==this.provinsi&&(i.push({field:"provinsi",oldValue:this.provinsi,newValue:n.provinsi.trim()}),this.provinsi=n.provinsi.trim()),n.agama!==void 0&&n.agama.trim()!==this.agama&&(i.push({field:"agama",oldValue:this.agama,newValue:n.agama.trim()}),this.agama=n.agama.trim()),n.subAgama!==void 0&&n.subAgama?.trim()!==this.subAgama&&(i.push({field:"subAgama",oldValue:this.subAgama||"",newValue:n.subAgama.trim()}),this.subAgama=n.subAgama.trim()),n.alasanMenghubungi!==void 0&&n.alasanMenghubungi.trim()!==this.alasanMenghubungi&&(i.push({field:"alasanMenghubungi",oldValue:this.alasanMenghubungi,newValue:n.alasanMenghubungi.trim()}),this.alasanMenghubungi=n.alasanMenghubungi.trim()),n.sumber!==void 0&&n.sumber!==this.sumber&&(i.push({field:"sumber",oldValue:this.sumber,newValue:n.sumber}),this.sumber=n.sumber),n.prioritas!==void 0&&n.prioritas!==this.prioritas&&(i.push({field:"prioritas",oldValue:this.prioritas,newValue:n.prioritas}),this.prioritas=n.prioritas),n.statusKontak!==void 0&&n.statusKontak!==this.statusKontak&&(i.push({field:"statusKontak",oldValue:this.statusKontak,newValue:n.statusKontak}),this.statusKontak=n.statusKontak),i.length>0&&(this.updatedAt=new Date,i.forEach(l=>{const u={id:Qi(),timestamp:this.updatedAt,action:l.field==="statusKontak"?"status_changed":"updated",field:l.field,oldValue:l.oldValue,newValue:l.newValue,updatedBy:t,notes:`${this.getFieldDisplayName(l.field)} diubah dari "${l.oldValue}" menjadi "${l.newValue}"`};this.history.push(u)}))}getFieldDisplayName(n){return{nama:"Nama",nomorTelepon:"Nomor Telepon",jenisKelamin:"Jenis Kelamin",usia:"Usia",profesi:"Profesi",statusPernikahan:"Status Pernikahan",mediaKomunikasi:"Media Komunikasi",mission:"Mission",alamat:"Alamat",provinsi:"Provinsi",agama:"Agama",subAgama:"Sub Agama",alasanMenghubungi:"Alasan Menghubungi",sumber:"Sumber",prioritas:"Prioritas",statusKontak:"Status Kontak"}[n]||n}addHistoryEntry(n,t,i,l,u,f){const h={id:Qi(),timestamp:new Date,action:n,field:l,oldValue:u,newValue:f,updatedBy:t,notes:i||`Contact ${n}`};this.history.push(h)}getHistory(){return[...this.history].sort((n,t)=>t.timestamp.getTime()-n.timestamp.getTime())}getRecentHistory(n=5){return this.getHistory().slice(0,n)}toObject(){return{id:this.id,createdAt:this.createdAt,nama:this.nama,nomorTelepon:this.nomorTelepon,jenisKelamin:this.jenisKelamin,usia:this.usia,profesi:this.profesi,statusPernikahan:this.statusPernikahan,mediaKomunikasi:this.mediaKomunikasi,mission:this.mission,alamat:this.alamat,provinsi:this.provinsi,agama:this.agama,subAgama:this.subAgama,alasanMenghubungi:this.alasanMenghubungi,sumber:this.sumber,prioritas:this.prioritas,statusKontak:this.statusKontak,updatedAt:this.updatedAt,createdBy:this.createdBy,history:this.history}}toJSON(){return JSON.stringify(this.toObject())}matchesSearch(n){const t=n.toLowerCase();return this.nama.toLowerCase().includes(t)||this.nomorTelepon.toLowerCase().includes(t)||this.jenisKelamin.toLowerCase().includes(t)||this.usia&&String(this.usia).includes(t)||this.profesi&&this.profesi.toLowerCase().includes(t)||this.statusPernikahan&&this.statusPernikahan.toLowerCase().includes(t)||this.mediaKomunikasi&&this.mediaKomunikasi.toLowerCase().includes(t)||this.mission&&this.mission.toLowerCase().includes(t)||this.alamat.toLowerCase().includes(t)||this.provinsi.toLowerCase().includes(t)||this.agama.toLowerCase().includes(t)||this.subAgama&&this.subAgama.toLowerCase().includes(t)||this.alasanMenghubungi.toLowerCase().includes(t)||this.sumber.toLowerCase().includes(t)||this.prioritas.toLowerCase().includes(t)||this.statusKontak.toLowerCase().includes(t)}getAgeInDays(){const t=Math.abs(new Date().getTime()-this.createdAt.getTime());return Math.ceil(t/(1e3*60*60*24))}isRecentlyUpdated(){return Math.abs(new Date().getTime()-this.updatedAt.getTime())/(1e3*60*60)<=24}}const VS=[{id:"contact-1",nama:"Sarah Johnson",nomorTelepon:"08123456789",jenisKelamin:"Perempuan",usia:28,alamat:"Jl. Sudirman No. 123, Jakarta Pusat",provinsi:"DKI Jakarta",agama:"Protestan",profesi:"Project Manager",statusPernikahan:"Tidak Menikah",alasanMenghubungi:"Konsultasi karir dan stress kerja",sumber:"Website",mediaKomunikasi:"WhatsApp Chat",prioritas:"Sedang",statusKontak:"New Contact",createdAt:new Date("2024-10-20"),updatedAt:new Date("2024-10-20"),createdBy:"admin",history:[{id:"hist-contact-1",timestamp:new Date("2024-10-20"),action:"created",updatedBy:"admin",notes:"Contact created"}]},{id:"contact-2",nama:"Michael Chen",nomorTelepon:"08567891234",jenisKelamin:"Laki-laki",usia:35,alamat:"Jl. Gatot Subroto No. 456, Bandung",provinsi:"Jawa Barat",agama:"Katolik",profesi:"Marketing Director",statusPernikahan:"Menikah",alasanMenghubungi:"Konseling keluarga",sumber:"Facebook",mediaKomunikasi:"WhatsApp Chat",prioritas:"Tinggi",statusKontak:"In Progress",createdAt:new Date("2024-10-18"),updatedAt:new Date("2024-10-19"),createdBy:"editor",history:[{id:"hist-contact-2",timestamp:new Date("2024-10-18"),action:"created",updatedBy:"editor",notes:"Contact created"},{id:"hist-contact-2-update",timestamp:new Date("2024-10-19"),action:"status_changed",field:"statusKontak",oldValue:"New Contact",newValue:"In Progress",updatedBy:"editor",notes:'Status Kontak diubah dari "New Contact" menjadi "In Progress"'}]},{id:"contact-3",nama:"Amanda Rodriguez",nomorTelepon:"62812345678",jenisKelamin:"Perempuan",usia:32,alamat:"Jl. Diponegoro No. 789, Surabaya",provinsi:"Jawa Timur",agama:"Islam",profesi:"Creative Director",statusPernikahan:"Menikah",alasanMenghubungi:"Terapi trauma dan kecemasan",sumber:"Instagram",mediaKomunikasi:"WhatsApp Chat",prioritas:"Tinggi",statusKontak:"Follow Up",createdAt:new Date("2024-10-15"),updatedAt:new Date("2024-10-20"),createdBy:"admin",history:[{id:"hist-contact-3",timestamp:new Date("2024-10-15"),action:"created",updatedBy:"admin",notes:"Contact created"},{id:"hist-contact-3-update",timestamp:new Date("2024-10-20"),action:"status_changed",field:"statusKontak",oldValue:"New Contact",newValue:"Follow Up",updatedBy:"admin",notes:'Status Kontak diubah dari "New Contact" menjadi "Follow Up"'}]},{id:"contact-4",nama:"David Kim",nomorTelepon:"8123456789",jenisKelamin:"Laki-laki",usia:29,alamat:"Jl. Ahmad Yani No. 321, Yogyakarta",provinsi:"DI Yogyakarta",agama:"Protestan",profesi:"CTO",statusPernikahan:"Tidak Menikah",alasanMenghubungi:"Konsultasi burnout dan work-life balance",sumber:"Website",mediaKomunikasi:"WhatsApp Chat",prioritas:"Sedang",statusKontak:"Completed",createdAt:new Date("2024-10-10"),updatedAt:new Date("2024-10-18"),createdBy:"editor",history:[{id:"hist-contact-4",timestamp:new Date("2024-10-10"),action:"created",updatedBy:"editor",notes:"Contact created"},{id:"hist-contact-4-update",timestamp:new Date("2024-10-18"),action:"status_changed",field:"statusKontak",oldValue:"In Progress",newValue:"Completed",updatedBy:"editor",notes:'Status Kontak diubah dari "In Progress" menjadi "Completed"'}]},{id:"contact-5",nama:"Lisa Thompson",nomorTelepon:"08234567890",jenisKelamin:"Perempuan",usia:26,alamat:"Jl. Thamrin No. 567, Jakarta",provinsi:"DKI Jakarta",agama:"Islam",profesi:"Sales Manager",statusPernikahan:"Tidak Menikah",alasanMenghubungi:"Konseling hubungan dan self-esteem",sumber:"Youtube",mediaKomunikasi:"WhatsApp Chat",prioritas:"Sedang",statusKontak:"New Contact",createdAt:new Date("2024-10-12"),updatedAt:new Date("2024-10-21"),createdBy:"admin",history:[{id:"hist-contact-5",timestamp:new Date("2024-10-12"),action:"created",updatedBy:"admin",notes:"Contact created"}]},{id:"contact-6",nama:"Robert Wilson",nomorTelepon:"08345678901",jenisKelamin:"Laki-laki",usia:41,alamat:"Jl. Kuningan No. 890, Jakarta Selatan",provinsi:"DKI Jakarta",agama:"Katolik",profesi:"Senior Consultant",statusPernikahan:"Menikah",alasanMenghubungi:"Terapi depresi dan anxiety",sumber:"Website",mediaKomunikasi:"WhatsApp Chat",prioritas:"Tinggi",statusKontak:"In Progress",createdAt:new Date("2024-10-14"),updatedAt:new Date("2024-10-22"),createdBy:"editor",history:[{id:"hist-contact-6",timestamp:new Date("2024-10-14"),action:"created",updatedBy:"editor",notes:"Contact created"},{id:"hist-contact-6-update",timestamp:new Date("2024-10-22"),action:"status_changed",field:"statusKontak",oldValue:"New Contact",newValue:"In Progress",updatedBy:"editor",notes:'Status Kontak diubah dari "New Contact" menjadi "In Progress"'}]}];class YS{getStorageData(n,t){try{const i=localStorage.getItem(n);if(i===null)return t;const l=JSON.parse(i);return n===sn.CONTACTS&&Array.isArray(l)?l.map(u=>({...u,createdAt:new Date(u.createdAt),updatedAt:new Date(u.updatedAt),history:u.history?u.history.map(f=>({...f,timestamp:new Date(f.timestamp)})):[]})):l}catch(i){return console.error(`Error reading from localStorage key ${n}:`,i),t}}setStorageData(n,t){try{localStorage.setItem(n,JSON.stringify(t))}catch(i){throw console.error(`Error writing to localStorage key ${n}:`,i),new Error("Storage quota exceeded or storage unavailable")}}getContacts(){return this.getStorageData(sn.CONTACTS,[]).map(t=>({...t,nomorTelepon:t.nomorTelepon||"",jenisKelamin:t.jenisKelamin||"Laki-laki",provinsi:t.provinsi||t.kotaKabupaten||"",sumber:t.sumber||"Lainnya",prioritas:t.prioritas||"Sedang",history:t.history||[{id:"migration-"+Date.now(),timestamp:t.createdAt||new Date,action:"created",updatedBy:t.createdBy||"system",notes:"Contact migrated to new format"}]}))}saveContacts(n){this.setStorageData(sn.CONTACTS,n)}addContact(n){const t=this.getContacts();t.push(n),this.saveContacts(t)}updateContact(n,t){const i=this.getContacts(),l=i.findIndex(u=>u.id===n);l!==-1&&(i[l]={...i[l],...t,updatedAt:new Date},this.saveContacts(i))}updateContactWithHistory(n,t,i){const l=this.getContacts(),u=l.findIndex(f=>f.id===n);if(u!==-1){const f=l[u],h=es.fromObject(f);h.update(t,i),l[u]=h.toObject(),this.saveContacts(l)}}deleteContact(n){const i=this.getContacts().filter(l=>l.id!==n);this.saveContacts(i)}getUsers(){return this.getStorageData(sn.USERS,this.getDefaultUsers())}saveUsers(n){this.setStorageData(sn.USERS,n)}getCurrentUser(){return this.getStorageData(sn.CURRENT_USER,null)}setCurrentUser(n){this.setStorageData(sn.CURRENT_USER,n)}getUserCredentials(){return this.getStorageData("user_credentials",[{username:"admin",password:"admin123"},{username:"editor",password:"editor123"}])}saveUserCredentials(n){this.setStorageData("user_credentials",n)}addUserCredential(n,t){const i=this.getUserCredentials(),l=i.findIndex(u=>u.username===n);l!==-1?i[l].password=t:i.push({username:n,password:t}),this.saveUserCredentials(i)}removeUserCredential(n){const i=this.getUserCredentials().filter(l=>l.username!==n);this.saveUserCredentials(i)}getSettings(){return this.getStorageData(sn.SETTINGS,this.getDefaultSettings())}saveSettings(n){this.setStorageData(sn.SETTINGS,n)}getDefaultUsers(){const n=new Date("2024-01-01T00:00:00Z");return[{id:"admin-consistent-id",username:"admin",role:"Admin",createdAt:n},{id:"editor-consistent-id",username:"editor",role:"Editor",createdAt:n}]}getDeviceType(){const n=navigator.userAgent;return/Mobile|Android|iPhone|iPad/.test(n)?"Mobile":"Desktop"}getOrCreateDeviceId(){const n=this.getStorageData("device_id",null);if(!n){const t="device-"+Date.now()+"-"+Math.random().toString(36).substr(2,9);return this.setStorageData("device_id",t),t}return n}getDeviceInfo(){return{deviceId:this.getOrCreateDeviceId(),deviceType:this.getDeviceType(),userAgent:navigator.userAgent}}getDefaultSettings(){return{contactStatuses:Tr,exportFormats:["csv","excel"],defaultFilters:{}}}getStorageUsage(){let n=0;for(let l in localStorage)localStorage.hasOwnProperty(l)&&(n+=localStorage[l].length+l.length);const t=5*1024*1024,i=n/t*100;return{used:n,total:t,percentage:i}}initializeDemoData(){console.log("Initializing demo contacts with WhatsApp numbers..."),this.saveContacts(VS),RS(async()=>{const{serviceStorage:n}=await Promise.resolve().then(()=>nN);return{serviceStorage:n}},void 0).then(({serviceStorage:n})=>{n.initializeDemoServiceData()})}clearAllData(){Object.values(sn).forEach(n=>{localStorage.removeItem(n)})}clearContactData(){localStorage.removeItem(sn.CONTACTS),console.log(" Contact data cleared")}clearDemoData(){this.clearContactData(),localStorage.removeItem("crm_services"),localStorage.removeItem("crm_service_sessions"),console.log(" All demo data cleared")}loadDemoData(){this.initializeDemoData(),console.log(" Demo data loaded")}getContactById(n){return this.getContacts().find(i=>i.id===n)||null}getContactsByUser(n){return this.getContacts().filter(i=>i.createdBy===n)}getContactsByStatus(n){return this.getContacts().filter(i=>i.statusKontak===n)}getContactsCount(){return this.getContacts().length}getUserById(n){return this.getUsers().find(i=>i.id===n)||null}getUserByUsername(n){return this.getUsers().find(i=>i.username.toLowerCase()===n.toLowerCase())||null}addUser(n){const t=this.getUsers();t.push(n),this.saveUsers(t)}updateUser(n,t){const i=this.getUsers(),l=i.findIndex(u=>u.id===n);l!==-1&&(i[l]={...i[l],...t},this.saveUsers(i))}deleteUser(n){const i=this.getUsers().filter(l=>l.id!==n);this.saveUsers(i)}isStorageAvailable(){try{const n="__storage_test__";return localStorage.setItem(n,"test"),localStorage.removeItem(n),!0}catch{return!1}}getStorageInfo(){return{isAvailable:this.isStorageAvailable(),usage:this.getStorageUsage(),contactsCount:this.getContactsCount(),usersCount:this.getUsers().length}}validateStorageData(){const n=[];try{this.getContacts().forEach((u,f)=>{(!u.id||!u.nama||!u.alamat||!u.agama||!u.alasanMenghubungi||!u.statusKontak)&&n.push(`Contact at index ${f} is missing required fields`)}),this.getUsers().forEach((u,f)=>{(!u.id||!u.username||!u.role)&&n.push(`User at index ${f} is missing required fields`)});const l=this.getSettings();(!l.contactStatuses||!Array.isArray(l.contactStatuses))&&n.push("Settings contactStatuses is invalid")}catch(t){n.push(`Storage validation error: ${t instanceof Error?t.message:"Unknown error"}`)}return{isValid:n.length===0,errors:n}}initializeStorage(){if(this.getContacts().length===0){const t=[{id:"sample-1",createdAt:new Date,nama:"John Doe",nomorTelepon:"081234567890",jenisKelamin:"Laki-laki",alamat:"Jl. Contoh No. 123, Jakarta",provinsi:"DKI Jakarta",agama:"Islam",alasanMenghubungi:"Konsultasi produk",sumber:"Website",prioritas:"Tinggi",statusKontak:"New Contact",updatedAt:new Date,createdBy:"admin-1",history:[{id:"hist-1",timestamp:new Date,action:"created",updatedBy:"admin-1",notes:"Contact created"}]},{id:"sample-2",createdAt:new Date(Date.now()-864e5),nama:"Jane Smith",nomorTelepon:"087654321098",jenisKelamin:"Perempuan",alamat:"Jl. Sample No. 456, Bandung",provinsi:"Jawa Barat",agama:"Kristen",alasanMenghubungi:"Keluhan layanan",sumber:"Facebook",prioritas:"Urgent",statusKontak:"In Progress",updatedAt:new Date(Date.now()-864e5),createdBy:"editor-1",history:[{id:"hist-2",timestamp:new Date(Date.now()-864e5),action:"created",updatedBy:"editor-1",notes:"Contact created"}]}];this.saveContacts(t)}this.getUsers().length===0&&this.saveUsers(this.getDefaultUsers()),this.getSettings().contactStatuses||this.saveSettings(this.getDefaultSettings())}exportBackup(){const n={contacts:this.getContacts(),users:this.getUsers(),settings:this.getSettings(),version:Q0};return JSON.stringify(n,null,2)}exportBackupFile(){try{const n=this.exportBackup(),i=`crm-backup-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,l=new Blob([n],{type:"application/json"}),u=URL.createObjectURL(l),f=document.createElement("a");f.href=u,f.download=i,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(u)}catch{throw new Error("Failed to export backup file")}}importBackup(n){const t=[];try{const i=JSON.parse(n);if(i.version!==Q0&&t.push(`Backup version (${i.version}) differs from current version (${Q0})`),!i.contacts||!Array.isArray(i.contacts))throw new Error("Invalid backup: contacts data is missing or invalid");if(!i.users||!Array.isArray(i.users))throw new Error("Invalid backup: users data is missing or invalid");if(!i.settings||typeof i.settings!="object")throw new Error("Invalid backup: settings data is missing or invalid");const l=this.exportBackup();this.setStorageData("__recovery_backup__",l),this.saveContacts(i.contacts),this.saveUsers(i.users),this.saveSettings(i.settings);const u=this.validateStorageData();return u.isValid||t.push("Some imported data may be invalid: "+u.errors.join(", ")),{success:!0,message:"Backup imported successfully",warnings:t}}catch(i){return{success:!1,message:i instanceof Error?i.message:"Unknown error during backup import",warnings:t}}}importBackupFromFile(n){return new Promise(t=>{const i=new FileReader;i.onload=l=>{try{const u=l.target?.result,f=this.importBackup(u);t(f)}catch{t({success:!1,message:"Failed to read backup file",warnings:[]})}},i.onerror=()=>{t({success:!1,message:"Error reading backup file",warnings:[]})},i.readAsText(n)})}hasRecoveryBackup(){try{return localStorage.getItem("__recovery_backup__")!==null}catch{return!1}}restoreFromRecovery(){try{const n=localStorage.getItem("__recovery_backup__");if(!n)return{success:!1,message:"No recovery backup available"};const t=this.importBackup(n);return t.success?(localStorage.removeItem("__recovery_backup__"),{success:!0,message:"Data restored from recovery backup"}):{success:!1,message:t.message}}catch{return{success:!1,message:"Failed to restore from recovery backup"}}}clearRecoveryBackup(){localStorage.removeItem("__recovery_backup__")}detectCorruption(){const n=[];try{this.isStorageAvailable()||n.push("LocalStorage is not available");const t=this.validateStorageData();t.isValid||n.push(...t.errors);const i=this.getContacts(),l=this.getUsers(),u=this.getSettings();Array.isArray(i)||n.push("Contacts data is corrupted"),(!Array.isArray(l)||l.length===0)&&n.push("Users data is missing or corrupted"),(!u||!u.contactStatuses)&&n.push("Settings data is corrupted")}catch(t){n.push(`Data corruption detected: ${t instanceof Error?t.message:"Unknown error"}`)}return{isCorrupted:n.length>0,issues:n}}repairCorruption(){const n=[];try{if(this.hasRecoveryBackup()&&this.restoreFromRecovery().success)return n.push("Restored data from recovery backup"),{success:!0,message:"Data corruption repaired using recovery backup",actionsPerformed:n};const t=this.detectCorruption();return t.issues.includes("Users data is missing or corrupted")&&(this.saveUsers(this.getDefaultUsers()),n.push("Restored default users")),t.issues.includes("Settings data is corrupted")&&(this.saveSettings(this.getDefaultSettings()),n.push("Restored default settings")),t.issues.includes("Contacts data is corrupted")&&(this.saveContacts([]),n.push("Reset contacts data (data may be lost)")),{success:!0,message:"Data corruption repaired with default values",actionsPerformed:n}}catch{return{success:!1,message:"Failed to repair data corruption",actionsPerformed:n}}}}const Ke=new YS;class XS{async login(n,t){const i=Ke.getUsers();if(Ke.getUserCredentials().some(f=>f.username===n&&f.password===t)){const f=i.find(h=>h.username===n);if(f)return Ke.setCurrentUser(f),f}return null}logout(){Ke.setCurrentUser(null)}getCurrentUser(){return Ke.getCurrentUser()}isAuthenticated(){return this.getCurrentUser()!==null}hasPermission(n){const t=this.getCurrentUser();return t?t.role==="Admin"||t.role==="Editor"&&n==="Editor":!1}canManageUsers(){return this.hasPermission("Admin")}canManageContacts(){return this.hasPermission("Editor")}canExportData(){return this.hasPermission("Editor")}}const qr=new XS,qS={currentUser:null,isAuthenticated:!1,isLoading:!0,error:null},JS=(a,n)=>{switch(n.type){case"LOGIN_START":return{...a,isLoading:!0,error:null};case"LOGIN_SUCCESS":return{...a,currentUser:n.payload,isAuthenticated:!0,isLoading:!1,error:null};case"LOGIN_FAILURE":return{...a,currentUser:null,isAuthenticated:!1,isLoading:!1,error:n.payload};case"LOGOUT":return{...a,currentUser:null,isAuthenticated:!1,isLoading:!1,error:null};case"CLEAR_ERROR":return{...a,error:null};case"SET_LOADING":return{...a,isLoading:n.payload};default:return a}},bo=G.createContext(void 0),$S=({children:a})=>{const[n,t]=G.useReducer(JS,qS);G.useEffect(()=>{(()=>{try{const x=qr.getCurrentUser();t(x?{type:"LOGIN_SUCCESS",payload:x}:{type:"SET_LOADING",payload:!1})}catch(x){console.error("Error checking authentication:",x),t({type:"SET_LOADING",payload:!1})}})()},[]);const i=async(S,x)=>{t({type:"LOGIN_START"});try{const C=await qr.login(S,x);return C?(t({type:"LOGIN_SUCCESS",payload:C}),!0):(t({type:"LOGIN_FAILURE",payload:"Username atau password salah"}),!1)}catch(C){const T=C instanceof Error?C.message:"Login gagal";return t({type:"LOGIN_FAILURE",payload:T}),!1}},l=()=>{try{qr.logout(),t({type:"LOGOUT"})}catch(S){console.error("Error during logout:",S),t({type:"LOGOUT"})}},u=()=>{t({type:"CLEAR_ERROR"})},f=S=>qr.hasPermission(S),h=()=>qr.canManageUsers(),g=()=>qr.canManageContacts(),v=()=>qr.canExportData(),p={currentUser:n.currentUser,isAuthenticated:n.isAuthenticated,login:i,logout:l,isLoading:n.isLoading,error:n.error,clearError:u,hasPermission:f,canManageUsers:h,canManageContacts:g,canExportData:v};return o.jsx(bo.Provider,{value:p,children:a})},QS=({onLoginSuccess:a})=>{const[n,t]=G.useState(""),[i,l]=G.useState(""),[u,f]=G.useState(!1),h=G.useContext(bo);if(!h)throw new Error("Login must be used within an AuthProvider");const{login:g,error:v,clearError:p,isLoading:S}=h;G.useEffect(()=>{v&&p()},[n,i,p]);const x=async C=>{if(C.preventDefault(),!(!n.trim()||!i.trim())){f(!0);try{await g(n.trim(),i)&&a?.()}catch(T){console.error("Login error:",T)}finally{f(!1)}}};return S?o.jsx("div",{className:"login-container",children:o.jsx("div",{className:"login-card",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Checking authentication..."})]})})}):o.jsx("div",{className:"login-container",children:o.jsxs("div",{className:"login-card",children:[o.jsxs("div",{className:"login-header",children:[o.jsx("h1",{children:"Hopeline Care"}),o.jsx("p",{children:"Contact Management System"})]}),o.jsxs("form",{onSubmit:x,className:"login-form",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"username",children:"Username"}),o.jsx("input",{id:"username",type:"text",value:n,onChange:C=>t(C.target.value),placeholder:"Masukkan username",disabled:u,required:!0,autoComplete:"username",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"password",children:"Password"}),o.jsx("input",{id:"password",type:"password",value:i,onChange:C=>l(C.target.value),placeholder:"Masukkan password",disabled:u,required:!0,autoComplete:"current-password",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"})]}),v&&o.jsx("div",{className:"error-message",children:v}),o.jsx("button",{type:"submit",className:"login-button",disabled:u||!n.trim()||!i.trim(),children:u?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"button-spinner"}),"Logging in..."]}):"Login"})]})]})})},ZS=({children:a,requiredRole:n,fallback:t})=>{const i=G.useContext(bo);if(!i)throw new Error("ProtectedRoute must be used within an AuthProvider");const{isAuthenticated:l,isLoading:u,hasPermission:f,currentUser:h}=i;return u?o.jsx("div",{className:"loading-container",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading..."})]})}):l?n&&!f(n)?o.jsx("div",{className:"access-denied",children:o.jsxs("div",{className:"access-denied-content",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:"You don't have permission to access this page."}),o.jsxs("p",{children:["Required role: ",o.jsx("strong",{children:n})]}),o.jsxs("p",{children:["Your role: ",o.jsx("strong",{children:h?.role})]}),o.jsx("div",{className:"access-denied-actions",children:o.jsx("button",{onClick:()=>window.history.back(),className:"back-button",children:"Go Back"})})]})}):o.jsx(o.Fragment,{children:a}):t||o.jsx(QS,{})},Vt=()=>{const a=G.useContext(bo);if(a===void 0)throw new Error("useAuth must be used within an AuthProvider");return a};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var co={};co.version="0.18.5";var Mv=1252,e2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jv=function(a){e2.indexOf(a)!=-1&&(Mv=a)};function t2(){jv(1252)}var yl=function(a){jv(a)};function a2(){yl(1200),t2()}var Zc=function(n){return String.fromCharCode(n)},R1=function(n){return String.fromCharCode(n)},oo,Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cl(a){for(var n="",t=0,i=0,l=0,u=0,f=0,h=0,g=0,v=0;v<a.length;)t=a.charCodeAt(v++),u=t>>2,i=a.charCodeAt(v++),f=(t&3)<<4|i>>4,l=a.charCodeAt(v++),h=(i&15)<<2|l>>6,g=l&63,isNaN(i)?h=g=64:isNaN(l)&&(g=64),n+=Er.charAt(u)+Er.charAt(f)+Er.charAt(h)+Er.charAt(g);return n}function Vn(a){var n="",t=0,i=0,l=0,u=0,f=0,h=0,g=0;a=a.replace(/[^\w\+\/\=]/g,"");for(var v=0;v<a.length;)u=Er.indexOf(a.charAt(v++)),f=Er.indexOf(a.charAt(v++)),t=u<<2|f>>4,n+=String.fromCharCode(t),h=Er.indexOf(a.charAt(v++)),i=(f&15)<<4|h>>2,h!==64&&(n+=String.fromCharCode(i)),g=Er.indexOf(a.charAt(v++)),l=(h&3)<<6|g,g!==64&&(n+=String.fromCharCode(l));return n}var nt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Xn=(function(){if(typeof Buffer<"u"){var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch{a=!0}return a?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Zr(a){return nt?Buffer.alloc?Buffer.alloc(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}function F1(a){return nt?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}var un=function(n){return nt?Xn(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function No(a){if(typeof ArrayBuffer>"u")return un(a);for(var n=new ArrayBuffer(a.length),t=new Uint8Array(n),i=0;i!=a.length;++i)t[i]=a.charCodeAt(i)&255;return n}function Nl(a){if(Array.isArray(a))return a.map(function(i){return String.fromCharCode(i)}).join("");for(var n=[],t=0;t<a.length;++t)n[t]=String.fromCharCode(a[t]);return n.join("")}function n2(a){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(a)}var Zt=nt?function(a){return Buffer.concat(a.map(function(n){return Buffer.isBuffer(n)?n:Xn(n)}))}:function(a){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<a.length;++n)t+=a[n].length;var i=new Uint8Array(t),l=0;for(n=0,t=0;n<a.length;t+=l,++n)if(l=a[n].length,a[n]instanceof Uint8Array)i.set(a[n],t);else{if(typeof a[n]=="string")throw"wtf";i.set(new Uint8Array(a[n]),t)}return i}return[].concat.apply([],a.map(function(u){return Array.isArray(u)?u:[].slice.call(u)}))};function r2(a){for(var n=[],t=0,i=a.length+250,l=Zr(a.length+255),u=0;u<a.length;++u){var f=a.charCodeAt(u);if(f<128)l[t++]=f;else if(f<2048)l[t++]=192|f>>6&31,l[t++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var h=a.charCodeAt(++u)&1023;l[t++]=240|f>>8&7,l[t++]=128|f>>2&63,l[t++]=128|h>>6&15|(f&3)<<4,l[t++]=128|h&63}else l[t++]=224|f>>12&15,l[t++]=128|f>>6&63,l[t++]=128|f&63;t>i&&(n.push(l.slice(0,t)),t=0,l=Zr(65535),i=65530)}return n.push(l.slice(0,t)),Zt(n)}var ml=/\u0000/g,eo=/[\u0001-\u0006]/g;function ts(a){for(var n="",t=a.length-1;t>=0;)n+=a.charAt(t--);return n}function fn(a,n){var t=""+a;return t.length>=n?t:bt("0",n-t.length)+t}function pf(a,n){var t=""+a;return t.length>=n?t:bt(" ",n-t.length)+t}function uo(a,n){var t=""+a;return t.length>=n?t:t+bt(" ",n-t.length)}function i2(a,n){var t=""+Math.round(a);return t.length>=n?t:bt("0",n-t.length)+t}function s2(a,n){var t=""+a;return t.length>=n?t:bt("0",n-t.length)+t}var L1=Math.pow(2,32);function Yi(a,n){if(a>L1||a<-L1)return i2(a,n);var t=Math.round(a);return s2(t,n)}function fo(a,n){return n=n||0,a.length>=7+n&&(a.charCodeAt(n)|32)===103&&(a.charCodeAt(n+1)|32)===101&&(a.charCodeAt(n+2)|32)===110&&(a.charCodeAt(n+3)|32)===101&&(a.charCodeAt(n+4)|32)===114&&(a.charCodeAt(n+5)|32)===97&&(a.charCodeAt(n+6)|32)===108}var B1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ef=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function l2(a){return a||(a={}),a[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"/ "hh""mm""ss" "',a}var Nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},K1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},c2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ho(a,n,t){for(var i=a<0?-1:1,l=a*i,u=0,f=1,h=0,g=1,v=0,p=0,S=Math.floor(l);v<n&&(S=Math.floor(l),h=S*f+u,p=S*v+g,!(l-S<5e-8));)l=1/(l-S),u=f,f=h,g=v,v=p;if(p>n&&(v>n?(p=g,h=u):(p=v,h=f)),!t)return[0,i*h,p];var x=Math.floor(i*h/p);return[x,i*h-x*p,p]}function to(a,n,t){if(a>2958465||a<0)return null;var i=a|0,l=Math.floor(86400*(a-i)),u=0,f=[],h={D:i,T:l,u:86400*(a-i)-l,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),n&&n.date1904&&(i+=1462),h.u>.9999&&(h.u=0,++l==86400&&(h.T=l=0,++i,++h.D)),i===60)f=t?[1317,10,29]:[1900,2,29],u=3;else if(i===0)f=t?[1317,8,29]:[1900,1,0],u=6;else{i>60&&--i;var g=new Date(1900,0,1);g.setDate(g.getDate()+i-1),f=[g.getFullYear(),g.getMonth()+1,g.getDate()],u=g.getDay(),i<60&&(u=(u+6)%7),t&&(u=v2(g,f))}return h.y=f[0],h.m=f[1],h.d=f[2],h.S=l%60,l=Math.floor(l/60),h.M=l%60,l=Math.floor(l/60),h.H=l,h.q=u,h}var kv=new Date(1899,11,31,0,0,0),o2=kv.getTime(),u2=new Date(1900,2,1,0,0,0);function Uv(a,n){var t=a.getTime();return n?t-=1461*24*60*60*1e3:a>=u2&&(t+=1440*60*1e3),(t-(o2+(a.getTimezoneOffset()-kv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function xf(a){return a.indexOf(".")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function f2(a){return a.indexOf("E")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function d2(a){var n=a<0?12:11,t=xf(a.toFixed(12));return t.length<=n||(t=a.toPrecision(10),t.length<=n)?t:a.toExponential(5)}function h2(a){var n=xf(a.toFixed(11));return n.length>(a<0?12:11)||n==="0"||n==="-0"?a.toPrecision(6):n}function m2(a){var n=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),t;return n>=-4&&n<=-1?t=a.toPrecision(10+n):Math.abs(n)<=9?t=d2(a):n===10?t=a.toFixed(10).substr(0,12):t=h2(a),xf(f2(t.toUpperCase()))}function ff(a,n){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(a|0)===a?a.toString(10):m2(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return wr(14,Uv(a,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+a)}function v2(a,n){n[0]-=581;var t=a.getDay();return a<60&&(t=(t+6)%7),t}function g2(a,n,t,i){var l="",u=0,f=0,h=t.y,g,v=0;switch(a){case 98:h=t.y+543;case 121:switch(n.length){case 1:case 2:g=h%100,v=2;break;default:g=h%1e4,v=4;break}break;case 109:switch(n.length){case 1:case 2:g=t.m,v=n.length;break;case 3:return ef[t.m-1][1];case 5:return ef[t.m-1][0];default:return ef[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:g=t.d,v=n.length;break;case 3:return B1[t.q][0];default:return B1[t.q][1]}break;case 104:switch(n.length){case 1:case 2:g=1+(t.H+11)%12,v=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:g=t.H,v=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:g=t.M,v=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?fn(t.S,n.length):(i>=2?f=i===3?1e3:100:f=i===1?10:1,u=Math.round(f*(t.S+t.u)),u>=60*f&&(u=0),n==="s"?u===0?"0":""+u/f:(l=fn(u,2+i),n==="ss"?l.substr(0,2):"."+l.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":g=t.D*24+t.H;break;case"[m]":case"[mm]":g=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":g=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}v=n.length===3?1:2;break;case 101:g=h,v=1;break}var p=v>0?fn(g,v):"";return p}function _r(a){var n=3;if(a.length<=n)return a;for(var t=a.length%n,i=a.substr(0,t);t!=a.length;t+=n)i+=(i.length>0?",":"")+a.substr(t,n);return i}var Ov=/%/g;function p2(a,n,t){var i=n.replace(Ov,""),l=n.length-i.length;return Hn(a,i,t*Math.pow(10,2*l))+bt("%",l)}function x2(a,n,t){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return Hn(a,n.substr(0,i),t/Math.pow(10,3*(n.length-i)))}function Iv(a,n){var t,i=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Iv(a,-n);var l=a.indexOf(".");l===-1&&(l=a.indexOf("E"));var u=Math.floor(Math.log(n)*Math.LOG10E)%l;if(u<0&&(u+=l),t=(n/Math.pow(10,u)).toPrecision(i+1+(l+u)%l),t.indexOf("e")===-1){var f=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+u):t+="E+"+(f-u);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,l)+"."+t.substr(2+l),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,v,p){return g+v+p.substr(0,(l+u)%l)+"."+p.substr(u)+"E"})}else t=n.toExponential(i);return a.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),a.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Rv=/# (\?+)( ?)\/( ?)(\d+)/;function S2(a,n,t){var i=parseInt(a[4],10),l=Math.round(n*i),u=Math.floor(l/i),f=l-u*i,h=i;return t+(u===0?"":""+u)+" "+(f===0?bt(" ",a[1].length+1+a[4].length):pf(f,a[1].length)+a[2]+"/"+a[3]+fn(h,a[4].length))}function y2(a,n,t){return t+(n===0?"":""+n)+bt(" ",a[1].length+2+a[4].length)}var Fv=/^#*0*\.([0#]+)/,Lv=/\).*[0#]/,Bv=/\(###\) ###\\?-####/;function fa(a){for(var n="",t,i=0;i!=a.length;++i)switch(t=a.charCodeAt(i)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function P1(a,n){var t=Math.pow(10,n);return""+Math.round(a*t)/t}function z1(a,n){var t=a-Math.floor(a),i=Math.pow(10,n);return n<(""+Math.round(t*i)).length?0:Math.round(t*i)}function C2(a,n){return n<(""+Math.round((a-Math.floor(a))*Math.pow(10,n))).length?1:0}function T2(a){return a<2147483647&&a>-2147483648?""+(a>=0?a|0:a-1|0):""+Math.floor(a)}function $a(a,n,t){if(a.charCodeAt(0)===40&&!n.match(Lv)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?$a("n",i,t):"("+$a("n",i,-t)+")"}if(n.charCodeAt(n.length-1)===44)return x2(a,n,t);if(n.indexOf("%")!==-1)return p2(a,n,t);if(n.indexOf("E")!==-1)return Iv(n,t);if(n.charCodeAt(0)===36)return"$"+$a(a,n.substr(n.charAt(1)==" "?2:1),t);var l,u,f,h,g=Math.abs(t),v=t<0?"-":"";if(n.match(/^00+$/))return v+Yi(g,n.length);if(n.match(/^[#?]+$/))return l=Yi(t,0),l==="0"&&(l=""),l.length>n.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(Rv))return S2(u,g,v);if(n.match(/^#+0+$/))return v+Yi(g,n.length-n.indexOf("0"));if(u=n.match(Fv))return l=P1(t,u[1].length).replace(/^([^\.]+)$/,"$1."+fa(u[1])).replace(/\.$/,"."+fa(u[1])).replace(/\.(\d*)$/,function(T,y){return"."+y+bt("0",fa(u[1]).length-y.length)}),n.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),u=n.match(/^(0*)\.(#*)$/))return v+P1(g,u[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=n.match(/^#{1,3},##0(\.?)$/))return v+_r(Yi(g,0));if(u=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+$a(a,n,-t):_r(""+(Math.floor(t)+C2(t,u[1].length)))+"."+fn(z1(t,u[1].length),u[1].length);if(u=n.match(/^#,#*,#0/))return $a(a,n.replace(/^#,#*,/,""),t);if(u=n.match(/^([0#]+)(\\?-([0#]+))+$/))return l=ts($a(a,n.replace(/[\\-]/g,""),t)),f=0,ts(ts(n.replace(/\\/g,"")).replace(/[0#]/g,function(T){return f<l.length?l.charAt(f++):T==="0"?"0":""}));if(n.match(Bv))return l=$a(a,"##########",t),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var p="";if(u=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(u[4].length,7),h=ho(g,Math.pow(10,f)-1,!1),l=""+v,p=Hn("n",u[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),l+=p+u[2]+"/"+u[3],p=uo(h[2],f),p.length<u[4].length&&(p=fa(u[4].substr(u[4].length-p.length))+p),l+=p,l;if(u=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(u[1].length,u[4].length),7),h=ho(g,Math.pow(10,f)-1,!0),v+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pf(h[1],f)+u[2]+"/"+u[3]+uo(h[2],f):bt(" ",2*f+1+u[2].length+u[3].length));if(u=n.match(/^[#0?]+$/))return l=Yi(t,0),n.length<=l.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(/^([#0?]+)\.([#0]+)$/)){l=""+t.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),f=l.indexOf(".");var S=n.indexOf(".")-f,x=n.length-l.length-S;return fa(n.substr(0,S)+l+n.substr(n.length-x))}if(u=n.match(/^00,000\.([#0]*0)$/))return f=z1(t,u[1].length),t<0?"-"+$a(a,n,-t):_r(T2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?fn(0,3-T.length):"")+T})+"."+fn(f,u[1].length);switch(n){case"###,##0.00":return $a(a,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var C=_r(Yi(g,0));return C!=="0"?v+C:"";case"###,###.00":return $a(a,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return $a(a,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function E2(a,n,t){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return Hn(a,n.substr(0,i),t/Math.pow(10,3*(n.length-i)))}function _2(a,n,t){var i=n.replace(Ov,""),l=n.length-i.length;return Hn(a,i,t*Math.pow(10,2*l))+bt("%",l)}function Kv(a,n){var t,i=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Kv(a,-n);var l=a.indexOf(".");l===-1&&(l=a.indexOf("E"));var u=Math.floor(Math.log(n)*Math.LOG10E)%l;if(u<0&&(u+=l),t=(n/Math.pow(10,u)).toPrecision(i+1+(l+u)%l),!t.match(/[Ee]/)){var f=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+u):t+="E+"+(f-u),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,v,p){return g+v+p.substr(0,(l+u)%l)+"."+p.substr(u)+"E"})}else t=n.toExponential(i);return a.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),a.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sn(a,n,t){if(a.charCodeAt(0)===40&&!n.match(Lv)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sn("n",i,t):"("+Sn("n",i,-t)+")"}if(n.charCodeAt(n.length-1)===44)return E2(a,n,t);if(n.indexOf("%")!==-1)return _2(a,n,t);if(n.indexOf("E")!==-1)return Kv(n,t);if(n.charCodeAt(0)===36)return"$"+Sn(a,n.substr(n.charAt(1)==" "?2:1),t);var l,u,f,h,g=Math.abs(t),v=t<0?"-":"";if(n.match(/^00+$/))return v+fn(g,n.length);if(n.match(/^[#?]+$/))return l=""+t,t===0&&(l=""),l.length>n.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(Rv))return y2(u,g,v);if(n.match(/^#+0+$/))return v+fn(g,n.length-n.indexOf("0"));if(u=n.match(Fv))return l=(""+t).replace(/^([^\.]+)$/,"$1."+fa(u[1])).replace(/\.$/,"."+fa(u[1])),l=l.replace(/\.(\d*)$/,function(T,y){return"."+y+bt("0",fa(u[1]).length-y.length)}),n.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),u=n.match(/^(0*)\.(#*)$/))return v+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=n.match(/^#{1,3},##0(\.?)$/))return v+_r(""+g);if(u=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sn(a,n,-t):_r(""+t)+"."+bt("0",u[1].length);if(u=n.match(/^#,#*,#0/))return Sn(a,n.replace(/^#,#*,/,""),t);if(u=n.match(/^([0#]+)(\\?-([0#]+))+$/))return l=ts(Sn(a,n.replace(/[\\-]/g,""),t)),f=0,ts(ts(n.replace(/\\/g,"")).replace(/[0#]/g,function(T){return f<l.length?l.charAt(f++):T==="0"?"0":""}));if(n.match(Bv))return l=Sn(a,"##########",t),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var p="";if(u=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(u[4].length,7),h=ho(g,Math.pow(10,f)-1,!1),l=""+v,p=Hn("n",u[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),l+=p+u[2]+"/"+u[3],p=uo(h[2],f),p.length<u[4].length&&(p=fa(u[4].substr(u[4].length-p.length))+p),l+=p,l;if(u=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(u[1].length,u[4].length),7),h=ho(g,Math.pow(10,f)-1,!0),v+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pf(h[1],f)+u[2]+"/"+u[3]+uo(h[2],f):bt(" ",2*f+1+u[2].length+u[3].length));if(u=n.match(/^[#0?]+$/))return l=""+t,n.length<=l.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(/^([#0]+)\.([#0]+)$/)){l=""+t.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),f=l.indexOf(".");var S=n.indexOf(".")-f,x=n.length-l.length-S;return fa(n.substr(0,S)+l+n.substr(n.length-x))}if(u=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sn(a,n,-t):_r(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?fn(0,3-T.length):"")+T})+"."+fn(0,u[1].length);switch(n){case"###,###":case"##,###":case"#,###":var C=_r(""+g);return C!=="0"?v+C:"";default:if(n.match(/\.[0#?]*$/))return Sn(a,n.slice(0,n.lastIndexOf(".")),t)+fa(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Hn(a,n,t){return(t|0)===t?Sn(a,n,t):$a(a,n,t)}function w2(a){for(var n=[],t=!1,i=0,l=0;i<a.length;++i)switch(a.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:n[n.length]=a.substr(l,i-l),l=i+1}if(n[n.length]=a.substr(l),t===!0)throw new Error("Format |"+a+"| unterminated string ");return n}var Pv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zv(a){for(var n=0,t="",i="";n<a.length;)switch(t=a.charAt(n)){case"G":fo(a,n)&&(n+=6),n++;break;case'"':for(;a.charCodeAt(++n)!==34&&n<a.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(a.charAt(n+1)==="1"||a.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(a.substr(n,3).toUpperCase()==="A/P"||a.substr(n,5).toUpperCase()==="AM/PM"||a.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(i=t;a.charAt(n++)!=="]"&&n<a.length;)i+=a.charAt(n);if(i.match(Pv))return!0;break;case".":case"0":case"#":for(;n<a.length&&("0#?.,E+-%".indexOf(t=a.charAt(++n))>-1||t=="\\"&&a.charAt(n+1)=="-"&&"0#".indexOf(a.charAt(n+2))>-1););break;case"?":for(;a.charAt(++n)===t;);break;case"*":++n,(a.charAt(n)==" "||a.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<a.length&&"0123456789".indexOf(a.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function b2(a,n,t,i){for(var l=[],u="",f=0,h="",g="t",v,p,S,x="H";f<a.length;)switch(h=a.charAt(f)){case"G":if(!fo(a,f))throw new Error("unrecognized character "+h+" in "+a);l[l.length]={t:"G",v:"General"},f+=7;break;case'"':for(u="";(S=a.charCodeAt(++f))!==34&&f<a.length;)u+=String.fromCharCode(S);l[l.length]={t:"t",v:u},++f;break;case"\\":var C=a.charAt(++f),T=C==="("||C===")"?C:"t";l[l.length]={t:T,v:C},++f;break;case"_":l[l.length]={t:"t",v:" "},f+=2;break;case"@":l[l.length]={t:"T",v:n},++f;break;case"B":case"b":if(a.charAt(f+1)==="1"||a.charAt(f+1)==="2"){if(v==null&&(v=to(n,t,a.charAt(f+1)==="2"),v==null))return"";l[l.length]={t:"X",v:a.substr(f,2)},g=h,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||v==null&&(v=to(n,t),v==null))return"";for(u=h;++f<a.length&&a.charAt(f).toLowerCase()===h;)u+=h;h==="m"&&g.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=x),l[l.length]={t:h,v:u},g=h;break;case"A":case"a":case"":var y={t:h,v:h};if(v==null&&(v=to(n,t)),a.substr(f,3).toUpperCase()==="A/P"?(v!=null&&(y.v=v.H>=12?"P":"A"),y.t="T",x="h",f+=3):a.substr(f,5).toUpperCase()==="AM/PM"?(v!=null&&(y.v=v.H>=12?"PM":"AM"),y.t="T",f+=5,x="h"):a.substr(f,5).toUpperCase()==="/"?(v!=null&&(y.v=v.H>=12?"":""),y.t="T",f+=5,x="h"):(y.t="t",++f),v==null&&y.t==="T")return"";l[l.length]=y,g=h;break;case"[":for(u=h;a.charAt(f++)!=="]"&&f<a.length;)u+=a.charAt(f);if(u.slice(-1)!=="]")throw'unterminated "[" block: |'+u+"|";if(u.match(Pv)){if(v==null&&(v=to(n,t),v==null))return"";l[l.length]={t:"Z",v:u.toLowerCase()},g=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",zv(a)||(l[l.length]={t:"t",v:u}));break;case".":if(v!=null){for(u=h;++f<a.length&&(h=a.charAt(f))==="0";)u+=h;l[l.length]={t:"s",v:u};break}case"0":case"#":for(u=h;++f<a.length&&"0#?.,E+-%".indexOf(h=a.charAt(f))>-1;)u+=h;l[l.length]={t:"n",v:u};break;case"?":for(u=h;a.charAt(++f)===h;)u+=h;l[l.length]={t:h,v:u},g=h;break;case"*":++f,(a.charAt(f)==" "||a.charAt(f)=="*")&&++f;break;case"(":case")":l[l.length]={t:i===1?"t":h,v:h},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=h;f<a.length&&"0123456789".indexOf(a.charAt(++f))>-1;)u+=a.charAt(f);l[l.length]={t:"D",v:u};break;case" ":l[l.length]={t:h,v:h},++f;break;case"$":l[l.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+a);l[l.length]={t:"t",v:h},++f;break}var _=0,w=0,k;for(f=l.length-1,g="t";f>=0;--f)switch(l[f].t){case"h":case"H":l[f].t=x,g="h",_<1&&(_=1);break;case"s":(k=l[f].v.match(/\.0+$/))&&(w=Math.max(w,k[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":g=l[f].t;break;case"m":g==="s"&&(l[f].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&l[f].v.match(/[Hh]/)&&(_=1),_<2&&l[f].v.match(/[Mm]/)&&(_=2),_<3&&l[f].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:v.u>=.5&&(v.u=0,++v.S),v.S>=60&&(v.S=0,++v.M),v.M>=60&&(v.M=0,++v.H);break;case 2:v.u>=.5&&(v.u=0,++v.S),v.S>=60&&(v.S=0,++v.M);break}var M="",N;for(f=0;f<l.length;++f)switch(l[f].t){case"t":case"T":case" ":case"D":break;case"X":l[f].v="",l[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[f].v=g2(l[f].t.charCodeAt(0),l[f].v,v,w),l[f].t="t";break;case"n":case"?":for(N=f+1;l[N]!=null&&((h=l[N].t)==="?"||h==="D"||(h===" "||h==="t")&&l[N+1]!=null&&(l[N+1].t==="?"||l[N+1].t==="t"&&l[N+1].v==="/")||l[f].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(l[N].v==="/"||l[N].v===" "&&l[N+1]!=null&&l[N+1].t=="?"));)l[f].v+=l[N].v,l[N]={v:"",t:";"},++N;M+=l[f].v,f=N-1;break;case"G":l[f].t="t",l[f].v=ff(n,t);break}var K="",J,B;if(M.length>0){M.charCodeAt(0)==40?(J=n<0&&M.charCodeAt(0)===45?-n:n,B=Hn("n",M,J)):(J=n<0&&i>1?-n:n,B=Hn("n",M,J),J<0&&l[0]&&l[0].t=="t"&&(B=B.substr(1),l[0].v="-"+l[0].v)),N=B.length-1;var Z=l.length;for(f=0;f<l.length;++f)if(l[f]!=null&&l[f].t!="t"&&l[f].v.indexOf(".")>-1){Z=f;break}var L=l.length;if(Z===l.length&&B.indexOf("E")===-1){for(f=l.length-1;f>=0;--f)l[f]==null||"n?".indexOf(l[f].t)===-1||(N>=l[f].v.length-1?(N-=l[f].v.length,l[f].v=B.substr(N+1,l[f].v.length)):N<0?l[f].v="":(l[f].v=B.substr(0,N+1),N=-1),l[f].t="t",L=f);N>=0&&L<l.length&&(l[L].v=B.substr(0,N+1)+l[L].v)}else if(Z!==l.length&&B.indexOf("E")===-1){for(N=B.indexOf(".")-1,f=Z;f>=0;--f)if(!(l[f]==null||"n?".indexOf(l[f].t)===-1)){for(p=l[f].v.indexOf(".")>-1&&f===Z?l[f].v.indexOf(".")-1:l[f].v.length-1,K=l[f].v.substr(p+1);p>=0;--p)N>=0&&(l[f].v.charAt(p)==="0"||l[f].v.charAt(p)==="#")&&(K=B.charAt(N--)+K);l[f].v=K,l[f].t="t",L=f}for(N>=0&&L<l.length&&(l[L].v=B.substr(0,N+1)+l[L].v),N=B.indexOf(".")+1,f=Z;f<l.length;++f)if(!(l[f]==null||"n?(".indexOf(l[f].t)===-1&&f!==Z)){for(p=l[f].v.indexOf(".")>-1&&f===Z?l[f].v.indexOf(".")+1:0,K=l[f].v.substr(0,p);p<l[f].v.length;++p)N<B.length&&(K+=B.charAt(N++));l[f].v=K,l[f].t="t",L=f}}}for(f=0;f<l.length;++f)l[f]!=null&&"n?".indexOf(l[f].t)>-1&&(J=i>1&&n<0&&f>0&&l[f-1].v==="-"?-n:n,l[f].v=Hn(l[f].t,l[f].v,J),l[f].t="t");var X="";for(f=0;f!==l.length;++f)l[f]!=null&&(X+=l[f].v);return X}var H1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function G1(a,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(a==t)return!0;break;case">":if(a>t)return!0;break;case"<":if(a<t)return!0;break;case"<>":if(a!=t)return!0;break;case">=":if(a>=t)return!0;break;case"<=":if(a<=t)return!0;break}return!1}function N2(a,n){var t=w2(a),i=t.length,l=t[i-1].indexOf("@");if(i<4&&l>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||l>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=l>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=l>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=l>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var u=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,u];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var f=t[0].match(H1),h=t[1].match(H1);return G1(n,f)?[i,t[0]]:G1(n,h)?[i,t[1]]:[i,t[f!=null&&h!=null?2:1]]}return[i,u]}function wr(a,n,t){t==null&&(t={});var i="";switch(typeof a){case"string":a=="m/d/yy"&&t.dateNF?i=t.dateNF:i=a;break;case"number":a==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:Nt)[a],i==null&&(i=t.table&&t.table[K1[a]]||Nt[K1[a]]),i==null&&(i=c2[a]||"General");break}if(fo(i,0))return ff(n,t);n instanceof Date&&(n=Uv(n,t.date1904));var l=N2(i,n);if(fo(l[1]))return ff(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return b2(l[1],n,t,l[0])}function Hv(a,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(Nt[t]==null){n<0&&(n=t);continue}if(Nt[t]==a){n=t;break}}n<0&&(n=391)}return Nt[n]=a,n}function Ao(a){for(var n=0;n!=392;++n)a[n]!==void 0&&Hv(a[n],n)}function Do(){Nt=l2()}var Gv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function A2(a){var n=typeof a=="number"?Nt[a]:a;return n=n.replace(Gv,"(\\d+)"),new RegExp("^"+n+"$")}function D2(a,n,t){var i=-1,l=-1,u=-1,f=-1,h=-1,g=-1;(n.match(Gv)||[]).forEach(function(S,x){var C=parseInt(t[x+1],10);switch(S.toLowerCase().charAt(0)){case"y":i=C;break;case"d":u=C;break;case"h":f=C;break;case"s":g=C;break;case"m":f>=0?h=C:l=C;break}}),g>=0&&h==-1&&l>=0&&(h=l,l=-1);var v=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(l>=1?l:1)).slice(-2)+"-"+("00"+(u>=1?u:1)).slice(-2);v.length==7&&(v="0"+v),v.length==8&&(v="20"+v);var p=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return f==-1&&h==-1&&g==-1?v:i==-1&&l==-1&&u==-1?p:v+"T"+p}var M2=(function(){var a={};a.version="1.2.0";function n(){for(var B=0,Z=new Array(256),L=0;L!=256;++L)B=L,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,Z[L]=B;return typeof Int32Array<"u"?new Int32Array(Z):Z}var t=n();function i(B){var Z=0,L=0,X=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)D[X]=B[X];for(X=0;X!=256;++X)for(L=B[X],Z=256+X;Z<4096;Z+=256)L=D[Z]=L>>>8^B[L&255];var z=[];for(X=1;X!=16;++X)z[X-1]=typeof Int32Array<"u"?D.subarray(X*256,X*256+256):D.slice(X*256,X*256+256);return z}var l=i(t),u=l[0],f=l[1],h=l[2],g=l[3],v=l[4],p=l[5],S=l[6],x=l[7],C=l[8],T=l[9],y=l[10],_=l[11],w=l[12],k=l[13],M=l[14];function N(B,Z){for(var L=Z^-1,X=0,D=B.length;X<D;)L=L>>>8^t[(L^B.charCodeAt(X++))&255];return~L}function K(B,Z){for(var L=Z^-1,X=B.length-15,D=0;D<X;)L=M[B[D++]^L&255]^k[B[D++]^L>>8&255]^w[B[D++]^L>>16&255]^_[B[D++]^L>>>24]^y[B[D++]]^T[B[D++]]^C[B[D++]]^x[B[D++]]^S[B[D++]]^p[B[D++]]^v[B[D++]]^g[B[D++]]^h[B[D++]]^f[B[D++]]^u[B[D++]]^t[B[D++]];for(X+=15;D<X;)L=L>>>8^t[(L^B[D++])&255];return~L}function J(B,Z){for(var L=Z^-1,X=0,D=B.length,z=0,ue=0;X<D;)z=B.charCodeAt(X++),z<128?L=L>>>8^t[(L^z)&255]:z<2048?(L=L>>>8^t[(L^(192|z>>6&31))&255],L=L>>>8^t[(L^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,ue=B.charCodeAt(X++)&1023,L=L>>>8^t[(L^(240|z>>8&7))&255],L=L>>>8^t[(L^(128|z>>2&63))&255],L=L>>>8^t[(L^(128|ue>>6&15|(z&3)<<4))&255],L=L>>>8^t[(L^(128|ue&63))&255]):(L=L>>>8^t[(L^(224|z>>12&15))&255],L=L>>>8^t[(L^(128|z>>6&63))&255],L=L>>>8^t[(L^(128|z&63))&255]);return~L}return a.table=t,a.bstr=N,a.buf=K,a.str=J,a})(),ht=(function(){var n={};n.version="1.2.1";function t(b,R){for(var U=b.split("/"),O=R.split("/"),I=0,F=0,ne=Math.min(U.length,O.length);I<ne;++I){if(F=U[I].length-O[I].length)return F;if(U[I]!=O[I])return U[I]<O[I]?-1:1}return U.length-O.length}function i(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:i(b.slice(0,-1));var R=b.lastIndexOf("/");return R===-1?b:b.slice(0,R+1)}function l(b){if(b.charAt(b.length-1)=="/")return l(b.slice(0,-1));var R=b.lastIndexOf("/");return R===-1?b:b.slice(R+1)}function u(b,R){typeof R=="string"&&(R=new Date(R));var U=R.getHours();U=U<<6|R.getMinutes(),U=U<<5|R.getSeconds()>>>1,b.write_shift(2,U);var O=R.getFullYear()-1980;O=O<<4|R.getMonth()+1,O=O<<5|R.getDate(),b.write_shift(2,O)}function f(b){var R=b.read_shift(2)&65535,U=b.read_shift(2)&65535,O=new Date,I=U&31;U>>>=5;var F=U&15;U>>>=4,O.setMilliseconds(0),O.setFullYear(U+1980),O.setMonth(F-1),O.setDate(I);var ne=R&31;R>>>=5;var he=R&63;return R>>>=6,O.setHours(R),O.setMinutes(he),O.setSeconds(ne<<1),O}function h(b){Oa(b,0);for(var R={},U=0;b.l<=b.length-4;){var O=b.read_shift(2),I=b.read_shift(2),F=b.l+I,ne={};switch(O){case 21589:U=b.read_shift(1),U&1&&(ne.mtime=b.read_shift(4)),I>5&&(U&2&&(ne.atime=b.read_shift(4)),U&4&&(ne.ctime=b.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}b.l=F,R[O]=ne}return R}var g;function v(){return g||(g={})}function p(b,R){if(b[0]==80&&b[1]==75)return Dr(b,R);if((b[0]|32)==109&&(b[1]|32)==105)return jr(b,R);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var U=3,O=512,I=0,F=0,ne=0,he=0,re=0,ie=[],le=b.slice(0,512);Oa(le,0);var xe=S(le);switch(U=xe[0],U){case 3:O=512;break;case 4:O=4096;break;case 0:if(xe[1]==0)return Dr(b,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}O!==512&&(le=b.slice(0,O),Oa(le,28));var Te=b.slice(0,O);x(le,U);var Me=le.read_shift(4,"i");if(U===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),he=le.read_shift(4,"i"),I=le.read_shift(4,"i"),re=le.read_shift(4,"i"),F=le.read_shift(4,"i");for(var ye=-1,De=0;De<109&&(ye=le.read_shift(4,"i"),!(ye<0));++De)ie[De]=ye;var Ie=C(b,O);_(re,F,Ie,O,ie);var gt=k(Ie,ne,ie,O);gt[ne].name="!Directory",I>0&&he!==ue&&(gt[he].name="!MiniFAT"),gt[ie[0]].name="!FAT",gt.fat_addrs=ie,gt.ssz=O;var pt={},Tt=[],Ka=[],kr=[];M(ne,gt,Ie,Tt,I,pt,Ka,he),T(Ka,kr,Tt),Tt.shift();var Jn={FileIndex:Ka,FullPaths:kr};return R&&R.raw&&(Jn.raw={header:Te,sectors:Ie}),Jn}function S(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(be,"Header Signature: "),b.l+=16;var R=b.read_shift(2,"u");return[b.read_shift(2,"u"),R]}function x(b,R){var U=9;switch(b.l+=2,U=b.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function C(b,R){for(var U=Math.ceil(b.length/R)-1,O=[],I=1;I<U;++I)O[I-1]=b.slice(I*R,(I+1)*R);return O[U-1]=b.slice(U*R),O}function T(b,R,U){for(var O=0,I=0,F=0,ne=0,he=0,re=U.length,ie=[],le=[];O<re;++O)ie[O]=le[O]=O,R[O]=U[O];for(;he<le.length;++he)O=le[he],I=b[O].L,F=b[O].R,ne=b[O].C,ie[O]===O&&(I!==-1&&ie[I]!==I&&(ie[O]=ie[I]),F!==-1&&ie[F]!==F&&(ie[O]=ie[F])),ne!==-1&&(ie[ne]=O),I!==-1&&O!=ie[O]&&(ie[I]=ie[O],le.lastIndexOf(I)<he&&le.push(I)),F!==-1&&O!=ie[O]&&(ie[F]=ie[O],le.lastIndexOf(F)<he&&le.push(F));for(O=1;O<re;++O)ie[O]===O&&(F!==-1&&ie[F]!==F?ie[O]=ie[F]:I!==-1&&ie[I]!==I&&(ie[O]=ie[I]));for(O=1;O<re;++O)if(b[O].type!==0){if(he=O,he!=ie[he])do he=ie[he],R[O]=R[he]+"/"+R[O];while(he!==0&&ie[he]!==-1&&he!=ie[he]);ie[O]=-1}for(R[0]+="/",O=1;O<re;++O)b[O].type!==2&&(R[O]+="/")}function y(b,R,U){for(var O=b.start,I=b.size,F=[],ne=O;U&&I>0&&ne>=0;)F.push(R.slice(ne*z,ne*z+z)),I-=z,ne=Jr(U,ne*4);return F.length===0?fe(0):Zt(F).slice(0,b.size)}function _(b,R,U,O,I){var F=ue;if(b===ue){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ne=U[b],he=(O>>>2)-1;if(!ne)return;for(var re=0;re<he&&(F=Jr(ne,re*4))!==ue;++re)I.push(F);_(Jr(ne,O-4),R-1,U,O,I)}}function w(b,R,U,O,I){var F=[],ne=[];I||(I=[]);var he=O-1,re=0,ie=0;for(re=R;re>=0;){I[re]=!0,F[F.length]=re,ne.push(b[re]);var le=U[Math.floor(re*4/O)];if(ie=re*4&he,O<4+ie)throw new Error("FAT boundary crossed: "+re+" 4 "+O);if(!b[le])break;re=Jr(b[le],ie)}return{nodes:F,data:Q1([ne])}}function k(b,R,U,O){var I=b.length,F=[],ne=[],he=[],re=[],ie=O-1,le=0,xe=0,Te=0,Me=0;for(le=0;le<I;++le)if(he=[],Te=le+R,Te>=I&&(Te-=I),!ne[Te]){re=[];var ye=[];for(xe=Te;xe>=0;){ye[xe]=!0,ne[xe]=!0,he[he.length]=xe,re.push(b[xe]);var De=U[Math.floor(xe*4/O)];if(Me=xe*4&ie,O<4+Me)throw new Error("FAT boundary crossed: "+xe+" 4 "+O);if(!b[De]||(xe=Jr(b[De],Me),ye[xe]))break}F[Te]={nodes:he,data:Q1([re])}}return F}function M(b,R,U,O,I,F,ne,he){for(var re=0,ie=O.length?2:0,le=R[b].data,xe=0,Te=0,Me;xe<le.length;xe+=128){var ye=le.slice(xe,xe+128);Oa(ye,64),Te=ye.read_shift(2),Me=Ef(ye,0,Te-ie),O.push(Me);var De={name:Me,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},Ie=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);Ie!==0&&(De.ct=N(ye,ye.l-8));var gt=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);gt!==0&&(De.mt=N(ye,ye.l-8)),De.start=ye.read_shift(4,"i"),De.size=ye.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=ue,De.name=""),De.type===5?(re=De.start,I>0&&re!==ue&&(R[re].name="!StreamData")):De.size>=4096?(De.storage="fat",R[De.start]===void 0&&(R[De.start]=w(U,De.start,R.fat_addrs,R.ssz)),R[De.start].name=De.name,De.content=R[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:re!==ue&&De.start!==ue&&R[re]&&(De.content=y(De,R[re].data,(R[he]||{}).data))),De.content&&Oa(De.content,0),F[Me]=De,ne.push(De)}}function N(b,R){return new Date((Ra(b,R+4)/1e7*Math.pow(2,32)+Ra(b,R)/1e7-11644473600)*1e3)}function K(b,R){return v(),p(g.readFileSync(b),R)}function J(b,R){var U=R&&R.type;switch(U||nt&&Buffer.isBuffer(b)&&(U="buffer"),U||"base64"){case"file":return K(b,R);case"base64":return p(un(Vn(b)),R);case"binary":return p(un(b),R)}return p(b,R)}function B(b,R){var U=R||{},O=U.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=O+"/",b.FileIndex[0]={name:O,type:5}),U.CLSID&&(b.FileIndex[0].clsid=U.CLSID),Z(b)}function Z(b){var R="Sh33tJ5";if(!ht.find(b,"/"+R)){var U=fe(4);U[0]=55,U[1]=U[3]=50,U[2]=54,b.FileIndex.push({name:R,type:2,content:U,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+R),L(b)}}function L(b,R){B(b);for(var U=!1,O=!1,I=b.FullPaths.length-1;I>=0;--I){var F=b.FileIndex[I];switch(F.type){case 0:O?U=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(F.R*F.L*F.C)&&(U=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!R)){var ne=new Date(1987,1,19),he=0,re=Object.create?Object.create(null):{},ie=[];for(I=0;I<b.FullPaths.length;++I)re[b.FullPaths[I]]=!0,b.FileIndex[I].type!==0&&ie.push([b.FullPaths[I],b.FileIndex[I]]);for(I=0;I<ie.length;++I){var le=i(ie[I][0]);O=re[le],O||(ie.push([le,{name:l(le).replace("/",""),type:1,clsid:ee,ct:ne,mt:ne,content:null}]),re[le]=!0)}for(ie.sort(function(Me,ye){return t(Me[0],ye[0])}),b.FullPaths=[],b.FileIndex=[],I=0;I<ie.length;++I)b.FullPaths[I]=ie[I][0],b.FileIndex[I]=ie[I][1];for(I=0;I<ie.length;++I){var xe=b.FileIndex[I],Te=b.FullPaths[I];if(xe.name=l(Te).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||ee,I===0)xe.C=ie.length>1?1:-1,xe.size=0,xe.type=5;else if(Te.slice(-1)=="/"){for(he=I+1;he<ie.length&&i(b.FullPaths[he])!=Te;++he);for(xe.C=he>=ie.length?-1:he,he=I+1;he<ie.length&&i(b.FullPaths[he])!=i(Te);++he);xe.R=he>=ie.length?-1:he,xe.type=1}else i(b.FullPaths[I+1]||"")==i(Te)&&(xe.R=I+1),xe.type=2}}}function X(b,R){var U=R||{};if(U.fileType=="mad")return Lo(b,U);switch(L(b),U.fileType){case"zip":return fi(b,U)}var O=(function(Me){for(var ye=0,De=0,Ie=0;Ie<Me.FileIndex.length;++Ie){var gt=Me.FileIndex[Ie];if(gt.content){var pt=gt.content.length;pt>0&&(pt<4096?ye+=pt+63>>6:De+=pt+511>>9)}}for(var Tt=Me.FullPaths.length+3>>2,Ka=ye+7>>3,kr=ye+127>>7,Jn=Ka+De+Tt+kr,mn=Jn+127>>7,xs=mn<=109?0:Math.ceil((mn-109)/127);Jn+mn+xs+127>>7>mn;)xs=++mn<=109?0:Math.ceil((mn-109)/127);var ma=[1,xs,mn,kr,Tt,De,ye,0];return Me.FileIndex[0].size=ye<<6,ma[7]=(Me.FileIndex[0].start=ma[0]+ma[1]+ma[2]+ma[3]+ma[4]+ma[5])+(ma[6]+7>>3),ma})(b),I=fe(O[7]<<9),F=0,ne=0;{for(F=0;F<8;++F)I.write_shift(1,Se[F]);for(F=0;F<8;++F)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),F=0;F<3;++F)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,O[2]),I.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:ue),I.write_shift(4,O[3]),I.write_shift(-4,O[1]?O[0]-1:ue),I.write_shift(4,O[1]),F=0;F<109;++F)I.write_shift(-4,F<O[2]?O[1]+F:-1)}if(O[1])for(ne=0;ne<O[1];++ne){for(;F<236+ne*127;++F)I.write_shift(-4,F<O[2]?O[1]+F:-1);I.write_shift(-4,ne===O[1]-1?ue:ne+1)}var he=function(Me){for(ne+=Me;F<ne-1;++F)I.write_shift(-4,F+1);Me&&(++F,I.write_shift(-4,ue))};for(ne=F=0,ne+=O[1];F<ne;++F)I.write_shift(-4,ge.DIFSECT);for(ne+=O[2];F<ne;++F)I.write_shift(-4,ge.FATSECT);he(O[3]),he(O[4]);for(var re=0,ie=0,le=b.FileIndex[0];re<b.FileIndex.length;++re)le=b.FileIndex[re],le.content&&(ie=le.content.length,!(ie<4096)&&(le.start=ne,he(ie+511>>9)));for(he(O[6]+7>>3);I.l&511;)I.write_shift(-4,ge.ENDOFCHAIN);for(ne=F=0,re=0;re<b.FileIndex.length;++re)le=b.FileIndex[re],le.content&&(ie=le.content.length,!(!ie||ie>=4096)&&(le.start=ne,he(ie+63>>6)));for(;I.l&511;)I.write_shift(-4,ge.ENDOFCHAIN);for(F=0;F<O[4]<<2;++F){var xe=b.FullPaths[F];if(!xe||xe.length===0){for(re=0;re<17;++re)I.write_shift(4,0);for(re=0;re<3;++re)I.write_shift(4,-1);for(re=0;re<12;++re)I.write_shift(4,0);continue}le=b.FileIndex[F],F===0&&(le.start=le.size?le.start-1:ue);var Te=F===0&&U.root||le.name;if(ie=2*(Te.length+1),I.write_shift(64,Te,"utf16le"),I.write_shift(2,ie),I.write_shift(1,le.type),I.write_shift(1,le.color),I.write_shift(-4,le.L),I.write_shift(-4,le.R),I.write_shift(-4,le.C),le.clsid)I.write_shift(16,le.clsid,"hex");else for(re=0;re<4;++re)I.write_shift(4,0);I.write_shift(4,le.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,le.start),I.write_shift(4,le.size),I.write_shift(4,0)}for(F=1;F<b.FileIndex.length;++F)if(le=b.FileIndex[F],le.size>=4096)if(I.l=le.start+1<<9,nt&&Buffer.isBuffer(le.content))le.content.copy(I,I.l,0,le.size),I.l+=le.size+511&-512;else{for(re=0;re<le.size;++re)I.write_shift(1,le.content[re]);for(;re&511;++re)I.write_shift(1,0)}for(F=1;F<b.FileIndex.length;++F)if(le=b.FileIndex[F],le.size>0&&le.size<4096)if(nt&&Buffer.isBuffer(le.content))le.content.copy(I,I.l,0,le.size),I.l+=le.size+63&-64;else{for(re=0;re<le.size;++re)I.write_shift(1,le.content[re]);for(;re&63;++re)I.write_shift(1,0)}if(nt)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function D(b,R){var U=b.FullPaths.map(function(re){return re.toUpperCase()}),O=U.map(function(re){var ie=re.split("/");return ie[ie.length-(re.slice(-1)=="/"?2:1)]}),I=!1;R.charCodeAt(0)===47?(I=!0,R=U[0].slice(0,-1)+R):I=R.indexOf("/")!==-1;var F=R.toUpperCase(),ne=I===!0?U.indexOf(F):O.indexOf(F);if(ne!==-1)return b.FileIndex[ne];var he=!F.match(eo);for(F=F.replace(ml,""),he&&(F=F.replace(eo,"!")),ne=0;ne<U.length;++ne)if((he?U[ne].replace(eo,"!"):U[ne]).replace(ml,"")==F||(he?O[ne].replace(eo,"!"):O[ne]).replace(ml,"")==F)return b.FileIndex[ne];return null}var z=64,ue=-2,be="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ke(b,R,U){v();var O=X(b,U);g.writeFileSync(R,O)}function Ne(b){for(var R=new Array(b.length),U=0;U<b.length;++U)R[U]=String.fromCharCode(b[U]);return R.join("")}function Le(b,R){var U=X(b,R);switch(R&&R.type||"buffer"){case"file":return v(),g.writeFileSync(R.filename,U),U;case"binary":return typeof U=="string"?U:Ne(U);case"base64":return Cl(typeof U=="string"?U:Ne(U));case"buffer":if(nt)return Buffer.isBuffer(U)?U:Xn(U);case"array":return typeof U=="string"?un(U):U}return U}var H;function j(b){try{var R=b.InflateRaw,U=new R;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)H=b;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function V(b,R){if(!H)return Rl(b,R);var U=H.InflateRaw,O=new U,I=O._processChunk(b.slice(b.l),O._finishFlushFlag);return b.l+=O.bytesRead,I}function P(b){return H?H.deflateRawSync(b):ms(b)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function je(b){var R=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(R>>16|R>>8|R)&255}for(var we=typeof Uint8Array<"u",Ae=we?new Uint8Array(256):[],Qe=0;Qe<256;++Qe)Ae[Qe]=je(Qe);function Ve(b,R){var U=Ae[b&255];return R<=8?U>>>8-R:(U=U<<8|Ae[b>>8&255],R<=16?U>>>16-R:(U=U<<8|Ae[b>>16&255],U>>>24-R))}function Kt(b,R){var U=R&7,O=R>>>3;return(b[O]|(U<=6?0:b[O+1]<<8))>>>U&3}function We(b,R){var U=R&7,O=R>>>3;return(b[O]|(U<=5?0:b[O+1]<<8))>>>U&7}function _a(b,R){var U=R&7,O=R>>>3;return(b[O]|(U<=4?0:b[O+1]<<8))>>>U&15}function vt(b,R){var U=R&7,O=R>>>3;return(b[O]|(U<=3?0:b[O+1]<<8))>>>U&31}function Ue(b,R){var U=R&7,O=R>>>3;return(b[O]|(U<=1?0:b[O+1]<<8))>>>U&127}function ca(b,R,U){var O=R&7,I=R>>>3,F=(1<<U)-1,ne=b[I]>>>O;return U<8-O||(ne|=b[I+1]<<8-O,U<16-O)||(ne|=b[I+2]<<16-O,U<24-O)||(ne|=b[I+3]<<24-O),ne&F}function wa(b,R,U){var O=R&7,I=R>>>3;return O<=5?b[I]|=(U&7)<<O:(b[I]|=U<<O&255,b[I+1]=(U&7)>>8-O),R+3}function en(b,R,U){var O=R&7,I=R>>>3;return U=(U&1)<<O,b[I]|=U,R+1}function hn(b,R,U){var O=R&7,I=R>>>3;return U<<=O,b[I]|=U&255,U>>>=8,b[I+1]=U,R+8}function Ul(b,R,U){var O=R&7,I=R>>>3;return U<<=O,b[I]|=U&255,U>>>=8,b[I+1]=U&255,b[I+2]=U>>>8,R+16}function hs(b,R){var U=b.length,O=2*U>R?2*U:R+5,I=0;if(U>=R)return b;if(nt){var F=F1(O);if(b.copy)b.copy(F);else for(;I<b.length;++I)F[I]=b[I];return F}else if(we){var ne=new Uint8Array(O);if(ne.set)ne.set(b);else for(;I<U;++I)ne[I]=b[I];return ne}return b.length=O,b}function Ct(b){for(var R=new Array(b),U=0;U<b;++U)R[U]=0;return R}function li(b,R,U){var O=1,I=0,F=0,ne=0,he=0,re=b.length,ie=we?new Uint16Array(32):Ct(32);for(F=0;F<32;++F)ie[F]=0;for(F=re;F<U;++F)b[F]=0;re=b.length;var le=we?new Uint16Array(re):Ct(re);for(F=0;F<re;++F)ie[I=b[F]]++,O<I&&(O=I),le[F]=0;for(ie[0]=0,F=1;F<=O;++F)ie[F+16]=he=he+ie[F-1]<<1;for(F=0;F<re;++F)he=b[F],he!=0&&(le[F]=ie[he+16]++);var xe=0;for(F=0;F<re;++F)if(xe=b[F],xe!=0)for(he=Ve(le[F],O)>>O-xe,ne=(1<<O+4-xe)-1;ne>=0;--ne)R[he|ne<<xe]=xe&15|F<<4;return O}var ci=we?new Uint16Array(512):Ct(512),oi=we?new Uint16Array(32):Ct(32);if(!we){for(var La=0;La<512;++La)ci[La]=0;for(La=0;La<32;++La)oi[La]=0}(function(){for(var b=[],R=0;R<32;R++)b.push(5);li(b,oi,32);var U=[];for(R=0;R<=143;R++)U.push(8);for(;R<=255;R++)U.push(9);for(;R<=279;R++)U.push(7);for(;R<=287;R++)U.push(8);li(U,ci,288)})();var Io=(function(){for(var R=we?new Uint8Array(32768):[],U=0,O=0;U<Ce.length-1;++U)for(;O<Ce[U+1];++O)R[O]=U;for(;O<32768;++O)R[O]=29;var I=we?new Uint8Array(259):[];for(U=0,O=0;U<ce.length-1;++U)for(;O<ce[U+1];++O)I[O]=U;function F(he,re){for(var ie=0;ie<he.length;){var le=Math.min(65535,he.length-ie),xe=ie+le==he.length;for(re.write_shift(1,+xe),re.write_shift(2,le),re.write_shift(2,~le&65535);le-- >0;)re[re.l++]=he[ie++]}return re.l}function ne(he,re){for(var ie=0,le=0,xe=we?new Uint16Array(32768):[];le<he.length;){var Te=Math.min(65535,he.length-le);if(Te<10){for(ie=wa(re,ie,+(le+Te==he.length)),ie&7&&(ie+=8-(ie&7)),re.l=ie/8|0,re.write_shift(2,Te),re.write_shift(2,~Te&65535);Te-- >0;)re[re.l++]=he[le++];ie=re.l*8;continue}ie=wa(re,ie,+(le+Te==he.length)+2);for(var Me=0;Te-- >0;){var ye=he[le];Me=(Me<<5^ye)&32767;var De=-1,Ie=0;if((De=xe[Me])&&(De|=le&-32768,De>le&&(De-=32768),De<le))for(;he[De+Ie]==he[le+Ie]&&Ie<250;)++Ie;if(Ie>2){ye=I[Ie],ye<=22?ie=hn(re,ie,Ae[ye+1]>>1)-1:(hn(re,ie,3),ie+=5,hn(re,ie,Ae[ye-23]>>5),ie+=3);var gt=ye<8?0:ye-4>>2;gt>0&&(Ul(re,ie,Ie-ce[ye]),ie+=gt),ye=R[le-De],ie=hn(re,ie,Ae[ye]>>3),ie-=3;var pt=ye<4?0:ye-2>>1;pt>0&&(Ul(re,ie,le-De-Ce[ye]),ie+=pt);for(var Tt=0;Tt<Ie;++Tt)xe[Me]=le&32767,Me=(Me<<5^he[le])&32767,++le;Te-=Ie-1}else ye<=143?ye=ye+48:ie=en(re,ie,1),ie=hn(re,ie,Ae[ye]),xe[Me]=le&32767,++le}ie=hn(re,ie,0)-1}return re.l=(ie+7)/8|0,re.l}return function(re,ie){return re.length<8?F(re,ie):ne(re,ie)}})();function ms(b){var R=fe(50+Math.floor(b.length*1.1)),U=Io(b,R);return R.slice(0,U)}var Ol=we?new Uint16Array(32768):Ct(32768),Il=we?new Uint16Array(32768):Ct(32768),qn=we?new Uint16Array(128):Ct(128),na=1,tn=1;function oa(b,R){var U=vt(b,R)+257;R+=5;var O=vt(b,R)+1;R+=5;var I=_a(b,R)+4;R+=4;for(var F=0,ne=we?new Uint8Array(19):Ct(19),he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,ie=we?new Uint8Array(8):Ct(8),le=we?new Uint8Array(8):Ct(8),xe=ne.length,Te=0;Te<I;++Te)ne[Y[Te]]=F=We(b,R),re<F&&(re=F),ie[F]++,R+=3;var Me=0;for(ie[0]=0,Te=1;Te<=re;++Te)le[Te]=Me=Me+ie[Te-1]<<1;for(Te=0;Te<xe;++Te)(Me=ne[Te])!=0&&(he[Te]=le[Me]++);var ye=0;for(Te=0;Te<xe;++Te)if(ye=ne[Te],ye!=0){Me=Ae[he[Te]]>>8-ye;for(var De=(1<<7-ye)-1;De>=0;--De)qn[Me|De<<ye]=ye&7|Te<<3}var Ie=[];for(re=1;Ie.length<U+O;)switch(Me=qn[Ue(b,R)],R+=Me&7,Me>>>=3){case 16:for(F=3+Kt(b,R),R+=2,Me=Ie[Ie.length-1];F-- >0;)Ie.push(Me);break;case 17:for(F=3+We(b,R),R+=3;F-- >0;)Ie.push(0);break;case 18:for(F=11+Ue(b,R),R+=7;F-- >0;)Ie.push(0);break;default:Ie.push(Me),re<Me&&(re=Me);break}var gt=Ie.slice(0,U),pt=Ie.slice(U);for(Te=U;Te<286;++Te)gt[Te]=0;for(Te=O;Te<30;++Te)pt[Te]=0;return na=li(gt,Ol,286),tn=li(pt,Il,30),R}function Ro(b,R){if(b[0]==3&&!(b[1]&3))return[Zr(R),2];for(var U=0,O=0,I=F1(R||1<<18),F=0,ne=I.length>>>0,he=0,re=0;(O&1)==0;){if(O=We(b,U),U+=3,O>>>1)O>>1==1?(he=9,re=5):(U=oa(b,U),he=na,re=tn);else{U&7&&(U+=8-(U&7));var ie=b[U>>>3]|b[(U>>>3)+1]<<8;if(U+=32,ie>0)for(!R&&ne<F+ie&&(I=hs(I,F+ie),ne=I.length);ie-- >0;)I[F++]=b[U>>>3],U+=8;continue}for(;;){!R&&ne<F+32767&&(I=hs(I,F+32767),ne=I.length);var le=ca(b,U,he),xe=O>>>1==1?ci[le]:Ol[le];if(U+=xe&15,xe>>>=4,(xe>>>8&255)===0)I[F++]=xe;else{if(xe==256)break;xe-=257;var Te=xe<8?0:xe-4>>2;Te>5&&(Te=0);var Me=F+ce[xe];Te>0&&(Me+=ca(b,U,Te),U+=Te),le=ca(b,U,re),xe=O>>>1==1?oi[le]:Il[le],U+=xe&15,xe>>>=4;var ye=xe<4?0:xe-2>>1,De=Ce[xe];for(ye>0&&(De+=ca(b,U,ye),U+=ye),!R&&ne<Me&&(I=hs(I,Me+100),ne=I.length);F<Me;)I[F]=I[F-De],++F}}}return R?[I,U+7>>>3]:[I.slice(0,F),U+7>>>3]}function Rl(b,R){var U=b.slice(b.l||0),O=Ro(U,R);return b.l+=O[1],O[0]}function Fl(b,R){if(b)typeof console<"u"&&console.error(R);else throw new Error(R)}function Dr(b,R){var U=b;Oa(U,0);var O=[],I=[],F={FileIndex:O,FullPaths:I};B(F,{root:R.root});for(var ne=U.length-4;(U[ne]!=80||U[ne+1]!=75||U[ne+2]!=5||U[ne+3]!=6)&&ne>=0;)--ne;U.l=ne+4,U.l+=4;var he=U.read_shift(2);U.l+=6;var re=U.read_shift(4);for(U.l=re,ne=0;ne<he;++ne){U.l+=20;var ie=U.read_shift(4),le=U.read_shift(4),xe=U.read_shift(2),Te=U.read_shift(2),Me=U.read_shift(2);U.l+=8;var ye=U.read_shift(4),De=h(U.slice(U.l+xe,U.l+xe+Te));U.l+=xe+Te+Me;var Ie=U.l;U.l=ye+4,ui(U,ie,le,F,De),U.l=Ie}return F}function ui(b,R,U,O,I){b.l+=2;var F=b.read_shift(2),ne=b.read_shift(2),he=f(b);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var re=b.read_shift(4),ie=b.read_shift(4),le=b.read_shift(4),xe=b.read_shift(2),Te=b.read_shift(2),Me="",ye=0;ye<xe;++ye)Me+=String.fromCharCode(b[b.l++]);if(Te){var De=h(b.slice(b.l,b.l+Te));(De[21589]||{}).mt&&(he=De[21589].mt),((I||{})[21589]||{}).mt&&(he=I[21589].mt)}b.l+=Te;var Ie=b.slice(b.l,b.l+ie);switch(ne){case 8:Ie=V(b,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var gt=!1;F&8&&(re=b.read_shift(4),re==134695760&&(re=b.read_shift(4),gt=!0),ie=b.read_shift(4),le=b.read_shift(4)),ie!=R&&Fl(gt,"Bad compressed size: "+R+" != "+ie),le!=U&&Fl(gt,"Bad uncompressed size: "+U+" != "+le),hi(O,Me,Ie,{unsafe:!0,mt:he})}function fi(b,R){var U=R||{},O=[],I=[],F=fe(1),ne=U.compression?8:0,he=0,re=0,ie=0,le=0,xe=0,Te=b.FullPaths[0],Me=Te,ye=b.FileIndex[0],De=[],Ie=0;for(re=1;re<b.FullPaths.length;++re)if(Me=b.FullPaths[re].slice(Te.length),ye=b.FileIndex[re],!(!ye.size||!ye.content||Me=="Sh33tJ5")){var gt=le,pt=fe(Me.length);for(ie=0;ie<Me.length;++ie)pt.write_shift(1,Me.charCodeAt(ie)&127);pt=pt.slice(0,pt.l),De[xe]=M2.buf(ye.content,0);var Tt=ye.content;ne==8&&(Tt=P(Tt)),F=fe(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,he),F.write_shift(2,ne),ye.mt?u(F,ye.mt):F.write_shift(4,0),F.write_shift(-4,De[xe]),F.write_shift(4,Tt.length),F.write_shift(4,ye.content.length),F.write_shift(2,pt.length),F.write_shift(2,0),le+=F.length,O.push(F),le+=pt.length,O.push(pt),le+=Tt.length,O.push(Tt),F=fe(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,he),F.write_shift(2,ne),F.write_shift(4,0),F.write_shift(-4,De[xe]),F.write_shift(4,Tt.length),F.write_shift(4,ye.content.length),F.write_shift(2,pt.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,gt),Ie+=F.l,I.push(F),Ie+=pt.length,I.push(pt),++xe}return F=fe(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,xe),F.write_shift(2,xe),F.write_shift(4,Ie),F.write_shift(4,le),F.write_shift(2,0),Zt([Zt(O),Zt(I),F])}var Ba={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function di(b,R){if(b.ctype)return b.ctype;var U=b.name||"",O=U.match(/\.([^\.]+)$/);return O&&Ba[O[1]]||R&&(O=(U=R).match(/[\.\\]([^\.\\])+$/),O&&Ba[O[1]])?Ba[O[1]]:"application/octet-stream"}function Mr(b){for(var R=Cl(b),U=[],O=0;O<R.length;O+=76)U.push(R.slice(O,O+76));return U.join(`\r
`)+`\r
`}function Fo(b){var R=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ie){var le=ie.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],O=R.split(`\r
`),I=0;I<O.length;++I){var F=O[I];if(F.length==0){U.push("");continue}for(var ne=0;ne<F.length;){var he=76,re=F.slice(ne,ne+he);re.charAt(he-1)=="="?he--:re.charAt(he-2)=="="?he-=2:re.charAt(he-3)=="="&&(he-=3),re=F.slice(ne,ne+he),ne+=he,ne<F.length&&(re+="="),U.push(re)}}return U.join(`\r
`)}function Ll(b){for(var R=[],U=0;U<b.length;++U){for(var O=b[U];U<=b.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+b[++U];R.push(O)}for(var I=0;I<R.length;++I)R[I]=R[I].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return un(R.join(`\r
`))}function vs(b,R,U){for(var O="",I="",F="",ne,he=0;he<10;++he){var re=R[he];if(!re||re.match(/^\s*$/))break;var ie=re.match(/^(.*?):\s*([^\s].*)$/);if(ie)switch(ie[1].toLowerCase()){case"content-location":O=ie[2].trim();break;case"content-type":F=ie[2].trim();break;case"content-transfer-encoding":I=ie[2].trim();break}}switch(++he,I.toLowerCase()){case"base64":ne=un(Vn(R.slice(he).join("")));break;case"quoted-printable":ne=Ll(R.slice(he));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var le=hi(b,O.slice(U.length),ne,{unsafe:!0});F&&(le.ctype=F)}function jr(b,R){if(Ne(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=R&&R.root||"",O=(nt&&Buffer.isBuffer(b)?b.toString("binary"):Ne(b)).split(`\r
`),I=0,F="";for(I=0;I<O.length;++I)if(F=O[I],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),U||(U=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),F.slice(0,U.length)!=U););var ne=(O[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var he="--"+(ne[1]||""),re=[],ie=[],le={FileIndex:re,FullPaths:ie};B(le);var xe,Te=0;for(I=0;I<O.length;++I){var Me=O[I];Me!==he&&Me!==he+"--"||(Te++&&vs(le,O.slice(xe,I),U),xe=I)}return le}function Lo(b,R){var U=R||{},O=U.boundary||"SheetJS";O="------="+O;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],F=b.FullPaths[0],ne=F,he=b.FileIndex[0],re=1;re<b.FullPaths.length;++re)if(ne=b.FullPaths[re].slice(F.length),he=b.FileIndex[re],!(!he.size||!he.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var ie=he.content,le=nt&&Buffer.isBuffer(ie)?ie.toString("binary"):Ne(ie),xe=0,Te=Math.min(1024,le.length),Me=0,ye=0;ye<=Te;++ye)(Me=le.charCodeAt(ye))>=32&&Me<128&&++xe;var De=xe>=Te*4/5;I.push(O),I.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+ne),I.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),I.push("Content-Type: "+di(he,ne)),I.push(""),I.push(De?Fo(le):Mr(le))}return I.push(O+`--\r
`),I.join(`\r
`)}function Bl(b){var R={};return B(R,b),R}function hi(b,R,U,O){var I=O&&O.unsafe;I||B(b);var F=!I&&ht.find(b,R);if(!F){var ne=b.FullPaths[0];R.slice(0,ne.length)==ne?ne=R:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+R).replace("//","/")),F={name:l(R),type:2},b.FileIndex.push(F),b.FullPaths.push(ne),I||ht.utils.cfb_gc(b)}return F.content=U,F.size=U?U.length:0,O&&(O.CLSID&&(F.clsid=O.CLSID),O.mt&&(F.mt=O.mt),O.ct&&(F.ct=O.ct)),F}function Kl(b,R){B(b);var U=ht.find(b,R);if(U){for(var O=0;O<b.FileIndex.length;++O)if(b.FileIndex[O]==U)return b.FileIndex.splice(O,1),b.FullPaths.splice(O,1),!0}return!1}function gs(b,R,U){B(b);var O=ht.find(b,R);if(O){for(var I=0;I<b.FileIndex.length;++I)if(b.FileIndex[I]==O)return b.FileIndex[I].name=l(U),b.FullPaths[I]=U,!0}return!1}function ps(b){L(b,!0)}return n.find=D,n.read=J,n.parse=p,n.write=Le,n.writeFile=ke,n.utils={cfb_new:Bl,cfb_add:hi,cfb_del:Kl,cfb_mov:gs,cfb_gc:ps,ReadShift:gl,CheckField:cg,prep_blob:Oa,bconcat:Zt,use_zlib:j,_deflateRaw:ms,_inflateRaw:Rl,consts:ge},n})();function j2(a){return typeof a=="string"?No(a):Array.isArray(a)?n2(a):a}function Al(a,n,t){if(typeof Deno<"u"){if(t&&typeof n=="string")switch(t){case"utf8":n=new TextEncoder(t).encode(n);break;case"binary":n=No(n);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(a,n)}var i=t=="utf8"?El(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,a);if(typeof Blob<"u"){var l=new Blob([j2(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(l,a);if(typeof saveAs<"u")return saveAs(l,a);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var u=URL.createObjectURL(l);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),chrome.downloads.download({url:u,filename:a,saveAs:!0});var f=document.createElement("a");if(f.download!=null)return f.download=a,f.href=u,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),u}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(a);return h.open("w"),h.encoding="binary",Array.isArray(n)&&(n=Nl(n)),h.write(n),h.close(),n}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+a)}function aa(a){for(var n=Object.keys(a),t=[],i=0;i<n.length;++i)Object.prototype.hasOwnProperty.call(a,n[i])&&t.push(n[i]);return t}function W1(a,n){for(var t=[],i=aa(a),l=0;l!==i.length;++l)t[a[i[l]][n]]==null&&(t[a[i[l]][n]]=i[l]);return t}function Sf(a){for(var n=[],t=aa(a),i=0;i!==t.length;++i)n[a[t[i]]]=t[i];return n}function Mo(a){for(var n=[],t=aa(a),i=0;i!==t.length;++i)n[a[t[i]]]=parseInt(t[i],10);return n}function k2(a){for(var n=[],t=aa(a),i=0;i!==t.length;++i)n[a[t[i]]]==null&&(n[a[t[i]]]=[]),n[a[t[i]]].push(t[i]);return n}var mo=new Date(1899,11,30,0,0,0);function Ta(a,n){var t=a.getTime(),i=mo.getTime()+(a.getTimezoneOffset()-mo.getTimezoneOffset())*6e4;return(t-i)/(1440*60*1e3)}var Wv=new Date,U2=mo.getTime()+(Wv.getTimezoneOffset()-mo.getTimezoneOffset())*6e4,V1=Wv.getTimezoneOffset();function Vv(a){var n=new Date;return n.setTime(a*24*60*60*1e3+U2),n.getTimezoneOffset()!==V1&&n.setTime(n.getTime()+(n.getTimezoneOffset()-V1)*6e4),n}var Y1=new Date("2017-02-19T19:06:09.000Z"),Yv=isNaN(Y1.getFullYear())?new Date("2/19/17"):Y1,O2=Yv.getFullYear()==2017;function ha(a,n){var t=new Date(a);if(O2)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(a instanceof Date)return a;if(Yv.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return a.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var l=a.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+l[0],+l[1]-1,+l[2],+l[3]||0,+l[4]||0,+l[5]||0);return a.indexOf("Z")>-1&&(u=new Date(u.getTime()-u.getTimezoneOffset()*60*1e3)),u}function jo(a,n){if(nt&&Buffer.isBuffer(a))return a.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(u){return t[u]||u})}catch{}for(var i=[],l=0;l!=a.length;++l)i.push(String.fromCharCode(a[l]));return i.join("")}function Ea(a){if(typeof JSON<"u"&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if(typeof a!="object"||a==null)return a;if(a instanceof Date)return new Date(a.getTime());var n={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=Ea(a[t]));return n}function bt(a,n){for(var t="";t.length<n;)t+=a;return t}function Gn(a){var n=Number(a);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(a))return n;var t=1,i=a.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(i))||(i=i.replace(/[(](.*)[)]/,function(l,u){return t=-t,u}),!isNaN(n=Number(i)))?n/t:n}var I2=["january","february","march","april","may","june","july","august","september","october","november","december"];function Tl(a){var n=new Date(a),t=new Date(NaN),i=n.getYear(),l=n.getMonth(),u=n.getDate();if(isNaN(u))return t;var f=a.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&I2.indexOf(f)==-1)return t}else if(f.match(/[a-z]/))return t;return i<0||i>8099?t:(l>0||u>1)&&i!=101?n:a.match(/[^-0-9:,\/\\]/)?t:n}function Ge(a,n,t){if(a.FullPaths){if(typeof t=="string"){var i;return nt?i=Xn(t):i=r2(t),ht.utils.cfb_add(a,n,i)}ht.utils.cfb_add(a,n,t)}else a.file(n,t)}function yf(){return ht.utils.cfb_new()}var Rt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Cf=Sf(R2),Tf=/[&<>'"]/g,F2=/[\u0000-\u0008\u000b-\u001f]/g;function ct(a){var n=a+"";return n.replace(Tf,function(t){return Cf[t]}).replace(F2,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function X1(a){return ct(a).replace(/ /g,"_x0020_")}var Xv=/[\u0000-\u001f]/g;function L2(a){var n=a+"";return n.replace(Tf,function(t){return Cf[t]}).replace(/\n/g,"<br/>").replace(Xv,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function B2(a){var n=a+"";return n.replace(Tf,function(t){return Cf[t]}).replace(Xv,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function K2(a){return a.replace(/(\r\n|[\r\n])/g,"&#10;")}function P2(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function tf(a){for(var n="",t=0,i=0,l=0,u=0,f=0,h=0;t<a.length;){if(i=a.charCodeAt(t++),i<128){n+=String.fromCharCode(i);continue}if(l=a.charCodeAt(t++),i>191&&i<224){f=(i&31)<<6,f|=l&63,n+=String.fromCharCode(f);continue}if(u=a.charCodeAt(t++),i<240){n+=String.fromCharCode((i&15)<<12|(l&63)<<6|u&63);continue}f=a.charCodeAt(t++),h=((i&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536,n+=String.fromCharCode(55296+(h>>>10&1023)),n+=String.fromCharCode(56320+(h&1023))}return n}function q1(a){var n=Zr(2*a.length),t,i,l=1,u=0,f=0,h;for(i=0;i<a.length;i+=l)l=1,(h=a.charCodeAt(i))<128?t=h:h<224?(t=(h&31)*64+(a.charCodeAt(i+1)&63),l=2):h<240?(t=(h&15)*4096+(a.charCodeAt(i+1)&63)*64+(a.charCodeAt(i+2)&63),l=3):(l=4,t=(h&7)*262144+(a.charCodeAt(i+1)&63)*4096+(a.charCodeAt(i+2)&63)*64+(a.charCodeAt(i+3)&63),t-=65536,f=55296+(t>>>10&1023),t=56320+(t&1023)),f!==0&&(n[u++]=f&255,n[u++]=f>>>8,f=0),n[u++]=t%256,n[u++]=t>>>8;return n.slice(0,u).toString("ucs2")}function J1(a){return Xn(a,"binary").toString("utf8")}var ao="foo bar baz",vl=nt&&(J1(ao)==tf(ao)&&J1||q1(ao)==tf(ao)&&q1)||tf,El=nt?function(a){return Xn(a,"utf8").toString("binary")}:function(a){for(var n=[],t=0,i=0,l=0;t<a.length;)switch(i=a.charCodeAt(t++),!0){case i<128:n.push(String.fromCharCode(i));break;case i<2048:n.push(String.fromCharCode(192+(i>>6))),n.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,l=a.charCodeAt(t++)-56320+(i<<10),n.push(String.fromCharCode(240+(l>>18&7))),n.push(String.fromCharCode(144+(l>>12&63))),n.push(String.fromCharCode(128+(l>>6&63))),n.push(String.fromCharCode(128+(l&63)));break;default:n.push(String.fromCharCode(224+(i>>12))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)))}return n.join("")},z2=(function(){var a=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),l=0;l<a.length;++l)i=i.replace(a[l][0],a[l][1]);return i}})(),qv=/(^\s|\s$|\n)/;function ea(a,n){return"<"+a+(n.match(qv)?' xml:space="preserve"':"")+">"+n+"</"+a+">"}function _l(a){return aa(a).map(function(n){return" "+n+'="'+a[n]+'"'}).join("")}function Ee(a,n,t){return"<"+a+(t!=null?_l(t):"")+(n!=null?(n.match(qv)?' xml:space="preserve"':"")+">"+n+"</"+a:"/")+">"}function df(a,n){try{return a.toISOString().replace(/\.\d*/,"")}catch(t){if(n)throw t}return""}function H2(a,n){switch(typeof a){case"string":var t=Ee("vt:lpwstr",ct(a));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ee((a|0)==a?"vt:i4":"vt:r8",ct(String(a)));case"boolean":return Ee("vt:bool",a?"true":"false")}if(a instanceof Date)return Ee("vt:filetime",df(a));throw new Error("Unable to serialize "+a)}var zt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ls=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ia={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function G2(a,n){for(var t=1-2*(a[n+7]>>>7),i=((a[n+7]&127)<<4)+(a[n+6]>>>4&15),l=a[n+6]&15,u=5;u>=0;--u)l=l*256+a[n+u];return i==2047?l==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,l+=Math.pow(2,52)),t*Math.pow(2,i-52)*l)}function W2(a,n,t){var i=(n<0||1/n==-1/0?1:0)<<7,l=0,u=0,f=i?-n:n;isFinite(f)?f==0?l=u=0:(l=Math.floor(Math.log(f)/Math.LN2),u=f*Math.pow(2,52-l),l<=-1023&&(!isFinite(u)||u<Math.pow(2,52))?l=-1022:(u-=Math.pow(2,52),l+=1023)):(l=2047,u=isNaN(n)?26985:0);for(var h=0;h<=5;++h,u/=256)a[t+h]=u&255;a[t+6]=(l&15)<<4|u&15,a[t+7]=l>>4|i}var $1=function(a){for(var n=[],t=10240,i=0;i<a[0].length;++i)if(a[0][i])for(var l=0,u=a[0][i].length;l<u;l+=t)n.push.apply(n,a[0][i].slice(l,l+t));return n},Q1=nt?function(a){return a[0].length>0&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(n){return Buffer.isBuffer(n)?n:Xn(n)})):$1(a)}:$1,Z1=function(a,n,t){for(var i=[],l=n;l<t;l+=2)i.push(String.fromCharCode(dl(a,l)));return i.join("").replace(ml,"")},Ef=nt?function(a,n,t){return Buffer.isBuffer(a)?a.toString("utf16le",n,t).replace(ml,""):Z1(a,n,t)}:Z1,ev=function(a,n,t){for(var i=[],l=n;l<n+t;++l)i.push(("0"+a[l].toString(16)).slice(-2));return i.join("")},Jv=nt?function(a,n,t){return Buffer.isBuffer(a)?a.toString("hex",n,n+t):ev(a,n,t)}:ev,tv=function(a,n,t){for(var i=[],l=n;l<t;l++)i.push(String.fromCharCode($i(a,l)));return i.join("")},Dl=nt?function(n,t,i){return Buffer.isBuffer(n)?n.toString("utf8",t,i):tv(n,t,i)}:tv,$v=function(a,n){var t=Ra(a,n);return t>0?Dl(a,n+4,n+4+t-1):""},Qv=$v,Zv=function(a,n){var t=Ra(a,n);return t>0?Dl(a,n+4,n+4+t-1):""},eg=Zv,tg=function(a,n){var t=2*Ra(a,n);return t>0?Dl(a,n+4,n+4+t-1):""},ag=tg,ng=function(n,t){var i=Ra(n,t);return i>0?Ef(n,t+4,t+4+i):""},rg=ng,ig=function(a,n){var t=Ra(a,n);return t>0?Dl(a,n+4,n+4+t):""},sg=ig,lg=function(a,n){return G2(a,n)},vo=lg,_f=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};nt&&(Qv=function(n,t){if(!Buffer.isBuffer(n))return $v(n,t);var i=n.readUInt32LE(t);return i>0?n.toString("utf8",t+4,t+4+i-1):""},eg=function(n,t){if(!Buffer.isBuffer(n))return Zv(n,t);var i=n.readUInt32LE(t);return i>0?n.toString("utf8",t+4,t+4+i-1):""},ag=function(n,t){if(!Buffer.isBuffer(n))return tg(n,t);var i=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+i-1)},rg=function(n,t){if(!Buffer.isBuffer(n))return ng(n,t);var i=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+i)},sg=function(n,t){if(!Buffer.isBuffer(n))return ig(n,t);var i=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+i)},vo=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):lg(n,t)},_f=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var $i=function(a,n){return a[n]},dl=function(a,n){return a[n+1]*256+a[n]},V2=function(a,n){var t=a[n+1]*256+a[n];return t<32768?t:(65535-t+1)*-1},Ra=function(a,n){return a[n+3]*(1<<24)+(a[n+2]<<16)+(a[n+1]<<8)+a[n]},Jr=function(a,n){return a[n+3]<<24|a[n+2]<<16|a[n+1]<<8|a[n]},Y2=function(a,n){return a[n]<<24|a[n+1]<<16|a[n+2]<<8|a[n+3]};function gl(a,n){var t="",i,l,u=[],f,h,g,v;switch(n){case"dbcs":if(v=this.l,nt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*a).toString("utf16le");else for(g=0;g<a;++g)t+=String.fromCharCode(dl(this,v)),v+=2;a*=2;break;case"utf8":t=Dl(this,this.l,this.l+a);break;case"utf16le":a*=2,t=Ef(this,this.l,this.l+a);break;case"wstr":return gl.call(this,a,"dbcs");case"lpstr-ansi":t=Qv(this,this.l),a=4+Ra(this,this.l);break;case"lpstr-cp":t=eg(this,this.l),a=4+Ra(this,this.l);break;case"lpwstr":t=ag(this,this.l),a=4+2*Ra(this,this.l);break;case"lpp4":a=4+Ra(this,this.l),t=rg(this,this.l),a&2&&(a+=2);break;case"8lpp4":a=4+Ra(this,this.l),t=sg(this,this.l),a&3&&(a+=4-(a&3));break;case"cstr":for(a=0,t="";(f=$i(this,this.l+a++))!==0;)u.push(Zc(f));t=u.join("");break;case"_wstr":for(a=0,t="";(f=dl(this,this.l+a))!==0;)u.push(Zc(f)),a+=2;a+=2,t=u.join("");break;case"dbcs-cont":for(t="",v=this.l,g=0;g<a;++g){if(this.lens&&this.lens.indexOf(v)!==-1)return f=$i(this,v),this.l=v+1,h=gl.call(this,a-g,f?"dbcs-cont":"sbcs-cont"),u.join("")+h;u.push(Zc(dl(this,v))),v+=2}t=u.join(""),a*=2;break;case"cpstr":case"sbcs-cont":for(t="",v=this.l,g=0;g!=a;++g){if(this.lens&&this.lens.indexOf(v)!==-1)return f=$i(this,v),this.l=v+1,h=gl.call(this,a-g,f?"dbcs-cont":"sbcs-cont"),u.join("")+h;u.push(Zc($i(this,v))),v+=1}t=u.join("");break;default:switch(a){case 1:return i=$i(this,this.l),this.l++,i;case 2:return i=(n==="i"?V2:dl)(this,this.l),this.l+=2,i;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(i=(a>0?Jr:Y2)(this,this.l),this.l+=4,i):(l=Ra(this,this.l),this.l+=4,l);case 8:case-8:if(n==="f")return a==8?l=vo(this,this.l):l=vo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,l;a=8;case 16:t=Jv(this,this.l,a);break}}return this.l+=a,t}var X2=function(a,n,t){a[t]=n&255,a[t+1]=n>>>8&255,a[t+2]=n>>>16&255,a[t+3]=n>>>24&255},q2=function(a,n,t){a[t]=n&255,a[t+1]=n>>8&255,a[t+2]=n>>16&255,a[t+3]=n>>24&255},J2=function(a,n,t){a[t]=n&255,a[t+1]=n>>>8&255};function $2(a,n,t){var i=0,l=0;if(t==="dbcs"){for(l=0;l!=n.length;++l)J2(this,n.charCodeAt(l),this.l+2*l);i=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),l=0;l!=n.length;++l)this[this.l+l]=n.charCodeAt(l)&255;i=n.length}else if(t==="hex"){for(;l<a;++l)this[this.l++]=parseInt(n.slice(2*l,2*l+2),16)||0;return this}else if(t==="utf16le"){var u=Math.min(this.l+a,this.length);for(l=0;l<Math.min(n.length,a);++l){var f=n.charCodeAt(l);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<u;)this[this.l++]=0;return this}else switch(a){case 1:i=1,this[this.l]=n&255;break;case 2:i=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:i=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:i=4,X2(this,n,this.l);break;case 8:if(i=8,t==="f"){W2(this,n,this.l);break}case 16:break;case-4:i=4,q2(this,n,this.l);break}return this.l+=i,this}function cg(a,n){var t=Jv(this,this.l,a.length>>1);if(t!==a)throw new Error(n+"Expected "+a+" saw "+t);this.l+=a.length>>1}function Oa(a,n){a.l=n,a.read_shift=gl,a.chk=cg,a.write_shift=$2}function Tn(a,n){a.l+=n}function fe(a){var n=Zr(a);return Oa(n,0),n}function Ca(){var a=[],n=nt?256:2048,t=function(v){var p=fe(v);return Oa(p,0),p},i=t(n),l=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&a.push(i),i=null)},u=function(v){return i&&v<i.length-i.l?i:(l(),i=t(Math.max(v+1,n)))},f=function(){return l(),Zt(a)},h=function(v){l(),i=v,i.l==null&&(i.l=i.length),u(n)};return{next:u,push:h,end:f,_bufs:a}}function pe(a,n,t,i){var l=+n,u;if(!isNaN(l)){i||(i=Gw[l].p||(t||[]).length||0),u=1+(l>=128?1:0)+1,i>=128&&++u,i>=16384&&++u,i>=2097152&&++u;var f=a.next(u);l<=127?f.write_shift(1,l):(f.write_shift(1,(l&127)+128),f.write_shift(1,l>>7));for(var h=0;h!=4;++h)if(i>=128)f.write_shift(1,(i&127)+128),i>>=7;else{f.write_shift(1,i);break}i>0&&_f(t)&&a.push(t)}}function pl(a,n,t){var i=Ea(a);if(n.s?(i.cRel&&(i.c+=n.s.c),i.rRel&&(i.r+=n.s.r)):(i.cRel&&(i.c+=n.c),i.rRel&&(i.r+=n.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function av(a,n,t){var i=Ea(a);return i.s=pl(i.s,n.s,t),i.e=pl(i.e,n.s,t),i}function xl(a,n){if(a.cRel&&a.c<0)for(a=Ea(a);a.c<0;)a.c+=n>8?16384:256;if(a.rRel&&a.r<0)for(a=Ea(a);a.r<0;)a.r+=n>8?1048576:n>5?65536:16384;var t=ot(a);return!a.cRel&&a.cRel!=null&&(t=ey(t)),!a.rRel&&a.rRel!=null&&(t=Q2(t)),t}function af(a,n){return a.s.r==0&&!a.s.rRel&&a.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!a.e.rRel?(a.s.cRel?"":"$")+sa(a.s.c)+":"+(a.e.cRel?"":"$")+sa(a.e.c):a.s.c==0&&!a.s.cRel&&a.e.c==(n.biff>=12?16383:255)&&!a.e.cRel?(a.s.rRel?"":"$")+ta(a.s.r)+":"+(a.e.rRel?"":"$")+ta(a.e.r):xl(a.s,n.biff)+":"+xl(a.e,n.biff)}function wf(a){return parseInt(Z2(a),10)-1}function ta(a){return""+(a+1)}function Q2(a){return a.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z2(a){return a.replace(/\$(\d+)$/,"$1")}function bf(a){for(var n=ty(a),t=0,i=0;i!==n.length;++i)t=26*t+n.charCodeAt(i)-64;return t-1}function sa(a){if(a<0)throw new Error("invalid column "+a);var n="";for(++a;a;a=Math.floor((a-1)/26))n=String.fromCharCode((a-1)%26+65)+n;return n}function ey(a){return a.replace(/^([A-Z])/,"$$$1")}function ty(a){return a.replace(/^\$([A-Z])/,"$1")}function ay(a){return a.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ht(a){for(var n=0,t=0,i=0;i<a.length;++i){var l=a.charCodeAt(i);l>=48&&l<=57?n=10*n+(l-48):l>=65&&l<=90&&(t=26*t+(l-64))}return{c:t-1,r:n-1}}function ot(a){for(var n=a.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(a.r+1)}function Fa(a){var n=a.indexOf(":");return n==-1?{s:Ht(a),e:Ht(a)}:{s:Ht(a.slice(0,n)),e:Ht(a.slice(n+1))}}function It(a,n){return typeof n>"u"||typeof n=="number"?It(a.s,a.e):(typeof a!="string"&&(a=ot(a)),typeof n!="string"&&(n=ot(n)),a==n?a:a+":"+n)}function yt(a){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,l=0,u=a.length;for(t=0;i<u&&!((l=a.charCodeAt(i)-64)<1||l>26);++i)t=26*t+l;for(n.s.c=--t,t=0;i<u&&!((l=a.charCodeAt(i)-48)<0||l>9);++i)t=10*t+l;if(n.s.r=--t,i===u||l!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++i,t=0;i!=u&&!((l=a.charCodeAt(i)-64)<1||l>26);++i)t=26*t+l;for(n.e.c=--t,t=0;i!=u&&!((l=a.charCodeAt(i)-48)<0||l>9);++i)t=10*t+l;return n.e.r=--t,n}function nv(a,n){var t=a.t=="d"&&n instanceof Date;if(a.z!=null)try{return a.w=wr(a.z,t?Ta(n):n)}catch{}try{return a.w=wr((a.XF||{}).numFmtId||(t?14:0),t?Ta(n):n)}catch{return""+n}}function Yn(a,n,t){return a==null||a.t==null||a.t=="z"?"":a.w!==void 0?a.w:(a.t=="d"&&!a.z&&t&&t.dateNF&&(a.z=t.dateNF),a.t=="e"?Ml[a.v]||a.v:n==null?nv(a,a.v):nv(a,n))}function ai(a,n){var t=n&&n.sheet?n.sheet:"Sheet1",i={};return i[t]=a,{SheetNames:[t],Sheets:i}}function og(a,n,t){var i=t||{},l=a?Array.isArray(a):i.dense,u=a||(l?[]:{}),f=0,h=0;if(u&&i.origin!=null){if(typeof i.origin=="number")f=i.origin;else{var g=typeof i.origin=="string"?Ht(i.origin):i.origin;f=g.r,h=g.c}u["!ref"]||(u["!ref"]="A1:A1")}var v={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(u["!ref"]){var p=yt(u["!ref"]);v.s.c=p.s.c,v.s.r=p.s.r,v.e.c=Math.max(v.e.c,p.e.c),v.e.r=Math.max(v.e.r,p.e.r),f==-1&&(v.e.r=f=p.e.r+1)}for(var S=0;S!=n.length;++S)if(n[S]){if(!Array.isArray(n[S]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=n[S].length;++x)if(!(typeof n[S][x]>"u")){var C={v:n[S][x]},T=f+S,y=h+x;if(v.s.r>T&&(v.s.r=T),v.s.c>y&&(v.s.c=y),v.e.r<T&&(v.e.r=T),v.e.c<y&&(v.e.c=y),n[S][x]&&typeof n[S][x]=="object"&&!Array.isArray(n[S][x])&&!(n[S][x]instanceof Date))C=n[S][x];else if(Array.isArray(C.v)&&(C.f=n[S][x][1],C.v=C.v[0]),C.v===null)if(C.f)C.t="n";else if(i.nullError)C.t="e",C.v=0;else if(i.sheetStubs)C.t="z";else continue;else typeof C.v=="number"?C.t="n":typeof C.v=="boolean"?C.t="b":C.v instanceof Date?(C.z=i.dateNF||Nt[14],i.cellDates?(C.t="d",C.w=wr(C.z,Ta(C.v))):(C.t="n",C.v=Ta(C.v),C.w=wr(C.z,C.v))):C.t="s";if(l)u[T]||(u[T]=[]),u[T][y]&&u[T][y].z&&(C.z=u[T][y].z),u[T][y]=C;else{var _=ot({c:y,r:T});u[_]&&u[_].z&&(C.z=u[_].z),u[_]=C}}}return v.s.c<1e7&&(u["!ref"]=It(v)),u}function cs(a,n){return og(null,a,n)}function ny(a){return a.read_shift(4,"i")}function dn(a,n){return n||(n=fe(4)),n.write_shift(4,a),n}function la(a){var n=a.read_shift(4);return n===0?"":a.read_shift(n,"dbcs")}function Gt(a,n){var t=!1;return n==null&&(t=!0,n=fe(4+2*a.length)),n.write_shift(4,a.length),a.length>0&&n.write_shift(0,a,"dbcs"),t?n.slice(0,n.l):n}function ry(a){return{ich:a.read_shift(2),ifnt:a.read_shift(2)}}function iy(a,n){return n||(n=fe(4)),n.write_shift(2,0),n.write_shift(2,0),n}function Nf(a,n){var t=a.l,i=a.read_shift(1),l=la(a),u=[],f={t:l,h:l};if((i&1)!==0){for(var h=a.read_shift(4),g=0;g!=h;++g)u.push(ry(a));f.r=u}else f.r=[{ich:0,ifnt:0}];return a.l=t+n,f}function sy(a,n){var t=!1;return n==null&&(t=!0,n=fe(15+4*a.t.length)),n.write_shift(1,0),Gt(a.t,n),t?n.slice(0,n.l):n}var ly=Nf;function cy(a,n){var t=!1;return n==null&&(t=!0,n=fe(23+4*a.t.length)),n.write_shift(1,1),Gt(a.t,n),n.write_shift(4,1),iy({},n),t?n.slice(0,n.l):n}function Za(a){var n=a.read_shift(4),t=a.read_shift(2);return t+=a.read_shift(1)<<16,a.l++,{c:n,iStyleRef:t}}function ni(a,n){return n==null&&(n=fe(8)),n.write_shift(-4,a.c),n.write_shift(3,a.iStyleRef||a.s),n.write_shift(1,0),n}function ri(a){var n=a.read_shift(2);return n+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:n}}function ii(a,n){return n==null&&(n=fe(4)),n.write_shift(3,a.iStyleRef||a.s),n.write_shift(1,0),n}var oy=la,ug=Gt;function Af(a){var n=a.read_shift(4);return n===0||n===4294967295?"":a.read_shift(n,"dbcs")}function go(a,n){var t=!1;return n==null&&(t=!0,n=fe(127)),n.write_shift(4,a.length>0?a.length:4294967295),a.length>0&&n.write_shift(0,a,"dbcs"),t?n.slice(0,n.l):n}var uy=la,hf=Af,Df=go;function fg(a){var n=a.slice(a.l,a.l+4),t=n[0]&1,i=n[0]&2;a.l+=4;var l=i===0?vo([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Jr(n,0)>>2;return t?l/100:l}function dg(a,n){n==null&&(n=fe(4));var t=0,i=0,l=a*100;if(a==(a|0)&&a>=-536870912&&a<1<<29?i=1:l==(l|0)&&l>=-536870912&&l<1<<29&&(i=1,t=1),i)n.write_shift(-4,((t?l:a)<<2)+(t+2));else throw new Error("unsupported RkNumber "+a)}function hg(a){var n={s:{},e:{}};return n.s.r=a.read_shift(4),n.e.r=a.read_shift(4),n.s.c=a.read_shift(4),n.e.c=a.read_shift(4),n}function fy(a,n){return n||(n=fe(16)),n.write_shift(4,a.s.r),n.write_shift(4,a.e.r),n.write_shift(4,a.s.c),n.write_shift(4,a.e.c),n}var si=hg,os=fy;function us(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function ei(a,n){return(n||fe(8)).write_shift(8,a,"f")}function dy(a){var n={},t=a.read_shift(1),i=t>>>1,l=a.read_shift(1),u=a.read_shift(2,"i"),f=a.read_shift(1),h=a.read_shift(1),g=a.read_shift(1);switch(a.l++,i){case 0:n.auto=1;break;case 1:n.index=l;var v=Cy[l];v&&(n.rgb=mv(v));break;case 2:n.rgb=mv([f,h,g]);break;case 3:n.theme=l;break}return u!=0&&(n.tint=u>0?u/32767:u/32768),n}function po(a,n){if(n||(n=fe(8)),!a||a.auto)return n.write_shift(4,0),n.write_shift(4,0),n;a.index!=null?(n.write_shift(1,2),n.write_shift(1,a.index)):a.theme!=null?(n.write_shift(1,6),n.write_shift(1,a.theme)):(n.write_shift(1,5),n.write_shift(1,0));var t=a.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),n.write_shift(2,t),!a.rgb||a.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var i=a.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),n.write_shift(1,parseInt(i.slice(0,2),16)),n.write_shift(1,parseInt(i.slice(2,4),16)),n.write_shift(1,parseInt(i.slice(4,6),16)),n.write_shift(1,255)}return n}function hy(a){var n=a.read_shift(1);a.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function my(a,n){n||(n=fe(2));var t=(a.italic?2:0)|(a.strike?8:0)|(a.outline?16:0)|(a.shadow?32:0)|(a.condense?64:0)|(a.extend?128:0);return n.write_shift(1,t),n.write_shift(1,0),n}var mg=2,Ua=3,no=11,xo=19,ro=64,vy=65,gy=71,py=4108,xy=4126,Qt=80,rv={1:{n:"CodePage",t:mg},2:{n:"Category",t:Qt},3:{n:"PresentationFormat",t:Qt},4:{n:"ByteCount",t:Ua},5:{n:"LineCount",t:Ua},6:{n:"ParagraphCount",t:Ua},7:{n:"SlideCount",t:Ua},8:{n:"NoteCount",t:Ua},9:{n:"HiddenCount",t:Ua},10:{n:"MultimediaClipCount",t:Ua},11:{n:"ScaleCrop",t:no},12:{n:"HeadingPairs",t:py},13:{n:"TitlesOfParts",t:xy},14:{n:"Manager",t:Qt},15:{n:"Company",t:Qt},16:{n:"LinksUpToDate",t:no},17:{n:"CharacterCount",t:Ua},19:{n:"SharedDoc",t:no},22:{n:"HyperlinksChanged",t:no},23:{n:"AppVersion",t:Ua,p:"version"},24:{n:"DigSig",t:vy},26:{n:"ContentType",t:Qt},27:{n:"ContentStatus",t:Qt},28:{n:"Language",t:Qt},29:{n:"Version",t:Qt},255:{},2147483648:{n:"Locale",t:xo},2147483651:{n:"Behavior",t:xo},1919054434:{}},iv={1:{n:"CodePage",t:mg},2:{n:"Title",t:Qt},3:{n:"Subject",t:Qt},4:{n:"Author",t:Qt},5:{n:"Keywords",t:Qt},6:{n:"Comments",t:Qt},7:{n:"Template",t:Qt},8:{n:"LastAuthor",t:Qt},9:{n:"RevNumber",t:Qt},10:{n:"EditTime",t:ro},11:{n:"LastPrinted",t:ro},12:{n:"CreatedDate",t:ro},13:{n:"ModifiedDate",t:ro},14:{n:"PageCount",t:Ua},15:{n:"WordCount",t:Ua},16:{n:"CharCount",t:Ua},17:{n:"Thumbnail",t:gy},18:{n:"Application",t:Qt},19:{n:"DocSecurity",t:Ua},255:{},2147483648:{n:"Locale",t:xo},2147483651:{n:"Behavior",t:xo},1919054434:{}};function Sy(a){return a.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var yy=Sy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Cy=Ea(yy),Ml={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ty={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},io={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function vg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gg(a,n){var t=k2(Ty),i=[],l;i[i.length]=Rt,i[i.length]=Ee("Types",null,{xmlns:zt.CT,"xmlns:xsd":zt.xsd,"xmlns:xsi":zt.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return Ee("Default",null,{Extension:g[0],ContentType:g[1]})}));var u=function(g){a[g]&&a[g].length>0&&(l=a[g][0],i[i.length]=Ee("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:io[g][n.bookType]||io[g].xlsx}))},f=function(g){(a[g]||[]).forEach(function(v){i[i.length]=Ee("Override",null,{PartName:(v[0]=="/"?"":"/")+v,ContentType:io[g][n.bookType]||io[g].xlsx})})},h=function(g){(a[g]||[]).forEach(function(v){i[i.length]=Ee("Override",null,{PartName:(v[0]=="/"?"":"/")+v,ContentType:t[g][0]})})};return u("workbooks"),f("sheets"),f("charts"),h("themes"),["strs","styles"].forEach(u),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),f("metadata"),h("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function pg(a){var n=a.lastIndexOf("/");return a.slice(0,n+1)+"_rels/"+a.slice(n+1)+".rels"}function as(a){var n=[Rt,Ee("Relationships",null,{xmlns:zt.RELS})];return aa(a["!id"]).forEach(function(t){n[n.length]=Ee("Relationship",null,a["!id"][t])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function lt(a,n,t,i,l,u){if(l||(l={}),a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),n<0)for(n=a["!idx"];a["!id"]["rId"+n];++n);if(a["!idx"]=n+1,l.Id="rId"+n,l.Type=i,l.Target=t,[tt.HLINK,tt.XPATH,tt.XMISS].indexOf(l.Type)>-1&&(l.TargetMode="External"),a["!id"][l.Id])throw new Error("Cannot rewrite rId "+n);return a["!id"][l.Id]=l,a[("/"+l.Target).replace("//","/")]=l,n}function Ey(a){var n=[Rt];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<a.length;++t)n.push('  <manifest:file-entry manifest:full-path="'+a[t][0]+'" manifest:media-type="'+a[t][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function sv(a,n,t){return['  <rdf:Description rdf:about="'+a+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function _y(a,n){return['  <rdf:Description rdf:about="'+a+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function wy(a){var n=[Rt];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=a.length;++t)n.push(sv(a[t][0],a[t][1])),n.push(_y("",a[t][0]));return n.push(sv("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function xg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+co.version+"</meta:generator></office:meta></office:document-meta>"}var Qr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function nf(a,n,t,i,l){l[a]!=null||n==null||n===""||(l[a]=n,n=ct(n),i[i.length]=t?Ee(a,n,t):ea(a,n))}function Sg(a,n){var t=n||{},i=[Rt,Ee("cp:coreProperties",null,{"xmlns:cp":zt.CORE_PROPS,"xmlns:dc":zt.dc,"xmlns:dcterms":zt.dcterms,"xmlns:dcmitype":zt.dcmitype,"xmlns:xsi":zt.xsi})],l={};if(!a&&!t.Props)return i.join("");a&&(a.CreatedDate!=null&&nf("dcterms:created",typeof a.CreatedDate=="string"?a.CreatedDate:df(a.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,l),a.ModifiedDate!=null&&nf("dcterms:modified",typeof a.ModifiedDate=="string"?a.ModifiedDate:df(a.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,l));for(var u=0;u!=Qr.length;++u){var f=Qr[u],h=t.Props&&t.Props[f[1]]!=null?t.Props[f[1]]:a?a[f[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&nf(f[0],h,null,i,l)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var ns=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Cg(a){var n=[],t=Ee;return a||(a={}),a.Application="SheetJS",n[n.length]=Rt,n[n.length]=Ee("Properties",null,{xmlns:zt.EXT_PROPS,"xmlns:vt":zt.vt}),ns.forEach(function(i){if(a[i[1]]!==void 0){var l;switch(i[2]){case"string":l=ct(String(a[i[1]]));break;case"bool":l=a[i[1]]?"true":"false";break}l!==void 0&&(n[n.length]=t(i[0],l))}}),n[n.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=t("TitlesOfParts",t("vt:vector",a.SheetNames.map(function(i){return"<vt:lpstr>"+ct(i)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}function Tg(a){var n=[Rt,Ee("Properties",null,{xmlns:zt.CUST_PROPS,"xmlns:vt":zt.vt})];if(!a)return n.join("");var t=1;return aa(a).forEach(function(l){++t,n[n.length]=Ee("property",H2(a[l]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:ct(l)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var lv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function by(a,n){var t=[];return aa(lv).map(function(i){for(var l=0;l<Qr.length;++l)if(Qr[l][1]==i)return Qr[l];for(l=0;l<ns.length;++l)if(ns[l][1]==i)return ns[l];throw i}).forEach(function(i){if(a[i[1]]!=null){var l=n&&n.Props&&n.Props[i[1]]!=null?n.Props[i[1]]:a[i[1]];switch(i[2]){case"date":l=new Date(l).toISOString().replace(/\.\d*Z/,"Z");break}typeof l=="number"?l=String(l):l===!0||l===!1?l=l?"1":"0":l instanceof Date&&(l=new Date(l).toISOString().replace(/\.\d*Z/,"")),t.push(ea(lv[i[1]]||i[1],l))}}),Ee("DocumentProperties",t.join(""),{xmlns:Ia.o})}function Ny(a,n){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",l=[];return a&&aa(a).forEach(function(u){if(Object.prototype.hasOwnProperty.call(a,u)){for(var f=0;f<Qr.length;++f)if(u==Qr[f][1])return;for(f=0;f<ns.length;++f)if(u==ns[f][1])return;for(f=0;f<t.length;++f)if(u==t[f])return;var h=a[u],g="string";typeof h=="number"?(g="float",h=String(h)):h===!0||h===!1?(g="boolean",h=h?"1":"0"):h=String(h),l.push(Ee(X1(u),h,{"dt:dt":g}))}}),n&&aa(n).forEach(function(u){if(Object.prototype.hasOwnProperty.call(n,u)&&!(a&&Object.prototype.hasOwnProperty.call(a,u))){var f=n[u],h="string";typeof f=="number"?(h="float",f=String(f)):f===!0||f===!1?(h="boolean",f=f?"1":"0"):f instanceof Date?(h="dateTime.tz",f=f.toISOString()):f=String(f),l.push(Ee(X1(u),f,{"dt:dt":h}))}}),"<"+i+' xmlns="'+Ia.o+'">'+l.join("")+"</"+i+">"}function Ay(a){var n=typeof a=="string"?new Date(Date.parse(a)):a,t=n.getTime()/1e3+11644473600,i=t%Math.pow(2,32),l=(t-i)/Math.pow(2,32);i*=1e7,l*=1e7;var u=i/Math.pow(2,32)|0;u>0&&(i=i%Math.pow(2,32),l+=u);var f=fe(8);return f.write_shift(4,i),f.write_shift(4,l),f}function cv(a,n){var t=fe(4),i=fe(4);switch(t.write_shift(4,a==80?31:a),a){case 3:i.write_shift(-4,n);break;case 5:i=fe(8),i.write_shift(8,n,"f");break;case 11:i.write_shift(4,n?1:0);break;case 64:i=Ay(n);break;case 31:case 80:for(i=fe(4+2*(n.length+1)+(n.length%2?0:2)),i.write_shift(4,n.length+1),i.write_shift(0,n,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+n)}return Zt([t,i])}var Eg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Dy(a){switch(typeof a){case"boolean":return 11;case"number":return(a|0)==a?3:5;case"string":return 31;case"object":if(a instanceof Date)return 64;break}return-1}function ov(a,n,t){var i=fe(8),l=[],u=[],f=8,h=0,g=fe(8),v=fe(8);if(g.write_shift(4,2),g.write_shift(4,1200),v.write_shift(4,1),u.push(g),l.push(v),f+=8+g.length,!n){v=fe(8),v.write_shift(4,0),l.unshift(v);var p=[fe(4)];for(p[0].write_shift(4,a.length),h=0;h<a.length;++h){var S=a[h][0];for(g=fe(8+2*(S.length+1)+(S.length%2?0:2)),g.write_shift(4,h+2),g.write_shift(4,S.length+1),g.write_shift(0,S,"dbcs");g.l!=g.length;)g.write_shift(1,0);p.push(g)}g=Zt(p),u.unshift(g),f+=8+g.length}for(h=0;h<a.length;++h)if(!(n&&!n[a[h][0]])&&!(Eg.indexOf(a[h][0])>-1||yg.indexOf(a[h][0])>-1)&&a[h][1]!=null){var x=a[h][1],C=0;if(n){C=+n[a[h][0]];var T=t[C];if(T.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}g=cv(T.t,x)}else{var _=Dy(x);_==-1&&(_=31,x=String(x)),g=cv(_,x)}u.push(g),v=fe(8),v.write_shift(4,n?C:2+h),l.push(v),f+=8+g.length}var w=8*(u.length+1);for(h=0;h<u.length;++h)l[h].write_shift(4,w),w+=u[h].length;return i.write_shift(4,f),i.write_shift(4,u.length),Zt([i].concat(l).concat(u))}function uv(a,n,t,i,l,u){var f=fe(l?68:48),h=[f];f.write_shift(2,65534),f.write_shift(2,0),f.write_shift(4,842412599),f.write_shift(16,ht.utils.consts.HEADER_CLSID,"hex"),f.write_shift(4,l?2:1),f.write_shift(16,n,"hex"),f.write_shift(4,l?68:48);var g=ov(a,t,i);if(h.push(g),l){var v=ov(l,null,null);f.write_shift(16,u,"hex"),f.write_shift(4,68+g.length),h.push(v)}return Zt(h)}function My(a,n){n||(n=fe(a));for(var t=0;t<a;++t)n.write_shift(1,0);return n}function jy(a,n){return a.read_shift(n)===1}function da(a,n){return n||(n=fe(2)),n.write_shift(2,+!!a),n}function _g(a){return a.read_shift(2,"u")}function Qa(a,n){return n||(n=fe(2)),n.write_shift(2,a),n}function wg(a,n,t){return t||(t=fe(2)),t.write_shift(1,n=="e"?+a:+!!a),t.write_shift(1,n=="e"?1:0),t}function bg(a,n,t){var i=a.read_shift(t&&t.biff>=12?2:1),l="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var u=a.read_shift(1);u&&(l="dbcs-cont")}else t.biff==12&&(l="wstr");t.biff>=2&&t.biff<=5&&(l="cpstr");var f=i?a.read_shift(i,l):"";return f}function ky(a){var n=a.t||"",t=fe(3);t.write_shift(2,n.length),t.write_shift(1,1);var i=fe(2*n.length);i.write_shift(2*n.length,n,"utf16le");var l=[t,i];return Zt(l)}function Uy(a,n,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return a.read_shift(n,"cpstr");if(t.biff>=12)return a.read_shift(n,"dbcs-cont")}var l=a.read_shift(1);return l===0?i=a.read_shift(n,"sbcs-cont"):i=a.read_shift(n,"dbcs-cont"),i}function Oy(a,n,t){var i=a.read_shift(t&&t.biff==2?1:2);return i===0?(a.l++,""):Uy(a,i,t)}function Iy(a,n,t){if(t.biff>5)return Oy(a,n,t);var i=a.read_shift(1);return i===0?(a.l++,""):a.read_shift(i,t.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function Ng(a,n,t){return t||(t=fe(3+2*a.length)),t.write_shift(2,a.length),t.write_shift(1,1),t.write_shift(31,a,"utf16le"),t}function fv(a,n){n||(n=fe(6+a.length*2)),n.write_shift(4,1+a.length);for(var t=0;t<a.length;++t)n.write_shift(2,a.charCodeAt(t));return n.write_shift(2,0),n}function Ry(a){var n=fe(512),t=0,i=a.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var l=i.indexOf("#"),u=l>-1?31:23;switch(i.charAt(0)){case"#":u=28;break;case".":u&=-3;break}n.write_shift(4,2),n.write_shift(4,u);var f=[8,6815827,6619237,4849780,83];for(t=0;t<f.length;++t)n.write_shift(4,f[t]);if(u==28)i=i.slice(1),fv(i,n);else if(u&2){for(f="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<f.length;++t)n.write_shift(1,parseInt(f[t],16));var h=l>-1?i.slice(0,l):i;for(n.write_shift(4,2*(h.length+1)),t=0;t<h.length;++t)n.write_shift(2,h.charCodeAt(t));n.write_shift(2,0),u&8&&fv(l>-1?i.slice(l+1):"",n)}else{for(f="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<f.length;++t)n.write_shift(1,parseInt(f[t],16));for(var g=0;i.slice(g*3,g*3+3)=="../"||i.slice(g*3,g*3+3)=="..\\";)++g;for(n.write_shift(2,g),n.write_shift(4,i.length-3*g+1),t=0;t<i.length-3*g;++t)n.write_shift(1,i.charCodeAt(t+3*g)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),t=0;t<6;++t)n.write_shift(4,0)}return n.slice(0,n.l)}function ti(a,n,t,i){return i||(i=fe(6)),i.write_shift(2,a),i.write_shift(2,n),i.write_shift(2,t||0),i}function Fy(a,n,t){var i=t.biff>8?4:2,l=a.read_shift(i),u=a.read_shift(i,"i"),f=a.read_shift(i,"i");return[l,u,f]}function Ly(a){var n=a.read_shift(2),t=a.read_shift(2),i=a.read_shift(2),l=a.read_shift(2);return{s:{c:i,r:n},e:{c:l,r:t}}}function Ag(a,n){return n||(n=fe(8)),n.write_shift(2,a.s.r),n.write_shift(2,a.e.r),n.write_shift(2,a.s.c),n.write_shift(2,a.e.c),n}function Mf(a,n,t){var i=1536,l=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,l=8;break;case"biff4":i=4,l=6;break;case"biff3":i=3,l=6;break;case"biff2":i=2,l=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var u=fe(l);return u.write_shift(2,i),u.write_shift(2,n),l>4&&u.write_shift(2,29282),l>6&&u.write_shift(2,1997),l>8&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function By(a,n){var t=!n||n.biff==8,i=fe(t?112:54);for(i.write_shift(n.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function Ky(a,n){var t=!n||n.biff>=8?2:1,i=fe(8+t*a.name.length);i.write_shift(4,a.pos),i.write_shift(1,a.hs||0),i.write_shift(1,a.dt),i.write_shift(1,a.name.length),n.biff>=8&&i.write_shift(1,1),i.write_shift(t*a.name.length,a.name,n.biff<8?"sbcs":"utf16le");var l=i.slice(0,i.l);return l.l=i.l,l}function Py(a,n){var t=fe(8);t.write_shift(4,a.Count),t.write_shift(4,a.Unique);for(var i=[],l=0;l<a.length;++l)i[l]=ky(a[l]);var u=Zt([t].concat(i));return u.parts=[t.length].concat(i.map(function(f){return f.length})),u}function zy(){var a=fe(18);return a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,29280),a.write_shift(2,17600),a.write_shift(2,56),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,1),a.write_shift(2,500),a}function Hy(a){var n=fe(18),t=1718;return a&&a.RTL&&(t|=64),n.write_shift(2,t),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function Gy(a,n){var t=a.name||"Arial",i=n&&n.biff==5,l=i?15+t.length:16+2*t.length,u=fe(l);return u.write_shift(2,a.sz*20),u.write_shift(4,0),u.write_shift(2,400),u.write_shift(4,0),u.write_shift(2,0),u.write_shift(1,t.length),i||u.write_shift(1,1),u.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),u}function Wy(a,n,t,i){var l=fe(10);return ti(a,n,i,l),l.write_shift(4,t),l}function Vy(a,n,t,i,l){var u=!l||l.biff==8,f=fe(8+ +u+(1+u)*t.length);return ti(a,n,i,f),f.write_shift(2,t.length),u&&f.write_shift(1,1),f.write_shift((1+u)*t.length,t,u?"utf16le":"sbcs"),f}function Yy(a,n,t,i){var l=t&&t.biff==5;i||(i=fe(l?3+n.length:5+2*n.length)),i.write_shift(2,a),i.write_shift(l?1:2,n.length),l||i.write_shift(1,1),i.write_shift((l?1:2)*n.length,n,l?"sbcs":"utf16le");var u=i.length>i.l?i.slice(0,i.l):i;return u.l==null&&(u.l=u.length),u}function Xy(a,n){var t=n.biff==8||!n.biff?4:2,i=fe(2*t+6);return i.write_shift(t,a.s.r),i.write_shift(t,a.e.r+1),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c+1),i.write_shift(2,0),i}function dv(a,n,t,i){var l=t&&t.biff==5;i||(i=fe(l?16:20)),i.write_shift(2,0),a.style?(i.write_shift(2,a.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,a.numFmtId||0),i.write_shift(2,n<<4));var u=0;return a.numFmtId>0&&l&&(u|=1024),i.write_shift(4,u),i.write_shift(4,0),l||i.write_shift(4,0),i.write_shift(2,0),i}function qy(a){var n=fe(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function Jy(a,n,t,i,l,u){var f=fe(8);return ti(a,n,i,f),wg(t,u,f),f}function $y(a,n,t,i){var l=fe(14);return ti(a,n,i,l),ei(t,l),l}function Qy(a,n,t){if(t.biff<8)return Zy(a,n,t);for(var i=[],l=a.l+n,u=a.read_shift(t.biff>8?4:2);u--!==0;)i.push(Fy(a,t.biff>8?12:6,t));if(a.l!=l)throw new Error("Bad ExternSheet: "+a.l+" != "+l);return i}function Zy(a,n,t){a[a.l+1]==3&&a[a.l]++;var i=bg(a,n,t);return i.charCodeAt(0)==3?i.slice(1):i}function eC(a){var n=fe(2+a.length*8);n.write_shift(2,a.length);for(var t=0;t<a.length;++t)Ag(a[t],n);return n}function tC(a){var n=fe(24),t=Ht(a[0]);n.write_shift(2,t.r),n.write_shift(2,t.r),n.write_shift(2,t.c),n.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),l=0;l<16;++l)n.write_shift(1,parseInt(i[l],16));return Zt([n,Ry(a[1])])}function aC(a){var n=a[1].Tooltip,t=fe(10+2*(n.length+1));t.write_shift(2,2048);var i=Ht(a[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var l=0;l<n.length;++l)t.write_shift(2,n.charCodeAt(l));return t.write_shift(2,0),t}function nC(a){return a||(a=fe(4)),a.write_shift(2,1),a.write_shift(2,1),a}function rC(a,n,t){if(!t.cellStyles)return Tn(a,n);var i=t&&t.biff>=12?4:2,l=a.read_shift(i),u=a.read_shift(i),f=a.read_shift(i),h=a.read_shift(i),g=a.read_shift(2);i==2&&(a.l+=2);var v={s:l,e:u,w:f,ixfe:h,flags:g};return(t.biff>=5||!t.biff)&&(v.level=g>>8&7),v}function iC(a,n){var t=fe(12);t.write_shift(2,n),t.write_shift(2,n),t.write_shift(2,a.width*256),t.write_shift(2,0);var i=0;return a.hidden&&(i|=1),t.write_shift(1,i),i=a.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function sC(a){for(var n=fe(2*a),t=0;t<a;++t)n.write_shift(2,t+1);return n}function lC(a,n,t){var i=fe(15);return kl(i,a,n),i.write_shift(8,t,"f"),i}function cC(a,n,t){var i=fe(9);return kl(i,a,n),i.write_shift(2,t),i}var oC=(function(){var a={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=Sf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(h,g){var v=[],p=Zr(1);switch(g.type){case"base64":p=un(Vn(h));break;case"binary":p=un(h);break;case"buffer":case"array":p=h;break}Oa(p,0);var S=p.read_shift(1),x=!!(S&136),C=!1,T=!1;switch(S){case 2:break;case 3:break;case 48:C=!0,x=!0;break;case 49:C=!0,x=!0;break;case 131:break;case 139:break;case 140:T=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+S.toString(16))}var y=0,_=521;S==2&&(y=p.read_shift(2)),p.l+=3,S!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),S!=2&&(_=p.read_shift(2));var w=p.read_shift(2),k=g.codepage||1252;S!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(k=a[p[p.l]]),p.l+=1,p.l+=2),T&&(p.l+=36);for(var M=[],N={},K=Math.min(p.length,S==2?521:_-10-(C?264:0)),J=T?32:11;p.l<K&&p[p.l]!=13;)switch(N={},N.name=oo.utils.decode(k,p.slice(p.l,p.l+J)).replace(/[\u0000\r\n].*$/g,""),p.l+=J,N.type=String.fromCharCode(p.read_shift(1)),S!=2&&!T&&(N.offset=p.read_shift(4)),N.len=p.read_shift(1),S==2&&(N.offset=p.read_shift(2)),N.dec=p.read_shift(1),N.name.length&&M.push(N),S!=2&&(p.l+=T?13:14),N.type){case"B":(!C||N.len!=8)&&g.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(p[p.l]!==13&&(p.l=_-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=_;var B=0,Z=0;for(v[0]=[],Z=0;Z!=M.length;++Z)v[0][Z]=M[Z].name;for(;y-- >0;){if(p[p.l]===42){p.l+=w;continue}for(++p.l,v[++B]=[],Z=0,Z=0;Z!=M.length;++Z){var L=p.slice(p.l,p.l+M[Z].len);p.l+=M[Z].len,Oa(L,0);var X=oo.utils.decode(k,L);switch(M[Z].type){case"C":X.trim().length&&(v[B][Z]=X.replace(/\s+$/,""));break;case"D":X.length===8?v[B][Z]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):v[B][Z]=X;break;case"F":v[B][Z]=parseFloat(X.trim());break;case"+":case"I":v[B][Z]=T?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":v[B][Z]=!0;break;case"N":case"F":v[B][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+S.toString(16));v[B][Z]="##MEMO##"+(T?parseInt(X.trim(),10):L.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(v[B][Z]=+X||0);break;case"@":v[B][Z]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":v[B][Z]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":v[B][Z]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":v[B][Z]=-L.read_shift(-8,"f");break;case"B":if(C&&M[Z].len==8){v[B][Z]=L.read_shift(8,"f");break}case"G":case"P":L.l+=M[Z].len;break;case"0":if(M[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+M[Z].type)}}}if(S!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return g&&g.sheetRows&&(v=v.slice(0,g.sheetRows)),g.DBF=M,v}function i(h,g){var v=g||{};v.dateNF||(v.dateNF="yyyymmdd");var p=cs(t(h,v),v);return p["!cols"]=v.DBF.map(function(S){return{wch:S.len,DBF:S}}),delete v.DBF,p}function l(h,g){try{return ai(i(h,g),g)}catch(v){if(g&&g.WTF)throw v}return{SheetNames:[],Sheets:{}}}var u={B:8,C:250,L:1,D:8,"?":0,"":0};function f(h,g){var v=g||{};if(+v.codepage>=0&&yl(+v.codepage),v.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ca(),S=_o(h,{header:1,raw:!0,cellDates:!0}),x=S[0],C=S.slice(1),T=h["!cols"]||[],y=0,_=0,w=0,k=1;for(y=0;y<x.length;++y){if(((T[y]||{}).DBF||{}).name){x[y]=T[y].DBF.name,++w;continue}if(x[y]!=null){if(++w,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(_=0;_<1024;++_)if(x.indexOf(x[y]+"_"+_)==-1){x[y]+="_"+_;break}}}}var M=yt(h["!ref"]),N=[],K=[],J=[];for(y=0;y<=M.e.c-M.s.c;++y){var B="",Z="",L=0,X=[];for(_=0;_<C.length;++_)C[_][y]!=null&&X.push(C[_][y]);if(X.length==0||x[y]==null){N[y]="?";continue}for(_=0;_<X.length;++_){switch(typeof X[_]){case"number":Z="B";break;case"string":Z="C";break;case"boolean":Z="L";break;case"object":Z=X[_]instanceof Date?"D":"C";break;default:Z="C"}L=Math.max(L,String(X[_]).length),B=B&&B!=Z?"C":Z}L>250&&(L=250),Z=((T[y]||{}).DBF||{}).type,Z=="C"&&T[y].DBF.len>L&&(L=T[y].DBF.len),B=="B"&&Z=="N"&&(B="N",J[y]=T[y].DBF.dec,L=T[y].DBF.len),K[y]=B=="C"||Z=="N"?L:u[B]||0,k+=K[y],N[y]=B}var D=p.next(32);for(D.write_shift(4,318902576),D.write_shift(4,C.length),D.write_shift(2,296+32*w),D.write_shift(2,k),y=0;y<4;++y)D.write_shift(4,0);for(D.write_shift(4,0|(+n[Mv]||3)<<8),y=0,_=0;y<x.length;++y)if(x[y]!=null){var z=p.next(32),ue=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,ue,"sbcs"),z.write_shift(1,N[y]=="?"?"C":N[y],"sbcs"),z.write_shift(4,_),z.write_shift(1,K[y]||u[N[y]]||0),z.write_shift(1,J[y]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),_+=K[y]||u[N[y]]||0}var be=p.next(264);for(be.write_shift(4,13),y=0;y<65;++y)be.write_shift(4,0);for(y=0;y<C.length;++y){var Se=p.next(k);for(Se.write_shift(1,0),_=0;_<x.length;++_)if(x[_]!=null)switch(N[_]){case"L":Se.write_shift(1,C[y][_]==null?63:C[y][_]?84:70);break;case"B":Se.write_shift(8,C[y][_]||0,"f");break;case"N":var ee="0";for(typeof C[y][_]=="number"&&(ee=C[y][_].toFixed(J[_]||0)),w=0;w<K[_]-ee.length;++w)Se.write_shift(1,32);Se.write_shift(1,ee,"sbcs");break;case"D":C[y][_]?(Se.write_shift(4,("0000"+C[y][_].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(C[y][_].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+C[y][_].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(C[y][_]!=null?C[y][_]:"").slice(0,K[_]);for(Se.write_shift(1,ge,"sbcs"),w=0;w<K[_]-ge.length;++w)Se.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:l,to_sheet:i,from_sheet:f}})(),uC=(function(){var a={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+aa(a).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,C){var T=a[C];return typeof T=="number"?R1(T):T},i=function(x,C,T){var y=C.charCodeAt(0)-32<<4|T.charCodeAt(0)-48;return y==59?x:R1(y)};a["|"]=254;function l(x,C){switch(C.type){case"base64":return u(Vn(x),C);case"binary":return u(x,C);case"buffer":return u(nt&&Buffer.isBuffer(x)?x.toString("binary"):Nl(x),C);case"array":return u(jo(x),C)}throw new Error("Unrecognized type "+C.type)}function u(x,C){var T=x.split(/[\n\r]+/),y=-1,_=-1,w=0,k=0,M=[],N=[],K=null,J={},B=[],Z=[],L=[],X=0,D;for(+C.codepage>=0&&yl(+C.codepage);w!==T.length;++w){X=0;var z=T[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(n,t),ue=z.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),be=ue[0],Se;if(z.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&N.push(z.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,ge=!1,ke=!1,Ne=!1,Le=-1,H=-1;for(k=1;k<ue.length;++k)switch(ue[k].charAt(0)){case"A":break;case"X":_=parseInt(ue[k].slice(1))-1,ge=!0;break;case"Y":for(y=parseInt(ue[k].slice(1))-1,ge||(_=0),D=M.length;D<=y;++D)M[D]=[];break;case"K":Se=ue[k].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(Gn(Se))?isNaN(Tl(Se).getDate())||(Se=ha(Se)):(Se=Gn(Se),K!==null&&zv(K)&&(Se=Vv(Se))),ee=!0;break;case"E":Ne=!0;var j=cT(ue[k].slice(1),{r:y,c:_});M[y][_]=[M[y][_],j];break;case"S":ke=!0,M[y][_]=[M[y][_],"S5S"];break;case"G":break;case"R":Le=parseInt(ue[k].slice(1))-1;break;case"C":H=parseInt(ue[k].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+z)}if(ee&&(M[y][_]&&M[y][_].length==2?M[y][_][0]=Se:M[y][_]=Se,K=null),ke){if(Ne)throw new Error("SYLK shared formula cannot have own formula");var V=Le>-1&&M[Le][H];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");M[y][_][1]=oT(V[1],{r:y-Le,c:_-H})}break;case"F":var P=0;for(k=1;k<ue.length;++k)switch(ue[k].charAt(0)){case"X":_=parseInt(ue[k].slice(1))-1,++P;break;case"Y":for(y=parseInt(ue[k].slice(1))-1,D=M.length;D<=y;++D)M[D]=[];break;case"M":X=parseInt(ue[k].slice(1))/20;break;case"F":break;case"G":break;case"P":K=N[parseInt(ue[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=ue[k].slice(1).split(" "),D=parseInt(L[0],10);D<=parseInt(L[1],10);++D)X=parseInt(L[2],10),Z[D-1]=X===0?{hidden:!0}:{wch:X},jf(Z[D-1]);break;case"C":_=parseInt(ue[k].slice(1))-1,Z[_]||(Z[_]={});break;case"R":y=parseInt(ue[k].slice(1))-1,B[y]||(B[y]={}),X>0?(B[y].hpt=X,B[y].hpx=Ug(X)):X===0&&(B[y].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+z)}P<1&&(K=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+z)}}return B.length>0&&(J["!rows"]=B),Z.length>0&&(J["!cols"]=Z),C&&C.sheetRows&&(M=M.slice(0,C.sheetRows)),[M,J]}function f(x,C){var T=l(x,C),y=T[0],_=T[1],w=cs(y,C);return aa(_).forEach(function(k){w[k]=_[k]}),w}function h(x,C){return ai(f(x,C),C)}function g(x,C,T,y){var _="C;Y"+(T+1)+";X"+(y+1)+";K";switch(x.t){case"n":_+=x.v||0,x.f&&!x.F&&(_+=";E"+Uf(x.f,{r:T,c:y}));break;case"b":_+=x.v?"TRUE":"FALSE";break;case"e":_+=x.w||x.v;break;case"d":_+='"'+(x.w||x.v)+'"';break;case"s":_+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function v(x,C){C.forEach(function(T,y){var _="F;W"+(y+1)+" "+(y+1)+" ";T.hidden?_+="0":(typeof T.width=="number"&&!T.wpx&&(T.wpx=So(T.width)),typeof T.wpx=="number"&&!T.wch&&(T.wch=yo(T.wpx)),typeof T.wch=="number"&&(_+=Math.round(T.wch))),_.charAt(_.length-1)!=" "&&x.push(_)})}function p(x,C){C.forEach(function(T,y){var _="F;";T.hidden?_+="M0;":T.hpt?_+="M"+20*T.hpt+";":T.hpx&&(_+="M"+20*Co(T.hpx)+";"),_.length>2&&x.push(_+"R"+(y+1))})}function S(x,C){var T=["ID;PWXL;N;E"],y=[],_=yt(x["!ref"]),w,k=Array.isArray(x),M=`\r
`;T.push("P;PGeneral"),T.push("F;P0;DG0G8;M255"),x["!cols"]&&v(T,x["!cols"]),x["!rows"]&&p(T,x["!rows"]),T.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var N=_.s.r;N<=_.e.r;++N)for(var K=_.s.c;K<=_.e.c;++K){var J=ot({r:N,c:K});w=k?(x[N]||[])[K]:x[J],!(!w||w.v==null&&(!w.f||w.F))&&y.push(g(w,x,N,K))}return T.join(M)+M+y.join(M)+M+"E"+M}return{to_workbook:h,to_sheet:f,from_sheet:S}})(),fC=(function(){function a(u,f){switch(f.type){case"base64":return n(Vn(u),f);case"binary":return n(u,f);case"buffer":return n(nt&&Buffer.isBuffer(u)?u.toString("binary"):Nl(u),f);case"array":return n(jo(u),f)}throw new Error("Unrecognized type "+f.type)}function n(u,f){for(var h=u.split(`
`),g=-1,v=-1,p=0,S=[];p!==h.length;++p){if(h[p].trim()==="BOT"){S[++g]=[],v=0;continue}if(!(g<0)){var x=h[p].trim().split(","),C=x[0],T=x[1];++p;for(var y=h[p]||"";(y.match(/["]/g)||[]).length&1&&p<h.length-1;)y+=`
`+h[++p];switch(y=y.trim(),+C){case-1:if(y==="BOT"){S[++g]=[],v=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?S[g][v]=!0:y==="FALSE"?S[g][v]=!1:isNaN(Gn(T))?isNaN(Tl(T).getDate())?S[g][v]=T:S[g][v]=ha(T):S[g][v]=Gn(T),++v;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),S[g][v++]=y!==""?y:null;break}if(y==="EOD")break}}return f&&f.sheetRows&&(S=S.slice(0,f.sheetRows)),S}function t(u,f){return cs(a(u,f),f)}function i(u,f){return ai(t(u,f),f)}var l=(function(){var u=function(g,v,p,S,x){g.push(v),g.push(p+","+S),g.push('"'+x.replace(/"/g,'""')+'"')},f=function(g,v,p,S){g.push(v+","+p),g.push(v==1?'"'+S.replace(/"/g,'""')+'"':S)};return function(g){var v=[],p=yt(g["!ref"]),S,x=Array.isArray(g);u(v,"TABLE",0,1,"sheetjs"),u(v,"VECTORS",0,p.e.r-p.s.r+1,""),u(v,"TUPLES",0,p.e.c-p.s.c+1,""),u(v,"DATA",0,0,"");for(var C=p.s.r;C<=p.e.r;++C){f(v,-1,0,"BOT");for(var T=p.s.c;T<=p.e.c;++T){var y=ot({r:C,c:T});if(S=x?(g[C]||[])[T]:g[y],!S){f(v,1,0,"");continue}switch(S.t){case"n":var _=S.w;!_&&S.v!=null&&(_=S.v),_==null?S.f&&!S.F?f(v,1,0,"="+S.f):f(v,1,0,""):f(v,0,_,"V");break;case"b":f(v,0,S.v?1:0,S.v?"TRUE":"FALSE");break;case"s":f(v,1,0,isNaN(S.v)?S.v:'="'+S.v+'"');break;case"d":S.w||(S.w=wr(S.z||Nt[14],Ta(ha(S.v)))),f(v,0,S.w,"V");break;default:f(v,1,0,"")}}}f(v,-1,0,"EOD");var w=`\r
`,k=v.join(w);return k}})();return{to_workbook:i,to_sheet:t,from_sheet:l}})(),Dg=(function(){function a(S){return S.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(S){return S.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(S,x){for(var C=S.split(`
`),T=-1,y=-1,_=0,w=[];_!==C.length;++_){var k=C[_].trim().split(":");if(k[0]==="cell"){var M=Ht(k[1]);if(w.length<=M.r)for(T=w.length;T<=M.r;++T)w[T]||(w[T]=[]);switch(T=M.r,y=M.c,k[2]){case"t":w[T][y]=a(k[3]);break;case"v":w[T][y]=+k[3];break;case"vtf":var N=k[k.length-1];case"vtc":switch(k[3]){case"nl":w[T][y]=!!+k[4];break;default:w[T][y]=+k[4];break}k[2]=="vtf"&&(w[T][y]=[w[T][y],N])}}}return x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),w}function i(S,x){return cs(t(S,x),x)}function l(S,x){return ai(i(S,x),x)}var u=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function v(S){if(!S||!S["!ref"])return"";for(var x=[],C=[],T,y="",_=Fa(S["!ref"]),w=Array.isArray(S),k=_.s.r;k<=_.e.r;++k)for(var M=_.s.c;M<=_.e.c;++M)if(y=ot({r:k,c:M}),T=w?(S[k]||[])[M]:S[y],!(!T||T.v==null||T.t==="z")){switch(C=["cell",y,"t"],T.t){case"s":case"str":C.push(n(T.v));break;case"n":T.f?(C[2]="vtf",C[3]="n",C[4]=T.v,C[5]=n(T.f)):(C[2]="v",C[3]=T.v);break;case"b":C[2]="vt"+(T.f?"f":"c"),C[3]="nl",C[4]=T.v?"1":"0",C[5]=n(T.f||(T.v?"TRUE":"FALSE"));break;case"d":var N=Ta(ha(T.v));C[2]="vtc",C[3]="nd",C[4]=""+N,C[5]=T.w||wr(T.z||Nt[14],N);break;case"e":continue}x.push(C.join(":"))}return x.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function p(S){return[u,f,h,f,v(S),g].join(`
`)}return{to_workbook:l,to_sheet:i,from_sheet:p}})(),dC=(function(){function a(p,S,x,C,T){T.raw?S[x][C]=p:p===""||(p==="TRUE"?S[x][C]=!0:p==="FALSE"?S[x][C]=!1:isNaN(Gn(p))?isNaN(Tl(p).getDate())?S[x][C]=p:S[x][C]=ha(p):S[x][C]=Gn(p))}function n(p,S){var x=S||{},C=[];if(!p||p.length===0)return C;for(var T=p.split(/[\r\n]/),y=T.length-1;y>=0&&T[y].length===0;)--y;for(var _=10,w=0,k=0;k<=y;++k)w=T[k].indexOf(" "),w==-1?w=T[k].length:w++,_=Math.max(_,w);for(k=0;k<=y;++k){C[k]=[];var M=0;for(a(T[k].slice(0,_).trim(),C,k,M,x),M=1;M<=(T[k].length-_)/10+1;++M)a(T[k].slice(_+(M-1)*10,_+M*10).trim(),C,k,M,x)}return x.sheetRows&&(C=C.slice(0,x.sheetRows)),C}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function l(p){for(var S={},x=!1,C=0,T=0;C<p.length;++C)(T=p.charCodeAt(C))==34?x=!x:!x&&T in t&&(S[T]=(S[T]||0)+1);T=[];for(C in S)Object.prototype.hasOwnProperty.call(S,C)&&T.push([S[C],C]);if(!T.length){S=i;for(C in S)Object.prototype.hasOwnProperty.call(S,C)&&T.push([S[C],C])}return T.sort(function(y,_){return y[0]-_[0]||i[y[1]]-i[_[1]]}),t[T.pop()[1]]||44}function u(p,S){var x=S||{},C="",T=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(C=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(C=p.charAt(4),p=p.slice(6)):C=l(p.slice(0,1024)):x&&x.FS?C=x.FS:C=l(p.slice(0,1024));var _=0,w=0,k=0,M=0,N=0,K=C.charCodeAt(0),J=!1,B=0,Z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var L=x.dateNF!=null?A2(x.dateNF):null;function X(){var D=p.slice(M,N),z={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)z.t="z";else if(x.raw)z.t="s",z.v=D;else if(D.trim().length===0)z.t="s",z.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(z.t="s",z.v=D.slice(2,-1).replace(/""/g,'"')):uT(D)?(z.t="n",z.f=D.slice(1)):(z.t="s",z.v=D);else if(D=="TRUE")z.t="b",z.v=!0;else if(D=="FALSE")z.t="b",z.v=!1;else if(!isNaN(k=Gn(D)))z.t="n",x.cellText!==!1&&(z.w=D),z.v=k;else if(!isNaN(Tl(D).getDate())||L&&D.match(L)){z.z=x.dateNF||Nt[14];var ue=0;L&&D.match(L)&&(D=D2(D,x.dateNF,D.match(L)||[]),ue=1),x.cellDates?(z.t="d",z.v=ha(D,ue)):(z.t="n",z.v=Ta(ha(D,ue))),x.cellText!==!1&&(z.w=wr(z.z,z.v instanceof Date?Ta(z.v):z.v)),x.cellNF||delete z.z}else z.t="s",z.v=D;if(z.t=="z"||(x.dense?(T[_]||(T[_]=[]),T[_][w]=z):T[ot({c:w,r:_})]=z),M=N+1,Z=p.charCodeAt(M),y.e.c<w&&(y.e.c=w),y.e.r<_&&(y.e.r=_),B==K)++w;else if(w=0,++_,x.sheetRows&&x.sheetRows<=_)return!0}e:for(;N<p.length;++N)switch(B=p.charCodeAt(N)){case 34:Z===34&&(J=!J);break;case K:case 10:case 13:if(!J&&X())break e;break}return N-M>0&&X(),T["!ref"]=It(y),T}function f(p,S){return!(S&&S.PRN)||S.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?u(p,S):cs(n(p,S),S)}function h(p,S){var x="",C=S.type=="string"?[0,0,0,0]:_b(p,S);switch(S.type){case"base64":x=Vn(p);break;case"binary":x=p;break;case"buffer":S.codepage==65001?x=p.toString("utf8"):S.codepage&&typeof oo<"u"||(x=nt&&Buffer.isBuffer(p)?p.toString("binary"):Nl(p));break;case"array":x=jo(p);break;case"string":x=p;break;default:throw new Error("Unrecognized type "+S.type)}return C[0]==239&&C[1]==187&&C[2]==191?x=vl(x.slice(3)):S.type!="string"&&S.type!="buffer"&&S.codepage==65001?x=vl(x):S.type=="binary"&&typeof oo<"u",x.slice(0,19)=="socialcalc:version:"?Dg.to_sheet(S.type=="string"?x:vl(x),S):f(x,S)}function g(p,S){return ai(h(p,S),S)}function v(p){for(var S=[],x=yt(p["!ref"]),C,T=Array.isArray(p),y=x.s.r;y<=x.e.r;++y){for(var _=[],w=x.s.c;w<=x.e.c;++w){var k=ot({r:y,c:w});if(C=T?(p[y]||[])[w]:p[k],!C||C.v==null){_.push("          ");continue}for(var M=(C.w||(Yn(C),C.w)||"").slice(0,10);M.length<10;)M+=" ";_.push(M+(w===0?" ":""))}S.push(_.join(""))}return S.join(`
`)}return{to_workbook:g,to_sheet:h,from_sheet:v}})(),hv=(function(){function a(j,V,P){if(j){Oa(j,j.l||0);for(var Y=P.Enum||Le;j.l<j.length;){var ce=j.read_shift(2),Ce=Y[ce]||Y[65535],je=j.read_shift(2),we=j.l+je,Ae=Ce.f&&Ce.f(j,je,P);if(j.l=we,V(Ae,Ce,ce))return}}}function n(j,V){switch(V.type){case"base64":return t(un(Vn(j)),V);case"binary":return t(un(j),V);case"buffer":case"array":return t(j,V)}throw"Unsupported type "+V.type}function t(j,V){if(!j)return j;var P=V||{},Y=P.dense?[]:{},ce="Sheet1",Ce="",je=0,we={},Ae=[],Qe=[],Ve={s:{r:0,c:0},e:{r:0,c:0}},Kt=P.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)P.Enum=Le,a(j,function(Ue,ca,wa){switch(wa){case 0:P.vers=Ue,Ue>=4096&&(P.qpro=!0);break;case 6:Ve=Ue;break;case 204:Ue&&(Ce=Ue);break;case 222:Ce=Ue;break;case 15:case 51:P.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:wa==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=P.dateNF||Nt[14],P.cellDates&&(Ue[1].t="d",Ue[1].v=Vv(Ue[1].v))),P.qpro&&Ue[3]>je&&(Y["!ref"]=It(Ve),we[ce]=Y,Ae.push(ce),Y=P.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},je=Ue[3],ce=Ce||"Sheet"+(je+1),Ce="");var en=P.dense?(Y[Ue[0].r]||[])[Ue[0].c]:Y[ot(Ue[0])];if(en){en.t=Ue[1].t,en.v=Ue[1].v,Ue[1].z!=null&&(en.z=Ue[1].z),Ue[1].f!=null&&(en.f=Ue[1].f);break}P.dense?(Y[Ue[0].r]||(Y[Ue[0].r]=[]),Y[Ue[0].r][Ue[0].c]=Ue[1]):Y[ot(Ue[0])]=Ue[1];break}},P);else if(j[2]==26||j[2]==14)P.Enum=H,j[2]==14&&(P.qpro=!0,j.l=0),a(j,function(Ue,ca,wa){switch(wa){case 204:ce=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>je&&(Y["!ref"]=It(Ve),we[ce]=Y,Ae.push(ce),Y=P.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},je=Ue[3],ce="Sheet"+(je+1)),Kt>0&&Ue[0].r>=Kt)break;P.dense?(Y[Ue[0].r]||(Y[Ue[0].r]=[]),Y[Ue[0].r][Ue[0].c]=Ue[1]):Y[ot(Ue[0])]=Ue[1],Ve.e.c<Ue[0].c&&(Ve.e.c=Ue[0].c),Ve.e.r<Ue[0].r&&(Ve.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(Qe[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:Qe[Ue[0]]=Ue[1],Ue[0]==je&&(ce=Ue[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(Y["!ref"]=It(Ve),we[Ce||ce]=Y,Ae.push(Ce||ce),!Qe.length)return{SheetNames:Ae,Sheets:we};for(var We={},_a=[],vt=0;vt<Qe.length;++vt)we[Ae[vt]]?(_a.push(Qe[vt]||Ae[vt]),We[Qe[vt]]=we[Qe[vt]]||we[Ae[vt]]):(_a.push(Qe[vt]),We[Qe[vt]]={"!ref":"A1"});return{SheetNames:_a,Sheets:We}}function i(j,V){var P=V||{};if(+P.codepage>=0&&yl(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Ca(),ce=yt(j["!ref"]),Ce=Array.isArray(j),je=[];_e(Y,0,u(1030)),_e(Y,6,g(ce));for(var we=Math.min(ce.e.r,8191),Ae=ce.s.r;Ae<=we;++Ae)for(var Qe=ta(Ae),Ve=ce.s.c;Ve<=ce.e.c;++Ve){Ae===ce.s.r&&(je[Ve]=sa(Ve));var Kt=je[Ve]+Qe,We=Ce?(j[Ae]||[])[Ve]:j[Kt];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?_e(Y,13,C(Ae,Ve,We.v)):_e(Y,14,y(Ae,Ve,We.v));else{var _a=Yn(We);_e(Y,15,S(Ae,Ve,_a.slice(0,239)))}}return _e(Y,1),Y.end()}function l(j,V){var P=V||{};if(+P.codepage>=0&&yl(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Ca();_e(Y,0,f(j));for(var ce=0,Ce=0;ce<j.SheetNames.length;++ce)(j.Sheets[j.SheetNames[ce]]||{})["!ref"]&&_e(Y,27,Ne(j.SheetNames[ce],Ce++));var je=0;for(ce=0;ce<j.SheetNames.length;++ce){var we=j.Sheets[j.SheetNames[ce]];if(!(!we||!we["!ref"])){for(var Ae=yt(we["!ref"]),Qe=Array.isArray(we),Ve=[],Kt=Math.min(Ae.e.r,8191),We=Ae.s.r;We<=Kt;++We)for(var _a=ta(We),vt=Ae.s.c;vt<=Ae.e.c;++vt){We===Ae.s.r&&(Ve[vt]=sa(vt));var Ue=Ve[vt]+_a,ca=Qe?(we[We]||[])[vt]:we[Ue];if(!(!ca||ca.t=="z"))if(ca.t=="n")_e(Y,23,X(We,vt,je,ca.v));else{var wa=Yn(ca);_e(Y,22,B(We,vt,je,wa.slice(0,239)))}}++je}}return _e(Y,1),Y.end()}function u(j){var V=fe(2);return V.write_shift(2,j),V}function f(j){var V=fe(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var P=0,Y=0,ce=0,Ce=0;Ce<j.SheetNames.length;++Ce){var je=j.SheetNames[Ce],we=j.Sheets[je];if(!(!we||!we["!ref"])){++ce;var Ae=Fa(we["!ref"]);P<Ae.e.r&&(P=Ae.e.r),Y<Ae.e.c&&(Y=Ae.e.c)}}return P>8191&&(P=8191),V.write_shift(2,P),V.write_shift(1,ce),V.write_shift(1,Y),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function h(j,V,P){var Y={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&P.qpro?(Y.s.c=j.read_shift(1),j.l++,Y.s.r=j.read_shift(2),Y.e.c=j.read_shift(1),j.l++,Y.e.r=j.read_shift(2),Y):(Y.s.c=j.read_shift(2),Y.s.r=j.read_shift(2),V==12&&P.qpro&&(j.l+=2),Y.e.c=j.read_shift(2),Y.e.r=j.read_shift(2),V==12&&P.qpro&&(j.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function g(j){var V=fe(8);return V.write_shift(2,j.s.c),V.write_shift(2,j.s.r),V.write_shift(2,j.e.c),V.write_shift(2,j.e.r),V}function v(j,V,P){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(Y[0].c=j.read_shift(1),Y[3]=j.read_shift(1),Y[0].r=j.read_shift(2),j.l+=2):(Y[2]=j.read_shift(1),Y[0].c=j.read_shift(2),Y[0].r=j.read_shift(2)),Y}function p(j,V,P){var Y=j.l+V,ce=v(j,V,P);if(ce[1].t="s",P.vers==20768){j.l++;var Ce=j.read_shift(1);return ce[1].v=j.read_shift(Ce,"utf8"),ce}return P.qpro&&j.l++,ce[1].v=j.read_shift(Y-j.l,"cstr"),ce}function S(j,V,P){var Y=fe(7+P.length);Y.write_shift(1,255),Y.write_shift(2,V),Y.write_shift(2,j),Y.write_shift(1,39);for(var ce=0;ce<Y.length;++ce){var Ce=P.charCodeAt(ce);Y.write_shift(1,Ce>=128?95:Ce)}return Y.write_shift(1,0),Y}function x(j,V,P){var Y=v(j,V,P);return Y[1].v=j.read_shift(2,"i"),Y}function C(j,V,P){var Y=fe(7);return Y.write_shift(1,255),Y.write_shift(2,V),Y.write_shift(2,j),Y.write_shift(2,P,"i"),Y}function T(j,V,P){var Y=v(j,V,P);return Y[1].v=j.read_shift(8,"f"),Y}function y(j,V,P){var Y=fe(13);return Y.write_shift(1,255),Y.write_shift(2,V),Y.write_shift(2,j),Y.write_shift(8,P,"f"),Y}function _(j,V,P){var Y=j.l+V,ce=v(j,V,P);if(ce[1].v=j.read_shift(8,"f"),P.qpro)j.l=Y;else{var Ce=j.read_shift(2);N(j.slice(j.l,j.l+Ce),ce),j.l+=Ce}return ce}function w(j,V,P){var Y=V&32768;return V&=-32769,V=(Y?j:0)+(V>=8192?V-16384:V),(Y?"":"$")+(P?sa(V):ta(V))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},M=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(j,V){Oa(j,0);for(var P=[],Y=0,ce="",Ce="",je="",we="";j.l<j.length;){var Ae=j[j.l++];switch(Ae){case 0:P.push(j.read_shift(8,"f"));break;case 1:Ce=w(V[0].c,j.read_shift(2),!0),ce=w(V[0].r,j.read_shift(2),!1),P.push(Ce+ce);break;case 2:{var Qe=w(V[0].c,j.read_shift(2),!0),Ve=w(V[0].r,j.read_shift(2),!1);Ce=w(V[0].c,j.read_shift(2),!0),ce=w(V[0].r,j.read_shift(2),!1),P.push(Qe+Ve+":"+Ce+ce)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(j.read_shift(2));break;case 6:{for(var Kt="";Ae=j[j.l++];)Kt+=String.fromCharCode(Ae);P.push('"'+Kt.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:we=P.pop(),je=P.pop(),P.push(["AND","OR"][Ae-20]+"("+je+","+we+")");break;default:if(Ae<32&&M[Ae])we=P.pop(),je=P.pop(),P.push(je+M[Ae]+we);else if(k[Ae]){if(Y=k[Ae][1],Y==69&&(Y=j[j.l++]),Y>P.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+P.join("|")+"|");return}var We=P.slice(-Y);P.length-=Y,P.push(k[Ae][0]+"("+We.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}P.length==1?V[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function K(j){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=j.read_shift(2),V[3]=j[j.l++],V[0].c=j[j.l++],V}function J(j,V){var P=K(j);return P[1].t="s",P[1].v=j.read_shift(V-4,"cstr"),P}function B(j,V,P,Y){var ce=fe(6+Y.length);ce.write_shift(2,j),ce.write_shift(1,P),ce.write_shift(1,V),ce.write_shift(1,39);for(var Ce=0;Ce<Y.length;++Ce){var je=Y.charCodeAt(Ce);ce.write_shift(1,je>=128?95:je)}return ce.write_shift(1,0),ce}function Z(j,V){var P=K(j);P[1].v=j.read_shift(2);var Y=P[1].v>>1;if(P[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return P[1].v=Y,P}function L(j,V){var P=K(j),Y=j.read_shift(4),ce=j.read_shift(4),Ce=j.read_shift(2);if(Ce==65535)return Y===0&&ce===3221225472?(P[1].t="e",P[1].v=15):Y===0&&ce===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var je=Ce&32768;return Ce=(Ce&32767)-16446,P[1].v=(1-je*2)*(ce*Math.pow(2,Ce+32)+Y*Math.pow(2,Ce)),P}function X(j,V,P,Y){var ce=fe(14);if(ce.write_shift(2,j),ce.write_shift(1,P),ce.write_shift(1,V),Y==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Ce=0,je=0,we=0,Ae=0;return Y<0&&(Ce=1,Y=-Y),je=Math.log2(Y)|0,Y/=Math.pow(2,je-31),Ae=Y>>>0,(Ae&2147483648)==0&&(Y/=2,++je,Ae=Y>>>0),Y-=Ae,Ae|=2147483648,Ae>>>=0,Y*=Math.pow(2,32),we=Y>>>0,ce.write_shift(4,we),ce.write_shift(4,Ae),je+=16383+(Ce?32768:0),ce.write_shift(2,je),ce}function D(j,V){var P=L(j);return j.l+=V-14,P}function z(j,V){var P=K(j),Y=j.read_shift(4);return P[1].v=Y>>6,P}function ue(j,V){var P=K(j),Y=j.read_shift(8,"f");return P[1].v=Y,P}function be(j,V){var P=ue(j);return j.l+=V-10,P}function Se(j,V){return j[j.l+V-1]==0?j.read_shift(V,"cstr"):""}function ee(j,V){var P=j[j.l++];P>V-1&&(P=V-1);for(var Y="";Y.length<P;)Y+=String.fromCharCode(j[j.l++]);return Y}function ge(j,V,P){if(!(!P.qpro||V<21)){var Y=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var ce=j.read_shift(V-21,"cstr");return[Y,ce]}}function ke(j,V){for(var P={},Y=j.l+V;j.l<Y;){var ce=j.read_shift(2);if(ce==14e3){for(P[ce]=[0,""],P[ce][0]=j.read_shift(2);j[j.l];)P[ce][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return P}function Ne(j,V){var P=fe(5+j.length);P.write_shift(2,14e3),P.write_shift(2,V);for(var Y=0;Y<j.length;++Y){var ce=j.charCodeAt(Y);P[P.l++]=ce>127?95:ce}return P[P.l++]=0,P}var Le={0:{n:"BOF",f:_g},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:T},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:Z},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ke},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:l,to_workbook:n}})(),hC=/^\s|\s$|[\t\n\r]/;function Mg(a,n){if(!n.bookSST)return"";var t=[Rt];t[t.length]=Ee("sst",null,{xmlns:ls[0],count:a.Count,uniqueCount:a.Unique});for(var i=0;i!=a.length;++i)if(a[i]!=null){var l=a[i],u="<si>";l.r?u+=l.r:(u+="<t",l.t||(l.t=""),l.t.match(hC)&&(u+=' xml:space="preserve"'),u+=">"+ct(l.t)+"</t>"),u+="</si>",t[t.length]=u}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function mC(a){return[a.read_shift(4),a.read_shift(4)]}function vC(a,n){return n||(n=fe(8)),n.write_shift(4,a.Count),n.write_shift(4,a.Unique),n}var gC=sy;function pC(a){var n=Ca();pe(n,159,vC(a));for(var t=0;t<a.length;++t)pe(n,19,gC(a[t]));return pe(n,160),n.end()}function xC(a){for(var n=[],t=a.split(""),i=0;i<t.length;++i)n[i]=t[i].charCodeAt(0);return n}function jg(a){var n=0,t,i=xC(a),l=i.length+1,u,f,h,g,v;for(t=Zr(l),t[0]=i.length,u=1;u!=l;++u)t[u]=i[u-1];for(u=l-1;u>=0;--u)f=t[u],h=(n&16384)===0?0:1,g=n<<1&32767,v=h|g,n=v^f;return n^52811}var SC=(function(){function a(l,u){switch(u.type){case"base64":return n(Vn(l),u);case"binary":return n(l,u);case"buffer":return n(nt&&Buffer.isBuffer(l)?l.toString("binary"):Nl(l),u);case"array":return n(jo(l),u)}throw new Error("Unrecognized type "+u.type)}function n(l,u){var f=u||{},h=f.dense?[]:{},g=l.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var v={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(p,S){Array.isArray(h)&&(h[S]=[]);for(var x=/\\\w+\b/g,C=0,T,y=-1;T=x.exec(p);){switch(T[0]){case"\\cell":var _=p.slice(C,x.lastIndex-T[0].length);if(_[0]==" "&&(_=_.slice(1)),++y,_.length){var w={v:_,t:"s"};Array.isArray(h)?h[S][y]=w:h[ot({r:S,c:y})]=w}break}C=x.lastIndex}y>v.e.c&&(v.e.c=y)}),h["!ref"]=It(v),h}function t(l,u){return ai(a(l,u),u)}function i(l){for(var u=["{\\rtf1\\ansi"],f=yt(l["!ref"]),h,g=Array.isArray(l),v=f.s.r;v<=f.e.r;++v){u.push("\\trowd\\trautofit1");for(var p=f.s.c;p<=f.e.c;++p)u.push("\\cellx"+(p+1));for(u.push("\\pard\\intbl"),p=f.s.c;p<=f.e.c;++p){var S=ot({r:v,c:p});h=g?(l[v]||[])[p]:l[S],!(!h||h.v==null&&(!h.f||h.F))&&(u.push(" "+(h.w||(Yn(h),h.w))),u.push("\\cell"))}u.push("\\pard\\intbl\\row")}return u.join("")+"}"}return{to_workbook:t,to_sheet:a,from_sheet:i}})();function mv(a){for(var n=0,t=1;n!=3;++n)t=t*256+(a[n]>255?255:a[n]<0?0:a[n]);return t.toString(16).toUpperCase().slice(1)}var yC=6,Wn=yC;function So(a){return Math.floor((a+Math.round(128/Wn)/256)*Wn)}function yo(a){return Math.floor((a-5)/Wn*100+.5)/100}function mf(a){return Math.round((a*Wn+5)/Wn*256)/256}function jf(a){a.width?(a.wpx=So(a.width),a.wch=yo(a.wpx),a.MDW=Wn):a.wpx?(a.wch=yo(a.wpx),a.width=mf(a.wch),a.MDW=Wn):typeof a.wch=="number"&&(a.width=mf(a.wch),a.wpx=So(a.width),a.MDW=Wn),a.customWidth&&delete a.customWidth}var CC=96,kg=CC;function Co(a){return a*96/kg}function Ug(a){return a*kg/96}function TC(a){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)a[i]!=null&&(n[n.length]=Ee("numFmt",null,{numFmtId:i,formatCode:ct(a[i])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Ee("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function EC(a){var n=[];return n[n.length]=Ee("cellXfs",null),a.forEach(function(t){n[n.length]=Ee("xf",null,t)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Ee("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function Og(a,n){var t=[Rt,Ee("styleSheet",null,{xmlns:ls[0],"xmlns:vt":zt.vt})],i;return a.SSF&&(i=TC(a.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=EC(n.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function _C(a,n){var t=a.read_shift(2),i=la(a);return[t,i]}function wC(a,n,t){t||(t=fe(6+4*n.length)),t.write_shift(2,a),Gt(n,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function bC(a,n,t){var i={};i.sz=a.read_shift(2)/20;var l=hy(a);l.fItalic&&(i.italic=1),l.fCondense&&(i.condense=1),l.fExtend&&(i.extend=1),l.fShadow&&(i.shadow=1),l.fOutline&&(i.outline=1),l.fStrikeout&&(i.strike=1);var u=a.read_shift(2);switch(u===700&&(i.bold=1),a.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var f=a.read_shift(1);f!=0&&(i.underline=f);var h=a.read_shift(1);h>0&&(i.family=h);var g=a.read_shift(1);switch(g>0&&(i.charset=g),a.l++,i.color=dy(a),a.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=la(a),i}function NC(a,n){n||(n=fe(153)),n.write_shift(2,a.sz*20),my(a,n),n.write_shift(2,a.bold?700:400);var t=0;a.vertAlign=="superscript"?t=1:a.vertAlign=="subscript"&&(t=2),n.write_shift(2,t),n.write_shift(1,a.underline||0),n.write_shift(1,a.family||0),n.write_shift(1,a.charset||0),n.write_shift(1,0),po(a.color,n);var i=0;return i=2,n.write_shift(1,i),Gt(a.name,n),n.length>n.l?n.slice(0,n.l):n}var AC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rf,DC=Tn;function vv(a,n){n||(n=fe(84)),rf||(rf=Sf(AC));var t=rf[a.patternType];t==null&&(t=40),n.write_shift(4,t);var i=0;if(t!=40)for(po({auto:1},n),po({auto:1},n);i<12;++i)n.write_shift(4,0);else{for(;i<4;++i)n.write_shift(4,0);for(;i<12;++i)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function MC(a,n){var t=a.l+n,i=a.read_shift(2),l=a.read_shift(2);return a.l=t,{ixfe:i,numFmtId:l}}function Ig(a,n,t){t||(t=fe(16)),t.write_shift(2,n||0),t.write_shift(2,a.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function ol(a,n){return n||(n=fe(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var jC=Tn;function kC(a,n){return n||(n=fe(51)),n.write_shift(1,0),ol(null,n),ol(null,n),ol(null,n),ol(null,n),ol(null,n),n.length>n.l?n.slice(0,n.l):n}function UC(a,n){return n||(n=fe(52)),n.write_shift(4,a.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),go(a.name||"",n),n.length>n.l?n.slice(0,n.l):n}function OC(a,n,t){var i=fe(2052);return i.write_shift(4,a),go(n,i),go(t,i),i.length>i.l?i.slice(0,i.l):i}function IC(a,n){if(n){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var l=i[0];l<=i[1];++l)n[l]!=null&&++t}),t!=0&&(pe(a,615,dn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var l=i[0];l<=i[1];++l)n[l]!=null&&pe(a,44,wC(l,n[l]))}),pe(a,616))}}function RC(a){var n=1;pe(a,611,dn(n)),pe(a,43,NC({sz:12,color:{theme:1},name:"Calibri",family:2})),pe(a,612)}function FC(a){var n=2;pe(a,603,dn(n)),pe(a,45,vv({patternType:"none"})),pe(a,45,vv({patternType:"gray125"})),pe(a,604)}function LC(a){var n=1;pe(a,613,dn(n)),pe(a,46,kC()),pe(a,614)}function BC(a){var n=1;pe(a,626,dn(n)),pe(a,47,Ig({numFmtId:0},65535)),pe(a,627)}function KC(a,n){pe(a,617,dn(n.length)),n.forEach(function(t){pe(a,47,Ig(t,0))}),pe(a,618)}function PC(a){var n=1;pe(a,619,dn(n)),pe(a,48,UC({xfId:0,name:"Normal"})),pe(a,620)}function zC(a){var n=0;pe(a,505,dn(n)),pe(a,506)}function HC(a){var n=0;pe(a,508,OC(n,"TableStyleMedium9","PivotStyleMedium4")),pe(a,509)}function GC(a,n){var t=Ca();return pe(t,278),IC(t,a.SSF),RC(t),FC(t),LC(t),BC(t),KC(t,n.cellXfs),PC(t),zC(t),HC(t),pe(t,279),t.end()}function Rg(a,n){if(n&&n.themeXLSX)return n.themeXLSX;if(a&&typeof a.raw=="string")return a.raw;var t=[Rt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function WC(a,n){return{flags:a.read_shift(4),version:a.read_shift(4),name:la(a)}}function VC(a){var n=fe(12+2*a.name.length);return n.write_shift(4,a.flags),n.write_shift(4,a.version),Gt(a.name,n),n.slice(0,n.l)}function YC(a){for(var n=[],t=a.read_shift(4);t-- >0;)n.push([a.read_shift(4),a.read_shift(4)]);return n}function XC(a){var n=fe(4+8*a.length);n.write_shift(4,a.length);for(var t=0;t<a.length;++t)n.write_shift(4,a[t][0]),n.write_shift(4,a[t][1]);return n}function qC(a,n){var t=fe(8+2*n.length);return t.write_shift(4,a),Gt(n,t),t.slice(0,t.l)}function JC(a){return a.l+=4,a.read_shift(4)!=0}function $C(a,n){var t=fe(8);return t.write_shift(4,a),t.write_shift(4,1),t}function QC(){var a=Ca();return pe(a,332),pe(a,334,dn(1)),pe(a,335,VC({name:"XLDAPR",version:12e4,flags:3496657072})),pe(a,336),pe(a,339,qC(1,"XLDAPR")),pe(a,52),pe(a,35,dn(514)),pe(a,4096,dn(0)),pe(a,4097,Qa(1)),pe(a,36),pe(a,53),pe(a,340),pe(a,337,$C(1)),pe(a,51,XC([[1,0]])),pe(a,338),pe(a,333),a.end()}function Fg(){var a=[Rt];return a.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),a.join("")}function ZC(a){var n={};n.i=a.read_shift(4);var t={};t.r=a.read_shift(4),t.c=a.read_shift(4),n.r=ot(t);var i=a.read_shift(1);return i&2&&(n.l="1"),i&8&&(n.a="1"),n}var Zi=1024;function Lg(a,n){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),l=[Ee("xml",null,{"xmlns:v":Ia.v,"xmlns:o":Ia.o,"xmlns:x":Ia.x,"xmlns:mv":Ia.mv}).replace(/\/>/,">"),Ee("o:shapelayout",Ee("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),Ee("v:shapetype",[Ee("v:stroke",null,{joinstyle:"miter"}),Ee("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Zi<a*1e3;)Zi+=1e3;return n.forEach(function(u){var f=Ht(u[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var g=h.type=="gradient"?Ee("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,v=Ee("v:fill",g,h),p={on:"t",obscured:"t"};++Zi,l=l.concat(["<v:shape"+_l({id:"_x0000_s"+Zi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(u[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",v,Ee("v:shadow",null,p),Ee("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ea("x:Anchor",[f.c+1,0,f.r+1,0,f.c+3,20,f.r+5,20].join(",")),ea("x:AutoFill","False"),ea("x:Row",String(f.r)),ea("x:Column",String(f.c)),u[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),l.push("</xml>"),l.join("")}function Bg(a){var n=[Rt,Ee("comments",null,{xmlns:ls[0]})],t=[];return n.push("<authors>"),a.forEach(function(i){i[1].forEach(function(l){var u=ct(l.a);t.indexOf(u)==-1&&(t.push(u),n.push("<author>"+u+"</author>")),l.T&&l.ID&&t.indexOf("tc="+l.ID)==-1&&(t.push("tc="+l.ID),n.push("<author>tc="+l.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),a.forEach(function(i){var l=0,u=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?l=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(g){g.a&&(l=t.indexOf(ct(g.a))),u.push(g.t||"")}),n.push('<comment ref="'+i[0]+'" authorId="'+l+'"><text>'),u.length<=1)n.push(ea("t",ct(u[0]||"")));else{for(var f=`Comment:
    `+u[0]+`
`,h=1;h<u.length;++h)f+=`Reply:
    `+u[h]+`
`;n.push(ea("t",ct(f)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function eT(a,n,t){var i=[Rt,Ee("ThreadedComments",null,{xmlns:zt.TCMNT}).replace(/[\/]>/,">")];return a.forEach(function(l){var u="";(l[1]||[]).forEach(function(f,h){if(!f.T){delete f.ID;return}f.a&&n.indexOf(f.a)==-1&&n.push(f.a);var g={ref:l[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};h==0?u=g.id:g.parentId=u,f.ID=g.id,f.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(f.a)).slice(-12)+"}"),i.push(Ee("threadedComment",ea("text",f.t||""),g))})}),i.push("</ThreadedComments>"),i.join("")}function tT(a){var n=[Rt,Ee("personList",null,{xmlns:zt.TCMNT,"xmlns:x":ls[0]}).replace(/[\/]>/,">")];return a.forEach(function(t,i){n.push(Ee("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),n.push("</personList>"),n.join("")}function aT(a){var n={};n.iauthor=a.read_shift(4);var t=si(a);return n.rfx=t.s,n.ref=ot(t.s),a.l+=16,n}function nT(a,n){return n==null&&(n=fe(36)),n.write_shift(4,a[1].iauthor),os(a[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var rT=la;function iT(a){return Gt(a.slice(0,54))}function sT(a){var n=Ca(),t=[];return pe(n,628),pe(n,630),a.forEach(function(i){i[1].forEach(function(l){t.indexOf(l.a)>-1||(t.push(l.a.slice(0,54)),pe(n,632,iT(l.a)))})}),pe(n,631),pe(n,633),a.forEach(function(i){i[1].forEach(function(l){l.iauthor=t.indexOf(l.a);var u={s:Ht(i[0]),e:Ht(i[0])};pe(n,635,nT([u,l])),l.t&&l.t.length>0&&pe(n,637,cy(l)),pe(n,636),delete l.iauthor})}),pe(n,634),pe(n,629),n.end()}function lT(a,n){n.FullPaths.forEach(function(t,i){if(i!=0){var l=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");l.slice(-1)!=="/"&&ht.utils.cfb_add(a,l,n.FileIndex[i].content)}})}var Kg=["xlsb","xlsm","xlam","biff8","xla"],cT=(function(){var a=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(i,l,u,f){var h=!1,g=!1;u.length==0?g=!0:u.charAt(0)=="["&&(g=!0,u=u.slice(1,-1)),f.length==0?h=!0:f.charAt(0)=="["&&(h=!0,f=f.slice(1,-1));var v=u.length>0?parseInt(u,10)|0:0,p=f.length>0?parseInt(f,10)|0:0;return h?p+=n.c:--p,g?v+=n.r:--v,l+(h?"":"$")+sa(p)+(g?"":"$")+ta(v)}return function(l,u){return n=u,l.replace(a,t)}})(),kf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Uf=(function(){return function(n,t){return n.replace(kf,function(i,l,u,f,h,g){var v=bf(f)-(u?0:t.c),p=wf(g)-(h?0:t.r),S=p==0?"":h?p+1:"["+p+"]",x=v==0?"":u?v+1:"["+v+"]";return l+"R"+S+"C"+x})}})();function oT(a,n){return a.replace(kf,function(t,i,l,u,f,h){return i+(l=="$"?l+u:sa(bf(u)+n.c))+(f=="$"?f+h:ta(wf(h)+n.r))})}function uT(a){return a.length!=1}function Ot(a){a.l+=1}function br(a,n){var t=a.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Pg(a,n,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return zg(a);t.biff==12&&(i=4)}var l=a.read_shift(i),u=a.read_shift(i),f=br(a),h=br(a);return{s:{r:l,c:f[0],cRel:f[1],rRel:f[2]},e:{r:u,c:h[0],cRel:h[1],rRel:h[2]}}}function zg(a){var n=br(a),t=br(a),i=a.read_shift(1),l=a.read_shift(1);return{s:{r:n[0],c:i,cRel:n[1],rRel:n[2]},e:{r:t[0],c:l,cRel:t[1],rRel:t[2]}}}function fT(a,n,t){if(t.biff<8)return zg(a);var i=a.read_shift(t.biff==12?4:2),l=a.read_shift(t.biff==12?4:2),u=br(a),f=br(a);return{s:{r:i,c:u[0],cRel:u[1],rRel:u[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function Hg(a,n,t){if(t&&t.biff>=2&&t.biff<=5)return dT(a);var i=a.read_shift(t&&t.biff==12?4:2),l=br(a);return{r:i,c:l[0],cRel:l[1],rRel:l[2]}}function dT(a){var n=br(a),t=a.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function hT(a){var n=a.read_shift(2),t=a.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function mT(a,n,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return vT(a);var l=a.read_shift(i>=12?4:2),u=a.read_shift(2),f=(u&16384)>>14,h=(u&32768)>>15;if(u&=16383,h==1)for(;l>524287;)l-=1048576;if(f==1)for(;u>8191;)u=u-16384;return{r:l,c:u,cRel:f,rRel:h}}function vT(a){var n=a.read_shift(2),t=a.read_shift(1),i=(n&32768)>>15,l=(n&16384)>>14;return n&=16383,i==1&&n>=8192&&(n=n-16384),l==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:l,rRel:i}}function gT(a,n,t){var i=(a[a.l++]&96)>>5,l=Pg(a,t.biff>=2&&t.biff<=5?6:8,t);return[i,l]}function pT(a,n,t){var i=(a[a.l++]&96)>>5,l=a.read_shift(2,"i"),u=8;if(t)switch(t.biff){case 5:a.l+=12,u=6;break;case 12:u=12;break}var f=Pg(a,u,t);return[i,l,f]}function xT(a,n,t){var i=(a[a.l++]&96)>>5;return a.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function ST(a,n,t){var i=(a[a.l++]&96)>>5,l=a.read_shift(2),u=8;if(t)switch(t.biff){case 5:a.l+=12,u=6;break;case 12:u=12;break}return a.l+=u,[i,l]}function yT(a,n,t){var i=(a[a.l++]&96)>>5,l=fT(a,n-1,t);return[i,l]}function CT(a,n,t){var i=(a[a.l++]&96)>>5;return a.l+=t.biff==2?6:t.biff==12?14:7,[i]}function gv(a){var n=a[a.l+1]&1,t=1;return a.l+=4,[n,t]}function TT(a,n,t){a.l+=2;for(var i=a.read_shift(t&&t.biff==2?1:2),l=[],u=0;u<=i;++u)l.push(a.read_shift(t&&t.biff==2?1:2));return l}function ET(a,n,t){var i=a[a.l+1]&255?1:0;return a.l+=2,[i,a.read_shift(t&&t.biff==2?1:2)]}function _T(a,n,t){var i=a[a.l+1]&255?1:0;return a.l+=2,[i,a.read_shift(t&&t.biff==2?1:2)]}function wT(a){var n=a[a.l+1]&255?1:0;return a.l+=2,[n,a.read_shift(2)]}function bT(a,n,t){var i=a[a.l+1]&255?1:0;return a.l+=t&&t.biff==2?3:4,[i]}function Gg(a){var n=a.read_shift(1),t=a.read_shift(1);return[n,t]}function NT(a){return a.read_shift(2),Gg(a)}function AT(a){return a.read_shift(2),Gg(a)}function DT(a,n,t){var i=(a[a.l]&96)>>5;a.l+=1;var l=Hg(a,0,t);return[i,l]}function MT(a,n,t){var i=(a[a.l]&96)>>5;a.l+=1;var l=mT(a,0,t);return[i,l]}function jT(a,n,t){var i=(a[a.l]&96)>>5;a.l+=1;var l=a.read_shift(2);t&&t.biff==5&&(a.l+=12);var u=Hg(a,0,t);return[i,l,u]}function kT(a,n,t){var i=(a[a.l]&96)>>5;a.l+=1;var l=a.read_shift(t&&t.biff<=3?1:2);return[kE[l],Yg[l],i]}function UT(a,n,t){var i=a[a.l++],l=a.read_shift(1),u=t&&t.biff<=3?[i==88?-1:0,a.read_shift(1)]:OT(a);return[l,(u[0]===0?Yg:jE)[u[1]]]}function OT(a){return[a[a.l+1]>>7,a.read_shift(2)&32767]}function IT(a,n,t){a.l+=t&&t.biff==2?3:4}function RT(a,n,t){if(a.l++,t&&t.biff==12)return[a.read_shift(4,"i"),0];var i=a.read_shift(2),l=a.read_shift(t&&t.biff==2?1:2);return[i,l]}function FT(a){return a.l++,Ml[a.read_shift(1)]}function LT(a){return a.l++,a.read_shift(2)}function BT(a){return a.l++,a.read_shift(1)!==0}function KT(a){return a.l++,us(a)}function PT(a,n,t){return a.l++,bg(a,n-1,t)}function zT(a,n){var t=[a.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=jy(a,1)?"TRUE":"FALSE",n!=12&&(a.l+=7);break;case 37:case 16:t[1]=Ml[a[a.l]],a.l+=n==12?4:8;break;case 0:a.l+=8;break;case 1:t[1]=us(a);break;case 2:t[1]=Iy(a,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function HT(a,n,t){for(var i=a.read_shift(t.biff==12?4:2),l=[],u=0;u!=i;++u)l.push((t.biff==12?si:Ly)(a));return l}function GT(a,n,t){var i=0,l=0;t.biff==12?(i=a.read_shift(4),l=a.read_shift(4)):(l=1+a.read_shift(1),i=1+a.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--l==0&&(l=256));for(var u=0,f=[];u!=i&&(f[u]=[]);++u)for(var h=0;h!=l;++h)f[u][h]=zT(a,t.biff);return f}function WT(a,n,t){var i=a.read_shift(1)>>>5&3,l=!t||t.biff>=8?4:2,u=a.read_shift(l);switch(t.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12;break}return[i,0,u]}function VT(a,n,t){if(t.biff==5)return YT(a);var i=a.read_shift(1)>>>5&3,l=a.read_shift(2),u=a.read_shift(4);return[i,l,u]}function YT(a){var n=a.read_shift(1)>>>5&3,t=a.read_shift(2,"i");a.l+=8;var i=a.read_shift(2);return a.l+=12,[n,t,i]}function XT(a,n,t){var i=a.read_shift(1)>>>5&3;a.l+=t&&t.biff==2?3:4;var l=a.read_shift(t&&t.biff==2?1:2);return[i,l]}function qT(a,n,t){var i=a.read_shift(1)>>>5&3,l=a.read_shift(t&&t.biff==2?1:2);return[i,l]}function JT(a,n,t){var i=a.read_shift(1)>>>5&3;return a.l+=4,t.biff<8&&a.l--,t.biff==12&&(a.l+=2),[i]}function $T(a,n,t){var i=(a[a.l++]&96)>>5,l=a.read_shift(2),u=4;if(t)switch(t.biff){case 5:u=15;break;case 12:u=6;break}return a.l+=u,[i,l]}var QT=Tn,ZT=Tn,eE=Tn;function jl(a,n,t){return a.l+=2,[hT(a)]}function Of(a){return a.l+=6,[]}var tE=jl,aE=Of,nE=Of,rE=jl;function Wg(a){return a.l+=2,[_g(a),a.read_shift(2)&1]}var iE=jl,sE=Wg,lE=Of,cE=jl,oE=jl,uE=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fE(a){a.l+=2;var n=a.read_shift(2),t=a.read_shift(2),i=a.read_shift(4),l=a.read_shift(2),u=a.read_shift(2),f=uE[t>>2&31];return{ixti:n,coltype:t&3,rt:f,idx:i,c:l,C:u}}function dE(a){return a.l+=2,[a.read_shift(4)]}function hE(a,n,t){return a.l+=5,a.l+=2,a.l+=t.biff==2?1:4,["PTGSHEET"]}function mE(a,n,t){return a.l+=t.biff==2?4:5,["PTGENDSHEET"]}function vE(a){var n=a.read_shift(1)>>>5&3,t=a.read_shift(2);return[n,t]}function gE(a){var n=a.read_shift(1)>>>5&3,t=a.read_shift(2);return[n,t]}function pE(a){return a.l+=4,[0,0]}var pv={1:{n:"PtgExp",f:RT},2:{n:"PtgTbl",f:eE},3:{n:"PtgAdd",f:Ot},4:{n:"PtgSub",f:Ot},5:{n:"PtgMul",f:Ot},6:{n:"PtgDiv",f:Ot},7:{n:"PtgPower",f:Ot},8:{n:"PtgConcat",f:Ot},9:{n:"PtgLt",f:Ot},10:{n:"PtgLe",f:Ot},11:{n:"PtgEq",f:Ot},12:{n:"PtgGe",f:Ot},13:{n:"PtgGt",f:Ot},14:{n:"PtgNe",f:Ot},15:{n:"PtgIsect",f:Ot},16:{n:"PtgUnion",f:Ot},17:{n:"PtgRange",f:Ot},18:{n:"PtgUplus",f:Ot},19:{n:"PtgUminus",f:Ot},20:{n:"PtgPercent",f:Ot},21:{n:"PtgParen",f:Ot},22:{n:"PtgMissArg",f:Ot},23:{n:"PtgStr",f:PT},26:{n:"PtgSheet",f:hE},27:{n:"PtgEndSheet",f:mE},28:{n:"PtgErr",f:FT},29:{n:"PtgBool",f:BT},30:{n:"PtgInt",f:LT},31:{n:"PtgNum",f:KT},32:{n:"PtgArray",f:CT},33:{n:"PtgFunc",f:kT},34:{n:"PtgFuncVar",f:UT},35:{n:"PtgName",f:WT},36:{n:"PtgRef",f:DT},37:{n:"PtgArea",f:gT},38:{n:"PtgMemArea",f:XT},39:{n:"PtgMemErr",f:QT},40:{n:"PtgMemNoMem",f:ZT},41:{n:"PtgMemFunc",f:qT},42:{n:"PtgRefErr",f:JT},43:{n:"PtgAreaErr",f:xT},44:{n:"PtgRefN",f:MT},45:{n:"PtgAreaN",f:yT},46:{n:"PtgMemAreaN",f:vE},47:{n:"PtgMemNoMemN",f:gE},57:{n:"PtgNameX",f:VT},58:{n:"PtgRef3d",f:jT},59:{n:"PtgArea3d",f:pT},60:{n:"PtgRefErr3d",f:$T},61:{n:"PtgAreaErr3d",f:ST},255:{}},xE={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},SE={1:{n:"PtgElfLel",f:Wg},2:{n:"PtgElfRw",f:cE},3:{n:"PtgElfCol",f:tE},6:{n:"PtgElfRwV",f:oE},7:{n:"PtgElfColV",f:rE},10:{n:"PtgElfRadical",f:iE},11:{n:"PtgElfRadicalS",f:lE},13:{n:"PtgElfColS",f:aE},15:{n:"PtgElfColSV",f:nE},16:{n:"PtgElfRadicalLel",f:sE},25:{n:"PtgList",f:fE},29:{n:"PtgSxName",f:dE},255:{}},yE={0:{n:"PtgAttrNoop",f:pE},1:{n:"PtgAttrSemi",f:bT},2:{n:"PtgAttrIf",f:_T},4:{n:"PtgAttrChoose",f:TT},8:{n:"PtgAttrGoto",f:ET},16:{n:"PtgAttrSum",f:IT},32:{n:"PtgAttrBaxcel",f:gv},33:{n:"PtgAttrBaxcel",f:gv},64:{n:"PtgAttrSpace",f:NT},65:{n:"PtgAttrSpaceSemi",f:AT},128:{n:"PtgAttrIfError",f:wT},255:{}};function CE(a,n,t,i){if(i.biff<8)return Tn(a,n);for(var l=a.l+n,u=[],f=0;f!==t.length;++f)switch(t[f][0]){case"PtgArray":t[f][1]=GT(a,0,i),u.push(t[f][1]);break;case"PtgMemArea":t[f][2]=HT(a,t[f][1],i),u.push(t[f][2]);break;case"PtgExp":i&&i.biff==12&&(t[f][1][1]=a.read_shift(4),u.push(t[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[f][0]}return n=l-a.l,n!==0&&u.push(Tn(a,n)),u}function TE(a,n,t){for(var i=a.l+n,l,u,f=[];i!=a.l;)n=i-a.l,u=a[a.l],l=pv[u]||pv[xE[u]],(u===24||u===25)&&(l=(u===24?SE:yE)[a[a.l+1]]),!l||!l.f?Tn(a,n):f.push([l.n,l.f(a,n,t)]);return f}function EE(a){for(var n=[],t=0;t<a.length;++t){for(var i=a[t],l=[],u=0;u<i.length;++u){var f=i[u];if(f)switch(f[0]){case 2:l.push('"'+f[1].replace(/"/g,'""')+'"');break;default:l.push(f[1])}else l.push("")}n.push(l.join(","))}return n.join(";")}var _E={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function wE(a,n){if(!a&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(a)?"'"+a+"'":a}function Vg(a,n,t){if(!a)return"SH33TJSERR0";if(t.biff>8&&(!a.XTI||!a.XTI[n]))return a.SheetNames[n];if(!a.XTI)return"SH33TJSERR6";var i=a.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":a.XTI[n-1];if(!i)return"SH33TJSERR1";var l="";if(t.biff>8)switch(a[i[0]][0]){case 357:return l=i[1]==-1?"#REF":a.SheetNames[i[1]],i[1]==i[2]?l:l+":"+a.SheetNames[i[2]];case 358:return t.SID!=null?a.SheetNames[t.SID]:"SH33TJSSAME"+a[i[0]][0];case 355:default:return"SH33TJSSRC"+a[i[0]][0]}switch(a[i[0]][0][0]){case 1025:return l=i[1]==-1?"#REF":a.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?l:l+":"+a.SheetNames[i[2]];case 14849:return a[i[0]].slice(1).map(function(u){return u.Name}).join(";;");default:return a[i[0]][0][3]?(l=i[1]==-1?"#REF":a[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?l:l+":"+a[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function xv(a,n,t){var i=Vg(a,n,t);return i=="#REF"?i:wE(i,t)}function ss(a,n,t,i,l){var u=l&&l.biff||8,f={s:{c:0,r:0}},h=[],g,v,p,S=0,x=0,C,T="";if(!a[0]||!a[0][0])return"";for(var y=-1,_="",w=0,k=a[0].length;w<k;++w){var M=a[0][w];switch(M[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=h.pop(),v=h.pop(),y>=0){switch(a[0][y][1][0]){case 0:_=bt(" ",a[0][y][1][1]);break;case 1:_=bt("\r",a[0][y][1][1]);break;default:if(_="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][y][1][0])}v=v+_,y=-1}h.push(v+_E[M[0]]+g);break;case"PtgIsect":g=h.pop(),v=h.pop(),h.push(v+" "+g);break;case"PtgUnion":g=h.pop(),v=h.pop(),h.push(v+","+g);break;case"PtgRange":g=h.pop(),v=h.pop(),h.push(v+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=pl(M[1][1],f,l),h.push(xl(p,u));break;case"PtgRefN":p=t?pl(M[1][1],t,l):M[1][1],h.push(xl(p,u));break;case"PtgRef3d":S=M[1][1],p=pl(M[1][2],f,l),T=xv(i,S,l),h.push(T+"!"+xl(p,u));break;case"PtgFunc":case"PtgFuncVar":var N=M[1][0],K=M[1][1];N||(N=0),N&=127;var J=N==0?[]:h.slice(-N);h.length-=N,K==="User"&&(K=J.shift()),h.push(K+"("+J.join(",")+")");break;case"PtgBool":h.push(M[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(M[1]);break;case"PtgNum":h.push(String(M[1]));break;case"PtgStr":h.push('"'+M[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(M[1]);break;case"PtgAreaN":C=av(M[1][1],t?{s:t}:f,l),h.push(af(C,l));break;case"PtgArea":C=av(M[1][1],f,l),h.push(af(C,l));break;case"PtgArea3d":S=M[1][1],C=M[1][2],T=xv(i,S,l),h.push(T+"!"+af(C,l));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=M[1][2];var B=(i.names||[])[x-1]||(i[0]||[])[x],Z=B?B.Name:"SH33TJSNAME"+String(x);Z&&Z.slice(0,6)=="_xlfn."&&!l.xlfn&&(Z=Z.slice(6)),h.push(Z);break;case"PtgNameX":var L=M[1][1];x=M[1][2];var X;if(l.biff<=5)L<0&&(L=-L),i[L]&&(X=i[L][x]);else{var D="";if(((i[L]||[])[0]||[])[0]==14849||(((i[L]||[])[0]||[])[0]==1025?i[L][x]&&i[L][x].itab>0&&(D=i.SheetNames[i[L][x].itab-1]+"!"):D=i.SheetNames[x-1]+"!"),i[L]&&i[L][x])D+=i[L][x].Name;else if(i[0]&&i[0][x])D+=i[0][x].Name;else{var z=(Vg(i,L,l)||"").split(";;");z[x-1]?D=z[x-1]:D+="SH33TJSERRX"}h.push(D);break}X||(X={Name:"SH33TJSERRY"}),h.push(X.Name);break;case"PtgParen":var ue="(",be=")";if(y>=0){switch(_="",a[0][y][1][0]){case 2:ue=bt(" ",a[0][y][1][1])+ue;break;case 3:ue=bt("\r",a[0][y][1][1])+ue;break;case 4:be=bt(" ",a[0][y][1][1])+be;break;case 5:be=bt("\r",a[0][y][1][1])+be;break;default:if(l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][y][1][0])}y=-1}h.push(ue+h.pop()+be);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":p={c:M[1][1],r:M[1][0]};var Se={c:t.c,r:t.r};if(i.sharedf[ot(p)]){var ee=i.sharedf[ot(p)];h.push(ss(ee,f,Se,i,l))}else{var ge=!1;for(g=0;g!=i.arrayf.length;++g)if(v=i.arrayf[g],!(p.c<v[0].s.c||p.c>v[0].e.c)&&!(p.r<v[0].s.r||p.r>v[0].e.r)){h.push(ss(v[1],f,Se,i,l)),ge=!0;break}ge||h.push(M[1])}break;case"PtgArray":h.push("{"+EE(M[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+M[1].idx+"[#"+M[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(M));default:throw new Error("Unrecognized Formula Token: "+String(M))}var ke=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(l.biff!=3&&y>=0&&ke.indexOf(a[0][w][0])==-1){M=a[0][y];var Ne=!0;switch(M[1][0]){case 4:Ne=!1;case 0:_=bt(" ",M[1][1]);break;case 5:Ne=!1;case 1:_=bt("\r",M[1][1]);break;default:if(_="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+M[1][0])}h.push((Ne?_:"")+h.pop()+(Ne?"":_)),y=-1}}if(h.length>1&&l.WTF)throw new Error("bad formula stack");return h[0]}function bE(a){if(a==null){var n=fe(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof a=="number")return ei(a);return ei(0)}function NE(a,n,t,i,l){var u=ti(n,t,l),f=bE(a.v),h=fe(6),g=33;h.write_shift(2,g),h.write_shift(4,0);for(var v=fe(a.bf.length),p=0;p<a.bf.length;++p)v[p]=a.bf[p];var S=Zt([u,f,h,v]);return S}function ko(a,n,t){var i=a.read_shift(4),l=TE(a,i,t),u=a.read_shift(4),f=u>0?CE(a,u,l,t):null;return[l,f]}var AE=ko,Uo=ko,DE=ko,ME=ko,jE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Yg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},kE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function UE(a){var n="of:="+a.replace(kf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function OE(a){return a.replace(/\./,"!")}var Sl=typeof Map<"u";function If(a,n,t){var i=0,l=a.length;if(t){if(Sl?t.has(n):Object.prototype.hasOwnProperty.call(t,n)){for(var u=Sl?t.get(n):t[n];i<u.length;++i)if(a[u[i]].t===n)return a.Count++,u[i]}}else for(;i<l;++i)if(a[i].t===n)return a.Count++,i;return a[l]={t:n},a.Count++,a.Unique++,t&&(Sl?(t.has(n)||t.set(n,[]),t.get(n).push(l)):(Object.prototype.hasOwnProperty.call(t,n)||(t[n]=[]),t[n].push(l))),l}function Oo(a,n){var t={min:a+1,max:a+1},i=-1;return n.MDW&&(Wn=n.MDW),n.width!=null?t.customWidth=1:n.wpx!=null?i=yo(n.wpx):n.wch!=null&&(i=n.wch),i>-1?(t.width=mf(i),t.customWidth=1):n.width!=null&&(t.width=n.width),n.hidden&&(t.hidden=!0),n.level!=null&&(t.outlineLevel=t.level=n.level),t}function Xg(a,n){if(a){var t=[.7,.7,.75,.75,.3,.3];a.left==null&&(a.left=t[0]),a.right==null&&(a.right=t[1]),a.top==null&&(a.top=t[2]),a.bottom==null&&(a.bottom=t[3]),a.header==null&&(a.header=t[4]),a.footer==null&&(a.footer=t[5])}}function Ar(a,n,t){var i=t.revssf[n.z!=null?n.z:"General"],l=60,u=a.length;if(i==null&&t.ssf){for(;l<392;++l)if(t.ssf[l]==null){Hv(n.z,l),t.ssf[l]=n.z,t.revssf[n.z]=i=l;break}}for(l=0;l!=u;++l)if(a[l].numFmtId===i)return l;return a[u]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},u}function IE(a,n,t){if(a&&a["!ref"]){var i=yt(a["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+a["!ref"])}}function RE(a){if(a.length===0)return"";for(var n='<mergeCells count="'+a.length+'">',t=0;t!=a.length;++t)n+='<mergeCell ref="'+It(a[t])+'"/>';return n+"</mergeCells>"}function FE(a,n,t,i,l){var u=!1,f={},h=null;if(i.bookType!=="xlsx"&&n.vbaraw){var g=n.SheetNames[t];try{n.Workbook&&(g=n.Workbook.Sheets[t].CodeName||g)}catch{}u=!0,f.codeName=El(ct(g))}if(a&&a["!outline"]){var v={summaryBelow:1,summaryRight:1};a["!outline"].above&&(v.summaryBelow=0),a["!outline"].left&&(v.summaryRight=0),h=(h||"")+Ee("outlinePr",null,v)}!u&&!h||(l[l.length]=Ee("sheetPr",h,f))}var LE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],BE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function KE(a){var n={sheet:1};return LE.forEach(function(t){a[t]!=null&&a[t]&&(n[t]="1")}),BE.forEach(function(t){a[t]!=null&&!a[t]&&(n[t]="0")}),a.password&&(n.password=jg(a.password).toString(16).toUpperCase()),Ee("sheetProtection",null,n)}function PE(a){return Xg(a),Ee("pageMargins",null,a)}function zE(a,n){for(var t=["<cols>"],i,l=0;l!=n.length;++l)(i=n[l])&&(t[t.length]=Ee("col",null,Oo(l,i)));return t[t.length]="</cols>",t.join("")}function HE(a,n,t,i){var l=typeof a.ref=="string"?a.ref:It(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,f=Fa(l);f.s.r==f.e.r&&(f.e.r=Fa(n["!ref"]).e.r,l=It(f));for(var h=0;h<u.length;++h){var g=u[h];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==i){g.Ref="'"+t.SheetNames[i]+"'!"+l;break}}return h==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+l}),Ee("autoFilter",null,{ref:l})}function GE(a,n,t,i){var l={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(l.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Ee("sheetViews",Ee("sheetView",null,l),{})}function WE(a,n,t,i){if(a.c&&t["!comments"].push([n,a.c]),a.v===void 0&&typeof a.f!="string"||a.t==="z"&&!a.f)return"";var l="",u=a.t,f=a.v;if(a.t!=="z")switch(a.t){case"b":l=a.v?"1":"0";break;case"n":l=""+a.v;break;case"e":l=Ml[a.v];break;case"d":i&&i.cellDates?l=ha(a.v,-1).toISOString():(a=Ea(a),a.t="n",l=""+(a.v=Ta(ha(a.v)))),typeof a.z>"u"&&(a.z=Nt[14]);break;default:l=a.v;break}var h=ea("v",ct(l)),g={r:n},v=Ar(i.cellXfs,a,i);switch(v!==0&&(g.s=v),a.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(a.v==null){delete a.t;break}if(a.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){h=ea("v",""+If(i.Strings,a.v,i.revStrings)),g.t="s";break}g.t="str";break}if(a.t!=u&&(a.t=u,a.v=f),typeof a.f=="string"&&a.f){var p=a.F&&a.F.slice(0,n.length)==n?{t:"array",ref:a.F}:null;h=Ee("f",ct(a.f),p)+(a.v!=null?h:"")}return a.l&&t["!links"].push([n,a.l]),a.D&&(g.cm=1),Ee("c",h,g)}function VE(a,n,t,i){var l=[],u=[],f=yt(a["!ref"]),h="",g,v="",p=[],S=0,x=0,C=a["!rows"],T=Array.isArray(a),y={r:v},_,w=-1;for(x=f.s.c;x<=f.e.c;++x)p[x]=sa(x);for(S=f.s.r;S<=f.e.r;++S){for(u=[],v=ta(S),x=f.s.c;x<=f.e.c;++x){g=p[x]+v;var k=T?(a[S]||[])[x]:a[g];k!==void 0&&(h=WE(k,g,a,n))!=null&&u.push(h)}(u.length>0||C&&C[S])&&(y={r:v},C&&C[S]&&(_=C[S],_.hidden&&(y.hidden=1),w=-1,_.hpx?w=Co(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(y.ht=w,y.customHeight=1),_.level&&(y.outlineLevel=_.level)),l[l.length]=Ee("row",u.join(""),y))}if(C)for(;S<C.length;++S)C&&C[S]&&(y={r:S+1},_=C[S],_.hidden&&(y.hidden=1),w=-1,_.hpx?w=Co(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(y.ht=w,y.customHeight=1),_.level&&(y.outlineLevel=_.level),l[l.length]=Ee("row","",y));return l.join("")}function qg(a,n,t,i){var l=[Rt,Ee("worksheet",null,{xmlns:ls[0],"xmlns:r":zt.r})],u=t.SheetNames[a],f=0,h="",g=t.Sheets[u];g==null&&(g={});var v=g["!ref"]||"A1",p=yt(v);if(p.e.c>16383||p.e.r>1048575){if(n.WTF)throw new Error("Range "+v+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),v=It(p)}i||(i={}),g["!comments"]=[];var S=[];FE(g,t,a,n,l),l[l.length]=Ee("dimension",null,{ref:v}),l[l.length]=GE(g,n,a,t),n.sheetFormat&&(l[l.length]=Ee("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(l[l.length]=zE(g,g["!cols"])),l[f=l.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(h=VE(g,n),h.length>0&&(l[l.length]=h)),l.length>f+1&&(l[l.length]="</sheetData>",l[f]=l[f].replace("/>",">")),g["!protect"]&&(l[l.length]=KE(g["!protect"])),g["!autofilter"]!=null&&(l[l.length]=HE(g["!autofilter"],g,t,a)),g["!merges"]!=null&&g["!merges"].length>0&&(l[l.length]=RE(g["!merges"]));var x=-1,C,T=-1;return g["!links"].length>0&&(l[l.length]="<hyperlinks>",g["!links"].forEach(function(y){y[1].Target&&(C={ref:y[0]},y[1].Target.charAt(0)!="#"&&(T=lt(i,-1,ct(y[1].Target).replace(/#.*$/,""),tt.HLINK),C["r:id"]="rId"+T),(x=y[1].Target.indexOf("#"))>-1&&(C.location=ct(y[1].Target.slice(x+1))),y[1].Tooltip&&(C.tooltip=ct(y[1].Tooltip)),l[l.length]=Ee("hyperlink",null,C))}),l[l.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(l[l.length]=PE(g["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(l[l.length]=ea("ignoredErrors",Ee("ignoredError",null,{numberStoredAsText:1,sqref:v}))),S.length>0&&(T=lt(i,-1,"../drawings/drawing"+(a+1)+".xml",tt.DRAW),l[l.length]=Ee("drawing",null,{"r:id":"rId"+T}),g["!drawing"]=S),g["!comments"].length>0&&(T=lt(i,-1,"../drawings/vmlDrawing"+(a+1)+".vml",tt.VML),l[l.length]=Ee("legacyDrawing",null,{"r:id":"rId"+T}),g["!legacy"]=T),l.length>1&&(l[l.length]="</worksheet>",l[1]=l[1].replace("/>",">")),l.join("")}function YE(a,n){var t={},i=a.l+n;t.r=a.read_shift(4),a.l+=4;var l=a.read_shift(2);a.l+=1;var u=a.read_shift(1);return a.l=i,u&7&&(t.level=u&7),u&16&&(t.hidden=!0),u&32&&(t.hpt=l/20),t}function XE(a,n,t){var i=fe(145),l=(t["!rows"]||[])[a]||{};i.write_shift(4,a),i.write_shift(4,0);var u=320;l.hpx?u=Co(l.hpx)*20:l.hpt&&(u=l.hpt*20),i.write_shift(2,u),i.write_shift(1,0);var f=0;l.level&&(f|=l.level),l.hidden&&(f|=16),(l.hpx||l.hpt)&&(f|=32),i.write_shift(1,f),i.write_shift(1,0);var h=0,g=i.l;i.l+=4;for(var v={r:a,c:0},p=0;p<16;++p)if(!(n.s.c>p+1<<10||n.e.c<p<<10)){for(var S=-1,x=-1,C=p<<10;C<p+1<<10;++C){v.c=C;var T=Array.isArray(t)?(t[v.r]||[])[v.c]:t[ot(v)];T&&(S<0&&(S=C),x=C)}S<0||(++h,i.write_shift(4,S),i.write_shift(4,x))}var y=i.l;return i.l=g,i.write_shift(4,h),i.l=y,i.length>i.l?i.slice(0,i.l):i}function qE(a,n,t,i){var l=XE(i,t,n);(l.length>17||(n["!rows"]||[])[i])&&pe(a,0,l)}var JE=si,$E=os;function QE(){}function ZE(a,n){var t={},i=a[a.l];return++a.l,t.above=!(i&64),t.left=!(i&128),a.l+=18,t.name=oy(a),t}function e_(a,n,t){t==null&&(t=fe(84+4*a.length));var i=192;n&&(n.above&&(i&=-65),n.left&&(i&=-129)),t.write_shift(1,i);for(var l=1;l<3;++l)t.write_shift(1,0);return po({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),ug(a,t),t.slice(0,t.l)}function t_(a){var n=Za(a);return[n]}function a_(a,n,t){return t==null&&(t=fe(8)),ni(n,t)}function n_(a){var n=ri(a);return[n]}function r_(a,n,t){return t==null&&(t=fe(4)),ii(n,t)}function i_(a){var n=Za(a),t=a.read_shift(1);return[n,t,"b"]}function s_(a,n,t){return t==null&&(t=fe(9)),ni(n,t),t.write_shift(1,a.v?1:0),t}function l_(a){var n=ri(a),t=a.read_shift(1);return[n,t,"b"]}function c_(a,n,t){return t==null&&(t=fe(5)),ii(n,t),t.write_shift(1,a.v?1:0),t}function o_(a){var n=Za(a),t=a.read_shift(1);return[n,t,"e"]}function u_(a,n,t){return t==null&&(t=fe(9)),ni(n,t),t.write_shift(1,a.v),t}function f_(a){var n=ri(a),t=a.read_shift(1);return[n,t,"e"]}function d_(a,n,t){return t==null&&(t=fe(8)),ii(n,t),t.write_shift(1,a.v),t.write_shift(2,0),t.write_shift(1,0),t}function h_(a){var n=Za(a),t=a.read_shift(4);return[n,t,"s"]}function m_(a,n,t){return t==null&&(t=fe(12)),ni(n,t),t.write_shift(4,n.v),t}function v_(a){var n=ri(a),t=a.read_shift(4);return[n,t,"s"]}function g_(a,n,t){return t==null&&(t=fe(8)),ii(n,t),t.write_shift(4,n.v),t}function p_(a){var n=Za(a),t=us(a);return[n,t,"n"]}function x_(a,n,t){return t==null&&(t=fe(16)),ni(n,t),ei(a.v,t),t}function S_(a){var n=ri(a),t=us(a);return[n,t,"n"]}function y_(a,n,t){return t==null&&(t=fe(12)),ii(n,t),ei(a.v,t),t}function C_(a){var n=Za(a),t=fg(a);return[n,t,"n"]}function T_(a,n,t){return t==null&&(t=fe(12)),ni(n,t),dg(a.v,t),t}function E_(a){var n=ri(a),t=fg(a);return[n,t,"n"]}function __(a,n,t){return t==null&&(t=fe(8)),ii(n,t),dg(a.v,t),t}function w_(a){var n=Za(a),t=Nf(a);return[n,t,"is"]}function b_(a){var n=Za(a),t=la(a);return[n,t,"str"]}function N_(a,n,t){return t==null&&(t=fe(12+4*a.v.length)),ni(n,t),Gt(a.v,t),t.length>t.l?t.slice(0,t.l):t}function A_(a){var n=ri(a),t=la(a);return[n,t,"str"]}function D_(a,n,t){return t==null&&(t=fe(8+4*a.v.length)),ii(n,t),Gt(a.v,t),t.length>t.l?t.slice(0,t.l):t}function M_(a,n,t){var i=a.l+n,l=Za(a);l.r=t["!row"];var u=a.read_shift(1),f=[l,u,"b"];if(t.cellFormula){a.l+=2;var h=Uo(a,i-a.l,t);f[3]=ss(h,null,l,t.supbooks,t)}else a.l=i;return f}function j_(a,n,t){var i=a.l+n,l=Za(a);l.r=t["!row"];var u=a.read_shift(1),f=[l,u,"e"];if(t.cellFormula){a.l+=2;var h=Uo(a,i-a.l,t);f[3]=ss(h,null,l,t.supbooks,t)}else a.l=i;return f}function k_(a,n,t){var i=a.l+n,l=Za(a);l.r=t["!row"];var u=us(a),f=[l,u,"n"];if(t.cellFormula){a.l+=2;var h=Uo(a,i-a.l,t);f[3]=ss(h,null,l,t.supbooks,t)}else a.l=i;return f}function U_(a,n,t){var i=a.l+n,l=Za(a);l.r=t["!row"];var u=la(a),f=[l,u,"str"];if(t.cellFormula){a.l+=2;var h=Uo(a,i-a.l,t);f[3]=ss(h,null,l,t.supbooks,t)}else a.l=i;return f}var O_=si,I_=os;function R_(a,n){return n==null&&(n=fe(4)),n.write_shift(4,a),n}function F_(a,n){var t=a.l+n,i=si(a),l=Af(a),u=la(a),f=la(a),h=la(a);a.l=t;var g={rfx:i,relId:l,loc:u,display:h};return f&&(g.Tooltip=f),g}function L_(a,n){var t=fe(50+4*(a[1].Target.length+(a[1].Tooltip||"").length));os({s:Ht(a[0]),e:Ht(a[0])},t),Df("rId"+n,t);var i=a[1].Target.indexOf("#"),l=i==-1?"":a[1].Target.slice(i+1);return Gt(l||"",t),Gt(a[1].Tooltip||"",t),Gt("",t),t.slice(0,t.l)}function B_(){}function K_(a,n,t){var i=a.l+n,l=hg(a),u=a.read_shift(1),f=[l];if(f[2]=u,t.cellFormula){var h=AE(a,i-a.l,t);f[1]=h}else a.l=i;return f}function P_(a,n,t){var i=a.l+n,l=si(a),u=[l];if(t.cellFormula){var f=ME(a,i-a.l,t);u[1]=f,a.l=i}else a.l=i;return u}function z_(a,n,t){t==null&&(t=fe(18));var i=Oo(a,n);t.write_shift(-4,a),t.write_shift(-4,a),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var l=0;return n.hidden&&(l|=1),typeof i.width=="number"&&(l|=2),n.level&&(l|=n.level<<8),t.write_shift(2,l),t}var Jg=["left","right","top","bottom","header","footer"];function H_(a){var n={};return Jg.forEach(function(t){n[t]=us(a)}),n}function G_(a,n){return n==null&&(n=fe(48)),Xg(a),Jg.forEach(function(t){ei(a[t],n)}),n}function W_(a){var n=a.read_shift(2);return a.l+=28,{RTL:n&32}}function V_(a,n,t){t==null&&(t=fe(30));var i=924;return(((n||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Y_(a){var n=fe(24);return n.write_shift(4,4),n.write_shift(4,1),os(a,n),n}function X_(a,n){return n==null&&(n=fe(66)),n.write_shift(2,a.password?jg(a.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?n.write_shift(4,a[t[0]]!=null&&!a[t[0]]?1:0):n.write_shift(4,a[t[0]]!=null&&a[t[0]]?0:1)}),n}function q_(){}function J_(){}function $_(a,n,t,i,l,u,f){if(n.v===void 0)return!1;var h="";switch(n.t){case"b":h=n.v?"1":"0";break;case"d":n=Ea(n),n.z=n.z||Nt[14],n.v=Ta(ha(n.v)),n.t="n";break;case"n":case"e":h=""+n.v;break;default:h=n.v;break}var g={r:t,c:i};switch(g.s=Ar(l.cellXfs,n,l),n.l&&u["!links"].push([ot(g),n.l]),n.c&&u["!comments"].push([ot(g),n.c]),n.t){case"s":case"str":return l.bookSST?(h=If(l.Strings,n.v,l.revStrings),g.t="s",g.v=h,f?pe(a,18,g_(n,g)):pe(a,7,m_(n,g))):(g.t="str",f?pe(a,17,D_(n,g)):pe(a,6,N_(n,g))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?f?pe(a,13,__(n,g)):pe(a,2,T_(n,g)):f?pe(a,16,y_(n,g)):pe(a,5,x_(n,g)),!0;case"b":return g.t="b",f?pe(a,15,c_(n,g)):pe(a,4,s_(n,g)),!0;case"e":return g.t="e",f?pe(a,14,d_(n,g)):pe(a,3,u_(n,g)),!0}return f?pe(a,12,r_(n,g)):pe(a,1,a_(n,g)),!0}function Q_(a,n,t,i){var l=yt(n["!ref"]||"A1"),u,f="",h=[];pe(a,145);var g=Array.isArray(n),v=l.e.r;n["!rows"]&&(v=Math.max(l.e.r,n["!rows"].length-1));for(var p=l.s.r;p<=v;++p){f=ta(p),qE(a,n,l,p);var S=!1;if(p<=l.e.r)for(var x=l.s.c;x<=l.e.c;++x){p===l.s.r&&(h[x]=sa(x)),u=h[x]+f;var C=g?(n[p]||[])[x]:n[u];if(!C){S=!1;continue}S=$_(a,C,p,x,i,n,S)}}pe(a,146)}function Z_(a,n){!n||!n["!merges"]||(pe(a,177,R_(n["!merges"].length)),n["!merges"].forEach(function(t){pe(a,176,I_(t))}),pe(a,178))}function ew(a,n){!n||!n["!cols"]||(pe(a,390),n["!cols"].forEach(function(t,i){t&&pe(a,60,z_(i,t))}),pe(a,391))}function tw(a,n){!n||!n["!ref"]||(pe(a,648),pe(a,649,Y_(yt(n["!ref"]))),pe(a,650))}function aw(a,n,t){n["!links"].forEach(function(i){if(i[1].Target){var l=lt(t,-1,i[1].Target.replace(/#.*$/,""),tt.HLINK);pe(a,494,L_(i,l))}}),delete n["!links"]}function nw(a,n,t,i){if(n["!comments"].length>0){var l=lt(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",tt.VML);pe(a,551,Df("rId"+l)),n["!legacy"]=l}}function rw(a,n,t,i){if(n["!autofilter"]){var l=n["!autofilter"],u=typeof l.ref=="string"?l.ref:It(l.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,h=Fa(u);h.s.r==h.e.r&&(h.e.r=Fa(n["!ref"]).e.r,u=It(h));for(var g=0;g<f.length;++g){var v=f[g];if(v.Name=="_xlnm._FilterDatabase"&&v.Sheet==i){v.Ref="'"+t.SheetNames[i]+"'!"+u;break}}g==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+u}),pe(a,161,os(yt(u))),pe(a,162)}}function iw(a,n,t){pe(a,133),pe(a,137,V_(n,t)),pe(a,138),pe(a,134)}function sw(a,n){n["!protect"]&&pe(a,535,X_(n["!protect"]))}function lw(a,n,t,i){var l=Ca(),u=t.SheetNames[a],f=t.Sheets[u]||{},h=u;try{t&&t.Workbook&&(h=t.Workbook.Sheets[a].CodeName||h)}catch{}var g=yt(f["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(n.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return f["!links"]=[],f["!comments"]=[],pe(l,129),(t.vbaraw||f["!outline"])&&pe(l,147,e_(h,f["!outline"])),pe(l,148,$E(g)),iw(l,f,t.Workbook),ew(l,f),Q_(l,f,a,n),sw(l,f),rw(l,f,t,a),Z_(l,f),aw(l,f,i),f["!margins"]&&pe(l,476,G_(f["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&tw(l,f),nw(l,f,a,i),pe(l,130),l.end()}function cw(a,n){a.l+=10;var t=la(a);return{name:t}}var ow=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function uw(a){return!a.Workbook||!a.Workbook.WBProps?"false":P2(a.Workbook.WBProps.date1904)?"true":"false"}var fw="][*?/\\".split("");function $g(a,n){if(a.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return fw.forEach(function(i){if(a.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function dw(a,n,t){a.forEach(function(i,l){$g(i);for(var u=0;u<l;++u)if(i==a[u])throw new Error("Duplicate Sheet Name: "+i);if(t){var f=n&&n[l]&&n[l].CodeName||i;if(f.charCodeAt(0)==95&&f.length>22)throw new Error("Bad Code Name: Worksheet"+f)}})}function hw(a){if(!a||!a.SheetNames||!a.Sheets)throw new Error("Invalid Workbook");if(!a.SheetNames.length)throw new Error("Workbook is empty");var n=a.Workbook&&a.Workbook.Sheets||[];dw(a.SheetNames,n,!!a.vbaraw);for(var t=0;t<a.SheetNames.length;++t)IE(a.Sheets[a.SheetNames[t]],a.SheetNames[t],t)}function Qg(a){var n=[Rt];n[n.length]=Ee("workbook",null,{xmlns:ls[0],"xmlns:r":zt.r});var t=a.Workbook&&(a.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(ow.forEach(function(h){a.Workbook.WBProps[h[0]]!=null&&a.Workbook.WBProps[h[0]]!=h[1]&&(i[h[0]]=a.Workbook.WBProps[h[0]])}),a.Workbook.WBProps.CodeName&&(i.codeName=a.Workbook.WBProps.CodeName,delete i.CodeName)),n[n.length]=Ee("workbookPr",null,i);var l=a.Workbook&&a.Workbook.Sheets||[],u=0;if(l&&l[0]&&l[0].Hidden){for(n[n.length]="<bookViews>",u=0;u!=a.SheetNames.length&&!(!l[u]||!l[u].Hidden);++u);u==a.SheetNames.length&&(u=0),n[n.length]='<workbookView firstSheet="'+u+'" activeTab="'+u+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",u=0;u!=a.SheetNames.length;++u){var f={name:ct(a.SheetNames[u].slice(0,31))};if(f.sheetId=""+(u+1),f["r:id"]="rId"+(u+1),l[u])switch(l[u].Hidden){case 1:f.state="hidden";break;case 2:f.state="veryHidden";break}n[n.length]=Ee("sheet",null,f)}return n[n.length]="</sheets>",t&&(n[n.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(h){var g={name:h.Name};h.Comment&&(g.comment=h.Comment),h.Sheet!=null&&(g.localSheetId=""+h.Sheet),h.Hidden&&(g.hidden="1"),h.Ref&&(n[n.length]=Ee("definedName",ct(h.Ref),g))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function mw(a,n){var t={};return t.Hidden=a.read_shift(4),t.iTabID=a.read_shift(4),t.strRelID=hf(a),t.name=la(a),t}function vw(a,n){return n||(n=fe(127)),n.write_shift(4,a.Hidden),n.write_shift(4,a.iTabID),Df(a.strRelID,n),Gt(a.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function gw(a,n){var t={},i=a.read_shift(4);t.defaultThemeVersion=a.read_shift(4);var l=n>8?la(a):"";return l.length>0&&(t.CodeName=l),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function pw(a,n){n||(n=fe(72));var t=0;return a&&a.filterPrivacy&&(t|=8),n.write_shift(4,t),n.write_shift(4,0),ug(a&&a.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function xw(a,n,t){var i=a.l+n;a.l+=4,a.l+=1;var l=a.read_shift(4),u=uy(a),f=DE(a,0,t),h=Af(a);a.l=i;var g={Name:u,Ptg:f};return l<268435455&&(g.Sheet=l),h&&(g.Comment=h),g}function Sw(a,n){pe(a,143);for(var t=0;t!=n.SheetNames.length;++t){var i=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t]&&n.Workbook.Sheets[t].Hidden||0,l={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:n.SheetNames[t]};pe(a,156,vw(l))}pe(a,144)}function yw(a,n){n||(n=fe(127));for(var t=0;t!=4;++t)n.write_shift(4,0);return Gt("SheetJS",n),Gt(co.version,n),Gt(co.version,n),Gt("7262",n),n.length>n.l?n.slice(0,n.l):n}function Cw(a,n){n||(n=fe(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,a),n.write_shift(4,a);var t=120;return n.write_shift(1,t),n.length>n.l?n.slice(0,n.l):n}function Tw(a,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var t=n.Workbook.Sheets,i=0,l=-1,u=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&l==-1?l=i:t[i].Hidden==1&&u==-1&&(u=i);u>l||(pe(a,135),pe(a,158,Cw(l)),pe(a,136))}}function Ew(a,n){var t=Ca();return pe(t,131),pe(t,128,yw()),pe(t,153,pw(a.Workbook&&a.Workbook.WBProps||null)),Tw(t,a),Sw(t,a),pe(t,132),t.end()}function _w(a,n,t){return(n.slice(-4)===".bin"?Ew:Qg)(a)}function ww(a,n,t,i,l){return(n.slice(-4)===".bin"?lw:qg)(a,t,i,l)}function bw(a,n,t){return(n.slice(-4)===".bin"?GC:Og)(a,t)}function Nw(a,n,t){return(n.slice(-4)===".bin"?pC:Mg)(a,t)}function Aw(a,n,t){return(n.slice(-4)===".bin"?sT:Bg)(a)}function Dw(a){return(a.slice(-4)===".bin"?QC:Fg)()}function Mw(a,n){var t=[];return a.Props&&t.push(by(a.Props,n)),a.Custprops&&t.push(Ny(a.Props,a.Custprops)),t.join("")}function jw(){return""}function kw(a,n){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(i,l){var u=[];u.push(Ee("NumberFormat",null,{"ss:Format":ct(Nt[i.numFmtId])}));var f={"ss:ID":"s"+(21+l)};t.push(Ee("Style",u.join(""),f))}),Ee("Styles",t.join(""))}function Zg(a){return Ee("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+Uf(a.Ref,{r:0,c:0})})}function Uw(a){if(!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,t=[],i=0;i<n.length;++i){var l=n[i];l.Sheet==null&&(l.Name.match(/^_xlfn\./)||t.push(Zg(l)))}return Ee("Names",t.join(""))}function Ow(a,n,t,i){if(!a||!((i||{}).Workbook||{}).Names)return"";for(var l=i.Workbook.Names,u=[],f=0;f<l.length;++f){var h=l[f];h.Sheet==t&&(h.Name.match(/^_xlfn\./)||u.push(Zg(h)))}return u.join("")}function Iw(a,n,t,i){if(!a)return"";var l=[];if(a["!margins"]&&(l.push("<PageSetup>"),a["!margins"].header&&l.push(Ee("Header",null,{"x:Margin":a["!margins"].header})),a["!margins"].footer&&l.push(Ee("Footer",null,{"x:Margin":a["!margins"].footer})),l.push(Ee("PageMargins",null,{"x:Bottom":a["!margins"].bottom||"0.75","x:Left":a["!margins"].left||"0.7","x:Right":a["!margins"].right||"0.7","x:Top":a["!margins"].top||"0.75"})),l.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)l.push(Ee("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var u=0;u<t&&!(i.Workbook.Sheets[u]&&!i.Workbook.Sheets[u].Hidden);++u);u==t&&l.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&l.push("<DisplayRightToLeft/>"),a["!protect"]&&(l.push(ea("ProtectContents","True")),a["!protect"].objects&&l.push(ea("ProtectObjects","True")),a["!protect"].scenarios&&l.push(ea("ProtectScenarios","True")),a["!protect"].selectLockedCells!=null&&!a["!protect"].selectLockedCells?l.push(ea("EnableSelection","NoSelection")):a["!protect"].selectUnlockedCells!=null&&!a["!protect"].selectUnlockedCells&&l.push(ea("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(f){a["!protect"][f[0]]&&l.push("<"+f[1]+"/>")})),l.length==0?"":Ee("WorksheetOptions",l.join(""),{xmlns:Ia.x})}function Rw(a){return a.map(function(n){var t=K2(n.t||""),i=Ee("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ee("Comment",i,{"ss:Author":n.a})}).join("")}function Fw(a,n,t,i,l,u,f){if(!a||a.v==null&&a.f==null)return"";var h={};if(a.f&&(h["ss:Formula"]="="+ct(Uf(a.f,f))),a.F&&a.F.slice(0,n.length)==n){var g=Ht(a.F.slice(n.length+1));h["ss:ArrayRange"]="RC:R"+(g.r==f.r?"":"["+(g.r-f.r)+"]")+"C"+(g.c==f.c?"":"["+(g.c-f.c)+"]")}if(a.l&&a.l.Target&&(h["ss:HRef"]=ct(a.l.Target),a.l.Tooltip&&(h["x:HRefScreenTip"]=ct(a.l.Tooltip))),t["!merges"])for(var v=t["!merges"],p=0;p!=v.length;++p)v[p].s.c!=f.c||v[p].s.r!=f.r||(v[p].e.c>v[p].s.c&&(h["ss:MergeAcross"]=v[p].e.c-v[p].s.c),v[p].e.r>v[p].s.r&&(h["ss:MergeDown"]=v[p].e.r-v[p].s.r));var S="",x="";switch(a.t){case"z":if(!i.sheetStubs)return"";break;case"n":S="Number",x=String(a.v);break;case"b":S="Boolean",x=a.v?"1":"0";break;case"e":S="Error",x=Ml[a.v];break;case"d":S="DateTime",x=new Date(a.v).toISOString(),a.z==null&&(a.z=a.z||Nt[14]);break;case"s":S="String",x=B2(a.v||"");break}var C=Ar(i.cellXfs,a,i);h["ss:StyleID"]="s"+(21+C),h["ss:Index"]=f.c+1;var T=a.v!=null?x:"",y=a.t=="z"?"":'<Data ss:Type="'+S+'">'+T+"</Data>";return(a.c||[]).length>0&&(y+=Rw(a.c)),Ee("Cell",y,h)}function Lw(a,n){var t='<Row ss:Index="'+(a+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=Ug(n.hpt)),n.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Bw(a,n,t,i){if(!a["!ref"])return"";var l=yt(a["!ref"]),u=a["!merges"]||[],f=0,h=[];a["!cols"]&&a["!cols"].forEach(function(_,w){jf(_);var k=!!_.width,M=Oo(w,_),N={"ss:Index":w+1};k&&(N["ss:Width"]=So(M.width)),_.hidden&&(N["ss:Hidden"]="1"),h.push(Ee("Column",null,N))});for(var g=Array.isArray(a),v=l.s.r;v<=l.e.r;++v){for(var p=[Lw(v,(a["!rows"]||[])[v])],S=l.s.c;S<=l.e.c;++S){var x=!1;for(f=0;f!=u.length;++f)if(!(u[f].s.c>S)&&!(u[f].s.r>v)&&!(u[f].e.c<S)&&!(u[f].e.r<v)){(u[f].s.c!=S||u[f].s.r!=v)&&(x=!0);break}if(!x){var C={r:v,c:S},T=ot(C),y=g?(a[v]||[])[S]:a[T];p.push(Fw(y,T,a,n,t,i,C))}}p.push("</Row>"),p.length>2&&h.push(p.join(""))}return h.join("")}function Kw(a,n,t){var i=[],l=t.SheetNames[a],u=t.Sheets[l],f=u?Ow(u,n,a,t):"";return f.length>0&&i.push("<Names>"+f+"</Names>"),f=u?Bw(u,n,a,t):"",f.length>0&&i.push("<Table>"+f+"</Table>"),i.push(Iw(u,n,a,t)),i.join("")}function Pw(a,n){n||(n={}),a.SSF||(a.SSF=Ea(Nt)),a.SSF&&(Do(),Ao(a.SSF),n.revssf=Mo(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF,n.cellXfs=[],Ar(n.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Mw(a,n)),t.push(jw()),t.push(""),t.push("");for(var i=0;i<a.SheetNames.length;++i)t.push(Ee("Worksheet",Kw(i,n,a),{"ss:Name":ct(a.SheetNames[i])}));return t[2]=kw(a,n),t[3]=Uw(a),Rt+Ee("Workbook",t.join(""),{xmlns:Ia.ss,"xmlns:o":Ia.o,"xmlns:x":Ia.x,"xmlns:ss":Ia.ss,"xmlns:dt":Ia.dt,"xmlns:html":Ia.html})}var sf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function zw(a,n){var t=[],i=[],l=[],u=0,f,h=W1(rv,"n"),g=W1(iv,"n");if(a.Props)for(f=aa(a.Props),u=0;u<f.length;++u)(Object.prototype.hasOwnProperty.call(h,f[u])?t:Object.prototype.hasOwnProperty.call(g,f[u])?i:l).push([f[u],a.Props[f[u]]]);if(a.Custprops)for(f=aa(a.Custprops),u=0;u<f.length;++u)Object.prototype.hasOwnProperty.call(a.Props||{},f[u])||(Object.prototype.hasOwnProperty.call(h,f[u])?t:Object.prototype.hasOwnProperty.call(g,f[u])?i:l).push([f[u],a.Custprops[f[u]]]);var v=[];for(u=0;u<l.length;++u)Eg.indexOf(l[u][0])>-1||yg.indexOf(l[u][0])>-1||l[u][1]!=null&&v.push(l[u]);i.length&&ht.utils.cfb_add(n,"/SummaryInformation",uv(i,sf.SI,g,iv)),(t.length||v.length)&&ht.utils.cfb_add(n,"/DocumentSummaryInformation",uv(t,sf.DSI,h,rv,v.length?v:null,sf.UDI))}function Hw(a,n){var t=n||{},i=ht.utils.cfb_new({root:"R"}),l="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":l="/Workbook",t.biff=8;break;case"biff5":l="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return ht.utils.cfb_add(i,l,ep(a,t)),t.biff==8&&(a.Props||a.Custprops)&&zw(a,i),t.biff==8&&a.vbaraw&&lT(i,ht.read(a.vbaraw,{type:typeof a.vbaraw=="string"?"binary":"buffer"})),i}var Gw={0:{f:YE},1:{f:t_},2:{f:C_},3:{f:o_},4:{f:i_},5:{f:p_},6:{f:b_},7:{f:h_},8:{f:U_},9:{f:k_},10:{f:M_},11:{f:j_},12:{f:n_},13:{f:E_},14:{f:f_},15:{f:l_},16:{f:S_},17:{f:A_},18:{f:v_},19:{f:Nf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:xw},40:{},42:{},43:{f:bC},44:{f:_C},45:{f:DC},46:{f:jC},47:{f:MC},48:{},49:{f:ny},50:{},51:{f:YC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rC},62:{f:w_},63:{f:ZC},64:{f:q_},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:W_},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ZE},148:{f:JE,p:16},151:{f:B_},152:{},153:{f:gw},154:{},155:{},156:{f:mw},157:{},158:{},159:{T:1,f:mC},160:{T:-1},161:{T:1,f:si},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:O_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:WC},336:{T:-1},337:{f:JC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Qy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:K_},427:{f:P_},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:H_},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:F_},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:rT},633:{T:1},634:{T:-1},635:{T:1,f:aT},636:{T:-1},637:{f:ly},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cw},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:J_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(a,n,t,i){var l=n;if(!isNaN(l)){var u=i||(t||[]).length||0,f=a.next(4);f.write_shift(2,l),f.write_shift(2,u),u>0&&_f(t)&&a.push(t)}}function Ww(a,n,t,i){var l=(t||[]).length||0;if(l<=8224)return _e(a,n,t,l);var u=n;if(!isNaN(u)){for(var f=t.parts||[],h=0,g=0,v=0;v+(f[h]||8224)<=8224;)v+=f[h]||8224,h++;var p=a.next(4);for(p.write_shift(2,u),p.write_shift(2,v),a.push(t.slice(g,g+v)),g+=v;g<l;){for(p=a.next(4),p.write_shift(2,60),v=0;v+(f[h]||8224)<=8224;)v+=f[h]||8224,h++;p.write_shift(2,v),a.push(t.slice(g,g+v)),g+=v}}}function kl(a,n,t){return a||(a=fe(7)),a.write_shift(2,n),a.write_shift(2,t),a.write_shift(2,0),a.write_shift(1,0),a}function Vw(a,n,t,i){var l=fe(9);return kl(l,a,n),wg(t,i||"b",l),l}function Yw(a,n,t){var i=fe(8+2*t.length);return kl(i,a,n),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function Xw(a,n,t,i){if(n.v!=null)switch(n.t){case"d":case"n":var l=n.t=="d"?Ta(ha(n.v)):n.v;l==(l|0)&&l>=0&&l<65536?_e(a,2,cC(t,i,l)):_e(a,3,lC(t,i,l));return;case"b":case"e":_e(a,5,Vw(t,i,n.v,n.t));return;case"s":case"str":_e(a,4,Yw(t,i,(n.v||"").slice(0,255)));return}_e(a,1,kl(null,t,i))}function qw(a,n,t,i){var l=Array.isArray(n),u=yt(n["!ref"]||"A1"),f,h="",g=[];if(u.e.c>255||u.e.r>16383){if(i.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,16383),f=It(u)}for(var v=u.s.r;v<=u.e.r;++v){h=ta(v);for(var p=u.s.c;p<=u.e.c;++p){v===u.s.r&&(g[p]=sa(p)),f=g[p]+h;var S=l?(n[v]||[])[p]:n[f];S&&Xw(a,S,v,p)}}}function Jw(a,n){for(var t=n||{},i=Ca(),l=0,u=0;u<a.SheetNames.length;++u)a.SheetNames[u]==t.sheet&&(l=u);if(l==0&&t.sheet&&a.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return _e(i,t.biff==4?1033:t.biff==3?521:9,Mf(a,16,t)),qw(i,a.Sheets[a.SheetNames[l]],l,t),_e(i,10),i.end()}function $w(a,n,t){_e(a,49,Gy({sz:12,name:"Arial"},t))}function Qw(a,n,t){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var l=i[0];l<=i[1];++l)n[l]!=null&&_e(a,1054,Yy(l,n[l],t))})}function Zw(a,n){var t=fe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),_e(a,2151,t),t=fe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Ag(yt(n["!ref"]||"A1"),t),t.write_shift(4,4),_e(a,2152,t)}function eb(a,n){for(var t=0;t<16;++t)_e(a,224,dv({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(i){_e(a,224,dv(i,0,n))})}function tb(a,n){for(var t=0;t<n["!links"].length;++t){var i=n["!links"][t];_e(a,440,tC(i)),i[1].Tooltip&&_e(a,2048,aC(i))}delete n["!links"]}function ab(a,n){if(n){var t=0;n.forEach(function(i,l){++t<=256&&i&&_e(a,125,iC(Oo(l,i),l))})}}function nb(a,n,t,i,l){var u=16+Ar(l.cellXfs,n,l);if(n.v==null&&!n.bf){_e(a,513,ti(t,i,u));return}if(n.bf)_e(a,6,NE(n,t,i,l,u));else switch(n.t){case"d":case"n":var f=n.t=="d"?Ta(ha(n.v)):n.v;_e(a,515,$y(t,i,f,u));break;case"b":case"e":_e(a,517,Jy(t,i,n.v,u,l,n.t));break;case"s":case"str":if(l.bookSST){var h=If(l.Strings,n.v,l.revStrings);_e(a,253,Wy(t,i,h,u))}else _e(a,516,Vy(t,i,(n.v||"").slice(0,255),u,l));break;default:_e(a,513,ti(t,i,u))}}function rb(a,n,t){var i=Ca(),l=t.SheetNames[a],u=t.Sheets[l]||{},f=(t||{}).Workbook||{},h=(f.Sheets||[])[a]||{},g=Array.isArray(u),v=n.biff==8,p,S="",x=[],C=yt(u["!ref"]||"A1"),T=v?65536:16384;if(C.e.c>255||C.e.r>=T){if(n.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,T-1)}_e(i,2057,Mf(t,16,n)),_e(i,13,Qa(1)),_e(i,12,Qa(100)),_e(i,15,da(!0)),_e(i,17,da(!1)),_e(i,16,ei(.001)),_e(i,95,da(!0)),_e(i,42,da(!1)),_e(i,43,da(!1)),_e(i,130,Qa(1)),_e(i,128,qy()),_e(i,131,da(!1)),_e(i,132,da(!1)),v&&ab(i,u["!cols"]),_e(i,512,Xy(C,n)),v&&(u["!links"]=[]);for(var y=C.s.r;y<=C.e.r;++y){S=ta(y);for(var _=C.s.c;_<=C.e.c;++_){y===C.s.r&&(x[_]=sa(_)),p=x[_]+S;var w=g?(u[y]||[])[_]:u[p];w&&(nb(i,w,y,_,n),v&&w.l&&u["!links"].push([p,w.l]))}}var k=h.CodeName||h.name||l;return v&&_e(i,574,Hy((f.Views||[])[0])),v&&(u["!merges"]||[]).length&&_e(i,229,eC(u["!merges"])),v&&tb(i,u),_e(i,442,Ng(k)),v&&Zw(i,u),_e(i,10),i.end()}function ib(a,n,t){var i=Ca(),l=(a||{}).Workbook||{},u=l.Sheets||[],f=l.WBProps||{},h=t.biff==8,g=t.biff==5;if(_e(i,2057,Mf(a,5,t)),t.bookType=="xla"&&_e(i,135),_e(i,225,h?Qa(1200):null),_e(i,193,My(2)),g&&_e(i,191),g&&_e(i,192),_e(i,226),_e(i,92,By("SheetJS",t)),_e(i,66,Qa(h?1200:1252)),h&&_e(i,353,Qa(0)),h&&_e(i,448),_e(i,317,sC(a.SheetNames.length)),h&&a.vbaraw&&_e(i,211),h&&a.vbaraw){var v=f.CodeName||"ThisWorkbook";_e(i,442,Ng(v))}_e(i,156,Qa(17)),_e(i,25,da(!1)),_e(i,18,da(!1)),_e(i,19,Qa(0)),h&&_e(i,431,da(!1)),h&&_e(i,444,Qa(0)),_e(i,61,zy()),_e(i,64,da(!1)),_e(i,141,Qa(0)),_e(i,34,da(uw(a)=="true")),_e(i,14,da(!0)),h&&_e(i,439,da(!1)),_e(i,218,Qa(0)),$w(i,a,t),Qw(i,a.SSF,t),eb(i,t),h&&_e(i,352,da(!1));var p=i.end(),S=Ca();h&&_e(S,140,nC()),h&&t.Strings&&Ww(S,252,Py(t.Strings)),_e(S,10);var x=S.end(),C=Ca(),T=0,y=0;for(y=0;y<a.SheetNames.length;++y)T+=(h?12:11)+(h?2:1)*a.SheetNames[y].length;var _=p.length+T+x.length;for(y=0;y<a.SheetNames.length;++y){var w=u[y]||{};_e(C,133,Ky({pos:_,hs:w.Hidden||0,dt:0,name:a.SheetNames[y]},t)),_+=n[y].length}var k=C.end();if(T!=k.length)throw new Error("BS8 "+T+" != "+k.length);var M=[];return p.length&&M.push(p),k.length&&M.push(k),x.length&&M.push(x),Zt(M)}function sb(a,n){var t=n||{},i=[];a&&!a.SSF&&(a.SSF=Ea(Nt)),a&&a.SSF&&(Do(),Ao(a.SSF),t.revssf=Mo(a.SSF),t.revssf[a.SSF[65535]]=0,t.ssf=a.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rf(t),t.cellXfs=[],Ar(t.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={});for(var l=0;l<a.SheetNames.length;++l)i[i.length]=rb(l,t,a);return i.unshift(ib(a,i,t)),Zt(i)}function ep(a,n){for(var t=0;t<=a.SheetNames.length;++t){var i=a.Sheets[a.SheetNames[t]];if(!(!i||!i["!ref"])){var l=Fa(i["!ref"]);l.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+a.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var u=n||{};switch(u.biff||2){case 8:case 5:return sb(a,n);case 4:case 3:case 2:return Jw(a,n)}throw new Error("invalid type "+u.bookType+" for BIFF")}function lb(a,n,t,i){for(var l=a["!merges"]||[],u=[],f=n.s.c;f<=n.e.c;++f){for(var h=0,g=0,v=0;v<l.length;++v)if(!(l[v].s.r>t||l[v].s.c>f)&&!(l[v].e.r<t||l[v].e.c<f)){if(l[v].s.r<t||l[v].s.c<f){h=-1;break}h=l[v].e.r-l[v].s.r+1,g=l[v].e.c-l[v].s.c+1;break}if(!(h<0)){var p=ot({r:t,c:f}),S=i.dense?(a[t]||[])[f]:a[p],x=S&&S.v!=null&&(S.h||L2(S.w||(Yn(S),S.w)||""))||"",C={};h>1&&(C.rowspan=h),g>1&&(C.colspan=g),i.editable?x='<span contenteditable="true">'+x+"</span>":S&&(C["data-t"]=S&&S.t||"z",S.v!=null&&(C["data-v"]=S.v),S.z!=null&&(C["data-z"]=S.z),S.l&&(S.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+S.l.Target+'">'+x+"</a>")),C.id=(i.id||"sjs")+"-"+p,u.push(Ee("td",x,C))}}var T="<tr>";return T+u.join("")+"</tr>"}var cb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ob="</body></html>";function ub(a,n,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function tp(a,n){var t=n||{},i=t.header!=null?t.header:cb,l=t.footer!=null?t.footer:ob,u=[i],f=Fa(a["!ref"]);t.dense=Array.isArray(a),u.push(ub(a,f,t));for(var h=f.s.r;h<=f.e.r;++h)u.push(lb(a,f,h,t));return u.push("</table>"+l),u.join("")}function ap(a,n,t){var i=t||{},l=0,u=0;if(i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Ht(i.origin):i.origin;l=f.r,u=f.c}var h=n.getElementsByTagName("tr"),g=Math.min(i.sheetRows||1e7,h.length),v={s:{r:0,c:0},e:{r:l,c:u}};if(a["!ref"]){var p=Fa(a["!ref"]);v.s.r=Math.min(v.s.r,p.s.r),v.s.c=Math.min(v.s.c,p.s.c),v.e.r=Math.max(v.e.r,p.e.r),v.e.c=Math.max(v.e.c,p.e.c),l==-1&&(v.e.r=l=p.e.r+1)}var S=[],x=0,C=a["!rows"]||(a["!rows"]=[]),T=0,y=0,_=0,w=0,k=0,M=0;for(a["!cols"]||(a["!cols"]=[]);T<h.length&&y<g;++T){var N=h[T];if(Sv(N)){if(i.display)continue;C[y]={hidden:!0}}var K=N.children;for(_=w=0;_<K.length;++_){var J=K[_];if(!(i.display&&Sv(J))){var B=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):z2(J.innerHTML),Z=J.getAttribute("data-z")||J.getAttribute("z");for(x=0;x<S.length;++x){var L=S[x];L.s.c==w+u&&L.s.r<y+l&&y+l<=L.e.r&&(w=L.e.c+1-u,x=-1)}M=+J.getAttribute("colspan")||1,((k=+J.getAttribute("rowspan")||1)>1||M>1)&&S.push({s:{r:y+l,c:w+u},e:{r:y+l+(k||1)-1,c:w+u+(M||1)-1}});var X={t:"s",v:B},D=J.getAttribute("data-t")||J.getAttribute("t")||"";B!=null&&(B.length==0?X.t=D||"z":i.raw||B.trim().length==0||D=="s"||(B==="TRUE"?X={t:"b",v:!0}:B==="FALSE"?X={t:"b",v:!1}:isNaN(Gn(B))?isNaN(Tl(B).getDate())||(X={t:"d",v:ha(B)},i.cellDates||(X={t:"n",v:Ta(X.v)}),X.z=i.dateNF||Nt[14]):X={t:"n",v:Gn(B)})),X.z===void 0&&Z!=null&&(X.z=Z);var z="",ue=J.getElementsByTagName("A");if(ue&&ue.length)for(var be=0;be<ue.length&&!(ue[be].hasAttribute("href")&&(z=ue[be].getAttribute("href"),z.charAt(0)!="#"));++be);z&&z.charAt(0)!="#"&&(X.l={Target:z}),i.dense?(a[y+l]||(a[y+l]=[]),a[y+l][w+u]=X):a[ot({c:w+u,r:y+l})]=X,v.e.c<w+u&&(v.e.c=w+u),w+=M}}++y}return S.length&&(a["!merges"]=(a["!merges"]||[]).concat(S)),v.e.r=Math.max(v.e.r,y-1+l),a["!ref"]=It(v),y>=g&&(a["!fullref"]=It((v.e.r=h.length-T+y-1+l,v))),a}function np(a,n){var t=n||{},i=t.dense?[]:{};return ap(i,a,n)}function fb(a,n){return ai(np(a,n),n)}function Sv(a){var n="",t=db(a);return t&&(n=t(a).getPropertyValue("display")),n||(n=a.style&&a.style.display),n==="none"}function db(a){return a.ownerDocument.defaultView&&typeof a.ownerDocument.defaultView.getComputedStyle=="function"?a.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var hb=(function(){var a=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+_l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+a+"</office:document-styles>";return function(){return Rt+n}})(),yv=(function(){var a=function(u){return ct(u).replace(/  +/g,function(f){return'<text:s text:c="'+f.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(u,f,h){var g=[];g.push('      <table:table table:name="'+ct(f.SheetNames[h])+`" table:style-name="ta1">
`);var v=0,p=0,S=Fa(u["!ref"]||"A1"),x=u["!merges"]||[],C=0,T=Array.isArray(u);if(u["!cols"])for(p=0;p<=S.e.c;++p)g.push("        <table:table-column"+(u["!cols"][p]?' table:style-name="co'+u["!cols"][p].ods+'"':"")+`></table:table-column>
`);var y="",_=u["!rows"]||[];for(v=0;v<S.s.r;++v)y=_[v]?' table:style-name="ro'+_[v].ods+'"':"",g.push("        <table:table-row"+y+`></table:table-row>
`);for(;v<=S.e.r;++v){for(y=_[v]?' table:style-name="ro'+_[v].ods+'"':"",g.push("        <table:table-row"+y+`>
`),p=0;p<S.s.c;++p)g.push(n);for(;p<=S.e.c;++p){var w=!1,k={},M="";for(C=0;C!=x.length;++C)if(!(x[C].s.c>p)&&!(x[C].s.r>v)&&!(x[C].e.c<p)&&!(x[C].e.r<v)){(x[C].s.c!=p||x[C].s.r!=v)&&(w=!0),k["table:number-columns-spanned"]=x[C].e.c-x[C].s.c+1,k["table:number-rows-spanned"]=x[C].e.r-x[C].s.r+1;break}if(w){g.push(t);continue}var N=ot({r:v,c:p}),K=T?(u[v]||[])[p]:u[N];if(K&&K.f&&(k["table:formula"]=ct(UE(K.f)),K.F&&K.F.slice(0,N.length)==N)){var J=Fa(K.F);k["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,k["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1}if(!K){g.push(n);continue}switch(K.t){case"b":M=K.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=K.v?"true":"false";break;case"n":M=K.w||String(K.v||0),k["office:value-type"]="float",k["office:value"]=K.v||0;break;case"s":case"str":M=K.v==null?"":K.v,k["office:value-type"]="string";break;case"d":M=K.w||ha(K.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=ha(K.v).toISOString(),k["table:style-name"]="ce1";break;default:g.push(n);continue}var B=a(M);if(K.l&&K.l.Target){var Z=K.l.Target;Z=Z.charAt(0)=="#"?"#"+OE(Z.slice(1)):Z,Z.charAt(0)!="#"&&!Z.match(/^\w+:/)&&(Z="../"+Z),B=Ee("text:a",B,{"xlink:href":Z.replace(/&/g,"&amp;")})}g.push("          "+Ee("table:table-cell",Ee("text:p",B,{}),k)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},l=function(u,f){u.push(` <office:automatic-styles>
`),u.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),u.push(`   <number:month number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:day number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:year/>
`),u.push(`  </number:date-style>
`);var h=0;f.SheetNames.map(function(v){return f.Sheets[v]}).forEach(function(v){if(v&&v["!cols"]){for(var p=0;p<v["!cols"].length;++p)if(v["!cols"][p]){var S=v["!cols"][p];if(S.width==null&&S.wpx==null&&S.wch==null)continue;jf(S),S.ods=h;var x=v["!cols"][p].wpx+"px";u.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),u.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),u.push(`  </style:style>
`),++h}}});var g=0;f.SheetNames.map(function(v){return f.Sheets[v]}).forEach(function(v){if(v&&v["!rows"]){for(var p=0;p<v["!rows"].length;++p)if(v["!rows"][p]){v["!rows"][p].ods=g;var S=v["!rows"][p].hpx+"px";u.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),u.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+S+`"/>
`),u.push(`  </style:style>
`),++g}}}),u.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),u.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),u.push(`  </style:style>
`),u.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),u.push(` </office:automatic-styles>
`)};return function(f,h){var g=[Rt],v=_l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=_l({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+v+p+`>
`),g.push(xg().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+v+`>
`),l(g,f),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var S=0;S!=f.SheetNames.length;++S)g.push(i(f.Sheets[f.SheetNames[S]],f,S));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function rp(a,n){if(n.bookType=="fods")return yv(a,n);var t=yf(),i="",l=[],u=[];return i="mimetype",Ge(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Ge(t,i,yv(a,n)),l.push([i,"text/xml"]),u.push([i,"ContentFile"]),i="styles.xml",Ge(t,i,hb(a,n)),l.push([i,"text/xml"]),u.push([i,"StylesFile"]),i="meta.xml",Ge(t,i,Rt+xg()),l.push([i,"text/xml"]),u.push([i,"MetadataFile"]),i="manifest.rdf",Ge(t,i,wy(u)),l.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Ge(t,i,Ey(l)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function To(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function mb(a){return typeof TextEncoder<"u"?new TextEncoder().encode(a):un(El(a))}function vb(a,n){e:for(var t=0;t<=a.length-n.length;++t){for(var i=0;i<n.length;++i)if(a[t+i]!=n[i])continue e;return!0}return!1}function Nr(a){var n=a.reduce(function(l,u){return l+u.length},0),t=new Uint8Array(n),i=0;return a.forEach(function(l){t.set(l,i),i+=l.length}),t}function gb(a,n,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,l=t/Math.pow(10,i-6176);a[n+15]|=i>>7,a[n+14]|=(i&127)<<1;for(var u=0;l>=1;++u,l/=256)a[n+u]=l&255;a[n+15]|=t>=0?0:128}function wl(a,n){var t=n?n[0]:0,i=a[t]&127;e:if(a[t++]>=128&&(i|=(a[t]&127)<<7,a[t++]<128||(i|=(a[t]&127)<<14,a[t++]<128)||(i|=(a[t]&127)<<21,a[t++]<128)||(i+=(a[t]&127)*Math.pow(2,28),++t,a[t++]<128)||(i+=(a[t]&127)*Math.pow(2,35),++t,a[t++]<128)||(i+=(a[t]&127)*Math.pow(2,42),++t,a[t++]<128)))break e;return n&&(n[0]=t),i}function st(a){var n=new Uint8Array(7);n[0]=a&127;var t=1;e:if(a>127){if(n[t-1]|=128,n[t]=a>>7&127,++t,a<=16383||(n[t-1]|=128,n[t]=a>>14&127,++t,a<=2097151)||(n[t-1]|=128,n[t]=a>>21&127,++t,a<=268435455)||(n[t-1]|=128,n[t]=a/256>>>21&127,++t,a<=34359738367)||(n[t-1]|=128,n[t]=a/65536>>>21&127,++t,a<=4398046511103))break e;n[t-1]|=128,n[t]=a/16777216>>>21&127,++t}return n.slice(0,t)}function rs(a){var n=0,t=a[n]&127;e:if(a[n++]>=128){if(t|=(a[n]&127)<<7,a[n++]<128||(t|=(a[n]&127)<<14,a[n++]<128)||(t|=(a[n]&127)<<21,a[n++]<128))break e;t|=(a[n]&127)<<28}return t}function Lt(a){for(var n=[],t=[0];t[0]<a.length;){var i=t[0],l=wl(a,t),u=l&7;l=Math.floor(l/8);var f=0,h;if(l==0)break;switch(u){case 0:{for(var g=t[0];a[t[0]++]>=128;);h=a.slice(g,t[0])}break;case 5:f=4,h=a.slice(t[0],t[0]+f),t[0]+=f;break;case 1:f=8,h=a.slice(t[0],t[0]+f),t[0]+=f;break;case 2:f=wl(a,t),h=a.slice(t[0],t[0]+f),t[0]+=f;break;case 3:case 4:default:throw new Error("PB Type ".concat(u," for Field ").concat(l," at offset ").concat(i))}var v={data:h,type:u};n[l]==null?n[l]=[v]:n[l].push(v)}return n}function $t(a){var n=[];return a.forEach(function(t,i){t.forEach(function(l){l.data&&(n.push(st(i*8+l.type)),l.type==2&&n.push(st(l.data.length)),n.push(l.data))})}),Nr(n)}function ln(a){for(var n,t=[],i=[0];i[0]<a.length;){var l=wl(a,i),u=Lt(a.slice(i[0],i[0]+l));i[0]+=l;var f={id:rs(u[1][0].data),messages:[]};u[2].forEach(function(h){var g=Lt(h.data),v=rs(g[3][0].data);f.messages.push({meta:g,data:a.slice(i[0],i[0]+v)}),i[0]+=v}),(n=u[3])!=null&&n[0]&&(f.merge=rs(u[3][0].data)>>>0>0),t.push(f)}return t}function Xi(a){var n=[];return a.forEach(function(t){var i=[];i[1]=[{data:st(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:st(+!!t.merge),type:0}]);var l=[];t.messages.forEach(function(f){l.push(f.data),f.meta[3]=[{type:0,data:st(f.data.length)}],i[2].push({data:$t(f.meta),type:2})});var u=$t(i);n.push(st(u.length)),n.push(u),l.forEach(function(f){return n.push(f)})}),Nr(n)}function pb(a,n){if(a!=0)throw new Error("Unexpected Snappy chunk type ".concat(a));for(var t=[0],i=wl(n,t),l=[];t[0]<n.length;){var u=n[t[0]]&3;if(u==0){var f=n[t[0]++]>>2;if(f<60)++f;else{var h=f-59;f=n[t[0]],h>1&&(f|=n[t[0]+1]<<8),h>2&&(f|=n[t[0]+2]<<16),h>3&&(f|=n[t[0]+3]<<24),f>>>=0,f++,t[0]+=h}l.push(n.slice(t[0],t[0]+f)),t[0]+=f;continue}else{var g=0,v=0;if(u==1?(v=(n[t[0]]>>2&7)+4,g=(n[t[0]++]&224)<<3,g|=n[t[0]++]):(v=(n[t[0]++]>>2)+1,u==2?(g=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(g=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),l=[Nr(l)],g==0)throw new Error("Invalid offset 0");if(g>l[0].length)throw new Error("Invalid offset beyond length");if(v>=g)for(l.push(l[0].slice(-g)),v-=g;v>=l[l.length-1].length;)l.push(l[l.length-1]),v-=l[l.length-1].length;l.push(l[0].slice(-g,-g+v))}}var p=Nr(l);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function cn(a){for(var n=[],t=0;t<a.length;){var i=a[t++],l=a[t]|a[t+1]<<8|a[t+2]<<16;t+=3,n.push(pb(i,a.slice(t,t+l))),t+=l}if(t!==a.length)throw new Error("data is not a valid framed stream!");return Nr(n)}function qi(a){for(var n=[],t=0;t<a.length;){var i=Math.min(a.length-t,268435455),l=new Uint8Array(4);n.push(l);var u=st(i),f=u.length;n.push(u),i<=60?(f++,n.push(new Uint8Array([i-1<<2]))):i<=256?(f+=2,n.push(new Uint8Array([240,i-1&255]))):i<=65536?(f+=3,n.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(f+=4,n.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(f+=5,n.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),n.push(a.slice(t,t+i)),f+=i,l[0]=0,l[1]=f&255,l[2]=f>>8&255,l[3]=f>>16&255,t+=i}return Nr(n)}function lf(a,n){var t=new Uint8Array(32),i=To(t),l=12,u=0;switch(t[0]=5,a.t){case"n":t[1]=2,gb(t,l,a.v),u|=1,l+=16;break;case"b":t[1]=6,i.setFloat64(l,a.v?1:0,!0),u|=2,l+=8;break;case"s":if(n.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));t[1]=3,i.setUint32(l,n.indexOf(a.v),!0),u|=8,l+=4;break;default:throw"unsupported cell type "+a.t}return i.setUint32(8,u,!0),t.slice(0,l)}function cf(a,n){var t=new Uint8Array(32),i=To(t),l=12,u=0;switch(t[0]=3,a.t){case"n":t[2]=2,i.setFloat64(l,a.v,!0),u|=32,l+=8;break;case"b":t[2]=6,i.setFloat64(l,a.v?1:0,!0),u|=32,l+=8;break;case"s":if(n.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));t[2]=3,i.setUint32(l,n.indexOf(a.v),!0),u|=16,l+=4;break;default:throw"unsupported cell type "+a.t}return i.setUint32(4,u,!0),t.slice(0,l)}function yr(a){var n=Lt(a);return wl(n[1][0].data)}function xb(a,n,t){var i,l,u,f;if(!((i=a[6])!=null&&i[0])||!((l=a[7])!=null&&l[0]))throw"Mutation only works on post-BNC storages!";var h=((f=(u=a[8])==null?void 0:u[0])==null?void 0:f.data)&&rs(a[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var g=0,v=To(a[7][0].data),p=0,S=[],x=To(a[4][0].data),C=0,T=[],y=0;y<n.length;++y){if(n[y]==null){v.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}v.setUint16(y*2,p,!0),x.setUint16(y*2,C,!0);var _,w;switch(typeof n[y]){case"string":_=lf({t:"s",v:n[y]},t),w=cf({t:"s",v:n[y]},t);break;case"number":_=lf({t:"n",v:n[y]},t),w=cf({t:"n",v:n[y]},t);break;case"boolean":_=lf({t:"b",v:n[y]},t),w=cf({t:"b",v:n[y]},t);break;default:throw new Error("Unsupported value "+n[y])}S.push(_),p+=_.length,T.push(w),C+=w.length,++g}for(a[2][0].data=st(g);y<a[7][0].data.length/2;++y)v.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return a[6][0].data=Nr(S),a[3][0].data=Nr(T),g}function Sb(a,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=a.Sheets[a.SheetNames[0]];a.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Fa(t["!ref"]);i.s.r=i.s.c=0;var l=!1;i.e.c>9&&(l=!0,i.e.c=9),i.e.r>49&&(l=!0,i.e.r=49),l&&console.error("The Numbers writer is currently limited to ".concat(It(i)));var u=_o(t,{range:i,header:1}),f=["~Sh33tJ5~"];u.forEach(function(V){return V.forEach(function(P){typeof P=="string"&&f.push(P)})});var h={},g=[],v=ht.read(n.numbers,{type:"base64"});v.FileIndex.map(function(V,P){return[V,v.FullPaths[P]]}).forEach(function(V){var P=V[0],Y=V[1];if(P.type==2&&P.name.match(/\.iwa/)){var ce=P.content,Ce=cn(ce),je=ln(Ce);je.forEach(function(we){g.push(we.id),h[we.id]={deps:[],location:Y,type:rs(we.messages[0].meta[1][0].data)}})}}),g.sort(function(V,P){return V-P});var p=g.filter(function(V){return V>1}).map(function(V){return[V,st(V)]});v.FileIndex.map(function(V,P){return[V,v.FullPaths[P]]}).forEach(function(V){var P=V[0];if(V[1],!!P.name.match(/\.iwa/)){var Y=ln(cn(P.content));Y.forEach(function(ce){ce.messages.forEach(function(Ce){p.forEach(function(je){ce.messages.some(function(we){return rs(we.meta[1][0].data)!=11006&&vb(we.data,je[1])})&&h[je[0]].deps.push(ce.id)})})})}});for(var S=ht.find(v,h[1].location),x=ln(cn(S.content)),C,T=0;T<x.length;++T){var y=x[T];y.id==1&&(C=y)}var _=yr(Lt(C.messages[0].data)[1][0].data);for(S=ht.find(v,h[_].location),x=ln(cn(S.content)),T=0;T<x.length;++T)y=x[T],y.id==_&&(C=y);for(_=yr(Lt(C.messages[0].data)[2][0].data),S=ht.find(v,h[_].location),x=ln(cn(S.content)),T=0;T<x.length;++T)y=x[T],y.id==_&&(C=y);for(_=yr(Lt(C.messages[0].data)[2][0].data),S=ht.find(v,h[_].location),x=ln(cn(S.content)),T=0;T<x.length;++T)y=x[T],y.id==_&&(C=y);var w=Lt(C.messages[0].data);{w[6][0].data=st(i.e.r+1),w[7][0].data=st(i.e.c+1);var k=yr(w[46][0].data),M=ht.find(v,h[k].location),N=ln(cn(M.content));{for(var K=0;K<N.length&&N[K].id!=k;++K);if(N[K].id!=k)throw"Bad ColumnRowUIDMapArchive";var J=Lt(N[K].messages[0].data);J[1]=[],J[2]=[],J[3]=[];for(var B=0;B<=i.e.c;++B){var Z=[];Z[1]=Z[2]=[{type:0,data:st(B+420690)}],J[1].push({type:2,data:$t(Z)}),J[2].push({type:0,data:st(B)}),J[3].push({type:0,data:st(B)})}J[4]=[],J[5]=[],J[6]=[];for(var L=0;L<=i.e.r;++L)Z=[],Z[1]=Z[2]=[{type:0,data:st(L+726270)}],J[4].push({type:2,data:$t(Z)}),J[5].push({type:0,data:st(L)}),J[6].push({type:0,data:st(L)});N[K].messages[0].data=$t(J)}M.content=qi(Xi(N)),M.size=M.content.length,delete w[46];var X=Lt(w[4][0].data);{X[7][0].data=st(i.e.r+1);var D=Lt(X[1][0].data),z=yr(D[2][0].data);M=ht.find(v,h[z].location),N=ln(cn(M.content));{if(N[0].id!=z)throw"Bad HeaderStorageBucket";var ue=Lt(N[0].messages[0].data);for(L=0;L<u.length;++L){var be=Lt(ue[2][0].data);be[1][0].data=st(L),be[4][0].data=st(u[L].length),ue[2][L]={type:ue[2][0].type,data:$t(be)}}N[0].messages[0].data=$t(ue)}M.content=qi(Xi(N)),M.size=M.content.length;var Se=yr(X[2][0].data);M=ht.find(v,h[Se].location),N=ln(cn(M.content));{if(N[0].id!=Se)throw"Bad HeaderStorageBucket";for(ue=Lt(N[0].messages[0].data),B=0;B<=i.e.c;++B)be=Lt(ue[2][0].data),be[1][0].data=st(B),be[4][0].data=st(i.e.r+1),ue[2][B]={type:ue[2][0].type,data:$t(be)};N[0].messages[0].data=$t(ue)}M.content=qi(Xi(N)),M.size=M.content.length;var ee=yr(X[4][0].data);(function(){for(var V=ht.find(v,h[ee].location),P=ln(cn(V.content)),Y,ce=0;ce<P.length;++ce){var Ce=P[ce];Ce.id==ee&&(Y=Ce)}var je=Lt(Y.messages[0].data);{je[3]=[];var we=[];f.forEach(function(Ve,Kt){we[1]=[{type:0,data:st(Kt)}],we[2]=[{type:0,data:st(1)}],we[3]=[{type:2,data:mb(Ve)}],je[3].push({type:2,data:$t(we)})})}Y.messages[0].data=$t(je);var Ae=Xi(P),Qe=qi(Ae);V.content=Qe,V.size=V.content.length})();var ge=Lt(X[3][0].data);{var ke=ge[1][0];delete ge[2];var Ne=Lt(ke.data);{var Le=yr(Ne[2][0].data);(function(){for(var V=ht.find(v,h[Le].location),P=ln(cn(V.content)),Y,ce=0;ce<P.length;++ce){var Ce=P[ce];Ce.id==Le&&(Y=Ce)}var je=Lt(Y.messages[0].data);{delete je[6],delete ge[7];var we=new Uint8Array(je[5][0].data);je[5]=[];for(var Ae=0,Qe=0;Qe<=i.e.r;++Qe){var Ve=Lt(we);Ae+=xb(Ve,u[Qe],f),Ve[1][0].data=st(Qe),je[5].push({data:$t(Ve),type:2})}je[1]=[{type:0,data:st(i.e.c+1)}],je[2]=[{type:0,data:st(i.e.r+1)}],je[3]=[{type:0,data:st(Ae)}],je[4]=[{type:0,data:st(i.e.r+1)}]}Y.messages[0].data=$t(je);var Kt=Xi(P),We=qi(Kt);V.content=We,V.size=V.content.length})()}ke.data=$t(Ne)}X[3][0].data=$t(ge)}w[4][0].data=$t(X)}C.messages[0].data=$t(w);var H=Xi(x),j=qi(H);return S.content=j,S.size=S.content.length,v}function yb(a){return function(t){for(var i=0;i!=a.length;++i){var l=a[i];t[l[0]]===void 0&&(t[l[0]]=l[1]),l[2]==="n"&&(t[l[0]]=Number(t[l[0]]))}}}function Rf(a){yb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function Cb(a,n){return n.bookType=="ods"?rp(a,n):n.bookType=="numbers"?Sb(a,n):n.bookType=="xlsb"?Tb(a,n):Eb(a,n)}function Tb(a,n){Zi=1024,a&&!a.SSF&&(a.SSF=Ea(Nt)),a&&a.SSF&&(Do(),Ao(a.SSF),n.revssf=Mo(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Sl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var t=n.bookType=="xlsb"?"bin":"xml",i=Kg.indexOf(n.bookType)>-1,l=vg();Rf(n=n||{});var u=yf(),f="",h=0;if(n.cellXfs=[],Ar(n.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),f="docProps/core.xml",Ge(u,f,Sg(a.Props,n)),l.coreprops.push(f),lt(n.rels,2,f,tt.CORE_PROPS),f="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var g=[],v=0;v<a.SheetNames.length;++v)(a.Workbook.Sheets[v]||{}).Hidden!=2&&g.push(a.SheetNames[v]);a.Props.SheetNames=g}for(a.Props.Worksheets=a.Props.SheetNames.length,Ge(u,f,Cg(a.Props)),l.extprops.push(f),lt(n.rels,3,f,tt.EXT_PROPS),a.Custprops!==a.Props&&aa(a.Custprops||{}).length>0&&(f="docProps/custom.xml",Ge(u,f,Tg(a.Custprops)),l.custprops.push(f),lt(n.rels,4,f,tt.CUST_PROPS)),h=1;h<=a.SheetNames.length;++h){var p={"!id":{}},S=a.Sheets[a.SheetNames[h-1]],x=(S||{})["!type"]||"sheet";switch(x){case"chart":default:f="xl/worksheets/sheet"+h+"."+t,Ge(u,f,ww(h-1,f,n,a,p)),l.sheets.push(f),lt(n.wbrels,-1,"worksheets/sheet"+h+"."+t,tt.WS[0])}if(S){var C=S["!comments"],T=!1,y="";C&&C.length>0&&(y="xl/comments"+h+"."+t,Ge(u,y,Aw(C,y)),l.comments.push(y),lt(p,-1,"../comments"+h+"."+t,tt.CMNT),T=!0),S["!legacy"]&&T&&Ge(u,"xl/drawings/vmlDrawing"+h+".vml",Lg(h,S["!comments"])),delete S["!comments"],delete S["!legacy"]}p["!id"].rId1&&Ge(u,pg(f),as(p))}return n.Strings!=null&&n.Strings.length>0&&(f="xl/sharedStrings."+t,Ge(u,f,Nw(n.Strings,f,n)),l.strs.push(f),lt(n.wbrels,-1,"sharedStrings."+t,tt.SST)),f="xl/workbook."+t,Ge(u,f,_w(a,f)),l.workbooks.push(f),lt(n.rels,1,f,tt.WB),f="xl/theme/theme1.xml",Ge(u,f,Rg(a.Themes,n)),l.themes.push(f),lt(n.wbrels,-1,"theme/theme1.xml",tt.THEME),f="xl/styles."+t,Ge(u,f,bw(a,f,n)),l.styles.push(f),lt(n.wbrels,-1,"styles."+t,tt.STY),a.vbaraw&&i&&(f="xl/vbaProject.bin",Ge(u,f,a.vbaraw),l.vba.push(f),lt(n.wbrels,-1,"vbaProject.bin",tt.VBA)),f="xl/metadata."+t,Ge(u,f,Dw(f)),l.metadata.push(f),lt(n.wbrels,-1,"metadata."+t,tt.XLMETA),Ge(u,"[Content_Types].xml",gg(l,n)),Ge(u,"_rels/.rels",as(n.rels)),Ge(u,"xl/_rels/workbook."+t+".rels",as(n.wbrels)),delete n.revssf,delete n.ssf,u}function Eb(a,n){Zi=1024,a&&!a.SSF&&(a.SSF=Ea(Nt)),a&&a.SSF&&(Do(),Ao(a.SSF),n.revssf=Mo(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Sl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var t="xml",i=Kg.indexOf(n.bookType)>-1,l=vg();Rf(n=n||{});var u=yf(),f="",h=0;if(n.cellXfs=[],Ar(n.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),f="docProps/core.xml",Ge(u,f,Sg(a.Props,n)),l.coreprops.push(f),lt(n.rels,2,f,tt.CORE_PROPS),f="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var g=[],v=0;v<a.SheetNames.length;++v)(a.Workbook.Sheets[v]||{}).Hidden!=2&&g.push(a.SheetNames[v]);a.Props.SheetNames=g}a.Props.Worksheets=a.Props.SheetNames.length,Ge(u,f,Cg(a.Props)),l.extprops.push(f),lt(n.rels,3,f,tt.EXT_PROPS),a.Custprops!==a.Props&&aa(a.Custprops||{}).length>0&&(f="docProps/custom.xml",Ge(u,f,Tg(a.Custprops)),l.custprops.push(f),lt(n.rels,4,f,tt.CUST_PROPS));var p=["SheetJ5"];for(n.tcid=0,h=1;h<=a.SheetNames.length;++h){var S={"!id":{}},x=a.Sheets[a.SheetNames[h-1]],C=(x||{})["!type"]||"sheet";switch(C){case"chart":default:f="xl/worksheets/sheet"+h+"."+t,Ge(u,f,qg(h-1,n,a,S)),l.sheets.push(f),lt(n.wbrels,-1,"worksheets/sheet"+h+"."+t,tt.WS[0])}if(x){var T=x["!comments"],y=!1,_="";if(T&&T.length>0){var w=!1;T.forEach(function(k){k[1].forEach(function(M){M.T==!0&&(w=!0)})}),w&&(_="xl/threadedComments/threadedComment"+h+"."+t,Ge(u,_,eT(T,p,n)),l.threadedcomments.push(_),lt(S,-1,"../threadedComments/threadedComment"+h+"."+t,tt.TCMNT)),_="xl/comments"+h+"."+t,Ge(u,_,Bg(T)),l.comments.push(_),lt(S,-1,"../comments"+h+"."+t,tt.CMNT),y=!0}x["!legacy"]&&y&&Ge(u,"xl/drawings/vmlDrawing"+h+".vml",Lg(h,x["!comments"])),delete x["!comments"],delete x["!legacy"]}S["!id"].rId1&&Ge(u,pg(f),as(S))}return n.Strings!=null&&n.Strings.length>0&&(f="xl/sharedStrings."+t,Ge(u,f,Mg(n.Strings,n)),l.strs.push(f),lt(n.wbrels,-1,"sharedStrings."+t,tt.SST)),f="xl/workbook."+t,Ge(u,f,Qg(a)),l.workbooks.push(f),lt(n.rels,1,f,tt.WB),f="xl/theme/theme1.xml",Ge(u,f,Rg(a.Themes,n)),l.themes.push(f),lt(n.wbrels,-1,"theme/theme1.xml",tt.THEME),f="xl/styles."+t,Ge(u,f,Og(a,n)),l.styles.push(f),lt(n.wbrels,-1,"styles."+t,tt.STY),a.vbaraw&&i&&(f="xl/vbaProject.bin",Ge(u,f,a.vbaraw),l.vba.push(f),lt(n.wbrels,-1,"vbaProject.bin",tt.VBA)),f="xl/metadata."+t,Ge(u,f,Fg()),l.metadata.push(f),lt(n.wbrels,-1,"metadata."+t,tt.XLMETA),p.length>1&&(f="xl/persons/person.xml",Ge(u,f,tT(p)),l.people.push(f),lt(n.wbrels,-1,"persons/person.xml",tt.PEOPLE)),Ge(u,"[Content_Types].xml",gg(l,n)),Ge(u,"_rels/.rels",as(n.rels)),Ge(u,"xl/_rels/workbook."+t+".rels",as(n.wbrels)),delete n.revssf,delete n.ssf,u}function _b(a,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":t=Vn(a.slice(0,12));break;case"binary":t=a;break;case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function ip(a,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return Al(n.file,ht.write(a,{type:nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return ht.write(a,n)}function wb(a,n){var t=Ea(n||{}),i=Cb(a,t);return bb(i,t)}function bb(a,n){var t={},i=nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(t.compression="DEFLATE"),n.password)t.type=i;else switch(n.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+n.type)}var l=a.FullPaths?ht.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!n.compression}):a.generate(t);if(typeof Deno<"u"&&typeof l=="string"){if(n.type=="binary"||n.type=="base64")return l;l=new Uint8Array(No(l))}return n.password&&typeof encrypt_agile<"u"?ip(encrypt_agile(l,n.password),n):n.type==="file"?Al(n.file,l):n.type=="string"?vl(l):l}function Nb(a,n){var t=n||{},i=Hw(a,t);return ip(i,t)}function yn(a,n,t){t||(t="");var i=t+a;switch(n.type){case"base64":return Cl(El(i));case"binary":return El(i);case"string":return a;case"file":return Al(n.file,i,"utf8");case"buffer":return nt?Xn(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):yn(i,{type:"binary"}).split("").map(function(l){return l.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function Ab(a,n){switch(n.type){case"base64":return Cl(a);case"binary":return a;case"string":return a;case"file":return Al(n.file,a,"binary");case"buffer":return nt?Xn(a,"binary"):a.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function so(a,n){switch(n.type){case"string":case"base64":case"binary":for(var t="",i=0;i<a.length;++i)t+=String.fromCharCode(a[i]);return n.type=="base64"?Cl(t):n.type=="string"?vl(t):t;case"file":return Al(n.file,a);case"buffer":return a;default:throw new Error("Unrecognized type "+n.type)}}function Eo(a,n){a2(),hw(a);var t=Ea(n||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=Eo(a,t);return t.type="array",No(i)}var l=0;if(t.sheet&&(typeof t.sheet=="number"?l=t.sheet:l=a.SheetNames.indexOf(t.sheet),!a.SheetNames[l]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return yn(Pw(a,t),t);case"slk":case"sylk":return yn(uC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"htm":case"html":return yn(tp(a.Sheets[a.SheetNames[l]],t),t);case"txt":return Ab(sp(a.Sheets[a.SheetNames[l]],t),t);case"csv":return yn(Ff(a.Sheets[a.SheetNames[l]],t),t,"\uFEFF");case"dif":return yn(fC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"dbf":return so(oC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"prn":return yn(dC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"rtf":return yn(SC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"eth":return yn(Dg.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"fods":return yn(rp(a,t),t);case"wk1":return so(hv.sheet_to_wk1(a.Sheets[a.SheetNames[l]],t),t);case"wk3":return so(hv.book_to_wk3(a,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),so(ep(a,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Nb(a,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return wb(a,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Db(a){if(!a.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=a.file.slice(a.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(a.bookType=t.slice(1)),a.bookType=n[a.bookType]||a.bookType}}function Mb(a,n,t){var i={};return i.type="file",i.file=n,Db(i),Eo(a,i)}function jb(a,n,t,i,l,u,f,h){var g=ta(t),v=h.defval,p=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),S=!0,x=l===1?[]:{};if(l!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!f||a[t])for(var C=n.s.c;C<=n.e.c;++C){var T=f?a[t][C]:a[i[C]+g];if(T===void 0||T.t===void 0){if(v===void 0)continue;u[C]!=null&&(x[u[C]]=v);continue}var y=T.v;switch(T.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+T.t)}if(u[C]!=null){if(y==null)if(T.t=="e"&&y===null)x[u[C]]=null;else if(v!==void 0)x[u[C]]=v;else if(p&&y===null)x[u[C]]=null;else continue;else x[u[C]]=p&&(T.t!=="n"||T.t==="n"&&h.rawNumbers!==!1)?y:Yn(T,y,h);y!=null&&(S=!1)}}return{row:x,isempty:S}}function _o(a,n){if(a==null||a["!ref"]==null)return[];var t={t:"n",v:0},i=0,l=1,u=[],f=0,h="",g={s:{r:0,c:0},e:{r:0,c:0}},v=n||{},p=v.range!=null?v.range:a["!ref"];switch(v.header===1?i=1:v.header==="A"?i=2:Array.isArray(v.header)?i=3:v.header==null&&(i=0),typeof p){case"string":g=yt(p);break;case"number":g=yt(a["!ref"]),g.s.r=p;break;default:g=p}i>0&&(l=0);var S=ta(g.s.r),x=[],C=[],T=0,y=0,_=Array.isArray(a),w=g.s.r,k=0,M={};_&&!a[w]&&(a[w]=[]);var N=v.skipHidden&&a["!cols"]||[],K=v.skipHidden&&a["!rows"]||[];for(k=g.s.c;k<=g.e.c;++k)if(!(N[k]||{}).hidden)switch(x[k]=sa(k),t=_?a[w][k]:a[x[k]+S],i){case 1:u[k]=k-g.s.c;break;case 2:u[k]=x[k];break;case 3:u[k]=v.header[k-g.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),h=f=Yn(t,null,v),y=M[f]||0,!y)M[f]=1;else{do h=f+"_"+y++;while(M[h]);M[f]=y,M[h]=1}u[k]=h}for(w=g.s.r+l;w<=g.e.r;++w)if(!(K[w]||{}).hidden){var J=jb(a,g,w,x,i,u,_,v);(J.isempty===!1||(i===1?v.blankrows!==!1:v.blankrows))&&(C[T++]=J.row)}return C.length=T,C}var Cv=/"/g;function kb(a,n,t,i,l,u,f,h){for(var g=!0,v=[],p="",S=ta(t),x=n.s.c;x<=n.e.c;++x)if(i[x]){var C=h.dense?(a[t]||[])[x]:a[i[x]+S];if(C==null)p="";else if(C.v!=null){g=!1,p=""+(h.rawNumbers&&C.t=="n"?C.v:Yn(C,null,h));for(var T=0,y=0;T!==p.length;++T)if((y=p.charCodeAt(T))===l||y===u||y===34||h.forceQuotes){p='"'+p.replace(Cv,'""')+'"';break}p=="ID"&&(p='"ID"')}else C.f!=null&&!C.F?(g=!1,p="="+C.f,p.indexOf(",")>=0&&(p='"'+p.replace(Cv,'""')+'"')):p="";v.push(p)}return h.blankrows===!1&&g?null:v.join(f)}function Ff(a,n){var t=[],i=n??{};if(a==null||a["!ref"]==null)return"";var l=yt(a["!ref"]),u=i.FS!==void 0?i.FS:",",f=u.charCodeAt(0),h=i.RS!==void 0?i.RS:`
`,g=h.charCodeAt(0),v=new RegExp((u=="|"?"\\|":u)+"+$"),p="",S=[];i.dense=Array.isArray(a);for(var x=i.skipHidden&&a["!cols"]||[],C=i.skipHidden&&a["!rows"]||[],T=l.s.c;T<=l.e.c;++T)(x[T]||{}).hidden||(S[T]=sa(T));for(var y=0,_=l.s.r;_<=l.e.r;++_)(C[_]||{}).hidden||(p=kb(a,l,_,S,f,g,u,i),p!=null&&(i.strip&&(p=p.replace(v,"")),(p||i.blankrows!==!1)&&t.push((y++?h:"")+p)));return delete i.dense,t.join("")}function sp(a,n){n||(n={}),n.FS="	",n.RS=`
`;var t=Ff(a,n);return t}function Ub(a){var n="",t,i="";if(a==null||a["!ref"]==null)return[];var l=yt(a["!ref"]),u="",f=[],h,g=[],v=Array.isArray(a);for(h=l.s.c;h<=l.e.c;++h)f[h]=sa(h);for(var p=l.s.r;p<=l.e.r;++p)for(u=ta(p),h=l.s.c;h<=l.e.c;++h)if(n=f[h]+u,t=v?(a[p]||[])[h]:a[n],i="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;i=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}g[g.length]=n+"="+i}return g}function lp(a,n,t){var i=t||{},l=+!i.skipHeader,u=a||{},f=0,h=0;if(u&&i.origin!=null)if(typeof i.origin=="number")f=i.origin;else{var g=typeof i.origin=="string"?Ht(i.origin):i.origin;f=g.r,h=g.c}var v,p={s:{c:0,r:0},e:{c:h,r:f+n.length-1+l}};if(u["!ref"]){var S=yt(u["!ref"]);p.e.c=Math.max(p.e.c,S.e.c),p.e.r=Math.max(p.e.r,S.e.r),f==-1&&(f=S.e.r+1,p.e.r=f+n.length-1+l)}else f==-1&&(f=0,p.e.r=n.length-1+l);var x=i.header||[],C=0;n.forEach(function(y,_){aa(y).forEach(function(w){(C=x.indexOf(w))==-1&&(x[C=x.length]=w);var k=y[w],M="z",N="",K=ot({c:h+C,r:f+_+l});v=bl(u,K),k&&typeof k=="object"&&!(k instanceof Date)?u[K]=k:(typeof k=="number"?M="n":typeof k=="boolean"?M="b":typeof k=="string"?M="s":k instanceof Date?(M="d",i.cellDates||(M="n",k=Ta(k)),N=i.dateNF||Nt[14]):k===null&&i.nullError&&(M="e",k=0),v?(v.t=M,v.v=k,delete v.w,delete v.R,N&&(v.z=N)):u[K]=v={t:M,v:k},N&&(v.z=N))})}),p.e.c=Math.max(p.e.c,h+x.length-1);var T=ta(f);if(l)for(C=0;C<x.length;++C)u[sa(C+h)+T]={t:"s",v:x[C]};return u["!ref"]=It(p),u}function Ob(a,n){return lp(null,a,n)}function bl(a,n,t){if(typeof n=="string"){if(Array.isArray(a)){var i=Ht(n);return a[i.r]||(a[i.r]=[]),a[i.r][i.c]||(a[i.r][i.c]={t:"z"})}return a[n]||(a[n]={t:"z"})}return typeof n!="number"?bl(a,ot(n)):bl(a,ot({r:n,c:t||0}))}function Ib(a,n){if(typeof n=="number"){if(n>=0&&a.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=a.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Rb(){return{SheetNames:[],Sheets:{}}}function Fb(a,n,t,i){var l=1;if(!t)for(;l<=65535&&a.SheetNames.indexOf(t="Sheet"+l)!=-1;++l,t=void 0);if(!t||a.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&a.SheetNames.indexOf(t)>=0){var u=t.match(/(^.*?)(\d+)$/);l=u&&+u[2]||0;var f=u&&u[1]||t;for(++l;l<=65535&&a.SheetNames.indexOf(t=f+l)!=-1;++l);}if($g(t),a.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return a.SheetNames.push(t),a.Sheets[t]=n,t}function Lb(a,n,t){a.Workbook||(a.Workbook={}),a.Workbook.Sheets||(a.Workbook.Sheets=[]);var i=Ib(a,n);switch(a.Workbook.Sheets[i]||(a.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}a.Workbook.Sheets[i].Hidden=t}function Bb(a,n){return a.z=n,a}function cp(a,n,t){return n?(a.l={Target:n},t&&(a.l.Tooltip=t)):delete a.l,a}function Kb(a,n,t){return cp(a,"#"+n,t)}function Pb(a,n,t){a.c||(a.c=[]),a.c.push({t:n,a:t||"SheetJS"})}function zb(a,n,t,i){for(var l=typeof n!="string"?n:yt(n),u=typeof n=="string"?n:It(n),f=l.s.r;f<=l.e.r;++f)for(var h=l.s.c;h<=l.e.c;++h){var g=bl(a,f,h);g.t="n",g.F=u,delete g.v,f==l.s.r&&h==l.s.c&&(g.f=t,i&&(g.D=!0))}return a}var Pn={encode_col:sa,encode_row:ta,encode_cell:ot,encode_range:It,decode_col:bf,decode_row:wf,split_cell:ay,decode_cell:Ht,decode_range:Fa,format_cell:Yn,sheet_add_aoa:og,sheet_add_json:lp,sheet_add_dom:ap,aoa_to_sheet:cs,json_to_sheet:Ob,table_to_sheet:np,table_to_book:fb,sheet_to_csv:Ff,sheet_to_txt:sp,sheet_to_json:_o,sheet_to_html:tp,sheet_to_formulae:Ub,sheet_to_row_object_array:_o,sheet_get_cell:bl,book_new:Rb,book_append_sheet:Fb,book_set_sheet_visibility:Lb,cell_set_number_format:Bb,cell_set_hyperlink:cp,cell_set_internal_link:Kb,cell_add_comment:Pb,sheet_set_array_formula:zb,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class Hb{generateFileName(n){const i=new Date().toISOString().split("T")[0];let l="";if(n.dateRange.type==="custom"&&n.dateRange.startDate&&n.dateRange.endDate){const f=n.dateRange.startDate.toISOString().split("T")[0],h=n.dateRange.endDate.toISOString().split("T")[0];l=`_${f}_to_${h}`}else n.dateRange.type!=="custom"&&(l=`_${n.dateRange.type}`);const u=n.format==="csv"?"csv":"xlsx";return`crm_contacts_export_${i}${l}.${u}`}filterContactsByDateRange(n,t){if(t.type==="custom"&&t.startDate&&t.endDate)return n.filter(u=>{const f=new Date(u.createdAt);return f>=t.startDate&&f<=t.endDate});const i=new Date;let l;switch(t.type){case"daily":l=new Date(i.getTime()-1440*60*1e3);break;case"weekly":l=new Date(i.getTime()-10080*60*1e3);break;case"monthly":l=new Date(i.getTime()-720*60*60*1e3);break;case"yearly":l=new Date(i.getTime()-365*24*60*60*1e3);break;default:return n}return n.filter(u=>{const f=new Date(u.createdAt);return f>=l&&f<=i})}prepareExportData(n,t){return n.map(i=>{const l={};return t.forEach(u=>{switch(u){case"createdAt":case"updatedAt":l[this.getFieldDisplayName(u)]=zn(new Date(i[u]));break;default:l[this.getFieldDisplayName(u)]=i[u]}}),l})}getFieldDisplayName(n){return{id:"ID",createdAt:"Created Date",nama:"Name",nomorTelepon:"Phone Number",jenisKelamin:"Gender",alamat:"Address",provinsi:"Province",agama:"Religion",alasanMenghubungi:"Reason for Contact",sumber:"Source",prioritas:"Priority",statusKontak:"Contact Status",updatedAt:"Last Updated",createdBy:"Created By",history:"History"}[n]||n}convertToCSV(n){if(n.length===0)return"No data available for export";const t=Object.keys(n[0]),i=t.join(","),l=n.map(u=>t.map(f=>{const h=u[f];return typeof h=="string"&&(h.includes(",")||h.includes('"')||h.includes(`
`))?`"${h.replace(/"/g,'""')}"`:h||""}).join(","));return[i,...l].join(`
`)}convertToExcel(n){if(n.length===0){const u=Pn.aoa_to_sheet([["No data available for export"]]),f=Pn.book_new();return Pn.book_append_sheet(f,u,"Contacts"),Eo(f,{bookType:"xlsx",type:"array"})}const t=Pn.json_to_sheet(n),i=Object.keys(n[0]).map(u=>{const f=Math.max(u.length,...n.map(h=>String(h[u]||"").length));return{wch:Math.min(f+2,50)}});t["!cols"]=i;const l=Pn.book_new();return Pn.book_append_sheet(l,t,"Contacts"),l.Props={Title:"CRM Contacts Export",Subject:"Contact Management Data",Author:"CRM System",CreatedDate:new Date},Eo(l,{bookType:"xlsx",type:"array"})}downloadFile(n,t,i){const l=new Blob([n],{type:i}),u=URL.createObjectURL(l),f=document.createElement("a");f.href=u,f.download=t,f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),setTimeout(()=>URL.revokeObjectURL(u),100)}exportContacts(n,t){try{const i=this.filterContactsByDateRange(n,t.dateRange);if(i.length===0)throw new Error("No contacts found for the selected date range");const l=this.prepareExportData(i,t.includeFields),u=this.generateFileName(t);if(t.format==="csv"){const f=this.convertToCSV(l);this.downloadFile(f,u,"text/csv;charset=utf-8;")}else if(t.format==="excel"){const f=this.convertToExcel(l);this.downloadFile(f,u,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}}catch(i){throw console.error("Export error:",i),i}}getExportStats(n,t){const i=this.filterContactsByDateRange(n,t.dateRange);let l="All time";return t.dateRange.type==="custom"&&t.dateRange.startDate&&t.dateRange.endDate?l=`${t.dateRange.startDate.toLocaleDateString()} - ${t.dateRange.endDate.toLocaleDateString()}`:t.dateRange.type!=="custom"&&(l={daily:"Last 24 hours",weekly:"Last 7 days",monthly:"Last 30 days",yearly:"Last 365 days"}[t.dateRange.type]||"All time"),{totalContacts:n.length,filteredContacts:i.length,dateRange:l,fields:t.includeFields.map(u=>this.getFieldDisplayName(u))}}validateExportOptions(n){const t=[];return(!n.format||!["csv","excel"].includes(n.format))&&t.push("Invalid export format. Must be CSV or Excel."),(!n.includeFields||n.includeFields.length===0)&&t.push("At least one field must be selected for export."),n.dateRange.type==="custom"&&(!n.dateRange.startDate||!n.dateRange.endDate?t.push("Start date and end date are required for custom date range."):n.dateRange.startDate>n.dateRange.endDate&&t.push("Start date must be before end date.")),{isValid:t.length===0,errors:t}}getAvailableFormats(){return[{value:"csv",label:"CSV",description:"Comma-separated values file, compatible with Excel, Google Sheets, and other applications"},{value:"excel",label:"Excel (.xlsx)",description:"Native Microsoft Excel format with proper formatting, auto-sized columns, and metadata"}]}getAvailableDateRanges(){return[{value:"daily",label:"Last 24 Hours",description:"Contacts created in the last 24 hours"},{value:"weekly",label:"Last 7 Days",description:"Contacts created in the last week"},{value:"monthly",label:"Last 30 Days",description:"Contacts created in the last month"},{value:"yearly",label:"Last 365 Days",description:"Contacts created in the last year"},{value:"custom",label:"Custom Range",description:"Select specific start and end dates"}]}}const Ji=new Hb,Gb=({contacts:a,isOpen:n,onClose:t,onExportComplete:i})=>{const[l,u]=G.useState({format:"csv",dateRange:{type:"monthly"},includeFields:[...cl]}),[f,h]=G.useState(!1),[g,v]=G.useState([]),[p,S]=G.useState(null);G.useEffect(()=>{if(n&&a.length>0)try{const N=Ji.getExportStats(a,l);S(N)}catch(N){console.error("Error calculating export stats:",N)}},[l,a,n]),G.useEffect(()=>{n&&(v([]),h(!1))},[n]);const x=N=>{u(K=>({...K,format:N}))},C=N=>{u(K=>({...K,dateRange:{type:N}}))},T=(N,K)=>{if(!K)return;const J=new Date(K);u(B=>({...B,dateRange:{...B.dateRange,[N]:J}}))},y=N=>{u(K=>{const J=K.includeFields,B=J.includes(N)?J.filter(Z=>Z!==N):[...J,N];return{...K,includeFields:B}})},_=()=>{u(N=>({...N,includeFields:[...cl]}))},w=()=>{u(N=>({...N,includeFields:[]}))},k=async()=>{v([]);const N=Ji.validateExportOptions(l);if(!N.isValid){v(N.errors);return}if(a.length===0){v(["No contacts available for export"]);return}h(!0);try{const K=Ji.generateFileName(l);Ji.exportContacts(a,l),i?.(K),t()}catch(K){const J=K instanceof Error?K.message:"Export failed";v([J])}finally{h(!1)}},M=N=>({id:"Contact ID",createdAt:"Created Date",nama:"Name",nomorTelepon:"Phone Number",jenisKelamin:"Gender",alamat:"Address",provinsi:"Province",agama:"Religion",alasanMenghubungi:"Reason for Contact",sumber:"Source",prioritas:"Priority",statusKontak:"Contact Status",updatedAt:"Last Updated",createdBy:"Created By",history:"History"})[N]||N;return n?o.jsx("div",{className:"export-modal-overlay",children:o.jsxs("div",{className:"export-modal",children:[o.jsxs("div",{className:"export-modal-header",children:[o.jsx("h2",{children:"Export Contacts"}),o.jsx("button",{onClick:t,className:"close-btn",disabled:f,children:""})]}),o.jsxs("div",{className:"export-modal-content",children:[g.length>0&&o.jsx("div",{className:"export-errors",children:g.map((N,K)=>o.jsx("div",{className:"error-message",children:N},K))}),o.jsxs("div",{className:"export-section",children:[o.jsx("h3",{children:"Export Format"}),o.jsx("div",{className:"format-options",children:Ji.getAvailableFormats().map(N=>o.jsxs("label",{className:"format-option",children:[o.jsx("input",{type:"radio",name:"format",value:N.value,checked:l.format===N.value,onChange:()=>x(N.value),disabled:f}),o.jsxs("div",{className:"format-info",children:[o.jsx("span",{className:"format-label",children:N.label}),o.jsx("span",{className:"format-description",children:N.description})]})]},N.value))})]}),o.jsxs("div",{className:"export-section",children:[o.jsx("h3",{children:"Date Range"}),o.jsx("div",{className:"date-range-options",children:Ji.getAvailableDateRanges().map(N=>o.jsxs("label",{className:"date-range-option",children:[o.jsx("input",{type:"radio",name:"dateRange",value:N.value,checked:l.dateRange.type===N.value,onChange:()=>C(N.value),disabled:f}),o.jsxs("div",{className:"range-info",children:[o.jsx("span",{className:"range-label",children:N.label}),o.jsx("span",{className:"range-description",children:N.description})]})]},N.value))}),l.dateRange.type==="custom"&&o.jsxs("div",{className:"custom-date-inputs",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"Start Date"}),o.jsx("input",{type:"date",value:l.dateRange.startDate?on(l.dateRange.startDate):"",onChange:N=>T("startDate",N.target.value),max:on(new Date),disabled:f})]}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"End Date"}),o.jsx("input",{type:"date",value:l.dateRange.endDate?on(l.dateRange.endDate):"",onChange:N=>T("endDate",N.target.value),max:on(new Date),min:l.dateRange.startDate?on(l.dateRange.startDate):void 0,disabled:f})]})]})]}),o.jsxs("div",{className:"export-section",children:[o.jsx("h3",{children:"Fields to Include"}),o.jsxs("div",{className:"field-selection-header",children:[o.jsxs("span",{children:[l.includeFields.length," of ",cl.length," fields selected"]}),o.jsxs("div",{className:"field-actions",children:[o.jsx("button",{onClick:_,className:"field-action-btn",disabled:f||l.includeFields.length===cl.length,children:"Select All"}),o.jsx("button",{onClick:w,className:"field-action-btn",disabled:f||l.includeFields.length===0,children:"Clear All"})]})]}),o.jsx("div",{className:"field-options",children:cl.map(N=>o.jsxs("label",{className:"field-option",children:[o.jsx("input",{type:"checkbox",checked:l.includeFields.includes(N),onChange:()=>y(N),disabled:f}),o.jsx("span",{className:"field-name",children:M(N)})]},N))})]}),p&&o.jsxs("div",{className:"export-stats",children:[o.jsx("h3",{children:"Export Preview"}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Total Contacts:"}),o.jsx("span",{className:"stat-value",children:p.totalContacts})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Contacts to Export:"}),o.jsx("span",{className:"stat-value",children:p.filteredContacts})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Date Range:"}),o.jsx("span",{className:"stat-value",children:p.dateRange})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Fields:"}),o.jsxs("span",{className:"stat-value",children:[p.fields.length," selected"]})]})]})]})]}),o.jsxs("div",{className:"export-modal-footer",children:[o.jsx("button",{onClick:t,className:"cancel-btn",disabled:f,children:"Cancel"}),o.jsx("button",{onClick:k,className:"export-btn",disabled:f||l.includeFields.length===0||p&&p.filteredContacts===0,children:f?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"export-spinner"}),"Exporting..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),"Export ",p?.filteredContacts||0," Contacts"]})})]})]})}):null},op=({contacts:a,variant:n="primary",size:t="medium",disabled:i=!1,className:l=""})=>{const[u,f]=G.useState(!1),[h,g]=G.useState(null),{canExportData:v}=Vt(),p=()=>{if(!v()){alert("You do not have permission to export data");return}if(a.length===0){alert("No contacts available to export");return}f(!0)},S=y=>{g({filename:y,timestamp:new Date});const _=`Export completed successfully!
File: ${y}`;alert(_)},x=()=>{switch(n){case"icon":return"";case"secondary":return"Export";default:return`Export ${a.length} Contacts`}},C=()=>"",T=i||!v()||a.length===0;return o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:p,disabled:T,className:`export-button ${n} ${t} ${l}`,title:v()?a.length===0?"No contacts available to export":`Export ${a.length} contacts`:"You do not have permission to export data",children:[o.jsx("span",{className:"export-icon",children:C()}),n!=="icon"&&o.jsx("span",{className:"export-text",children:x()}),a.length>0&&n==="primary"&&o.jsx("span",{className:"contact-count",children:a.length})]}),h&&o.jsxs("div",{className:"last-export-info",children:[o.jsx("span",{className:"export-success-icon",children:""}),o.jsxs("span",{className:"export-info-text",children:["Last export: ",h.filename," at ",h.timestamp.toLocaleTimeString()]})]}),o.jsx(Gb,{contacts:a,isOpen:u,onClose:()=>f(!1),onExportComplete:S})]})},is="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3c!--%20White%20rounded%20rectangle%20background%20--%3e%3crect%20x='2'%20y='6'%20width='36'%20height='28'%20rx='8'%20ry='8'%20fill='white'/%3e%3c!--%20Black%20figure%20with%20raised%20arms%20--%3e%3cg%20transform='translate(20,%2020)'%3e%3c!--%20Head%20--%3e%3ccircle%20cx='0'%20cy='-6'%20r='3'%20fill='black'/%3e%3c!--%20Body%20(V-shape%20torso)%20--%3e%3cpath%20d='M-4%20-2%20L0%202%20L4%20-2%20L2%206%20L-2%206%20Z'%20fill='black'/%3e%3c!--%20Left%20arm%20raised%20--%3e%3cpath%20d='M-4%20-2%20L-8%20-8%20L-6%20-10%20L-2%20-4'%20fill='black'/%3e%3c!--%20Right%20arm%20raised%20--%3e%3cpath%20d='M4%20-2%20L8%20-8%20L6%20-10%20L2%20-4'%20fill='black'/%3e%3c!--%20Legs%20--%3e%3cpath%20d='M-2%206%20L-3%2012%20L-1%2012%20L0%206'%20fill='black'/%3e%3cpath%20d='M2%206%20L3%2012%20L1%2012%20L0%206'%20fill='black'/%3e%3c/g%3e%3c/svg%3e";class Wb{STORAGE_KEY="crm_branding_config";MAX_FILE_SIZE=2*1024*1024;SUPPORTED_FORMATS=["image/png","image/jpeg","image/jpg","image/svg+xml","image/webp"];getCurrentLogo(){try{const n=localStorage.getItem(this.STORAGE_KEY);if(n){const t=JSON.parse(n);return t.logoMetadata.uploadDate=new Date(t.logoMetadata.uploadDate),t}}catch(n){console.warn("Failed to load branding config from localStorage:",n)}return this.getDefaultConfig()}getDefaultConfig(){return{logoUrl:is,logoType:"default",logoMetadata:{filename:"default-logo.svg",originalName:"default-logo.svg",size:0,format:"image/svg+xml",uploadDate:new Date,uploadedBy:"system"},fallbackLogo:is}}async updateLogo(n,t){const i=this.validateLogoFile(n);if(!i.isValid)throw new Error(`Logo validation failed: ${i.errors.join(", ")}`);try{const l=await this.fileToBase64(n),u=await this.getImageDimensions(l),f={logoUrl:l,logoType:"custom",logoMetadata:{filename:`custom-logo-${Date.now()}.${this.getFileExtension(n.name)}`,originalName:n.name,size:n.size,format:n.type,dimensions:u,uploadDate:new Date,uploadedBy:t},fallbackLogo:is};return localStorage.setItem(this.STORAGE_KEY,JSON.stringify(f)),f}catch(l){throw console.error("Failed to update logo:",l),new Error("Failed to process logo file. Please try again.")}}resetToDefault(){const n=this.getDefaultConfig();return localStorage.removeItem(this.STORAGE_KEY),n}validateLogoFile(n){const t=[];return this.SUPPORTED_FORMATS.includes(n.type)||t.push("Unsupported file format. Supported formats: PNG, JPG, SVG, WebP"),n.size>this.MAX_FILE_SIZE&&t.push(`File size too large. Maximum size: ${this.MAX_FILE_SIZE/(1024*1024)}MB`),n.size===0&&t.push("File is empty"),(!n.name||n.name.trim()==="")&&t.push("Invalid file name"),{isValid:t.length===0,errors:t}}fileToBase64(n){return new Promise((t,i)=>{const l=new FileReader;l.onload=()=>{typeof l.result=="string"?t(l.result):i(new Error("Failed to convert file to base64"))},l.onerror=()=>i(new Error("Failed to read file")),l.readAsDataURL(n)})}getImageDimensions(n){return new Promise((t,i)=>{const l=new Image;l.onload=()=>{t({width:l.width,height:l.height})},l.onerror=()=>i(new Error("Failed to load image")),l.src=n})}getFileExtension(n){return n.split(".").pop()?.toLowerCase()||"png"}getLogoHistory(){try{const n=localStorage.getItem(`${this.STORAGE_KEY}_history`);return n?JSON.parse(n):[]}catch{return[]}}clearBrandingData(){localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(`${this.STORAGE_KEY}_history`)}}const hl=new Wb,Vb=({variant:a="header",size:n="auto",className:t="",alt:i="Company Logo",onClick:l})=>{const[u,f]=G.useState(is),[h,g]=G.useState(!0);G.useEffect(()=>{const S=()=>{try{const T=hl.getCurrentLogo();f(T.logoUrl)}catch(T){console.warn("Failed to load logo, using default:",T),f(is)}finally{g(!1)}};S();const x=T=>{T.key==="crm_branding_config"&&S()};window.addEventListener("storage",x);const C=()=>{S()};return window.addEventListener("logoUpdated",C),()=>{window.removeEventListener("storage",x),window.removeEventListener("logoUpdated",C)}},[]);const v=["logo",`logo--${a}`,`logo--${n}`,h?"logo--loading":"",t].filter(Boolean).join(" "),p=()=>{console.warn("Logo failed to load, falling back to default"),f(is)};return h?o.jsx("div",{className:v,children:o.jsx("div",{className:"logo__placeholder"})}):o.jsx("div",{className:v,onClick:l,children:o.jsx("img",{src:u,alt:i,className:"logo__image",role:"img","aria-label":"Company branding logo",onError:p})})},Yb=({currentView:a,onViewChange:n})=>{const{currentUser:t,logout:i,hasPermission:l}=Vt(),[u,f]=G.useState(!1),h=()=>{window.confirm("Are you sure you want to logout?")&&i()},g=x=>{n(x),f(!1)},v=()=>{f(!u)},p=()=>{f(!1)};G.useEffect(()=>{const x=()=>{window.innerWidth>1024&&f(!1)};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const S=[{id:"dashboard",label:"Dashboard",icon:"",view:"dashboard"},{id:"contacts",label:"Contacts",icon:"",view:"contacts"},{id:"add-contact",label:"Add Contact",icon:"",view:"add-contact"},{id:"service-tracking",label:"Service Tracking",icon:"",view:"service-tracking"},...l("Admin")?[{id:"users",label:"User Management",icon:"",view:"users"}]:[]];return o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"mobile-nav-toggle",onClick:v,"aria-label":"Toggle navigation menu",children:u?"":""}),o.jsx("div",{className:`mobile-nav-overlay ${u?"active":""}`,onClick:p}),o.jsxs("nav",{className:`navigation ${u?"mobile-open":""}`,children:[o.jsx("div",{className:"nav-header",children:o.jsxs("div",{className:"nav-logo",children:[o.jsx(Vb,{variant:"header",size:"auto",alt:"Hopeline Care Logo"}),o.jsxs("div",{className:"nav-logo-text",children:[o.jsx("h1",{children:"Hopeline Care"}),o.jsx("span",{children:"Contact Management"})]})]})}),o.jsx("div",{className:"nav-menu",children:S.map(x=>o.jsxs("button",{onClick:()=>g(x.view),className:`nav-item ${a===x.view?"active":""}`,children:[o.jsx("span",{className:"nav-icon",children:x.icon}),o.jsx("span",{className:"nav-label",children:x.label})]},x.id))}),o.jsxs("div",{className:"nav-user",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("div",{className:"user-avatar",children:t?.username.charAt(0).toUpperCase()}),o.jsxs("div",{className:"user-details",children:[o.jsx("div",{className:"user-name",children:t?.username}),o.jsx("div",{className:"user-role",children:t?.role}),o.jsxs("div",{className:"device-info",children:[Ke.getDeviceInfo().deviceType," Device"]})]})]}),o.jsxs("div",{className:"user-permissions",children:[o.jsxs("div",{className:"permission-item",children:[o.jsx("span",{className:"permission-label",children:"Manage Contacts:"}),o.jsx("span",{className:`permission-status ${l("Editor")?"allowed":"denied"}`,children:l("Editor")?"":""})]}),o.jsxs("div",{className:"permission-item",children:[o.jsx("span",{className:"permission-label",children:"Manage Users:"}),o.jsx("span",{className:`permission-status ${l("Admin")?"allowed":"denied"}`,children:l("Admin")?"":""})]})]}),o.jsx("div",{className:"nav-export",children:o.jsx(op,{contacts:Ke.getContacts(),variant:"secondary",size:"small"})}),o.jsxs("button",{onClick:h,className:"logout-btn",children:[o.jsx("span",{children:""}),"Logout"]})]})]})]})},ia={MANAGE_USERS:"manage_users",MANAGE_CONTACTS:"manage_contacts",EXPORT_DATA:"export_data",DELETE_CONTACTS:"delete_contacts",VIEW_ALL_CONTACTS:"view_all_contacts",VIEW_OWN_CONTACTS:"view_own_contacts",EXPORT_ALL_DATA:"export_all_data",EXPORT_OWN_DATA:"export_own_data",VIEW_ALL_SERVICES:"view_all_services",VIEW_OWN_SERVICES:"view_own_services",EDIT_SETTINGS:"edit_settings"},Xb={Admin:[ia.MANAGE_USERS,ia.MANAGE_CONTACTS,ia.EXPORT_DATA,ia.EXPORT_ALL_DATA,ia.DELETE_CONTACTS,ia.VIEW_ALL_CONTACTS,ia.VIEW_ALL_SERVICES,ia.EDIT_SETTINGS],Editor:[ia.MANAGE_CONTACTS,ia.EXPORT_OWN_DATA,ia.VIEW_OWN_CONTACTS,ia.VIEW_OWN_SERVICES]},wo=(a,n)=>a?Xb[a.role].includes(n):!1,of=a=>wo(a,ia.DELETE_CONTACTS),lo=(a,n)=>a?a.role==="Admin"?!0:a.role==="Editor"?a.username===n:!1:!1,qb=(a,n)=>a?a.role==="Admin"?!0:a.role==="Editor"?a.username===n:!1:!1,Jb=a=>wo(a,ia.VIEW_ALL_CONTACTS),Tv=a=>wo(a,ia.EXPORT_OWN_DATA)&&!wo(a,ia.EXPORT_ALL_DATA),up=(a,n)=>n?Jb(n)?a:a.filter(t=>lo(n,t.createdBy)):[],fp=(a,n)=>n?n.role==="Admin"?a:a.filter(t=>qb(n,t.userId)):[],dp=(a,n)=>n?n.role==="Admin"?a:a.filter(t=>t.userId===n.username):[],Lf=(a,n)=>n?n.role==="Admin"?a:a.filter(t=>t.username===n.username):[],Bf=a=>a?.role==="Admin",hp=a=>!a||a.role==="Admin"?"all":a.username,$b=(a,n)=>!n||n.role==="Admin"?a:{...a,contacts:a.contacts?up(a.contacts,n):[],services:a.services?fp(a.services,n):[],sessions:a.sessions?dp(a.sessions,n):[]},Qb={filters:{},contacts:[],isLoading:!1,error:null},Zb=(a,n)=>{switch(n.type){case"SET_LOADING":return{...a,isLoading:n.payload};case"SET_ERROR":return{...a,error:n.payload,isLoading:!1};case"SET_CONTACTS":const t=HS(n.payload);return{...a,contacts:t,isLoading:!1,error:null};case"UPDATE_FILTER":const i={...a.filters,[n.payload.key]:n.payload.value};return Object.keys(i).forEach(l=>{const u=i[l];(u===""||u===null||u===void 0||Array.isArray(u)&&u.length===0)&&delete i[l]}),{...a,filters:i};case"CLEAR_FILTERS":return{...a,filters:{}};default:return a}},mp=G.createContext(void 0),eN=({children:a})=>{const[n,t]=G.useReducer(Zb,Qb),{currentUser:i}=Vt(),l=G.useMemo(()=>{if(!n.contacts.length)return[];if(!i)return[];const M=up(n.contacts,i);return zS(M,n.filters)},[n.contacts,n.filters,i]);G.useEffect(()=>{u()},[i]);const u=async()=>{t({type:"SET_LOADING",payload:!0});try{const M=Ke.getContacts();t({type:"SET_CONTACTS",payload:M})}catch(M){const N=M instanceof Error?M.message:"Failed to load contacts";t({type:"SET_ERROR",payload:N})}},f=(M,N)=>{t({type:"UPDATE_FILTER",payload:{key:M,value:N}})},h=()=>{t({type:"CLEAR_FILTERS"})},g=()=>{},v=()=>{t({type:"CLEAR_FILTERS"})},p=()=>{u()},S=Object.keys(n.filters).length>0,x=l.length,C=n.contacts.length,T=l.length,y=Object.entries(n.filters).map(([M,N])=>Array.isArray(N)?`${M}: ${N.join(", ")}`:`${M}: ${N}`),_=(M,N)=>{const K=new Date;switch(M){case"recent":const J=new Date(K.getTime()-6048e5);f("dateRange",{startDate:J,endDate:K});break;case"thisWeek":const B=new Date(K.setDate(K.getDate()-K.getDay()));f("dateRange",{startDate:B,endDate:new Date});break;case"thisMonth":const Z=new Date(K.getFullYear(),K.getMonth(),1);f("dateRange",{startDate:Z,endDate:new Date});break;case"byStatus":N&&f("statusKontak",[N]);break}},w=M=>{f("globalSearch",M)},k={filters:n.filters,filteredContacts:l,isLoading:n.isLoading,error:n.error,hasActiveFilters:S,filterCount:x,filterSummary:y,totalContacts:C,filteredCount:T,updateFilter:f,clearFilters:h,applyFilters:g,resetFilters:v,refreshContacts:p,applyQuickFilter:_,searchContacts:w};return o.jsx(mp.Provider,{value:k,children:a})},fs=()=>{const a=G.useContext(mp);if(!a)throw new Error("useFilter must be used within a FilterProvider");return a},tN=({history:a,isExpanded:n=!1,maxEntries:t=5})=>{const[i,l]=G.useState(n),[u,f]=G.useState(!1),h=[...a].sort((T,y)=>new Date(y.timestamp).getTime()-new Date(T.timestamp).getTime()),g=u?h:h.slice(0,t),v=h.length>t,p=T=>{const y=new Date(T),w=new Date().getTime()-y.getTime(),k=Math.floor(w/(1e3*60*60*24)),M=Math.floor(w/(1e3*60*60)),N=Math.floor(w/(1e3*60));return N<1?"Baru saja":N<60?`${N} menit yang lalu`:M<24?`${M} jam yang lalu`:k<7?`${k} hari yang lalu`:y.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},S=T=>{switch(T){case"created":return"";case"updated":return"";case"status_changed":return"";default:return""}},x=T=>{switch(T){case"created":return"success";case"updated":return"info";case"status_changed":return"warning";default:return"default"}},C=T=>{const y=Ke.getUserByUsername(T);if(y)return y.username;const _=Ke.getUserById(T);return _?_.username:T||"Unknown"};return!a||a.length===0?o.jsx("div",{className:"contact-history empty",children:o.jsx("p",{className:"empty-message",children:"Belum ada riwayat perubahan"})}):o.jsxs("div",{className:"contact-history",children:[o.jsx("div",{className:"history-header",children:o.jsxs("button",{className:"history-toggle",onClick:()=>l(!i),"aria-expanded":i,children:[o.jsx("span",{className:"toggle-icon",children:i?"":""}),o.jsxs("span",{className:"history-title",children:["Riwayat Perubahan (",h.length,")"]})]})}),i&&o.jsxs("div",{className:"history-content",children:[o.jsx("div",{className:"history-timeline",children:g.map((T,y)=>o.jsxs("div",{className:"history-entry",children:[o.jsxs("div",{className:"entry-marker",children:[o.jsx("span",{className:`entry-icon ${x(T.action)}`,children:S(T.action)}),y<g.length-1&&o.jsx("div",{className:"entry-line"})]}),o.jsxs("div",{className:"entry-content",children:[o.jsxs("div",{className:"entry-header",children:[o.jsx("span",{className:"entry-user",children:C(T.updatedBy)}),o.jsx("span",{className:"entry-time",children:p(T.timestamp)})]}),o.jsxs("div",{className:"entry-details",children:[T.notes&&o.jsx("p",{className:"entry-notes",children:T.notes}),T.field&&T.oldValue&&T.newValue&&o.jsxs("div",{className:"entry-change",children:[o.jsxs("span",{className:"field-name",children:[T.field,":"]}),o.jsxs("div",{className:"value-change",children:[o.jsxs("span",{className:"old-value",children:['"',T.oldValue,'"']}),o.jsx("span",{className:"arrow",children:""}),o.jsxs("span",{className:"new-value",children:['"',T.newValue,'"']})]})]})]})]})]},T.id))}),v&&o.jsx("div",{className:"history-actions",children:o.jsx("button",{className:"show-more-btn",onClick:()=>f(!u),children:u?"Tampilkan lebih sedikit":`Tampilkan ${h.length-t} lainnya`})})]})]})},Ev=({history:a,maxEntries:n=3})=>{const t=[...a].sort((h,g)=>new Date(g.timestamp).getTime()-new Date(h.timestamp).getTime()),i=t.slice(0,n);if(i.length===0)return o.jsx("span",{className:"history-compact empty",children:"Belum ada riwayat"});const l=i[0],u=h=>{const g=Ke.getUserByUsername(h);if(g)return g.username;const v=Ke.getUserById(h);return v?v.username:h||"Unknown"},f=h=>{const g=new Date(h),p=new Date().getTime()-g.getTime(),S=Math.floor(p/(1e3*60*60*24)),x=Math.floor(p/(1e3*60*60));return x<1?"Baru saja":x<24?`${x}j`:S<30?`${S}h`:g.toLocaleDateString("id-ID",{day:"numeric",month:"short"})};return o.jsxs("div",{className:"history-compact",children:[o.jsxs("span",{className:"last-update",children:["Terakhir diubah oleh ",u(l.updatedBy),"  ",f(l.timestamp)]}),t.length>1&&o.jsxs("span",{className:"history-count",children:["+",t.length-1," perubahan lainnya"]})]})};class aN{formatPhoneNumber(n){let t=n.replace(/\D/g,"");return t.startsWith("0")?t="62"+t.substring(1):t.startsWith("8")?t="62"+t:t.startsWith("62")||(t="62"+t),t}generateWhatsAppURL(n,t){const i=this.formatPhoneNumber(n),l="https://wa.me/";if(t){const u=encodeURIComponent(t);return`${l}${i}?text=${u}`}return`${l}${i}`}isValidPhoneNumber(n){if(!n)return!1;const t=n.replace(/\D/g,"");return t.length<10||t.length>15?!1:t.startsWith("62")||t.startsWith("0")||t.startsWith("8")}openWhatsApp(n,t){const i=this.generateWhatsAppURL(n,t);window.open(i,"_blank","noopener,noreferrer")}getMessageTemplates(){return[{id:"follow_up_1",name:"Follow Up - General",message:"Halo {name}, terima kasih telah menghubungi Hopeline Care. Apakah ada yang bisa kami bantu lebih lanjut?",category:"follow_up",variables:["name"]},{id:"follow_up_2",name:"Follow Up - Service",message:"Halo {name}, bagaimana kabar Anda setelah layanan kemarin? Apakah ada yang ingin Anda sampaikan?",category:"follow_up",variables:["name"]},{id:"appointment_reminder",name:"Appointment Reminder",message:"Halo {name}, ini pengingat untuk janji temu Anda pada {date} pukul {time}. Mohon konfirmasi kehadiran Anda.",category:"appointment",variables:["name","date","time"]},{id:"service_completion",name:"Service Completion",message:"Halo {name}, terima kasih telah menggunakan layanan Hopeline Care. Semoga Anda merasa terbantu. Jangan ragu untuk menghubungi kami lagi.",category:"service_completion",variables:["name"]},{id:"welcome_message",name:"Welcome Message",message:"Selamat datang di Hopeline Care, {name}! Kami siap membantu Anda. Silakan sampaikan apa yang bisa kami bantu.",category:"general",variables:["name"]},{id:"check_in",name:"Check In",message:"Halo {name}, kami ingin menanyakan kabar Anda. Bagaimana perasaan Anda hari ini?",category:"follow_up",variables:["name"]}]}processTemplate(n,t){let i=n.message;return n.variables.forEach(l=>{const u=`{${l}}`,f=t[l]||u;i=i.replace(new RegExp(u,"g"),f)}),i}getMessageHistory(n){try{const t=localStorage.getItem(`whatsapp_history_${n}`);return t?JSON.parse(t).map(l=>({...l,sentAt:new Date(l.sentAt)})):[]}catch(t){return console.error("Error loading WhatsApp history:",t),[]}}saveMessageToHistory(n){try{const t={...n,id:this.generateMessageId(),sentAt:new Date},i=this.getMessageHistory(n.contactId),l=[t,...i].slice(0,50);localStorage.setItem(`whatsapp_history_${n.contactId}`,JSON.stringify(l))}catch(t){console.error("Error saving WhatsApp history:",t)}}generateMessageId(){return`wa_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}sendMessage(n,t,i,l,u){if(!this.isValidPhoneNumber(t))throw new Error("Invalid phone number format");this.openWhatsApp(t,i),this.saveMessageToHistory({contactId:n,phoneNumber:this.formatPhoneNumber(t),message:i,template:u,sentBy:l})}getMessageStats(n){try{const t=Object.keys(localStorage).filter(p=>p.startsWith("whatsapp_history_"));let i=0,l=0;const u=new Map,f=new Set,h=new Date,g=new Date(h.getFullYear(),h.getMonth(),1);t.forEach(p=>{const S=p.replace("whatsapp_history_","");this.getMessageHistory(S).forEach(C=>{if(i++,f.add(S),C.sentAt>=g&&l++,C.template){const T=u.get(C.template)||0;u.set(C.template,T+1)}})});const v=Array.from(u.entries()).map(([p,S])=>({template:p,count:S})).sort((p,S)=>S.count-p.count).slice(0,5);return{totalMessages:i,messagesThisMonth:l,topTemplates:v,activeContacts:f.size}}catch(t){return console.error("Error calculating WhatsApp stats:",t),{totalMessages:0,messagesThisMonth:0,topTemplates:[],activeContacts:0}}}}const Cn=new aN,{formatPhoneNumber:HN,generateWhatsAppURL:GN,openWhatsApp:WN,getMessageTemplates:VN,processTemplate:YN,isValidPhoneNumber:XN,sendMessage:qN,getMessageHistory:JN,getMessageStats:$N}=Cn;class $r{static instance;constructor(){}static getInstance(){return $r.instance||($r.instance=new $r),$r.instance}addServiceEntry(n){const t={...n,id:Qi(),createdAt:new Date,updatedAt:new Date};this.validateServiceEntry(t);const i=this.getAllServices();return i.push(t),this.saveServices(i),this.updateServiceMetrics(n.contactId,n.userId),t}getAllServices(){try{const n=localStorage.getItem(Qc.SERVICES);return n?JSON.parse(n).map(i=>({...i,createdAt:new Date(i.createdAt),updatedAt:new Date(i.updatedAt)})):[]}catch(n){return console.error("Error loading services:",n),[]}}getServicesByContact(n){return this.getAllServices().filter(t=>t.contactId===n)}getServicesByUser(n){return this.getAllServices().filter(t=>t.userId===n)}getServicesByDate(n){return this.getAllServices().filter(t=>t.date===n)}getServicesByContactAndUser(n,t){return this.getAllServices().filter(i=>i.contactId===n&&i.userId===t)}updateServiceEntry(n,t){const i=this.getAllServices(),l=i.findIndex(f=>f.id===n);if(l===-1)return null;const u={...i[l],...t,updatedAt:new Date};return this.validateServiceEntry(u),i[l]=u,this.saveServices(i),this.updateServiceMetrics(u.contactId,u.userId),u}deleteServiceEntry(n){const t=this.getAllServices(),i=t.findIndex(u=>u.id===n);if(i===-1)return!1;const l=t[i];return t.splice(i,1),this.saveServices(t),this.updateServiceMetrics(l.contactId,l.userId),!0}getServiceMetrics(n,t){const i=this.getServicesByContactAndUser(n,t);return i.length===0?null:this.calculateServiceMetrics(n,t,i)}getAllServiceMetrics(){const n=this.getAllServices(),t=new Map;return n.forEach(i=>{const l=`${i.contactId}-${i.userId}`;if(!t.has(l)){const u=this.calculateServiceMetrics(i.contactId,i.userId,this.getServicesByContactAndUser(i.contactId,i.userId));t.set(l,u)}}),Array.from(t.values())}getContactServiceSummary(n){const t=this.getServicesByContact(n),i=new Set(t.map(v=>v.date)),l=t.reduce((v,p)=>v+p.duration,0),u=new Set(t.map(v=>v.userId)).size,h=t.sort((v,p)=>new Date(p.createdAt).getTime()-new Date(v.createdAt).getTime())[0],g=this.calculateMonthlyTrend(t);return{contactId:n,totalServiceDays:i.size,totalServiceHours:Math.round(l/60*100)/100,activeUsers:u,lastServiceDate:h?h.createdAt:new Date(0),lastServiceUser:h?h.userId:"",monthlyTrend:g}}saveServices(n){try{localStorage.setItem(Qc.SERVICES,JSON.stringify(n))}catch(t){throw console.error("Error saving services:",t),new Error("Failed to save service data")}}validateServiceEntry(n){const t=Cr;if(n.duration<0)throw new Error("Service duration cannot be negative");if(n.duration===0&&n.serviceType!=="WhatsApp Chat")throw new Error("Service duration must be greater than 0 for non-chat services");if(n.duration>t.maxDurationPerSession)throw new Error(`Service duration cannot exceed ${t.maxDurationPerSession} minutes per session`);const i=new Date(n.date),l=new Date,u=new Date;if(u.setDate(l.getDate()-t.maxPastDate),i>l)throw new Error("Cannot log services for future dates");if(i<u)throw new Error(`Cannot log services older than ${t.maxPastDate} days`);if(n.serviceType!=="WhatsApp Chat"&&this.getServicesByDate(n.date).filter(g=>g.contactId===n.contactId&&g.userId===n.userId&&g.id!==n.id&&g.serviceType!=="WhatsApp Chat").reduce((g,v)=>g+v.duration,0)+n.duration>t.maxDurationPerDay)throw new Error(`Total daily service duration cannot exceed ${t.maxDurationPerDay} minutes`)}calculateServiceMetrics(n,t,i){if(i.length===0)return{contactId:n,userId:t,serviceCount:0,totalDuration:0,firstService:new Date,lastService:new Date,averageDuration:0,servicesThisMonth:0,durationThisMonth:0};const u=new Set(i.map(_=>_.date)).size,f=i.reduce((_,w)=>_+w.duration,0),h=i.sort((_,w)=>new Date(_.createdAt).getTime()-new Date(w.createdAt).getTime()),g=h[0].createdAt,v=h[h.length-1].createdAt,p=Math.round(f/u),S=new Date;S.setDate(1),S.setHours(0,0,0,0);const x=i.filter(_=>new Date(_.createdAt)>=S),T=new Set(x.map(_=>_.date)).size,y=x.reduce((_,w)=>_+w.duration,0);return{contactId:n,userId:t,serviceCount:u,totalDuration:f,firstService:g,lastService:v,averageDuration:p,servicesThisMonth:T,durationThisMonth:y}}calculateMonthlyTrend(n){const t=new Map,i=[];for(let l=5;l>=0;l--){const u=new Date;u.setMonth(u.getMonth()-l);const f=u.toISOString().slice(0,7);i.push(f),t.set(f,{serviceCount:new Set,duration:0})}return n.forEach(l=>{const u=l.date.slice(0,7);if(t.has(u)){const f=t.get(u);f.serviceCount.add(l.date),f.duration+=l.duration}}),i.map(l=>({month:l,serviceCount:t.get(l).serviceCount.size,duration:t.get(l).duration}))}updateServiceMetrics(n,t){}clearAllServices(){localStorage.removeItem(Qc.SERVICES),localStorage.removeItem(Qc.SERVICE_METRICS)}exportServiceData(){return{services:this.getAllServices(),metrics:this.getAllServiceMetrics()}}importServiceData(n){n.services.forEach(t=>this.validateServiceEntry(t)),this.saveServices(n.services)}initializeDemoServiceData(){if(this.getAllServices().length>0)return;console.log("Initializing demo service data...");const t=[],i=new Date,l=["demo-1","demo-2","demo-3","demo-4"],u=["admin","editor"],f=["Konseling","Follow Up","Konsultasi","Terapi","Assessment"],h=["Sesi konseling individual","Follow up progress klien","Konsultasi masalah keluarga","Terapi trauma","Assessment awal","Sesi lanjutan","Evaluasi progress","Konseling kelompok"];for(let g=0;g<30;g++){const v=new Date(i);if(v.setDate(i.getDate()-g),v.getDay()===0||v.getDay()===6)continue;const p=Math.floor(Math.random()*4);for(let S=0;S<p;S++){const x=l[Math.floor(Math.random()*l.length)],C=u[Math.floor(Math.random()*u.length)],T=f[Math.floor(Math.random()*f.length)],y=h[Math.floor(Math.random()*h.length)],_=30+Math.floor(Math.random()*151);t.push({contactId:x,userId:C,date:v.toISOString().split("T")[0],duration:_,serviceType:T,description:y})}}t.forEach(g=>{this.addServiceEntry(g)}),console.log(`Added ${t.length} demo service entries`)}}const Wt=$r.getInstance(),nN=Object.freeze(Object.defineProperty({__proto__:null,ServiceStorage:$r,serviceStorage:Wt},Symbol.toStringTag,{value:"Module"})),vf=({contact:a,variant:n="primary",showTemplates:t=!0,className:i=""})=>{const{currentUser:l}=Vt(),[u,f]=G.useState(!1),[h,g]=G.useState(""),[v,p]=G.useState(null),[S,x]=G.useState(!1),C=Cn.getMessageTemplates(),T=(M,N)=>{if(l)try{const K=new Date().toISOString().split("T")[0];Wt.addServiceEntry({contactId:a.id,userId:l.username,date:K,duration:0,serviceType:"WhatsApp Chat",description:`${M}: ${N.substring(0,100)}${N.length>100?"...":""}`}),console.log("WhatsApp service recorded:",{contact:a.nama,user:l.username,type:M,date:K})}catch(K){console.error("Error recording WhatsApp service:",K)}},y=()=>{if(!Cn.isValidPhoneNumber(a.nomorTelepon)){alert("Nomor telepon tidak valid untuk WhatsApp");return}try{const M=`Halo ${a.nama}, saya dari Hopeline Care.`;Cn.sendMessage(a.id,a.nomorTelepon,M,l?.username||"Unknown","quick_message"),T("Quick Message",M)}catch(M){console.error("Error sending WhatsApp message:",M),alert("Gagal membuka WhatsApp. Periksa nomor telepon.")}},_=()=>{if(v){x(!0);try{const M={name:a.nama,date:new Date().toLocaleDateString("id-ID"),time:new Date().toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})},N=Cn.processTemplate(v,M);Cn.sendMessage(a.id,a.nomorTelepon,N,l?.username||"Unknown",v.id),T(`Template: ${v.name}`,N),f(!1),p(null)}catch(M){console.error("Error sending template message:",M),alert("Gagal mengirim pesan. Periksa nomor telepon.")}finally{x(!1)}}},w=()=>{if(h.trim()){x(!0);try{Cn.sendMessage(a.id,a.nomorTelepon,h,l?.username||"Unknown","custom_message"),T("Custom Message",h),f(!1),g("")}catch(M){console.error("Error sending custom message:",M),alert("Gagal mengirim pesan. Periksa nomor telepon.")}finally{x(!1)}}},k=()=>{const M=Cn.isValidPhoneNumber(a.nomorTelepon);switch(n){case"icon":return o.jsx("button",{onClick:t?()=>f(!0):y,disabled:!M,className:`whatsapp-btn whatsapp-btn-icon ${i}`,title:M?"Kirim WhatsApp":"Nomor telepon tidak valid",children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.516"})})});case"secondary":return o.jsxs("button",{onClick:t?()=>f(!0):y,disabled:!M,className:`whatsapp-btn whatsapp-btn-secondary ${i}`,children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.516"})}),"WhatsApp"]});default:return o.jsxs("button",{onClick:t?()=>f(!0):y,disabled:!M,className:`whatsapp-btn whatsapp-btn-primary ${i}`,children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.516"})}),"Kirim WhatsApp"]})}};return o.jsxs(o.Fragment,{children:[k(),u&&o.jsx("div",{className:"whatsapp-modal-overlay",onClick:()=>f(!1),children:o.jsxs("div",{className:"whatsapp-modal",onClick:M=>M.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("h3",{children:["Kirim WhatsApp ke ",a.nama]}),o.jsx("button",{onClick:()=>f(!1),className:"close-btn",children:""})]}),o.jsxs("div",{className:"modal-content",children:[o.jsx("div",{className:"contact-info",children:o.jsxs("span",{className:"phone-number",children:[" ",Cn.formatPhoneNumber(a.nomorTelepon)]})}),o.jsx("div",{className:"quick-actions",children:o.jsx("button",{onClick:y,className:"quick-action-btn",disabled:S,children:" Chat Langsung"})}),o.jsxs("div",{className:"templates-section",children:[o.jsx("h4",{children:"Template Pesan"}),o.jsx("div",{className:"templates-grid",children:C.map(M=>o.jsxs("div",{className:`template-card ${v?.id===M.id?"selected":""}`,onClick:()=>p(M),children:[o.jsx("div",{className:"template-name",children:M.name}),o.jsx("div",{className:"template-preview",children:Cn.processTemplate(M,{name:a.nama,date:new Date().toLocaleDateString("id-ID"),time:"14:00"})})]},M.id))}),v&&o.jsx("button",{onClick:_,disabled:S,className:"send-template-btn",children:S?"Mengirim...":"Kirim Template"})]}),o.jsxs("div",{className:"custom-message-section",children:[o.jsx("h4",{children:"Pesan Kustom"}),o.jsx("textarea",{value:h,onChange:M=>g(M.target.value),placeholder:"Tulis pesan kustom...",className:"custom-message-input",rows:3}),o.jsx("button",{onClick:w,disabled:!h.trim()||S,className:"send-custom-btn",children:S?"Mengirim...":"Kirim Pesan Kustom"})]})]})]})})]})},rN=({searchQuery:a,onCancel:n})=>{const i=(u=>{const f=u.trim();return/^[\d\s\-\+\(\)]+$/.test(f)&&f.length>=8?{nama:"",nomorTelepon:f.replace(/\s/g,"")}:{nama:f,nomorTelepon:""}})(a),l=()=>{n(),window.dispatchEvent(new CustomEvent("navigateToAddContact",{detail:i}))};return o.jsxs("div",{className:"quick-add-contact",children:[o.jsx("div",{className:"quick-add-header",children:o.jsxs("div",{className:"search-result-info",children:[o.jsx("span",{className:"search-icon",children:""}),o.jsxs("div",{className:"search-text",children:[o.jsxs("strong",{children:['"',a,'"']})," tidak ditemukan"]})]})}),o.jsxs("div",{className:"quick-add-content",children:[o.jsxs("div",{className:"parsed-data-preview",children:[o.jsx("h4",{children:"Data yang terdeteksi:"}),o.jsxs("div",{className:"data-preview",children:[i.nama&&o.jsxs("div",{className:"data-item",children:[o.jsx("span",{className:"data-label",children:"Nama:"}),o.jsx("span",{className:"data-value",children:i.nama})]}),i.nomorTelepon&&o.jsxs("div",{className:"data-item",children:[o.jsx("span",{className:"data-label",children:"Nomor Telepon:"}),o.jsx("span",{className:"data-value",children:i.nomorTelepon})]})]})]}),o.jsxs("div",{className:"quick-add-actions",children:[o.jsxs("button",{onClick:l,className:"quick-add-btn primary",children:[o.jsx("span",{children:""}),"Tambah Contact"]}),o.jsxs("button",{onClick:n,className:"quick-add-btn cancel",children:[o.jsx("span",{children:""}),"Batal"]})]}),o.jsx("div",{className:"quick-add-info",children:o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Tambah Contact:"})," Buka form lengkap untuk menambah contact dengan semua field yang diperlukan"]})})]})]})},iN=({onContactSelect:a,onContactEdit:n,onContactDelete:t})=>{const[i,l]=G.useState("createdAt"),[u,f]=G.useState("desc"),[h,g]=G.useState(1),[v]=G.useState(10),[p,S]=G.useState(!1),{currentUser:x}=Vt(),{filteredContacts:C,isLoading:T,refreshContacts:y,filters:_}=fs();G.useEffect(()=>{y()},[y]);const w=G.useMemo(()=>{const D=[...C];return D.sort((z,ue)=>{let be=z[i],Se=ue[i];if(i==="createdAt"||i==="updatedAt"){const ee=new Date(be).getTime(),ge=new Date(Se).getTime();return u==="asc"?ee<ge?-1:ee>ge?1:0:ee>ge?-1:ee<ge?1:0}return typeof be=="string"&&typeof Se=="string"&&(be=be.toLowerCase(),Se=Se.toLowerCase()),be===void 0&&(be=""),Se===void 0&&(Se=""),u==="asc"?be<Se?-1:be>Se?1:0:be>Se?-1:be<Se?1:0}),D},[C,i,u]);G.useEffect(()=>{const D=_.globalSearch&&_.globalSearch.trim().length>0,z=w.length===0;S(!!(D&&z&&!T))},[_.globalSearch,w.length,T]);const k=Math.ceil(w.length/v),M=(h-1)*v,N=w.slice(M,M+v),K=D=>{i===D?f(u==="asc"?"desc":"asc"):(l(D),f("asc"))},J=async D=>{if(!of(x)){alert("You do not have permission to delete contacts");return}const z=C.find(Se=>Se.id===D);if(!z){alert("Contact not found");return}if(!lo(x,z.createdBy)){alert("You can only delete contacts that you created");return}const ue=` KONFIRMASI HAPUS KONTAK

Apakah Anda yakin ingin menghapus kontak berikut?

 Nama: ${z.nama}
 Telepon: ${z.nomorTelepon||"Tidak ada"}
 Provinsi: ${z.provinsi||"Tidak ada"}
 Status: ${z.statusKontak}
 Prioritas: ${z.prioritas}
 Dibuat: ${z.createdAt?Z0(new Date(z.createdAt)):"Tidak diketahui"}

 PERINGATAN:
 Kontak ini akan dihapus secara permanen
 Semua riwayat perubahan akan hilang
 Data layanan terkait akan terpengaruh
 Tindakan ini TIDAK DAPAT dibatalkan

Ketik "HAPUS" untuk konfirmasi atau "Batal" untuk membatalkan.`;if(prompt(ue)==="HAPUS")try{Ke.deleteContact(D),y(),t?.(D)}catch(Se){console.error("Error deleting contact:",Se),alert("Failed to delete contact")}},B=D=>i!==D?"":u==="asc"?"":"",Z=D=>({"New Contact":"#e74c3c","In Progress":"#f39c12","Follow Up":"#3498db",Completed:"#27ae60"})[D]||"#95a5a6",L=()=>{S(!1)},X=()=>{S(!1)};return T?o.jsx("div",{className:"contact-list-loading",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading contacts..."})]})}):o.jsxs("div",{className:"contact-list",children:[o.jsxs("div",{className:"contact-list-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h2",{children:"Contact Management"}),o.jsx("div",{className:"contact-list-stats",children:o.jsxs("span",{children:["Showing: ",w.length," contacts"]})})]}),o.jsx("div",{className:"header-actions",children:o.jsx(op,{contacts:w,variant:"primary",size:"medium"})})]}),p?o.jsx(rN,{searchQuery:_.globalSearch||"",onContactAdded:L,onCancel:X}):w.length===0?o.jsx("div",{className:"no-contacts",children:o.jsx("p",{children:"No contacts found matching current filters"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"contact-table-container",children:o.jsxs("table",{className:"contact-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsxs("th",{onClick:()=>K("nama"),className:"sortable",children:["Nama ",B("nama")]}),o.jsxs("th",{onClick:()=>K("nomorTelepon"),className:"sortable",children:["Telepon ",B("nomorTelepon")]}),o.jsxs("th",{onClick:()=>K("provinsi"),className:"sortable",children:["Provinsi ",B("provinsi")]}),o.jsxs("th",{onClick:()=>K("sumber"),className:"sortable",children:["Sumber ",B("sumber")]}),o.jsxs("th",{onClick:()=>K("prioritas"),className:"sortable",children:["Prioritas ",B("prioritas")]}),o.jsxs("th",{onClick:()=>K("statusKontak"),className:"sortable",children:["Status ",B("statusKontak")]}),o.jsxs("th",{onClick:()=>K("createdAt"),className:"sortable",children:["Created ",B("createdAt")]}),o.jsx("th",{children:"Actions"})]})}),o.jsx("tbody",{children:N.map(D=>o.jsxs("tr",{className:"contact-row",children:[o.jsx("td",{className:"contact-name",children:o.jsxs("div",{className:"name-with-history",children:[o.jsx("strong",{children:D.nama}),o.jsx(Ev,{history:D.history||[],maxEntries:1})]})}),o.jsx("td",{className:"contact-phone",children:D.nomorTelepon||"-"}),o.jsx("td",{className:"contact-city",children:D.provinsi||"-"}),o.jsx("td",{className:"contact-sumber",children:o.jsx("span",{className:"sumber-badge",children:D.sumber||"Lainnya"})}),o.jsx("td",{className:"contact-priority",children:o.jsx("span",{className:`priority-badge priority-${(D.prioritas||"sedang").toLowerCase()}`,children:D.prioritas||"Sedang"})}),o.jsx("td",{children:o.jsx("span",{className:"status-badge",style:{backgroundColor:Z(D.statusKontak)},children:D.statusKontak})}),o.jsx("td",{className:"contact-date",children:D.createdAt?Z0(new Date(D.createdAt)):"No Date"}),o.jsxs("td",{className:"contact-actions",children:[o.jsx(vf,{contact:D,variant:"icon",showTemplates:!1,className:"contact-list-whatsapp"}),o.jsx("button",{onClick:()=>a?.(D),className:"action-btn view-btn",title:"View Details",children:""}),o.jsx("button",{onClick:()=>n?.(D),className:"action-btn edit-btn",title:"Edit Contact",children:""}),of(x)&&lo(x,D.createdBy)&&o.jsx("button",{onClick:()=>J(D.id),className:"action-btn delete-btn",title:"Delete Contact",children:""})]})]},D.id))})]})}),o.jsx("div",{className:"contact-cards",children:N.map(D=>o.jsxs("div",{className:"contact-card",children:[o.jsxs("div",{className:"contact-card-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"contact-card-name",children:D.nama}),o.jsx("div",{className:"contact-card-phone",children:D.nomorTelepon||"No Phone"})]}),o.jsxs("div",{className:"contact-card-badges",children:[o.jsx("span",{className:"status-badge",style:{backgroundColor:Z(D.statusKontak)},children:D.statusKontak}),o.jsx("span",{className:`priority-badge priority-${(D.prioritas||"sedang").toLowerCase()}`,children:D.prioritas||"Sedang"})]})]}),o.jsxs("div",{className:"contact-card-body",children:[o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"Provinsi"}),o.jsx("div",{className:"contact-card-value",children:D.provinsi||"-"})]}),o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"Sumber"}),o.jsx("div",{className:"contact-card-value",children:o.jsx("span",{className:"sumber-badge",children:D.sumber||"Lainnya"})})]}),o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"Created"}),o.jsx("div",{className:"contact-card-value",children:D.createdAt?Z0(new Date(D.createdAt)):"No Date"})]}),o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"History"}),o.jsx("div",{className:"contact-card-value",children:o.jsx(Ev,{history:D.history||[],maxEntries:1})})]})]}),o.jsxs("div",{className:"contact-card-actions",children:[o.jsx(vf,{contact:D,variant:"button",showTemplates:!1,size:"small"}),o.jsx("button",{onClick:()=>a?.(D),className:"action-btn view-btn",children:" View"}),o.jsx("button",{onClick:()=>n?.(D),className:"action-btn edit-btn",children:" Edit"}),of(x)&&lo(x,D.createdBy)&&o.jsx("button",{onClick:()=>J(D.id),className:"action-btn delete-btn",children:" Delete"})]})]},D.id))}),k>1&&o.jsxs("div",{className:"pagination",children:[o.jsx("button",{onClick:()=>g(D=>Math.max(D-1,1)),disabled:h===1,className:"pagination-btn",children:"Previous"}),o.jsxs("div",{className:"pagination-info",children:["Page ",h," of ",k]}),o.jsx("button",{onClick:()=>g(D=>Math.min(D+1,k)),disabled:h===k,className:"pagination-btn",children:"Next"})]})]})]})},sN=()=>{const[a,n]=G.useState([]),[t,i]=G.useState(!0);G.useEffect(()=>{const p=()=>{try{i(!0);const C=Ke.getContacts();n(C)}catch(C){console.error("Error loading contacts for suggestions:",C),n([])}finally{i(!1)}};p();const S=C=>{C.key==="crm_contacts"&&p()},x=()=>{p()};return window.addEventListener("storage",S),window.addEventListener("contactsUpdated",x),()=>{window.removeEventListener("storage",S),window.removeEventListener("contactsUpdated",x)}},[]);const l=G.useMemo(()=>{if(t||a.length===0)return{names:[],phoneNumbers:[]};const p=new Set,S=new Set;a.forEach(T=>{T.nama&&T.nama.trim()&&p.add(T.nama.trim()),T.nomorTelepon&&T.nomorTelepon.trim()&&S.add(T.nomorTelepon.trim())});const x=Array.from(p).sort((T,y)=>T.toLowerCase().localeCompare(y.toLowerCase())),C=Array.from(S).sort();return{names:x,phoneNumbers:C}},[a,t]);return{suggestions:l,isLoading:t,isNameDuplicate:p=>p.trim()?l.names.some(S=>S.toLowerCase()===p.toLowerCase()):!1,isPhoneNumberDuplicate:p=>p.trim()?l.phoneNumbers.some(S=>S===p.trim()):!1,findContactByName:p=>{if(p.trim())return a.find(S=>S.nama.toLowerCase()===p.toLowerCase())},findContactByPhoneNumber:p=>{if(p.trim())return a.find(S=>S.nomorTelepon===p.trim())},getSimilarContacts:(p,S)=>{if(!p.trim())return[];const x=p.toLowerCase();return a.filter(C=>(C[S]?.toLowerCase()||"").includes(x))},refreshSuggestions:()=>{window.dispatchEvent(new CustomEvent("contactsUpdated"))}}},uf=({id:a,value:n,onChange:t,suggestions:i,placeholder:l,className:u="",disabled:f=!1,type:h="text",maxLength:g,autoComplete:v="off",autoCorrect:p="off",autoCapitalize:S="none",spellCheck:x=!1,showDuplicateWarning:C=!0,excludeFromDuplicateCheck:T})=>{const[y,_]=G.useState([]),[w,k]=G.useState(!1),[M,N]=G.useState(-1),[K,J]=G.useState(!1),B=G.useRef(null),Z=G.useRef(null),L=G.useCallback(Ne=>Ne.trim()?i.filter(H=>H.toLowerCase().includes(Ne.toLowerCase())).sort((H,j)=>{const V=H.toLowerCase().startsWith(Ne.toLowerCase()),P=j.toLowerCase().startsWith(Ne.toLowerCase());return V&&!P?-1:!V&&P?1:H.localeCompare(j)}):[],[i]);G.useEffect(()=>{const Ne=L(n);_(Ne),k(Ne.length>0&&n.trim().length>0),N(-1)},[n,i,L]);const X=Ne=>{K||t(Ne.target.value)},D=()=>{J(!0)},z=Ne=>{J(!1),t(Ne.currentTarget.value)},ue=Ne=>{if(!(!w||y.length===0))switch(Ne.key){case"ArrowDown":Ne.preventDefault(),N(Le=>Le<y.length-1?Le+1:0);break;case"ArrowUp":Ne.preventDefault(),N(Le=>Le>0?Le-1:y.length-1);break;case"Enter":Ne.preventDefault(),M>=0&&be(y[M]);break;case"Escape":k(!1),N(-1);break;case"Tab":k(!1),N(-1);break}},be=Ne=>{t(Ne),k(!1),N(-1),B.current?.focus()},Se=()=>{n.trim()&&y.length>0&&k(!0)},ee=()=>{setTimeout(()=>{Z.current?.contains(document.activeElement)||(k(!1),N(-1))},150)},ge=Ne=>{be(Ne)},ke=C&&n.trim()&&i.some(Ne=>Ne.toLowerCase()===n.toLowerCase()&&Ne.toLowerCase()!==T?.toLowerCase());return o.jsxs("div",{className:"autocomplete-container",children:[o.jsx("input",{ref:B,id:a,type:h,value:n,onChange:X,onCompositionStart:D,onCompositionEnd:z,onKeyDown:ue,onFocus:Se,onBlur:ee,placeholder:l,className:`${u} ${ke?"duplicate-warning":""}`,disabled:f,maxLength:g,autoComplete:v,autoCorrect:p,autoCapitalize:S,spellCheck:x}),w&&y.length>0&&o.jsxs("div",{ref:Z,className:"suggestions-dropdown",children:[y.slice(0,5).map((Ne,Le)=>o.jsxs("div",{className:`suggestion-item ${Le===M?"active":""} ${Ne.toLowerCase()===n.toLowerCase()?"exact-match":""}`,onClick:()=>ge(Ne),onMouseEnter:()=>N(Le),children:[o.jsx("span",{className:"suggestion-text",children:Ne}),C&&Ne.toLowerCase()===n.toLowerCase()&&Ne.toLowerCase()!==T?.toLowerCase()&&o.jsx("span",{className:"duplicate-badge",children:"Sudah Ada"})]},Ne)),y.length>5&&o.jsxs("div",{className:"suggestions-more",children:["+",y.length-5," lainnya..."]})]}),ke&&C&&o.jsx("div",{className:"duplicate-warning-text",children:" Data ini sudah ada dalam kontak"})]})},ds={Aceh:{"Kabupaten Aceh Barat":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Barat Daya":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Besar":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Jaya":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Selatan":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Singkil":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Tamiang":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Tengah":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Tenggara":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Timur":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Utara":{mission:"NSM",uni:"WIUM"},"Kabupaten Bener Meriah":{mission:"NSM",uni:"WIUM"},"Kabupaten Bireuen":{mission:"NSM",uni:"WIUM"},"Kabupaten Gayo Lues":{mission:"NSM",uni:"WIUM"},"Kabupaten Nagan Raya":{mission:"NSM",uni:"WIUM"},"Kabupaten Pidie":{mission:"NSM",uni:"WIUM"},"Kabupaten Pidie Jaya":{mission:"NSM",uni:"WIUM"},"Kabupaten Simeulue":{mission:"NSM",uni:"WIUM"},"Kota Banda Aceh":{mission:"NSM",uni:"WIUM"},"Kota Langsa":{mission:"NSM",uni:"WIUM"},"Kota Lhokseumawe":{mission:"NSM",uni:"WIUM"},"Kota Sabang":{mission:"NSM",uni:"WIUM"},"Kota Subulussalam":{mission:"NSM",uni:"WIUM"}},"Sumatera Utara":{"Kabupaten Asahan":{mission:"NSM",uni:"WIUM"},"Kabupaten Batu Bara":{mission:"NSM",uni:"WIUM"},"Kabupaten Dairi":{mission:"NSM",uni:"WIUM"},"Kabupaten Deli Serdang":{mission:"NSM",uni:"WIUM"},"Kabupaten Humbang Hasundutan":{mission:"CSM",uni:"WIUM"},"Kabupaten Karo":{mission:"NSM",uni:"WIUM"},"Kabupaten Labuhanbatu":{mission:"NSM",uni:"WIUM"},"Kabupaten Labuhanbatu Selatan":{mission:"NSM",uni:"WIUM"},"Kabupaten Labuhanbatu Utara":{mission:"NSM",uni:"WIUM"},"Kabupaten Langkat":{mission:"NSM",uni:"WIUM"},"Kabupaten Mandailing Natal":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias Barat":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias Utara":{mission:"CSM",uni:"WIUM"},"Kabupaten Padang Lawas":{mission:"NSM",uni:"WIUM"},"Kabupaten Padang Lawas Utara":{mission:"NSM",uni:"WIUM"},"Kabupaten Pakpak Bharat":{mission:"NSM",uni:"WIUM"},"Kabupaten Samosir":{mission:"NSM",uni:"WIUM"},"Kabupaten Serdang Bedagai":{mission:"NSM",uni:"WIUM"},"Kabupaten Simalungun":{mission:"NSM",uni:"WIUM"},"Kabupaten Tapanuli Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Tapanuli Tengah":{mission:"CSM",uni:"WIUM"},"Kabupaten Tapanuli Utara":{mission:"CSM",uni:"WIUM"},"Kabupaten Toba":{mission:"NSM",uni:"WIUM"},"Kota Binjai":{mission:"NSM",uni:"WIUM"},"Kota Gunungsitoli":{mission:"NSM",uni:"WIUM"},"Kota Medan":{mission:"NSM",uni:"WIUM"},"Kota Padangsidimpuan":{mission:"NSM",uni:"WIUM"},"Kota Pematangsiantar":{mission:"NSM",uni:"WIUM"},"Kota Sibolga":{mission:"NSM",uni:"WIUM"},"Kota Tanjungbalai":{mission:"NSM",uni:"WIUM"},"Kota Tebing Tinggi":{mission:"NSM",uni:"WIUM"}},"Sumatera Barat":{"Kabupaten Agam":{mission:"CSM",uni:"WIUM"},"Kabupaten Dharmasraya":{mission:"CSM",uni:"WIUM"},"Kabupaten Kepulauan Mentawai":{mission:"CSM",uni:"WIUM"},"Kabupaten Lima Puluh Kota":{mission:"CSM",uni:"WIUM"},"Kabupaten Padang Pariaman":{mission:"CSM",uni:"WIUM"},"Kabupaten Pasaman":{mission:"CSM",uni:"WIUM"},"Kabupaten Pasaman Barat":{mission:"CSM",uni:"WIUM"},"Kabupaten Pesisir Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Sijunjung":{mission:"CSM",uni:"WIUM"},"Kabupaten Solok":{mission:"CSM",uni:"WIUM"},"Kabupaten Solok Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Tanah Datar":{mission:"CSM",uni:"WIUM"},"Kota Bukittinggi":{mission:"CSM",uni:"WIUM"},"Kota Padang":{mission:"CSM",uni:"WIUM"},"Kota Padang Panjang":{mission:"CSM",uni:"WIUM"},"Kota Pariaman":{mission:"CSM",uni:"WIUM"},"Kota Payakumbuh":{mission:"CSM",uni:"WIUM"},"Kota Sawahlunto":{mission:"CSM",uni:"WIUM"},"Kota Solok":{mission:"CSM",uni:"WIUM"}},Riau:{"Kabupaten Kampar":{mission:"CSM",uni:"WIUM"},"Kabupaten Indragiri Hulu":{mission:"CSM",uni:"WIUM"},"Kabupaten Bengkalis":{mission:"CSM",uni:"WIUM"},"Kabupaten Indragiri Hilir":{mission:"CSM",uni:"WIUM"},"Kabupaten Pelalawan":{mission:"CSM",uni:"WIUM"},"Kabupaten Rokan Hulu":{mission:"CSM",uni:"WIUM"},"Kabupaten Rokan Hilir":{mission:"CSM",uni:"WIUM"},"Kabupaten Siak":{mission:"CSM",uni:"WIUM"},"Kabupaten Kuantan Singingi":{mission:"CSM",uni:"WIUM"},"Kabupaten Kepulauan Meranti":{mission:"CSM",uni:"WIUM"},"Kota Pekanbaru":{mission:"CSM",uni:"WIUM"},"Kota Dumai":{mission:"CSM",uni:"WIUM"}},"Kepulauan Riau":{"Kabupaten Bintan":{mission:"CSM",uni:"WIUM"},"Kabupaten Karimun":{mission:"CSM",uni:"WIUM"},"Kabupaten Natuna":{mission:"CSM",uni:"WIUM"},"Kabupaten Lingga":{mission:"CSM",uni:"WIUM"},"Kabupaten Kepulauan Anambas":{mission:"CSM",uni:"WIUM"},"Kota Batam":{mission:"CSM",uni:"WIUM"},"Kota Tanjung Pinang":{mission:"CSM",uni:"WIUM"}},Jambi:{"Kabupaten Kerinci":{mission:"SSM",uni:"WIUM"},"Kabupaten Merangin":{mission:"SSM",uni:"WIUM"},"Kabupaten Sarolangun":{mission:"SSM",uni:"WIUM"},"Kabupaten Batanghari":{mission:"SSM",uni:"WIUM"},"Kabupaten Muaro Jambi":{mission:"SSM",uni:"WIUM"},"Kabupaten Tanjung Jabung Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Tanjung Jabung Timur":{mission:"SSM",uni:"WIUM"},"Kabupaten Bungo":{mission:"SSM",uni:"WIUM"},"Kabupaten Tebo":{mission:"SSM",uni:"WIUM"},"Kota Jambi":{mission:"SSM",uni:"WIUM"},"Kota Sungai Penuh":{mission:"SSM",uni:"WIUM"}},"Sumatera Selatan":{"Kabupaten Ogan Komering Ulu":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Komering Ilir":{mission:"SSM",uni:"WIUM"},"Kabupaten Muara Enim":{mission:"SSM",uni:"WIUM"},"Kabupaten Lahat":{mission:"SSM",uni:"WIUM"},"Kabupaten Musi Rawas":{mission:"SSM",uni:"WIUM"},"Kabupaten Musi Banyuasin":{mission:"SSM",uni:"WIUM"},"Kabupaten Banyuasin":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Komering Ulu Timur":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Komering Ulu Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Ilir":{mission:"SSM",uni:"WIUM"},"Kabupaten Empat Lawang":{mission:"SSM",uni:"WIUM"},"Kabupaten Penukal Abab Lematang Ilir":{mission:"SSM",uni:"WIUM"},"Kabupaten Musi Rawas Utara":{mission:"SSM",uni:"WIUM"},"Kota Palembang":{mission:"SSM",uni:"WIUM"},"Kota Pagar Alam":{mission:"SSM",uni:"WIUM"},"Kota Lubuk Linggau":{mission:"SSM",uni:"WIUM"},"Kota Prabumulih":{mission:"SSM",uni:"WIUM"}},"Kepulauan Bangka Belitung":{"Kabupaten Bangka":{mission:"SSM",uni:"WIUM"},"Kabupaten Belitung":{mission:"SSM",uni:"WIUM"},"Kabupaten Bangka Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Bangka Tengah":{mission:"SSM",uni:"WIUM"},"Kabupaten Bangka Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Belitung Timur":{mission:"SSM",uni:"WIUM"},"Kota Pangkal Pinang":{mission:"SSM",uni:"WIUM"}},Bengkulu:{"Kabupaten Bengkulu Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Rejang Lebong":{mission:"SSM",uni:"WIUM"},"Kabupaten Bengkulu Utara":{mission:"SSM",uni:"WIUM"},"Kabupaten Kaur":{mission:"SSM",uni:"WIUM"},"Kabupaten Seluma":{mission:"SSM",uni:"WIUM"},"Kabupaten Muko Muko":{mission:"SSM",uni:"WIUM"},"Kabupaten Lebong":{mission:"SSM",uni:"WIUM"},"Kabupaten Kepahiang":{mission:"SSM",uni:"WIUM"},"Kabupaten Bengkulu Tengah":{mission:"SSM",uni:"WIUM"},"Kota Bengkulu":{mission:"SSM",uni:"WIUM"}},Lampung:{"Kabupaten Lampung Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Tengah":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Utara":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Tulang Bawang":{mission:"SSM",uni:"WIUM"},"Kabupaten Tanggamus":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Timur":{mission:"SSM",uni:"WIUM"},"Kabupaten Way Kanan":{mission:"SSM",uni:"WIUM"},"Kabupaten Pesawaran":{mission:"SSM",uni:"WIUM"},"Kabupaten Pringsewu":{mission:"SSM",uni:"WIUM"},"Kabupaten Mesuji":{mission:"SSM",uni:"WIUM"},"Kabupaten Tulang Bawang Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Pesisir Barat":{mission:"SSM",uni:"WIUM"},"Kota Bandar Lampung":{mission:"SSM",uni:"WIUM"},"Kota Metro":{mission:"SSM",uni:"WIUM"}},Banten:{"Kabupaten Pandeglang":{mission:"JBC",uni:"WIUM"},"Kabupaten Lebak":{mission:"JBC",uni:"WIUM"},"Kabupaten Tangerang":{mission:"JBC",uni:"WIUM"},"Kabupaten Serang":{mission:"JBC",uni:"WIUM"},"Kota Tangerang":{mission:"JBC",uni:"WIUM"},"Kota Cilegon":{mission:"JBC",uni:"WIUM"},"Kota Serang":{mission:"JBC",uni:"WIUM"},"Kota Tangerang Selatan":{mission:"JBC",uni:"WIUM"}},Jakarta:{"Kepulauan Seribu":{mission:"JBC",uni:"WIUM"},"Jakarta Utara":{mission:"JBC",uni:"WIUM"},"Jakarta Barat":{mission:"JBC",uni:"WIUM"},"Jakarta Pusat":{mission:"JC",uni:"CIUM"},"Jakarta Selatan":{mission:"JC",uni:"CIUM"},"Jakarta Timur":{mission:"JC",uni:"CIUM"}},"Jawa Barat":{Depok:{mission:"JC",uni:"CIUM"},Bekasi:{mission:"JC",uni:"CIUM"},Bogor:{mission:"JC",uni:"CIUM"},Karawang:{mission:"JC",uni:"CIUM"},Sukabumi:{mission:"JC",uni:"CIUM"},Purwakarta:{mission:"JC",uni:"CIUM"},"Kabupaten Cianjur":{mission:"WJC",uni:"CIUM"},"Kabupaten Bandung":{mission:"WJC",uni:"CIUM"},"Kabupaten Garut":{mission:"WJC",uni:"CIUM"},"Kabupaten Tasikmalaya":{mission:"WJC",uni:"CIUM"},"Kabupaten Ciamis":{mission:"WJC",uni:"CIUM"},"Kabupaten Kuningan":{mission:"WJC",uni:"CIUM"},"Kabupaten Cirebon":{mission:"WJC",uni:"CIUM"},"Kabupaten Majalengka":{mission:"WJC",uni:"CIUM"},"Kabupaten Sumedang":{mission:"WJC",uni:"CIUM"},"Kabupaten Indramayu":{mission:"WJC",uni:"CIUM"},"Kabupaten Subang":{mission:"WJC",uni:"CIUM"},"Kabupaten Karawang":{mission:"WJC",uni:"CIUM"},"Kabupaten Bandung Barat":{mission:"WJC",uni:"CIUM"},"Kabupaten Pangandaran":{mission:"WJC",uni:"CIUM"},"Kota Bandung":{mission:"WJC",uni:"CIUM"},"Kota Cirebon":{mission:"WJC",uni:"CIUM"},"Kota Cimahi":{mission:"WJC",uni:"CIUM"},"Kota Tasikmalaya":{mission:"WJC",uni:"CIUM"},"Kota Banjar":{mission:"WJC",uni:"CIUM"}}},lN=()=>Object.keys(ds).sort(),cN=a=>{const n=ds[a];return n?Object.keys(n).sort():[]},oN=(a,n)=>{const t=ds[a];if(!t)return"";const i=t[n];return i?i.mission:""},uN=(a,n)=>{const t=ds[a];if(!t)return"";const i=t[n];return i?i.uni:""},fN=(a,n)=>{const t=ds[a];if(!t)return null;const i=t[n];return i?{provinsi:a,kabKota:n,mission:i.mission,uni:i.uni}:null};Object.assign(ds,{"Jawa Tengah":{"Kabupaten Cilacap":{mission:"CJM",uni:"CIUM"},"Kabupaten Banyumas":{mission:"CJM",uni:"CIUM"},"Kabupaten Purbalingga":{mission:"CJM",uni:"CIUM"},"Kabupaten Banjarnegara":{mission:"CJM",uni:"CIUM"},"Kabupaten Kebumen":{mission:"CJM",uni:"CIUM"},"Kabupaten Purworejo":{mission:"CJM",uni:"CIUM"},"Kabupaten Wonosobo":{mission:"CJM",uni:"CIUM"},"Kabupaten Magelang":{mission:"CJM",uni:"CIUM"},"Kabupaten Boyolali":{mission:"CJM",uni:"CIUM"},"Kabupaten Klaten":{mission:"CJM",uni:"CIUM"},"Kabupaten Sukoharjo":{mission:"CJM",uni:"CIUM"},"Kabupaten Wonogiri":{mission:"CJM",uni:"CIUM"},"Kabupaten Karanganyar":{mission:"CJM",uni:"CIUM"},"Kabupaten Sragen":{mission:"CJM",uni:"CIUM"},"Kabupaten Grobogan":{mission:"CJM",uni:"CIUM"},"Kabupaten Blora":{mission:"CJM",uni:"CIUM"},"Kabupaten Rembang":{mission:"CJM",uni:"CIUM"},"Kabupaten Pati":{mission:"CJM",uni:"CIUM"},"Kabupaten Kudus":{mission:"CJM",uni:"CIUM"},"Kabupaten Jepara":{mission:"CJM",uni:"CIUM"},"Kabupaten Demak":{mission:"CJM",uni:"CIUM"},"Kabupaten Semarang":{mission:"CJM",uni:"CIUM"},"Kabupaten Temanggung":{mission:"CJM",uni:"CIUM"},"Kabupaten Kendal":{mission:"CJM",uni:"CIUM"},"Kabupaten Batang":{mission:"CJM",uni:"CIUM"},"Kabupaten Pekalongan":{mission:"CJM",uni:"CIUM"},"Kabupaten Pemalang":{mission:"CJM",uni:"CIUM"},"Kabupaten Tegal":{mission:"CJM",uni:"CIUM"},"Kabupaten Brebes":{mission:"CJM",uni:"CIUM"},"Kota Magelang":{mission:"CJM",uni:"CIUM"},"Kota Surakarta":{mission:"CJM",uni:"CIUM"},"Kota Salatiga":{mission:"CJM",uni:"CIUM"},"Kota Semarang":{mission:"CJM",uni:"CIUM"},"Kota Pekalongan":{mission:"CJM",uni:"CIUM"},"Kota Tegal":{mission:"CJM",uni:"CIUM"}},"DI Yogyakarta":{"Kabupaten Kulon Progo":{mission:"CJM",uni:"CIUM"},"Kabupaten Bantul":{mission:"CJM",uni:"CIUM"},"Kabupaten Gunungkidul":{mission:"CJM",uni:"CIUM"},"Kabupaten Sleman":{mission:"CJM",uni:"CIUM"},"Kota Yogyakarta":{mission:"CJM",uni:"CIUM"}},"Jawa Timur":{"Kabupaten Pacitan":{mission:"EJC",uni:"CIUM"},"Kabupaten Ponorogo":{mission:"EJC",uni:"CIUM"},"Kabupaten Trenggalek":{mission:"EJC",uni:"CIUM"},"Kabupaten Tulungagung":{mission:"EJC",uni:"CIUM"},"Kabupaten Blitar":{mission:"EJC",uni:"CIUM"},"Kabupaten Kediri":{mission:"EJC",uni:"CIUM"},"Kabupaten Malang":{mission:"EJC",uni:"CIUM"},"Kabupaten Lumajang":{mission:"EJC",uni:"CIUM"},"Kabupaten Jember":{mission:"EJC",uni:"CIUM"},"Kabupaten Banyuwangi":{mission:"EJC",uni:"CIUM"},"Kabupaten Bondowoso":{mission:"EJC",uni:"CIUM"},"Kabupaten Situbondo":{mission:"EJC",uni:"CIUM"},"Kabupaten Probolinggo":{mission:"EJC",uni:"CIUM"},"Kabupaten Pasuruan":{mission:"EJC",uni:"CIUM"},"Kabupaten Sidoarjo":{mission:"EJC",uni:"CIUM"},"Kabupaten Mojokerto":{mission:"EJC",uni:"CIUM"},"Kabupaten Jombang":{mission:"EJC",uni:"CIUM"},"Kabupaten Nganjuk":{mission:"EJC",uni:"CIUM"},"Kabupaten Madiun":{mission:"EJC",uni:"CIUM"},"Kabupaten Magetan":{mission:"EJC",uni:"CIUM"},"Kabupaten Ngawi":{mission:"EJC",uni:"CIUM"},"Kabupaten Bojonegoro":{mission:"EJC",uni:"CIUM"},"Kabupaten Tuban":{mission:"EJC",uni:"CIUM"},"Kabupaten Lamongan":{mission:"EJC",uni:"CIUM"},"Kabupaten Gresik":{mission:"EJC",uni:"CIUM"},"Kabupaten Bangkalan":{mission:"EJC",uni:"CIUM"},"Kabupaten Sampang":{mission:"EJC",uni:"CIUM"},"Kabupaten Pamekasan":{mission:"EJC",uni:"CIUM"},"Kabupaten Sumenep":{mission:"EJC",uni:"CIUM"},"Kota Kediri":{mission:"EJC",uni:"CIUM"},"Kota Blitar":{mission:"EJC",uni:"CIUM"},"Kota Malang":{mission:"EJC",uni:"CIUM"},"Kota Probolinggo":{mission:"EJC",uni:"CIUM"},"Kota Pasuruan":{mission:"EJC",uni:"CIUM"},"Kota Mojokerto":{mission:"EJC",uni:"CIUM"},"Kota Madiun":{mission:"EJC",uni:"CIUM"},"Kota Surabaya":{mission:"EJC",uni:"CIUM"},"Kota Batu":{mission:"EJC",uni:"CIUM"}},Bali:{"Kabupaten Jembrana":{mission:"EJC",uni:"CIUM"},"Kabupaten Tabanan":{mission:"EJC",uni:"CIUM"},"Kabupaten Badung":{mission:"EJC",uni:"CIUM"},"Kabupaten Gianyar":{mission:"EJC",uni:"CIUM"},"Kabupaten Klungkung":{mission:"EJC",uni:"CIUM"},"Kabupaten Bangli":{mission:"EJC",uni:"CIUM"},"Kabupaten Karangasem":{mission:"EJC",uni:"CIUM"},"Kabupaten Buleleng":{mission:"EJC",uni:"CIUM"},"Kota Denpasar":{mission:"EJC",uni:"CIUM"}},"Nusa Tenggara Barat":{"Kabupaten Lombok Barat":{mission:"EJC",uni:"CIUM"},"Kabupaten Lombok Tengah":{mission:"EJC",uni:"CIUM"},"Kabupaten Lombok Timur":{mission:"EJC",uni:"CIUM"},"Kabupaten Sumbawa":{mission:"EJC",uni:"CIUM"},"Kabupaten Dompu":{mission:"EJC",uni:"CIUM"},"Kabupaten Bima":{mission:"EJC",uni:"CIUM"},"Kabupaten Sumbawa Barat":{mission:"EJC",uni:"CIUM"},"Kabupaten Lombok Utara":{mission:"EJC",uni:"CIUM"},"Kota Mataram":{mission:"EJC",uni:"CIUM"},"Kota Bima":{mission:"EJC",uni:"CIUM"}},"Nusa Tenggara Timur":{"Kabupaten Kupang":{mission:"NTM",uni:"CIUM"},"Kabupaten Timor Tengah Selatan":{mission:"NTM",uni:"CIUM"},"Kabupaten Timor Tengah Utara":{mission:"NTM",uni:"CIUM"},"Kabupaten Belu":{mission:"NTM",uni:"CIUM"},"Kabupaten Alor":{mission:"NTM",uni:"CIUM"},"Kabupaten Flores Timur":{mission:"NTM",uni:"CIUM"},"Kabupaten Sikka":{mission:"NTM",uni:"CIUM"},"Kabupaten Ende":{mission:"NTM",uni:"CIUM"},"Kabupaten Ngada":{mission:"NTM",uni:"CIUM"},"Kabupaten Manggarai":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Timur":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Barat":{mission:"NTM",uni:"CIUM"},"Kabupaten Lembata":{mission:"NTM",uni:"CIUM"},"Kabupaten Rote Ndao":{mission:"NTM",uni:"CIUM"},"Kabupaten Manggarai Barat":{mission:"NTM",uni:"CIUM"},"Kabupaten Nagekeo":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Tengah":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Barat Daya":{mission:"NTM",uni:"CIUM"},"Kabupaten Manggarai Timur":{mission:"NTM",uni:"CIUM"},"Kabupaten Sabu Raijua":{mission:"NTM",uni:"CIUM"},"Kabupaten Malaka":{mission:"NTM",uni:"CIUM"},"Kota Kupang":{mission:"NTM",uni:"CIUM"}},"Kalimantan Barat":{"Kabupaten Sambas":{mission:"WKR",uni:"CIUM"},"Kabupaten Mempawah":{mission:"WKR",uni:"CIUM"},"Kabupaten Sanggau":{mission:"WKR",uni:"CIUM"},"Kabupaten Ketapang":{mission:"WKR",uni:"CIUM"},"Kabupaten Sintang":{mission:"WKR",uni:"CIUM"},"Kabupaten Kapuas Hulu":{mission:"WKR",uni:"CIUM"},"Kabupaten Bengkayang":{mission:"WKR",uni:"CIUM"},"Kabupaten Landak":{mission:"WKR",uni:"CIUM"},"Kabupaten Sekadau":{mission:"WKR",uni:"CIUM"},"Kabupaten Melawi":{mission:"WKR",uni:"CIUM"},"Kabupaten Kayong Utara":{mission:"WKR",uni:"CIUM"},"Kabupaten Kubu Raya":{mission:"WKR",uni:"CIUM"},"Kota Pontianak":{mission:"WKR",uni:"CIUM"},"Kota Singkawang":{mission:"WKR",uni:"CIUM"}},"Kalimantan Tengah":{"Kabupaten Kotawaringin Barat":{mission:"EKM",uni:"CIUM"},"Kabupaten Kotawaringin Timur":{mission:"EKM",uni:"CIUM"},"Kabupaten Kapuas":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Selatan":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Utara":{mission:"EKM",uni:"CIUM"},"Kabupaten Katingan":{mission:"EKM",uni:"CIUM"},"Kabupaten Seruyan":{mission:"EKM",uni:"CIUM"},"Kabupaten Sukamara":{mission:"EKM",uni:"CIUM"},"Kabupaten Lamandau":{mission:"EKM",uni:"CIUM"},"Kabupaten Gunung Mas":{mission:"EKM",uni:"CIUM"},"Kabupaten Pulang Pisau":{mission:"EKM",uni:"CIUM"},"Kabupaten Murung Raya":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Timur":{mission:"EKM",uni:"CIUM"},"Kota Palangkaraya":{mission:"EKM",uni:"CIUM"}},"Kalimantan Selatan":{"Kabupaten Tanah Laut":{mission:"EKM",uni:"CIUM"},"Kabupaten Kotabaru":{mission:"EKM",uni:"CIUM"},"Kabupaten Banjar":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Kuala":{mission:"EKM",uni:"CIUM"},"Kabupaten Tapin":{mission:"EKM",uni:"CIUM"},"Kabupaten Hulu Sungai Selatan":{mission:"EKM",uni:"CIUM"},"Kabupaten Hulu Sungai Tengah":{mission:"EKM",uni:"CIUM"},"Kabupaten Hulu Sungai Utara":{mission:"EKM",uni:"CIUM"},"Kabupaten Tabalong":{mission:"EKM",uni:"CIUM"},"Kabupaten Tanah Bumbu":{mission:"EKM",uni:"CIUM"},"Kabupaten Balangan":{mission:"EKM",uni:"CIUM"},"Kota Banjarmasin":{mission:"EKM",uni:"CIUM"},"Kota Banjarbaru":{mission:"EKM",uni:"CIUM"}},"Kalimantan Timur":{"Kabupaten Paser":{mission:"EKM",uni:"CIUM"},"Kabupaten Kutai Kartanegara":{mission:"EKM",uni:"CIUM"},"Kabupaten Berau":{mission:"EKM",uni:"CIUM"},"Kabupaten Kutai Barat":{mission:"EKM",uni:"CIUM"},"Kabupaten Kutai Timur":{mission:"EKM",uni:"CIUM"},"Kabupaten Penajam Paser Utara":{mission:"EKM",uni:"CIUM"},"Kabupaten Mahakam Ulu":{mission:"EKM",uni:"CIUM"},"Kota Balikpapan":{mission:"EKM",uni:"CIUM"},"Kota Samarinda":{mission:"EKM",uni:"CIUM"},"Kota Bontang":{mission:"EKM",uni:"CIUM"}},"Kalimantan Utara":{"Kabupaten Bulungan":{mission:"EKM",uni:"CIUM"},"Kabupaten Malinau":{mission:"EKM",uni:"CIUM"},"Kabupaten Nunukan":{mission:"EKM",uni:"CIUM"},"Kabupaten Tana Tidung":{mission:"EKM",uni:"CIUM"},"Kota Tarakan":{mission:"EKM",uni:"CIUM"}},Gorontalo:{Gorontalo:{mission:"BMGM",uni:"EIUC"},Boalemo:{mission:"BMGM",uni:"EIUC"},"Bone Bolango":{mission:"BMGM",uni:"EIUC"},"Gorontalo Utara":{mission:"BMGM",uni:"EIUC"},Pohuwato:{mission:"BMGM",uni:"EIUC"}},"Maluku Utara":{Ternate:{mission:"MNMC",uni:"EIUC"},"Tidore Kepulauan":{mission:"MNMC",uni:"EIUC"},"Halmahera Barat":{mission:"MNMC",uni:"EIUC"},"Halmahera Selatan":{mission:"MNMC",uni:"EIUC"},"Halmahera Tengah":{mission:"MNMC",uni:"EIUC"},"Halmahera Timur":{mission:"MNMC",uni:"EIUC"},"Halmahera Utara":{mission:"MNMC",uni:"EIUC"},"Kepulauan Sula":{mission:"MNMC",uni:"EIUC"},"Pulau Morotai":{mission:"MNMC",uni:"EIUC"},"Pulau Taliabu":{mission:"MNMC",uni:"EIUC"}},Maluku:{Ambon:{mission:"MM",uni:"EIUC"},Tual:{mission:"MM",uni:"EIUC"},Buru:{mission:"MM",uni:"EIUC"},"Buru Selatan":{mission:"MM",uni:"EIUC"},"Kepulauan Aru":{mission:"MM",uni:"EIUC"},"Kepulauan Tanimbar":{mission:"MM",uni:"EIUC"},"Maluku Barat Daya":{mission:"MM",uni:"EIUC"},"Maluku Tengah":{mission:"MM",uni:"EIUC"},"Maluku Tenggara":{mission:"MM",uni:"EIUC"},"Seram Bagian Barat":{mission:"MM",uni:"EIUC"},"Seram Bagian Timur":{mission:"MM",uni:"EIUC"}},"Papua Barat Daya":{"Sorong (Kota)":{mission:"SPM",uni:"EIUC"},Maybrat:{mission:"SPM",uni:"EIUC"},"Raja Ampat":{mission:"SPM",uni:"EIUC"},"Sorong (Kabupaten)":{mission:"SPM",uni:"EIUC"},"Sorong Selatan":{mission:"SPM",uni:"EIUC"},Tambrauw:{mission:"SPM",uni:"EIUC"}},Papua:{Jayapura:{mission:"PM",uni:"EIUC"},"Biak Numfor":{mission:"PM",uni:"EIUC"},"Jayapura (Kabupaten)":{mission:"PM",uni:"EIUC"},Keerom:{mission:"PM",uni:"EIUC"},"Kepulauan Yapen":{mission:"PM",uni:"EIUC"},"Mamberamo Raya":{mission:"PM",uni:"EIUC"},Sarmi:{mission:"PM",uni:"EIUC"},Supiori:{mission:"PM",uni:"EIUC"},Waropen:{mission:"PM",uni:"EIUC"}},"Papua Barat":{Fakfak:{mission:"WPM",uni:"EIUC"},Kaimana:{mission:"WPM",uni:"EIUC"},Manokwari:{mission:"WPM",uni:"EIUC"},"Manokwari Selatan":{mission:"WPM",uni:"EIUC"},"Pegunungan Arfak":{mission:"WPM",uni:"EIUC"},"Teluk Bintuni":{mission:"WPM",uni:"EIUC"},"Teluk Wondama":{mission:"WPM",uni:"EIUC"}},"Sulawesi Tengah":{Palu:{mission:"CSM",uni:"EIUC"},Banggai:{mission:"CSM",uni:"EIUC"},"Banggai Kepulauan":{mission:"CSM",uni:"EIUC"},"Banggai Laut":{mission:"CSM",uni:"EIUC"},Buol:{mission:"CSM",uni:"EIUC"},Donggala:{mission:"CSM",uni:"EIUC"},Morowali:{mission:"CSM",uni:"EIUC"},"Morowali Utara":{mission:"CSM",uni:"EIUC"},"Parigi Moutong":{mission:"CSM",uni:"EIUC"},Poso:{mission:"CSM",uni:"EIUC"},Sigi:{mission:"CSM",uni:"EIUC"},"Tojo Una Una":{mission:"CSM",uni:"EIUC"},Tolitoli:{mission:"CSM",uni:"EIUC"}},"Sulawesi Tenggara":{Baubau:{mission:"SSC",uni:"EIUC"},Tenggari:{mission:"SSC",uni:"EIUC"},Bombana:{mission:"SSC",uni:"EIUC"},Buton:{mission:"SSC",uni:"EIUC"},"Buton Selatan":{mission:"SSC",uni:"EIUC"},"Buton Tengah":{mission:"SSC",uni:"EIUC"},"Buton Utara":{mission:"SSC",uni:"EIUC"},Kolaka:{mission:"SSC",uni:"EIUC"},"Kolaka Timur":{mission:"SSC",uni:"EIUC"},"Kolaka Utara":{mission:"SSC",uni:"EIUC"},Konawe:{mission:"SSC",uni:"EIUC"},"Konawe Kepulauan":{mission:"SSC",uni:"EIUC"},"Konawe Selatan":{mission:"SSC",uni:"EIUC"},"Konawe Utara":{mission:"SSC",uni:"EIUC"},Muna:{mission:"SSC",uni:"EIUC"},"Muna Barat Wakatobi":{mission:"SSC",uni:"EIUC"}},"Sulawesi Utara":{Bitung:{mission:"NMBM",uni:"EIUC"},"Minahasa Utara":{mission:"NMBM",uni:"EIUC"},Manado:{mission:"MNMC",uni:"EIUC"},Kotamobagu:{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow":{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow Selatan":{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow Timur":{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow Utara":{mission:"BMGM",uni:"EIUC"},"Kepulauan Sangihe":{mission:"NIM",uni:"EIUC"},"Kepulauan Siau Tagulandang Biaro":{mission:"NIM",uni:"EIUC"},"Kepulauan Talaud":{mission:"NIM",uni:"EIUC"},Minahasa:{mission:"MC",uni:"EIUC"},"Minahasa Selatan":{mission:"MC",uni:"EIUC"},"Minahasa Tenggara":{mission:"MC",uni:"EIUC"},Tomohon:{mission:"MC",uni:"EIUC"}},"Papua Pegunungan":{Jayawijaya:{mission:"PM",uni:"EIUC"},"Lanny Jaya":{mission:"PM",uni:"EIUC"},"Mamberamo Tengah":{mission:"PM",uni:"EIUC"},Nduga:{mission:"PM",uni:"EIUC"},"Pegunungan Bintang":{mission:"PM",uni:"EIUC"},Tolikara:{mission:"PM",uni:"EIUC"},Yahukimo:{mission:"PM",uni:"EIUC"},Yalimo:{mission:"PM",uni:"EIUC"}},"Papua Selatan":{Asmat:{mission:"PM",uni:"EIUC"},"Boven Digoel":{mission:"PM",uni:"EIUC"},Mappi:{mission:"PM",uni:"EIUC"},Merauke:{mission:"PM",uni:"EIUC"}},"Papua Tengah":{Deiyai:{mission:"CPM",uni:"EIUC"},Dogiyai:{mission:"CPM",uni:"EIUC"},"Intan Jaya":{mission:"CPM",uni:"EIUC"},Mimika:{mission:"CPM",uni:"EIUC"},Nabire:{mission:"CPM",uni:"EIUC"},Paniai:{mission:"CPM",uni:"EIUC"},Puncak:{mission:"CPM",uni:"EIUC"},"Puncak Jaya":{mission:"CPM",uni:"EIUC"}},"Sulawesi Selatan":{Makassar:{mission:"SSC",uni:"EIUC"},Palopo:{mission:"LTTM",uni:"EIUC"},Parepare:{mission:"SSC",uni:"EIUC"},Bantaeng:{mission:"SSC",uni:"EIUC"},Barru:{mission:"SSC",uni:"EIUC"},Bone:{mission:"SSC",uni:"EIUC"},Bulukumba:{mission:"SSC",uni:"EIUC"},Enrekang:{mission:"SSC",uni:"EIUC"},Gowa:{mission:"SSC",uni:"EIUC"},Jeneponto:{mission:"SSC",uni:"EIUC"},"Kepulauan Selayar":{mission:"SSC",uni:"EIUC"},Luwu:{mission:"LTTM",uni:"EIUC"},"Luwu Timur":{mission:"LTTM",uni:"EIUC"},"Luwu Utara":{mission:"LTTM",uni:"EIUC"},Maros:{mission:"SSC",uni:"EIUC"},"Pangkajene Dan Kepulauan":{mission:"SSC",uni:"EIUC"},Pinrang:{mission:"SSC",uni:"EIUC"},"Sidenreng Rappang":{mission:"SSC",uni:"EIUC"},Sinjai:{mission:"SSC",uni:"EIUC"},Soppeng:{mission:"SSC",uni:"EIUC"},Takalar:{mission:"SSC",uni:"EIUC"},"Tana Toraja":{mission:"LTTM",uni:"EIUC"},"Toraja Utara":{mission:"LTTM",uni:"EIUC"},Wajo:{mission:"SSC",uni:"EIUC"}}});const dN=({initialProvinsi:a="",initialKabKota:n="",onChange:t}={})=>{const[i,l]=G.useState(a),[u,f]=G.useState(n),[h,g]=G.useState(""),[v,p]=G.useState(""),S=lN(),x=i?cN(i):[];G.useEffect(()=>{if(i&&u){const M=oN(i,u),N=uN(i,u);g(M),p(N),t&&t({provinsi:i,kabKota:u,mission:M,uni:N})}else g(""),p(""),t&&t({provinsi:i,kabKota:u,mission:"",uni:""})},[i,u,t]);const C=G.useCallback(M=>{l(M),f(""),g(""),p("")},[]),T=G.useCallback(M=>{f(M)},[]),y=G.useCallback(()=>{l(""),f(""),g(""),p("")},[]),_=G.useCallback(M=>{M.provinsi&&l(M.provinsi),M.kabKota&&f(M.kabKota)},[]),w=i&&u&&h&&v,k=fN(i,u);return{provinsi:i,kabKota:u,mission:h,uni:v,provinsiOptions:S,kabKotaOptions:x,handleProvinsiChange:C,handleKabKotaChange:T,reset:y,setInitialValues:_,isValid:w,territoryInfo:k,selection:{provinsi:i,kabKota:u,mission:h,uni:v}}},_v=({id:a,value:n,options:t,onChange:i,placeholder:l="Pilih atau ketik untuk mencari...",disabled:u=!1,className:f="",error:h=!1,label:g,required:v=!1})=>{const[p,S]=G.useState(!1),[x,C]=G.useState(""),[T,y]=G.useState(-1),_=G.useRef(null),w=G.useRef(null),k=t.filter(L=>L.toLowerCase().includes(x.toLowerCase())),M=L=>{const X=L.target.value;C(X),S(!0),y(-1);const D=t.find(z=>z.toLowerCase()===X.toLowerCase());D&&D!==n?i(D):!D&&n&&i("")},N=L=>{i(L),C(""),S(!1),y(-1),_.current?.blur()},K=L=>{if(!p){(L.key==="Enter"||L.key==="ArrowDown")&&(S(!0),y(0),L.preventDefault());return}switch(L.key){case"ArrowDown":L.preventDefault(),y(X=>X<k.length-1?X+1:0);break;case"ArrowUp":L.preventDefault(),y(X=>X>0?X-1:k.length-1);break;case"Enter":L.preventDefault(),T>=0&&k[T]&&N(k[T]);break;case"Escape":S(!1),C(""),y(-1),_.current?.blur();break}},J=()=>{u||(S(!0),C(""))},B=()=>{setTimeout(()=>{w.current?.contains(document.activeElement)||(S(!1),C(""),y(-1))},150)};G.useEffect(()=>{const L=X=>{_.current&&!_.current.contains(X.target)&&w.current&&!w.current.contains(X.target)&&(S(!1),C(""),y(-1))};return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[]),G.useEffect(()=>{if(T>=0&&w.current){const L=w.current.children[T];L&&L.scrollIntoView({block:"nearest",behavior:"smooth"})}},[T]);const Z=p?x:n;return o.jsxs("div",{className:`searchable-select ${f}`,children:[g&&o.jsxs("label",{htmlFor:a,className:"searchable-select-label",children:[g," ",v&&o.jsx("span",{className:"required",children:"*"})]}),o.jsxs("div",{className:"searchable-select-container",children:[o.jsx("input",{ref:_,id:a,type:"text",value:Z,onChange:M,onFocus:J,onBlur:B,onKeyDown:K,placeholder:l,disabled:u,className:`searchable-select-input ${h?"error":""}`,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1}),o.jsx("div",{className:"searchable-select-arrow",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",className:p?"rotated":"",children:o.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),p&&o.jsx("div",{ref:w,className:"searchable-select-dropdown",children:k.length>0?k.map((L,X)=>o.jsx("div",{className:`searchable-select-option ${X===T?"highlighted":""} ${L===n?"selected":""}`,onClick:()=>N(L),onMouseEnter:()=>y(X),children:L},L)):o.jsxs("div",{className:"searchable-select-no-results",children:['Tidak ditemukan "',x,'"']})})]})]})},hN=({initialProvinsi:a,initialKabKota:n,onChange:t,disabled:i=!1,className:l="",showLabels:u=!0,errors:f={}})=>{const{provinsi:h,kabKota:g,mission:v,uni:p,provinsiOptions:S,kabKotaOptions:x,handleProvinsiChange:C,handleKabKotaChange:T}=dN({initialProvinsi:a,initialKabKota:n,onChange:t});return o.jsxs("div",{className:`territory-selector ${l}`,children:[o.jsxs("div",{className:"territory-field",children:[o.jsx(_v,{id:"provinsi",value:h,options:S,onChange:C,placeholder:"Pilih atau ketik nama provinsi...",disabled:i,className:f.provinsi?"error":"",error:!!f.provinsi,label:u?"Provinsi":void 0,required:!1}),f.provinsi&&o.jsx("span",{className:"error-message",children:f.provinsi})]}),o.jsxs("div",{className:"territory-field",children:[o.jsx(_v,{id:"kabKota",value:g,options:x,onChange:T,placeholder:h?"Pilih atau ketik nama kab/kota...":"Pilih provinsi dulu",disabled:i||!h,className:f.kabKota?"error":"",error:!!f.kabKota,label:u?"Kab/Kota":void 0,required:!1}),f.kabKota&&o.jsx("span",{className:"error-message",children:f.kabKota})]}),o.jsxs("div",{className:"territory-field",children:[u&&o.jsx("label",{htmlFor:"mission",className:"territory-label",children:"Mission"}),o.jsx("input",{id:"mission",type:"text",value:v,className:`territory-input auto-selected ${f.mission?"error":""}`,disabled:!0,placeholder:g?"Auto-selected":"Pilih Kab/Kota dulu",readOnly:!0}),f.mission&&o.jsx("span",{className:"error-message",children:f.mission}),v&&o.jsx("span",{className:"help-text",children:"Otomatis dipilih berdasarkan Kab/Kota"})]}),o.jsxs("div",{className:"territory-field",children:[u&&o.jsx("label",{htmlFor:"uni",className:"territory-label",children:"Uni"}),o.jsx("input",{id:"uni",type:"text",value:p,className:`territory-input auto-selected ${f.uni?"error":""}`,disabled:!0,placeholder:g?"Auto-selected":"Pilih Kab/Kota dulu",readOnly:!0}),f.uni&&o.jsx("span",{className:"error-message",children:f.uni}),p&&o.jsxs("span",{className:"help-text",children:[p==="WIUM"&&"Western Indonesia Union Mission",p==="CIUM"&&"Central Indonesia Union Mission",p==="EIUC"&&"Eastern Indonesia Union Conference"]})]}),h&&g&&v&&p&&o.jsxs("div",{className:"territory-summary",children:[o.jsxs("div",{className:"summary-item",children:[o.jsx("span",{className:"summary-label",children:"Wilayah:"}),o.jsxs("span",{className:"summary-value",children:[h,"  ",g]})]}),o.jsxs("div",{className:"summary-item",children:[o.jsx("span",{className:"summary-label",children:"Organisasi:"}),o.jsxs("span",{className:"summary-value",children:[v," (",p,")"]})]})]})]})};class mN{STORAGE_KEY="crm_service_sessions";getSessions(){try{const n=localStorage.getItem(this.STORAGE_KEY);return n?JSON.parse(n).map(i=>({...i,startTime:new Date(i.startTime),endTime:i.endTime?new Date(i.endTime):void 0})):[]}catch(n){return console.error("Error loading service sessions:",n),[]}}saveSessions(n){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(n))}catch(t){console.error("Error saving service sessions:",t)}}startSession(n,t){const i=new Date,l={id:`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,contactId:n,userId:t,startTime:i,status:"active",serviceDate:i.toISOString().split("T")[0],serviceHour:i.getHours()},u=this.getSessions(),f=[],h=u.map(g=>{if(g.userId===t&&g.status==="active"){const v=i,p=Math.floor((v.getTime()-g.startTime.getTime())/1e3),S=Math.round(p/60),x={...g,status:"completed",endTime:v,duration:p};if(f.push(x),S>0)try{Wt.addServiceEntry({contactId:g.contactId,userId:g.userId,date:g.serviceDate,duration:S,serviceType:"Timer Session (Auto-stopped)",description:`Auto-stopped when starting new service (${Math.floor(S/60)}h ${S%60}m)`}),console.log(`Auto-stopped and recorded service for contact ${g.contactId}: ${S} minutes`)}catch(C){console.error("Failed to create service entry for auto-stopped session:",C)}return x}return g});return f.forEach(g=>{window.dispatchEvent(new CustomEvent("serviceAutoStopped",{detail:{session:g,newContactId:n,userId:t}}))}),h.push(l),this.saveSessions(h),window.dispatchEvent(new CustomEvent("serviceStarted",{detail:{session:l,autoStoppedCount:f.length}})),l}endSession(n){const t=this.getSessions(),i=t.findIndex(v=>v.id===n);if(i===-1)return null;const l=t[i],u=new Date,f=Math.floor((u.getTime()-l.startTime.getTime())/1e3),h=Math.round(f/60),g={...l,endTime:u,duration:f,status:"completed"};if(t[i]=g,this.saveSessions(t),h>0)try{Wt.addServiceEntry({contactId:l.contactId,userId:l.userId,date:l.serviceDate,duration:h,serviceType:"Timer Session",description:`Automatic entry from service timer (${Math.floor(h/60)}h ${h%60}m)`}),window.dispatchEvent(new CustomEvent("serviceAdded",{detail:{contactId:l.contactId,userId:l.userId}}))}catch(v){console.error("Failed to create service entry from timer session:",v)}return window.dispatchEvent(new CustomEvent("serviceEnded",{detail:{session:g,contactId:l.contactId,userId:l.userId,duration:f}})),g}getActiveSession(n){return this.getSessions().find(i=>i.userId===n&&i.status==="active")||null}getActiveSessions(){return this.getSessions().filter(t=>t.status==="active")}getActiveSessionForContact(n,t){return this.getSessions().find(l=>l.contactId===n&&l.userId===t&&l.status==="active")||null}getSessionsForContact(n){return this.getSessions().filter(i=>i.contactId===n&&i.status==="completed").sort((i,l)=>l.startTime.getTime()-i.startTime.getTime())}getSessionsForUser(n){return this.getSessions().filter(i=>i.userId===n).sort((i,l)=>l.startTime.getTime()-i.startTime.getTime())}pauseSession(n){const t=this.getSessions(),i=t.findIndex(l=>l.id===n);return i===-1?null:(t[i]={...t[i],status:"paused"},this.saveSessions(t),t[i])}resumeSession(n){const t=this.getSessions(),i=t.findIndex(l=>l.id===n);return i===-1?null:(t[i]={...t[i],status:"active"},this.saveSessions(t),t[i])}getTodaySessions(n){const t=new Date().toISOString().split("T")[0];return this.getSessions().filter(l=>l.userId===n&&l.serviceDate===t)}getTodayServiceTime(n){return this.getTodaySessions(n).reduce((i,l)=>l.status==="completed"&&l.duration?i+l.duration:i,0)}getServiceStats(n,t=7){const i=new Date;i.setDate(i.getDate()-t);const l=this.getSessions().filter(h=>h.userId===n&&h.status==="completed"&&h.startTime>=i),u=l.reduce((h,g)=>h+(g.duration||0),0),f=new Set(l.map(h=>h.contactId)).size;return{totalSessions:l.length,totalTime:u,averageTime:l.length>0?Math.round(u/l.length):0,contactsServed:f}}recoverOrphanedSessions(){const n=this.getSessions(),t=new Date,i=480*60*1e3,l=[],u=n.map(f=>{if(f.status==="active"){const h=t.getTime()-f.startTime.getTime();if(h>i){const g=Math.floor(h/1e3),v=Math.round(g/60),p={...f,status:"completed",endTime:t,duration:g};if(l.push(p),v>0)try{Wt.addServiceEntry({contactId:f.contactId,userId:f.userId,date:f.serviceDate,duration:Math.min(v,480),serviceType:"Timer Session (Recovered)",description:`Recovered from system crash/disconnect (${Math.floor(v/60)}h ${v%60}m)`}),console.log(`Recovered orphaned session for contact ${f.contactId}: ${v} minutes`)}catch(S){console.error("Failed to create service entry for recovered session:",S)}return p}}return f});return l.length>0&&(this.saveSessions(u),window.dispatchEvent(new CustomEvent("sessionsRecovered",{detail:{recoveredSessions:l}})),console.log(`Recovered ${l.length} orphaned service sessions`)),l}initializeRecovery(){this.recoverOrphanedSessions(),setInterval(()=>{this.recoverOrphanedSessions()},300*1e3),window.addEventListener("beforeunload",()=>{this.handleBeforeUnload()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&setTimeout(()=>{this.recoverOrphanedSessions()},1e3)})}handleBeforeUnload(){if(this.getActiveSessions().length>0){const i=this.getSessions().map(l=>l.status==="active"?{...l,lastActivity:new Date}:l);this.saveSessions(i)}}forceCompleteAllActiveSessions(n){const t=this.getSessions(),i=new Date,l=[],u=t.map(f=>{if(f.status==="active"&&(!n||f.userId===n)){const h=Math.floor((i.getTime()-f.startTime.getTime())/1e3),g=Math.round(h/60),v={...f,status:"completed",endTime:i,duration:h};if(l.push(v),g>0)try{Wt.addServiceEntry({contactId:f.contactId,userId:f.userId,date:f.serviceDate,duration:g,serviceType:"Timer Session (Force Completed)",description:`Force completed session (${Math.floor(g/60)}h ${g%60}m)`})}catch(p){console.error("Failed to create service entry for force completed session:",p)}return v}return f});return l.length>0&&(this.saveSessions(u),window.dispatchEvent(new CustomEvent("sessionsForceCompleted",{detail:{completedSessions:l}}))),l}}const Bt=new mN,vN=a=>{const{currentUser:n}=Vt(),[t,i]=G.useState(null),[l,u]=G.useState(0),[f,h]=G.useState(!1);G.useEffect(()=>{if(!n)return;Bt.initializeRecovery();const w=a?Bt.getActiveSessionForContact(a,n.username):Bt.getActiveSession(n.username);if(i(w),w){const J=Math.floor((Date.now()-w.startTime.getTime())/1e3);u(J)}const k=J=>{const{recoveredSessions:B}=J.detail;if(console.log("Sessions recovered:",B),B.length>0){const Z=`${B.length} service session(s) recovered from system interruption`;console.info(Z)}},M=J=>{const{session:B}=J.detail;console.log("Service auto-stopped:",B);const Z=Math.round((B.duration||0)/60);if(Z>0){const L=`Previous service (${Z}m) auto-stopped and recorded`;console.info(L)}},N=J=>{const{session:B,contactId:Z}=J.detail;console.log("Service ended:",B),(!a||Z===a)&&(i(null),u(0))},K=J=>{const{session:B}=J.detail;console.log("Service started:",B),(!a||B.contactId===a)&&(i(B),u(0))};return window.addEventListener("sessionsRecovered",k),window.addEventListener("serviceAutoStopped",M),window.addEventListener("serviceEnded",N),window.addEventListener("serviceStarted",K),()=>{window.removeEventListener("sessionsRecovered",k),window.removeEventListener("serviceAutoStopped",M),window.removeEventListener("serviceEnded",N),window.removeEventListener("serviceStarted",K)}},[n,a]),G.useEffect(()=>{if(!t||t.status!=="active")return;const w=setInterval(()=>{const k=Math.floor((Date.now()-t.startTime.getTime())/1e3);u(k)},1e3);return()=>clearInterval(w)},[t]);const g=G.useCallback(async w=>{if(!n)return null;h(!0);try{const k=Bt.startSession(w||a||"",n.username);return i(k),u(0),k}catch(k){return console.error("Error starting service:",k),null}finally{h(!1)}},[n,a]),v=G.useCallback(async()=>{if(!t||!n)return null;h(!0);try{const w=Bt.endSession(t.id);return i(null),u(0),w}catch(w){return console.error("Error ending service:",w),null}finally{h(!1)}},[t,n]),p=G.useCallback(async()=>{if(!t)return null;try{const w=Bt.pauseSession(t.id);return i(w),w}catch(w){return console.error("Error pausing service:",w),null}},[t]),S=G.useCallback(async()=>{if(!t)return null;try{const w=Bt.resumeSession(t.id);return i(w),w}catch(w){return console.error("Error resuming service:",w),null}},[t]),x=G.useCallback(w=>{const k=Math.floor(w/3600),M=Math.floor(w%3600/60),N=w%60;return k>0?`${k.toString().padStart(2,"0")}:${M.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`:`${M.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`},[]),C=G.useCallback(()=>a?Bt.getSessionsForContact(a):[],[a]),T=G.useCallback(()=>{if(!n)return{totalTime:0,sessionCount:0};const w=Bt.getTodaySessions(n.username),k=Bt.getTodayServiceTime(n.username);return{totalTime:k,sessionCount:w.length,formattedTime:x(k)}},[n,x]),y=G.useCallback(()=>{if(!n)return[];const w=Bt.forceCompleteAllActiveSessions(n.username);return w.length>0&&(i(null),u(0),console.log(`Force completed ${w.length} active sessions`)),w},[n]),_=G.useCallback(()=>{const w=Bt.recoverOrphanedSessions();if(w.length>0&&n){const k=a?Bt.getActiveSessionForContact(a,n.username):Bt.getActiveSession(n.username);if(i(k),k){const M=Math.floor((Date.now()-k.startTime.getTime())/1e3);u(M)}else u(0)}return w},[n,a]);return{activeSession:t,elapsedTime:l,isLoading:f,isActive:t?.status==="active",isPaused:t?.status==="paused",startService:g,endService:v,pauseService:p,resumeService:S,forceCompleteAllSessions:y,triggerRecovery:_,formatElapsedTime:()=>x(l),getServiceHistory:C,getTodayStats:T,canStart:!t&&!!n,canEnd:!!t&&t.status==="active",canPause:!!t&&t.status==="active",canResume:!!t&&t.status==="paused"}},gN=({contactId:a,contactName:n,onServiceStart:t,onServiceEnd:i,className:l=""})=>{const[u,f]=G.useState(null),{activeSession:h,isLoading:g,isActive:v,startService:p,endService:S,pauseService:x,resumeService:C,formatElapsedTime:T,canStart:y,canEnd:_,canPause:w,canResume:k,getTodayStats:M,forceCompleteAllSessions:N,triggerRecovery:K}=vN(a);G.useEffect(()=>{const D=be=>{const{session:Se}=be.detail,ee=Math.round((Se.duration||0)/60);ee>0&&(f(`Previous service (${ee}m) auto-stopped and recorded`),setTimeout(()=>f(null),5e3))},z=be=>{const{recoveredSessions:Se}=be.detail;Se.length>0&&(f(`${Se.length} service session(s) recovered from interruption`),setTimeout(()=>f(null),5e3))},ue=be=>{const{session:Se,contactId:ee}=be.detail;if(ee===a){const ge=Math.round((Se.duration||0)/60);ge>0&&(f(`Service completed (${ge}m) and recorded`),setTimeout(()=>f(null),5e3))}};return window.addEventListener("serviceAutoStopped",D),window.addEventListener("sessionsRecovered",z),window.addEventListener("serviceEnded",ue),()=>{window.removeEventListener("serviceAutoStopped",D),window.removeEventListener("sessionsRecovered",z),window.removeEventListener("serviceEnded",ue)}},[]);const J=async()=>{await p(a)&&t?.()},B=async()=>{const D=await S();D&&D.duration&&i?.(D.duration)},Z=async()=>{await x()},L=async()=>{await C()},X=M();return o.jsxs("div",{className:`service-timer-widget ${l}`,children:[o.jsxs("div",{className:"service-timer-header",children:[o.jsxs("div",{className:"service-timer-title",children:[o.jsx("span",{className:"timer-icon",children:""}),o.jsx("h3",{children:"Service Tracking"})]}),o.jsxs("div",{className:"service-timer-subtitle",children:["Melayani: ",o.jsx("strong",{children:n})]})]}),o.jsxs("div",{className:"service-timer-content",children:[h?o.jsxs("div",{className:"timer-active-state",children:[o.jsx("div",{className:"timer-display",children:o.jsxs("div",{className:"timer-main",children:[o.jsx("span",{className:"timer-text",children:T()}),o.jsxs("div",{className:`timer-status ${v?"active":"paused"}`,children:[v&&o.jsx("div",{className:"pulse-indicator"}),o.jsx("span",{className:"status-text",children:v?"Sedang Melayani":"Dijeda"})]})]})}),o.jsx("div",{className:"timer-controls",children:v?o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:Z,disabled:g||!w,className:"service-btn pause-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Jeda"]}),o.jsxs("button",{onClick:B,disabled:g||!_,className:"service-btn end-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Selesai"]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:L,disabled:g||!k,className:"service-btn resume-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Lanjutkan"]}),o.jsxs("button",{onClick:B,disabled:g,className:"service-btn end-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Selesai"]})]})})]}):o.jsxs("div",{className:"timer-start-state",children:[o.jsxs("div",{className:"timer-display-placeholder",children:[o.jsx("span",{className:"timer-text",children:"00:00"}),o.jsx("span",{className:"timer-label",children:"Siap untuk memulai pelayanan"})]}),o.jsx("button",{onClick:J,disabled:g||!y,className:"service-btn start-btn",children:g?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"loading-spinner",children:""}),"Memulai..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"btn-icon",children:""}),"Mulai Pelayanan"]})})]}),u&&o.jsxs("div",{className:"timer-notification",children:[o.jsx("span",{className:"notification-icon",children:""}),o.jsx("span",{className:"notification-text",children:u}),o.jsx("button",{onClick:()=>f(null),className:"notification-close",children:""})]}),o.jsxs("div",{className:"timer-stats",children:[o.jsxs("div",{className:"stats-item",children:[o.jsx("span",{className:"stats-label",children:"Hari ini:"}),o.jsx("span",{className:"stats-value",children:X.formattedTime})]}),o.jsxs("div",{className:"stats-item",children:[o.jsx("span",{className:"stats-label",children:"Sesi:"}),o.jsx("span",{className:"stats-value",children:X.sessionCount})]})]}),o.jsxs("div",{className:"timer-emergency-actions",children:[o.jsx("button",{onClick:()=>{K().length===0&&(f("No sessions to recover"),setTimeout(()=>f(null),3e3))},className:"emergency-btn recovery-btn",title:"Manually trigger session recovery",children:" Recovery"}),o.jsx("button",{onClick:()=>{const D=N();D.length>0?(f(`Force completed ${D.length} active sessions`),setTimeout(()=>f(null),5e3)):(f("No active sessions to complete"),setTimeout(()=>f(null),3e3))},className:"emergency-btn force-complete-btn",title:"Force complete all active sessions",children:" Force Stop All"})]})]})]})},pN=({contact:a,onSave:n,onCancel:t,mode:i="create",initialData:l})=>{const[u,f]=G.useState({nama:l?.nama||"",nomorTelepon:l?.nomorTelepon||"",jenisKelamin:"Laki-laki",usia:"",profesi:"",statusPernikahan:"",mediaKomunikasi:"",alamat:"",provinsi:"",kabKota:"",mission:"",uni:"",agama:"",subAgama:"",alasanMenghubungi:"",sumber:"",prioritas:"Urgent",statusKontak:"New Contact"}),[h,g]=G.useState({}),[v,p]=G.useState(!1),[S,x]=G.useState(!1),[C,T]=G.useState(i),[y,_]=G.useState(a||null),{currentUser:w}=Vt(),{suggestions:k,isNameDuplicate:M,isPhoneNumberDuplicate:N}=sN();G.useEffect(()=>{a&&i==="edit"&&Bt.getActiveSessionForContact(a.id,w?.username||"")&&(_(a),T("service"))},[a,i]),G.useEffect(()=>{f(a&&i==="edit"?{nama:a.nama,nomorTelepon:a.nomorTelepon||"",jenisKelamin:a.jenisKelamin||"Laki-laki",usia:a.usia?String(a.usia):"",profesi:a.profesi||"",statusPernikahan:a.statusPernikahan||"",mediaKomunikasi:a.mediaKomunikasi||"",alamat:a.alamat,provinsi:a.provinsi||"",kabKota:a.kabKota||"",mission:a.mission||"",uni:a.uni||"",agama:a.agama,subAgama:a.subAgama||"",alasanMenghubungi:a.alasanMenghubungi,sumber:a.sumber||"",prioritas:a.prioritas||"Urgent",statusKontak:a.statusKontak}:{nama:"",nomorTelepon:"",jenisKelamin:"Laki-laki",usia:"",profesi:"",statusPernikahan:"",mediaKomunikasi:"",alamat:"",provinsi:"",kabKota:"",mission:"",uni:"",agama:"",subAgama:"",alasanMenghubungi:"",sumber:"",prioritas:"Urgent",statusKontak:"New Contact"}),g({}),x(!1)},[a,i]),G.useEffect(()=>{l&&i==="create"&&!a&&f(D=>({...D,nama:l.nama||D.nama,nomorTelepon:l.nomorTelepon||D.nomorTelepon}))},[l,i,a]);const K=G.useCallback((D,z)=>{f(ue=>{if(ue[D]===z)return ue;const be={...ue,[D]:z};return D==="agama"&&(z==="Protestan"?be.subAgama="":z?be.subAgama=z:be.subAgama=""),be}),x(!0),g(ue=>{if(!ue[D])return ue;const be={...ue};return delete be[D],be})},[]),J=G.useCallback(D=>{f(z=>({...z,provinsi:D.provinsi,kabKota:D.kabKota,mission:D.mission,uni:D.uni})),x(!0),g(z=>{const ue={...z};return delete ue.provinsi,delete ue.kabKota,delete ue.mission,delete ue.uni,ue})},[]),B=()=>{const D={};if(u.nama.trim()?u.nama.length>100?D.nama="Nama must be less than 100 characters":i==="create"&&M(u.nama)&&(D.nama="Nama ini sudah ada dalam kontak"):D.nama="Nama is required",u.nomorTelepon.trim()?u.nomorTelepon.length>20?D.nomorTelepon="Nomor telepon must be less than 20 characters":i==="create"&&N(u.nomorTelepon)&&(D.nomorTelepon="Nomor telepon ini sudah ada dalam kontak"):D.nomorTelepon="Nomor telepon is required",u.usia.trim()){const z=parseInt(u.usia);(isNaN(z)||z<1||z>120)&&(D.usia="Usia must be between 1 and 120")}return u.profesi.trim()&&u.profesi.length>100&&(D.profesi="Profesi must be less than 100 characters"),u.agama.trim()&&u.agama.length>50&&(D.agama="Agama must be less than 50 characters"),u.alasanMenghubungi.trim()&&u.alasanMenghubungi.length>500&&(D.alasanMenghubungi="Alasan menghubungi must be less than 500 characters"),u.jenisKelamin||(D.jenisKelamin="Jenis kelamin is required"),u.prioritas||(D.prioritas="Prioritas is required"),u.statusKontak||(D.statusKontak="Status kontak is required"),u.sumber||(D.sumber="Sumber is required"),u.agama.trim()||(D.agama="Agama is required"),u.alasanMenghubungi.trim()||(D.alasanMenghubungi="Alasan menghubungi is required"),u.alamat.trim()?u.alamat.length>200&&(D.alamat="Alamat must be less than 200 characters"):D.alamat="Alamat is required",g(D),Object.keys(D).length===0},Z=async D=>{if(D.preventDefault(),!!B()){if(!w){alert("You must be logged in to save contacts");return}p(!0);try{let z;if(i==="edit"&&a||C==="edit"&&y){const ue=a||y;Ke.updateContactWithHistory(ue.id,{...u,usia:u.usia?parseInt(u.usia):void 0,statusPernikahan:u.statusPernikahan||void 0,mediaKomunikasi:u.mediaKomunikasi||void 0,mission:u.mission||void 0,kabKota:u.kabKota||void 0,uni:u.uni||void 0,sumber:u.sumber},w.username),z=Ke.getContactById(ue.id)||ue,window.dispatchEvent(new CustomEvent("contactsUpdated"))}else{const ue=new es(u.nama,u.nomorTelepon,u.jenisKelamin,u.alamat,u.provinsi,u.agama,u.alasanMenghubungi,u.sumber,u.prioritas,u.statusKontak,w.username,u.usia?parseInt(u.usia):void 0,u.profesi||void 0,u.statusPernikahan||void 0,u.mediaKomunikasi||void 0,u.mission||void 0,u.subAgama||void 0,u.kabKota||void 0,u.uni||void 0);Ke.addContact(ue.toObject()),z=ue.toObject(),window.dispatchEvent(new CustomEvent("contactsUpdated"))}i==="create"?(_(z),T("service"),f({nama:z.nama,nomorTelepon:z.nomorTelepon||"",jenisKelamin:z.jenisKelamin||"Laki-laki",usia:z.usia?String(z.usia):"",profesi:z.profesi||"",statusPernikahan:z.statusPernikahan||"",mediaKomunikasi:z.mediaKomunikasi||"",alamat:z.alamat||"",provinsi:z.provinsi||"",kabKota:z.kabKota||"",mission:z.mission||"",uni:z.uni||"",agama:z.agama||"",subAgama:z.subAgama||"",alasanMenghubungi:z.alasanMenghubungi||"",sumber:z.sumber||"",prioritas:z.prioritas||"Urgent",statusKontak:z.statusKontak||"New Contact"}),x(!1),alert(`Contact "${z.nama}" berhasil disimpan! Siap untuk memulai pelayanan.`)):C==="edit"&&y?(_(z),T("service"),f({nama:z.nama,nomorTelepon:z.nomorTelepon||"",jenisKelamin:z.jenisKelamin||"Laki-laki",usia:z.usia?String(z.usia):"",profesi:z.profesi||"",statusPernikahan:z.statusPernikahan||"",mediaKomunikasi:z.mediaKomunikasi||"",alamat:z.alamat||"",provinsi:z.provinsi||"",kabKota:z.kabKota||"",mission:z.mission||"",uni:z.uni||"",agama:z.agama||"",subAgama:z.subAgama||"",alasanMenghubungi:z.alasanMenghubungi||"",sumber:z.sumber||"",prioritas:z.prioritas||"Urgent",statusKontak:z.statusKontak||"New Contact"}),x(!1),alert(`Contact "${z.nama}" berhasil diupdate! Kembali ke service mode.`)):n?.(z)}catch(z){console.error("Error saving contact:",z),alert("Failed to save contact. Please try again.")}finally{p(!1)}}},L=()=>{S?window.confirm("You have unsaved changes. Are you sure you want to cancel?")&&t?.():t?.()},X=(D,z)=>{const ue=u[D].length,be=ue>z*.8;return o.jsxs("span",{className:`character-count ${be?"near-limit":""}`,children:[ue,"/",z]})};return o.jsxs("div",{className:"contact-form-container",children:[o.jsxs("div",{className:"contact-form-header",children:[o.jsx("h2",{children:C==="service"?"Service Mode":i==="edit"?"Edit Contact":"Add New Contact"}),o.jsx("p",{children:C==="service"?`Ready to serve ${y?.nama||"contact"}`:i==="edit"?"Update the contact information below":"Fill in the details to add a new contact"})]}),o.jsxs("form",{onSubmit:Z,className:"contact-form",children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"nama",className:"form-label",children:["Nama ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx(uf,{id:"nama",value:u.nama,onChange:D=>K("nama",D),suggestions:k.names,className:`form-input ${h.nama?"error":""}`,placeholder:"Enter full name",disabled:v,maxLength:100,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:!1,excludeFromDuplicateCheck:a?.nama||y?.nama}),o.jsxs("div",{className:"form-meta",children:[h.nama&&o.jsx("span",{className:"error-message",children:h.nama}),X("nama",100)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"nomorTelepon",className:"form-label",children:["Nomor Telepon ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx(uf,{id:"nomorTelepon",type:"tel",value:u.nomorTelepon,onChange:D=>K("nomorTelepon",D),suggestions:k.phoneNumbers,className:`form-input ${h.nomorTelepon?"error":""}`,placeholder:"Enter phone number",disabled:v,maxLength:20,autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:!1,excludeFromDuplicateCheck:a?.nomorTelepon||y?.nomorTelepon}),o.jsxs("div",{className:"form-meta",children:[h.nomorTelepon&&o.jsx("span",{className:"error-message",children:h.nomorTelepon}),X("nomorTelepon",20)]})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"jenisKelamin",className:"form-label",children:["Jenis Kelamin ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("select",{id:"jenisKelamin",value:u.jenisKelamin,onChange:D=>K("jenisKelamin",D.target.value),className:`form-select ${h.jenisKelamin?"error":""}`,disabled:v,children:Nv.map(D=>o.jsx("option",{value:D,children:D},D))}),o.jsx("div",{className:"form-meta",children:h.jenisKelamin&&o.jsx("span",{className:"error-message",children:h.jenisKelamin})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"usia",className:"form-label",children:"Usia"}),o.jsx("input",{id:"usia",type:"number",value:u.usia,onChange:D=>K("usia",D.target.value),className:`form-input ${h.usia?"error":""}`,placeholder:"Enter age (optional)",disabled:v,min:"1",max:"120",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),o.jsx("div",{className:"form-meta",children:h.usia&&o.jsx("span",{className:"error-message",children:h.usia})})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"profesi",className:"form-label",children:"Profesi"}),o.jsx("input",{id:"profesi",type:"text",value:u.profesi,onChange:D=>K("profesi",D.target.value),className:`form-input ${h.profesi?"error":""}`,placeholder:"Enter profession (optional)",disabled:v,maxLength:100,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:"false"}),o.jsxs("div",{className:"form-meta",children:[h.profesi&&o.jsx("span",{className:"error-message",children:h.profesi}),X("profesi",100)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"statusPernikahan",className:"form-label",children:"Status Pernikahan"}),o.jsxs("select",{id:"statusPernikahan",value:u.statusPernikahan,onChange:D=>K("statusPernikahan",D.target.value),className:`form-select ${h.statusPernikahan?"error":""}`,disabled:v,children:[o.jsx("option",{value:"",children:"Pilih Status Pernikahan"}),BS.map(D=>o.jsx("option",{value:D,children:D},D))]}),o.jsx("div",{className:"form-meta",children:h.statusPernikahan&&o.jsx("span",{className:"error-message",children:h.statusPernikahan})})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"mediaKomunikasi",className:"form-label",children:"Media Komunikasi"}),o.jsxs("select",{id:"mediaKomunikasi",value:u.mediaKomunikasi,onChange:D=>K("mediaKomunikasi",D.target.value),className:`form-select ${h.mediaKomunikasi?"error":""}`,disabled:v,children:[o.jsx("option",{value:"",children:"Pilih Media Komunikasi"}),KS.map(D=>o.jsx("option",{value:D,children:D},D))]}),o.jsx("div",{className:"form-meta",children:h.mediaKomunikasi&&o.jsx("span",{className:"error-message",children:h.mediaKomunikasi})})]}),o.jsx("div",{className:"form-group territory-group",children:o.jsx(hN,{initialProvinsi:u.provinsi,initialKabKota:u.kabKota,onChange:J,disabled:v,errors:{provinsi:h.provinsi,kabKota:h.kabKota,mission:h.mission,uni:h.uni},className:"horizontal"})})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"agama",className:"form-label",children:["Agama ",o.jsx("span",{className:"required",children:"*"})]}),o.jsxs("select",{id:"agama",value:u.agama,onChange:D=>K("agama",D.target.value),className:`form-select ${h.agama?"error":""}`,disabled:v,required:!0,children:[o.jsx("option",{value:"",children:"Pilih Agama"}),FS.map(D=>o.jsx("option",{value:D,children:D},D))]}),o.jsx("div",{className:"form-meta",children:h.agama&&o.jsx("span",{className:"error-message",children:h.agama})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"subAgama",className:"form-label",children:u.agama==="Protestan"?"Gereja":"Sub Agama"}),u.agama==="Protestan"?o.jsx(uf,{id:"subAgama",value:u.subAgama,onChange:D=>K("subAgama",D),suggestions:LS,className:`form-input ${h.subAgama?"error":""}`,placeholder:"Cari nama gereja...",disabled:v,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:!1,showDuplicateWarning:!1}):o.jsx("input",{id:"subAgama",type:"text",value:u.subAgama,onChange:D=>K("subAgama",D.target.value),className:`form-input ${h.subAgama?"error":""}`,placeholder:u.agama?u.agama:"Pilih agama terlebih dahulu",disabled:v||!u.agama,readOnly:!!(u.agama&&u.agama!=="Protestan"),autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:!1}),o.jsxs("div",{className:"form-meta",children:[h.subAgama&&o.jsx("span",{className:"error-message",children:h.subAgama}),u.agama==="Protestan"&&o.jsx("span",{className:"help-text",children:"Ketik untuk mencari gereja Protestan"})]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"alamat",className:"form-label",children:["Alamat ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("textarea",{id:"alamat",value:u.alamat,onChange:D=>K("alamat",D.target.value),className:`form-textarea ${h.alamat?"error":""}`,placeholder:"Enter complete address",disabled:v,required:!0,rows:3,maxLength:200,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:"false"}),o.jsxs("div",{className:"form-meta",children:[h.alamat&&o.jsx("span",{className:"error-message",children:h.alamat}),X("alamat",200)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"alasanMenghubungi",className:"form-label",children:["Alasan Menghubungi ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("textarea",{id:"alasanMenghubungi",value:u.alasanMenghubungi,onChange:D=>K("alasanMenghubungi",D.target.value),className:`form-textarea ${h.alasanMenghubungi?"error":""}`,placeholder:"Enter reason for contact",disabled:v,required:!0,rows:4,maxLength:500,autoComplete:"off",autoCorrect:"off",autoCapitalize:"sentences",spellCheck:"false"}),o.jsxs("div",{className:"form-meta",children:[h.alasanMenghubungi&&o.jsx("span",{className:"error-message",children:h.alasanMenghubungi}),X("alasanMenghubungi",500)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"sumber",className:"form-label",children:["Sumber ",o.jsx("span",{className:"required",children:"*"})]}),o.jsxs("select",{id:"sumber",value:u.sumber,onChange:D=>K("sumber",D.target.value),className:`form-select ${h.sumber?"error":""}`,disabled:v,required:!0,children:[o.jsx("option",{value:"",children:"Pilih Sumber"}),Dv.map(D=>o.jsx("option",{value:D,children:D},D))]}),o.jsx("div",{className:"form-meta",children:h.sumber&&o.jsx("span",{className:"error-message",children:h.sumber})})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"prioritas",className:"form-label",children:["Prioritas ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("select",{id:"prioritas",value:u.prioritas,onChange:D=>K("prioritas",D.target.value),className:`form-select ${h.prioritas?"error":""}`,disabled:v,children:Av.map(D=>o.jsx("option",{value:D,children:D},D))}),o.jsx("div",{className:"form-meta",children:h.prioritas&&o.jsx("span",{className:"error-message",children:h.prioritas})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"statusKontak",className:"form-label",children:"Status Kontak"}),o.jsx("select",{id:"statusKontak",value:u.statusKontak,onChange:D=>K("statusKontak",D.target.value),className:`form-select ${h.statusKontak?"error":""}`,disabled:v,children:Tr.map(D=>o.jsx("option",{value:D,children:D},D))}),o.jsx("div",{className:"form-meta",children:h.statusKontak&&o.jsx("span",{className:"error-message",children:h.statusKontak})})]})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",onClick:L,className:"btn btn-secondary",disabled:v,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v||!S,children:v?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"button-spinner"}),i==="edit"?"Updating...":"Saving..."]}):i==="edit"?"Update Contact":"Save Contact"})]})]}),(C==="service"||i==="edit"&&y)&&y&&o.jsx(gN,{contactId:y.id,contactName:y.nama,onServiceStart:()=>{console.log("Service started for:",y.nama)},onServiceEnd:D=>{console.log("Service ended for:",y.nama,"Duration:",D,"seconds")}}),C==="service"&&y&&o.jsxs("div",{className:"service-mode-actions",children:[o.jsx("button",{type:"button",onClick:()=>{y&&f({nama:y.nama,nomorTelepon:y.nomorTelepon||"",jenisKelamin:y.jenisKelamin||"Laki-laki",usia:y.usia?String(y.usia):"",profesi:y.profesi||"",statusPernikahan:y.statusPernikahan||"",mediaKomunikasi:y.mediaKomunikasi||"",alamat:y.alamat||"",provinsi:y.provinsi||"",kabKota:y.kabKota||"",mission:y.mission||"",uni:y.uni||"",agama:y.agama||"",subAgama:y.subAgama||"",alasanMenghubungi:y.alasanMenghubungi||"",sumber:y.sumber||"",prioritas:y.prioritas||"Urgent",statusKontak:y.statusKontak||"New Contact"}),T("edit")},className:"btn btn-secondary",children:" Edit Contact Info"}),o.jsx("button",{type:"button",onClick:t,className:"btn btn-outline",children:" Back to Contacts"})]})]})},xN=({contactId:a,onServiceLogged:n,onCancel:t,initialDate:i=new Date})=>{const{currentUser:l}=Vt(),[u,f]=G.useState(!1),[h,g]=G.useState({}),[v,p]=G.useState(!1),S=N=>{const K=N.getFullYear(),J=(N.getMonth()+1).toString().padStart(2,"0"),B=N.getDate().toString().padStart(2,"0");return`${K}-${J}-${B}`},[x,C]=G.useState({duration:"",customDuration:"",date:S(i)}),T=G.useCallback(N=>{C(K=>({...K,duration:String(N)})),p(!1),g(K=>({...K,duration:""}))},[]),y=G.useCallback(()=>{p(N=>{const K=!N;return C(K?J=>({...J,duration:""}):J=>({...J,customDuration:""})),K}),g(N=>({...N,duration:""}))},[]),_=G.useCallback((N,K)=>{C(J=>({...J,[N]:K})),g(J=>({...J,[N]:""}))},[]),w=()=>{const N={},K=parseInt(v?x.customDuration:x.duration);if(!K||isNaN(K)||K<=0?N.duration="Please select or enter a valid duration":K>Cr.maxDurationPerSession&&(N.duration=`Duration cannot exceed ${Cr.maxDurationPerSession/60} hours per session`),!x.date)N.date="Service date is required";else{const J=new Date(x.date),B=new Date,Z=new Date;Z.setDate(B.getDate()-Cr.maxPastDate),J>B?N.date="Cannot log services for future dates":J<Z&&(N.date=`Cannot log services older than ${Cr.maxPastDate} days`)}if(!N.duration&&!N.date&&K)try{Wt.getServicesByDate(x.date).filter(Z=>Z.contactId===a&&Z.userId===l?.id).reduce((Z,L)=>Z+L.duration,0)+K>Cr.maxDurationPerDay&&(N.duration=`Total daily service duration cannot exceed ${Cr.maxDurationPerDay/60} hours`)}catch(J){console.error("Error validating daily duration:",J)}return g(N),Object.keys(N).length===0},k=async N=>{if(N.preventDefault(),!!w()){f(!0);try{const K=parseInt(v?x.customDuration:x.duration);if(!l)throw new Error("User not authenticated");const J={contactId:a,userId:l.id,date:x.date,duration:K},B=Wt.addServiceEntry(J);n(B),C({duration:"",customDuration:"",date:S(new Date)}),p(!1)}catch(K){console.error("Error logging service:",K),g({submit:K instanceof Error?K.message:"Failed to log service"})}finally{f(!1)}}},M=N=>{if(N<60)return`${N} min`;const K=Math.floor(N/60),J=N%60;return J>0?`${K}h ${J}m`:`${K}h`};return o.jsxs("form",{onSubmit:k,className:"service-entry-form",children:[o.jsxs("div",{className:"form-header",children:[o.jsx("h3",{children:"Log Service Activity"}),o.jsx("p",{children:"Record time spent serving this contact"})]}),h.submit&&o.jsx("div",{className:"error-banner",children:h.submit}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{className:"form-label",children:["Service Date ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{type:"date",value:x.date,onChange:N=>_("date",N.target.value),className:`form-input ${h.date?"error":""}`,disabled:u,max:S(new Date)}),h.date&&o.jsx("span",{className:"error-message",children:h.date})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{className:"form-label",children:["Service Duration ",o.jsx("span",{className:"required",children:"*"})]}),!v&&o.jsx("div",{className:"quick-duration-buttons",children:PS.map(N=>o.jsx("button",{type:"button",onClick:()=>T(N.value),className:`duration-btn ${x.duration===String(N.value)?"active":""}`,disabled:u,children:N.label},N.value))}),v&&o.jsxs("div",{className:"custom-duration-input",children:[o.jsx("input",{type:"number",value:x.customDuration,onChange:N=>_("customDuration",N.target.value),className:`form-input ${h.duration?"error":""}`,placeholder:"Enter minutes",min:"1",max:Cr.maxDurationPerSession,disabled:u}),o.jsx("span",{className:"input-suffix",children:"minutes"})]}),o.jsx("button",{type:"button",onClick:y,className:"toggle-custom-btn",disabled:u,children:v?"Use Quick Options":"Enter Custom Duration"}),h.duration&&o.jsx("span",{className:"error-message",children:h.duration}),(x.duration||x.customDuration)&&o.jsxs("div",{className:"duration-preview",children:["Duration: ",M(v?parseInt(x.customDuration)||0:parseInt(x.duration)||0)]})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",onClick:t,className:"btn btn-secondary",disabled:u,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?"Logging Service...":"Log Service"})]})]})},SN=({isOpen:a,contactId:n,contactName:t,onClose:i,onServiceLogged:l})=>{const u=G.useCallback(g=>{g.key==="Escape"&&i()},[i]),f=G.useCallback(g=>{g.target===g.currentTarget&&i()},[i]),h=G.useCallback(g=>{l(g),i()},[l,i]);return G.useEffect(()=>(a?(document.addEventListener("keydown",u),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",u),document.body.style.overflow="unset"),()=>{document.removeEventListener("keydown",u),document.body.style.overflow="unset"}),[a,u]),a?o.jsx("div",{className:"service-modal-overlay",onClick:f,children:o.jsxs("div",{className:"service-modal-container",children:[o.jsxs("div",{className:"service-modal-header",children:[o.jsxs("div",{className:"modal-title",children:[o.jsx("h2",{children:"Log Service"}),o.jsxs("p",{children:["Contact: ",o.jsx("strong",{children:t})]})]}),o.jsx("button",{onClick:i,className:"modal-close-btn","aria-label":"Close modal",children:""})]}),o.jsx("div",{className:"service-modal-content",children:o.jsx(xN,{contactId:n,onServiceLogged:h,onCancel:i})})]})}):null},yN=({contactId:a,onDateClick:n})=>{const[t,i]=G.useState(new Date),[l,u]=G.useState([]),[f,h]=G.useState([]),g=G.useCallback(()=>{const w=Wt.getServicesByContact(a);h(w)},[a]),v=G.useCallback(()=>{const w=t.getFullYear(),k=t.getMonth(),M=new Date(w,k,1),N=new Date(w,k+1,0),K=new Date(M);K.setDate(K.getDate()-M.getDay());const J=new Date(N);J.setDate(J.getDate()+(6-N.getDay()));const B=[],Z=new Date;Z.setHours(0,0,0,0);const L=new Map;f.forEach(D=>{const z=D.date;L.has(z)||L.set(z,[]),L.get(z).push(D)});const X=new Date(K);for(;X<=J;){const D=X.getFullYear(),z=X.getMonth()+1,ue=X.getDate(),be=`${D}-${z.toString().padStart(2,"0")}-${ue.toString().padStart(2,"0")}`,Se=L.get(be)||[],ee=Se.reduce((ke,Ne)=>ke+Ne.duration,0),ge={date:be,day:X.getDate(),isCurrentMonth:X.getMonth()===k,isToday:X.getTime()===Z.getTime(),hasService:Se.length>0,serviceCount:Se.length,totalDuration:ee,services:Se};B.push(ge),X.setDate(X.getDate()+1)}u(B)},[t,f]);G.useEffect(()=>{g()},[g]),G.useEffect(()=>{const w=()=>{g()};return window.addEventListener("serviceAdded",w),window.addEventListener("serviceUpdated",w),window.addEventListener("serviceDeleted",w),()=>{window.removeEventListener("serviceAdded",w),window.removeEventListener("serviceUpdated",w),window.removeEventListener("serviceDeleted",w)}},[g]),G.useEffect(()=>{v()},[v]);const p=()=>{i(w=>{const k=new Date(w);return k.setMonth(k.getMonth()-1),k})},S=()=>{i(w=>{const k=new Date(w);return k.setMonth(k.getMonth()+1),k})},x=()=>{i(new Date)},C=w=>{w.hasService&&n&&n(w.date,w.services)},T=w=>{if(w<60)return`${w}m`;const k=Math.floor(w/60),M=w%60;return M>0?`${k}h${M}m`:`${k}h`},y=t.toLocaleDateString("en-US",{month:"long",year:"numeric"}),_=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return o.jsxs("div",{className:"service-calendar",children:[o.jsxs("div",{className:"calendar-header",children:[o.jsxs("div",{className:"calendar-navigation",children:[o.jsx("button",{onClick:p,className:"nav-btn",title:"Previous month",children:""}),o.jsx("h3",{className:"month-year",children:y}),o.jsx("button",{onClick:S,className:"nav-btn",title:"Next month",children:""})]}),o.jsx("button",{onClick:x,className:"today-btn",children:"Today"})]}),o.jsxs("div",{className:"calendar-grid",children:[_.map(w=>o.jsx("div",{className:"week-day-header",children:w},w)),l.map((w,k)=>o.jsxs("div",{className:`calendar-day ${w.isCurrentMonth?"":"other-month"} ${w.isToday?"today":""} ${w.hasService?"has-service":""}`,onClick:()=>C(w),title:w.hasService?`${w.serviceCount} service${w.serviceCount>1?"s":""}, ${T(w.totalDuration)}`:void 0,children:[o.jsx("span",{className:"day-number",children:w.day}),w.hasService&&o.jsxs("div",{className:"service-indicator",children:[o.jsx("div",{className:"service-dot"}),o.jsx("span",{className:"service-count",children:w.serviceCount})]})]},k))]}),o.jsxs("div",{className:"calendar-legend",children:[o.jsxs("div",{className:"legend-item",children:[o.jsx("div",{className:"legend-dot"}),o.jsx("span",{children:"Service day"})]}),o.jsxs("div",{className:"legend-item",children:[o.jsx("div",{className:"legend-today"}),o.jsx("span",{children:"Today"})]})]})]})};class CN{generateFileName(n){const i=new Date().toISOString().split("T")[0];let l="";if(n.dateRange.type==="custom"&&n.dateRange.startDate&&n.dateRange.endDate){const h=n.dateRange.startDate.toISOString().split("T")[0],g=n.dateRange.endDate.toISOString().split("T")[0];l=`_${h}_to_${g}`}else l=`_${n.dateRange.type}`;let u="";if(n.filters.userId){const g=Ke.getUsers().find(v=>v.id===n.filters.userId);g&&(u=`_user_${g.username}`)}const f=n.format==="csv"?"csv":"xlsx";return`service_report_${n.reportType}_${i}${l}${u}.${f}`}filterServicesByDateRange(n,t){if(t.type==="custom"&&t.startDate&&t.endDate){const f=t.startDate.toISOString().split("T")[0],h=t.endDate.toISOString().split("T")[0];return n.filter(g=>g.date>=f&&g.date<=h)}const i=new Date;let l;switch(t.type){case"daily":l=new Date(i.getTime()-1440*60*1e3);break;case"weekly":l=new Date(i.getTime()-10080*60*1e3);break;case"monthly":l=new Date(i.getTime()-720*60*60*1e3);break;case"quarterly":l=new Date(i.getTime()-2160*60*60*1e3);break;case"yearly":l=new Date(i.getTime()-365*24*60*60*1e3);break;default:return n}const u=l.toISOString().split("T")[0];return n.filter(f=>f.date>=u)}getServiceReportData(n){let t=Wt.getAllServices();t=this.filterServicesByDateRange(t,n.dateRange),n.filters.userId&&(t=t.filter(x=>x.userId===n.filters.userId)),n.filters.contactId&&(t=t.filter(x=>x.contactId===n.filters.contactId));const i=new Set(t.map(x=>x.contactId)),u=Ke.getContacts().filter(x=>i.has(x.id)),f=Wt.getAllServiceMetrics().filter(x=>t.some(T=>T.contactId===x.contactId&&T.userId===x.userId)),h=new Set(t.map(x=>x.date)),g=new Set(t.map(x=>x.userId)),v=new Set(t.map(x=>x.contactId)),p=t.reduce((x,C)=>x+C.duration,0),S={totalServices:t.length,totalDuration:p,totalServiceDays:h.size,activeUsers:g.size,activeContacts:v.size,averageDurationPerService:t.length>0?Math.round(p/t.length):0,averageDurationPerDay:h.size>0?Math.round(p/h.size):0};return{services:t,contacts:u,metrics:f,summary:S}}formatDuration(n){if(n<60)return`${n} min`;const t=Math.floor(n/60),i=n%60;return i>0?`${t}h ${i}m`:`${t}h`}exportDetailedReport(n){const t=this.getServiceReportData(n),i=t.services.filter(x=>x.serviceType==="WhatsApp Chat"),l=t.services.filter(x=>x.serviceType!=="WhatsApp Chat"),u=new Map;t.services.forEach(x=>{if(!u.has(x.contactId)){const C=t.services.filter(M=>M.contactId===x.contactId),T=C.filter(M=>M.serviceType==="WhatsApp Chat"),y=C.filter(M=>M.serviceType!=="WhatsApp Chat"),_=new Set(y.map(M=>M.date)),w=new Set(T.map(M=>M.date)),k=y.reduce((M,N)=>M+N.duration,0);u.set(x.contactId,{totalServiceDays:_.size,totalServiceTime:k,totalChatCount:T.length,chatDays:w.size})}});const f=l.map(x=>{const C=t.contacts.find(_=>_.id===x.contactId),T=u.get(x.contactId),y={"Service Type":"Call Service","Service Date":x.date,"Contact ID":x.contactId,"Contact Name":C?.nama||"Unknown","User ID":x.userId,"Duration (minutes)":x.duration,"Duration (formatted)":this.formatDuration(x.duration),"Service Description":x.description||x.serviceType||"","Contact Total Call Days":T?.totalServiceDays||0,"Contact Total Call Time (minutes)":T?.totalServiceTime||0,"Contact Total Call Time (formatted)":this.formatDuration(T?.totalServiceTime||0),"Service Created":zn(x.createdAt)};return n.filters.includeContactInfo&&C&&(y["Contact Phone"]=C.nomorTelepon||"",y["Contact Address"]=C.alamat||"",y["Contact Status"]=C.statusKontak||"",y["Contact Priority"]=C.prioritas||"",y["Contact Source"]=C.sumber||""),y}),h=i.map(x=>{const C=t.contacts.find(_=>_.id===x.contactId),T=u.get(x.contactId),y={"Service Type":"WhatsApp Chat","Service Date":x.date,"Contact ID":x.contactId,"Contact Name":C?.nama||"Unknown","User ID":x.userId,"Duration (minutes)":"N/A (Chat)","Duration (formatted)":"Chat","Service Description":x.description||"WhatsApp Chat","Contact Total Chat Count":T?.totalChatCount||0,"Contact Chat Days":T?.chatDays||0,"Service Created":zn(x.createdAt)};return n.filters.includeContactInfo&&C&&(y["Contact Phone"]=C.nomorTelepon||"",y["Contact Address"]=C.alamat||"",y["Contact Status"]=C.statusKontak||"",y["Contact Priority"]=C.prioritas||"",y["Contact Source"]=C.sumber||""),y}),g=[...f.length>0?[{"Service Type":"=== CALL SERVICES ===","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":"","Duration (formatted)":"","Service Description":"","Service Created":""},...f]:[],...h.length>0?[{"Service Type":"=== WHATSAPP CHAT SERVICES ===","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":"","Duration (formatted)":"","Service Description":"","Service Created":""},...h]:[]],v={"Service Type":"--- CALL SERVICES SUMMARY ---","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":l.reduce((x,C)=>x+C.duration,0),"Duration (formatted)":this.formatDuration(l.reduce((x,C)=>x+C.duration,0)),"Service Description":`${l.length} call services`,"Service Created":""},p={"Service Type":"--- CHAT SERVICES SUMMARY ---","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":"N/A (Chat)","Duration (formatted)":"Chat","Service Description":`${i.length} chat interactions`,"Service Created":""},S={"Service Type":"--- OVERALL SUMMARY ---","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":`${l.reduce((x,C)=>x+C.duration,0)} (calls only)`,"Duration (formatted)":`${this.formatDuration(l.reduce((x,C)=>x+C.duration,0))} + ${i.length} chats`,"Service Description":`${t.services.length} total services (${l.length} calls + ${i.length} chats)`,"Service Created":""};n.filters.includeContactInfo&&[v,p,S].forEach(x=>{x["Contact Phone"]="",x["Contact Address"]="",x["Contact Status"]="",x["Contact Priority"]="",x["Contact Source"]=""}),g.push(v,p,S),this.exportData(g,n,"Detailed Service Report")}exportSummaryReport(n){const t=this.getServiceReportData(n),i=t.services.filter(T=>T.serviceType==="WhatsApp Chat"),l=t.services.filter(T=>T.serviceType!=="WhatsApp Chat"),u=new Map;t.services.forEach(T=>{const y=t.contacts.find(k=>k.id===T.contactId),_=T.contactId;u.has(_)||u.set(_,{contactId:T.contactId,contactName:y?.nama||"Unknown",totalCallServices:0,totalChatServices:0,totalCallDuration:0,callServiceDays:0,chatServiceDays:0,activeUsers:0,firstService:T.date,lastService:T.date});const w=u.get(_);T.serviceType==="WhatsApp Chat"?w.totalChatServices++:(w.totalCallServices++,w.totalCallDuration+=T.duration),T.date<w.firstService&&(w.firstService=T.date),T.date>w.lastService&&(w.lastService=T.date)}),u.forEach((T,y)=>{const _=l.filter(J=>J.contactId===y),w=i.filter(J=>J.contactId===y),k=t.services.filter(J=>J.contactId===y),M=new Set(_.map(J=>J.date)),N=new Set(w.map(J=>J.date)),K=new Set(k.map(J=>J.userId));T.callServiceDays=M.size,T.chatServiceDays=N.size,T.activeUsers=K.size});const f=Array.from(u.values()).map(T=>({"Contact ID":T.contactId,"Contact Name":T.contactName,"Call Services":T.totalCallServices,"Chat Services":T.totalChatServices,"Total Services":T.totalCallServices+T.totalChatServices,"Call Service Days":T.callServiceDays,"Chat Service Days":T.chatServiceDays,"Call Duration (minutes)":T.totalCallDuration,"Call Duration (formatted)":this.formatDuration(T.totalCallDuration),"Chat Frequency":`${T.totalChatServices} interactions`,"Active Users":T.activeUsers,"Average Call Duration":T.totalCallServices>0?Math.round(T.totalCallDuration/T.totalCallServices):0,"Average Call Duration per Day":T.callServiceDays>0?Math.round(T.totalCallDuration/T.callServiceDays):0,"Average Chats per Day":T.chatServiceDays>0?Math.round(T.totalChatServices/T.chatServiceDays*100)/100:0,"First Service":T.firstService,"Last Service":T.lastService})),h=f.reduce((T,y)=>T+y["Call Services"],0),g=f.reduce((T,y)=>T+y["Chat Services"],0),v=f.reduce((T,y)=>T+y["Call Duration (minutes)"],0),p=f.reduce((T,y)=>T+y["Call Service Days"],0),S=f.reduce((T,y)=>T+y["Chat Service Days"],0),C={"Contact ID":`--- OVERALL SUMMARY${n.filters.userId?` (Filtered by User: ${Ke.getUsers().find(T=>T.id===n.filters.userId)?.username||"Unknown"})`:""} ---`,"Contact Name":"","Call Services":h,"Chat Services":g,"Total Services":h+g,"Call Service Days":p,"Chat Service Days":S,"Call Duration (minutes)":v,"Call Duration (formatted)":this.formatDuration(v),"Chat Frequency":`${g} total interactions`,"Active Users":t.summary.activeUsers,"Average Call Duration":h>0?Math.round(v/h):0,"Average Call Duration per Day":p>0?Math.round(v/p):0,"Average Chats per Day":S>0?Math.round(g/S*100)/100:0,"First Service":"","Last Service":""};f.push(C),this.exportData(f,n,"Service Summary Report")}exportAnalyticsReport(n){const t=this.getServiceReportData(n),l=[{"Report Type":"Overall Summary","Filter Applied":`User: ${n.filters.userId?Ke.getUsers().find(g=>g.id===n.filters.userId)?.username||"Unknown User":"All Users"}`,"Total Services":t.summary.totalServices,"Total Service Days":t.summary.totalServiceDays,"Total Duration (minutes)":t.summary.totalDuration,"Total Duration (formatted)":this.formatDuration(t.summary.totalDuration),"Active Users":t.summary.activeUsers,"Active Contacts":t.summary.activeContacts,"Average Duration per Service":t.summary.averageDurationPerService,"Average Duration per Day":t.summary.averageDurationPerDay,"Report Generated":zn(new Date)}],u=new Map;t.services.forEach(g=>{u.has(g.userId)||u.set(g.userId,{userId:g.userId,totalServices:0,totalDuration:0,serviceDays:0,contactsServed:0});const v=u.get(g.userId);v.totalServices++,v.totalDuration+=g.duration}),u.forEach((g,v)=>{const p=t.services.filter(C=>C.userId===v),S=new Set(p.map(C=>C.date)),x=new Set(p.map(C=>C.contactId));g.serviceDays=S.size,g.contactsServed=x.size});const f=Array.from(u.values()).map(g=>({"User ID":g.userId,"Total Services":g.totalServices,"Service Days":g.serviceDays,"Total Duration (minutes)":g.totalDuration,"Total Duration (formatted)":this.formatDuration(g.totalDuration),"Contacts Served":g.contactsServed,"Average Duration per Service":Math.round(g.totalDuration/g.totalServices),"Average Duration per Day":Math.round(g.totalDuration/g.serviceDays),"Services per Day":Math.round(g.totalServices/g.serviceDays*100)/100})),h=[...l,{"Report Type":"--- USER PERFORMANCE ---"},...f];this.exportData(h,n,"Service Analytics Report")}exportData(n,t,i){const l=this.generateFileName(t);t.format==="csv"?this.exportToCSV(n,l):this.exportToExcel(n,l,i)}exportToCSV(n,t){if(n.length===0){alert("No data to export");return}const i=Object.keys(n[0]),l=[i.join(","),...n.map(g=>i.map(v=>{const p=g[v];return typeof p=="string"&&(p.includes(",")||p.includes('"'))?`"${p.replace(/"/g,'""')}"`:p}).join(","))].join(`
`),u=new Blob([l],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a"),h=URL.createObjectURL(u);f.setAttribute("href",h),f.setAttribute("download",t),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}exportToExcel(n,t,i){if(n.length===0){alert("No data to export");return}const l=Pn.json_to_sheet(n),u=Pn.book_new();Pn.book_append_sheet(u,l,i);const f=Object.keys(n[0]).map(h=>({wch:Math.max(h.length,...n.map(g=>String(g[h]||"").length))}));l["!cols"]=f,Mb(u,t)}exportWeeklyReport(){this.exportSummaryReport({format:"excel",reportType:"summary",dateRange:{type:"weekly"},filters:{includeContactInfo:!0}})}exportMonthlyReport(){this.exportAnalyticsReport({format:"excel",reportType:"analytics",dateRange:{type:"monthly"},filters:{includeContactInfo:!0}})}exportCustomReport(n,t,i){this.exportDetailedReport({format:"excel",reportType:"detailed",dateRange:{type:"custom",startDate:n,endDate:t},filters:{userId:i,includeContactInfo:!0}})}}const ul=new CN,TN=({isOpen:a,onClose:n})=>{const{currentUser:t}=Vt(),[i,l]=G.useState({format:"excel",reportType:"summary",dateRange:{type:"monthly"},filters:{includeContactInfo:!0}}),[u,f]=G.useState(!1),[h,g]=G.useState([]);G.useEffect(()=>{if(a&&t){const S=Ke.getUsers(),x=Lf(S,t);g(x);const C=hp(t);l(T=>({...T,filters:{...T.filters,userId:C!=="all"?C:void 0}}))}},[a,t]);const v=async()=>{if(i.dateRange.type==="custom"){if(!i.dateRange.startDate||!i.dateRange.endDate){alert("Please select both start and end dates for custom range.");return}if(i.dateRange.startDate>i.dateRange.endDate){alert("Start date must be before end date.");return}}f(!0);try{switch(i.reportType){case"detailed":ul.exportDetailedReport(i);break;case"summary":ul.exportSummaryReport(i);break;case"analytics":ul.exportAnalyticsReport(i);break}n()}catch(S){console.error("Export error:",S),alert("Export failed. Please try again.")}finally{f(!1)}},p=S=>{f(!0);try{S==="weekly"?ul.exportWeeklyReport():ul.exportMonthlyReport(),n()}catch(x){console.error("Quick export error:",x),alert("Export failed. Please try again.")}finally{f(!1)}};return a?o.jsx("div",{className:"service-export-modal-overlay",onClick:n,children:o.jsxs("div",{className:"service-export-modal",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Export Service Reports"}),i.filters.userId&&o.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"#666"},children:["Filtered by: ",h.find(S=>S.id===i.filters.userId)?.username||"Unknown User"]})]}),o.jsx("button",{onClick:n,className:"close-btn",children:""})]}),o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"quick-export-section",children:[o.jsx("h3",{children:"Quick Export"}),o.jsxs("div",{className:"quick-export-buttons",children:[o.jsx("button",{onClick:()=>p("weekly"),disabled:u,className:"quick-export-btn",children:" Weekly Summary"}),o.jsx("button",{onClick:()=>p("monthly"),disabled:u,className:"quick-export-btn",children:" Monthly Analytics"})]})]}),o.jsx("div",{className:"divider",children:"OR"}),o.jsxs("div",{className:"custom-export-section",children:[o.jsx("h3",{children:"Custom Export"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Report Type:"}),o.jsxs("select",{value:i.reportType,onChange:S=>l(x=>({...x,reportType:S.target.value})),children:[o.jsx("option",{value:"detailed",children:"Detailed Report"}),o.jsx("option",{value:"summary",children:"Summary Report"}),o.jsx("option",{value:"analytics",children:"Analytics Report"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Date Range:"}),o.jsxs("select",{value:i.dateRange.type,onChange:S=>l(x=>({...x,dateRange:{type:S.target.value}})),children:[o.jsx("option",{value:"daily",children:"Last 24 Hours"}),o.jsx("option",{value:"weekly",children:"Last Week"}),o.jsx("option",{value:"monthly",children:"Last Month"}),o.jsx("option",{value:"quarterly",children:"Last Quarter"}),o.jsx("option",{value:"yearly",children:"Last Year"}),o.jsx("option",{value:"custom",children:"Custom Range"})]})]}),i.dateRange.type==="custom"&&o.jsxs("div",{className:"custom-date-range",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Start Date:"}),o.jsx("input",{type:"date",value:i.dateRange.startDate?i.dateRange.startDate.toISOString().split("T")[0]:"",onChange:S=>{const x=S.target.value?new Date(S.target.value):void 0;l(C=>({...C,dateRange:{...C.dateRange,startDate:x}}))},max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"End Date:"}),o.jsx("input",{type:"date",value:i.dateRange.endDate?i.dateRange.endDate.toISOString().split("T")[0]:"",onChange:S=>{const x=S.target.value?new Date(S.target.value):void 0;l(C=>({...C,dateRange:{...C.dateRange,endDate:x}}))},max:new Date().toISOString().split("T")[0],min:i.dateRange.startDate?i.dateRange.startDate.toISOString().split("T")[0]:void 0})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Format:"}),o.jsxs("select",{value:i.format,onChange:S=>l(x=>({...x,format:S.target.value})),children:[o.jsx("option",{value:"excel",children:"Excel (.xlsx)"}),o.jsx("option",{value:"csv",children:"CSV (.csv)"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Filter by User:"}),o.jsxs("select",{value:i.filters.userId||"",onChange:S=>l(x=>({...x,filters:{...x.filters,userId:S.target.value||void 0}})),disabled:Tv(t),children:[Bf(t)&&o.jsx("option",{value:"",children:"All Users"}),h.map(S=>o.jsxs("option",{value:S.id,children:[S.username," (",S.role,")"]},S.id))]}),Tv(t)&&o.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"#666"},children:"You can only export your own data"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:i.filters.includeContactInfo||!1,onChange:S=>l(x=>({...x,filters:{...x.filters,includeContactInfo:S.target.checked}}))}),"Include Contact Information"]})})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{onClick:n,disabled:u,className:"btn-secondary",children:"Cancel"}),o.jsx("button",{onClick:v,disabled:u,className:"btn-primary",children:u?"Exporting...":"Export Report"})]})]})}):null},EN=({onFilterChange:a,initialFilters:n})=>{const[t,i]=G.useState({period:"all",...n}),[l,u]=G.useState(!1);G.useEffect(()=>{const S=new Date;let x,C;switch(t.period){case"week":x=new Date(S),x.setDate(S.getDate()-7),C=new Date(S);break;case"month":x=new Date(S),x.setMonth(S.getMonth()-1),C=new Date(S);break;case"quarter":x=new Date(S),x.setMonth(S.getMonth()-3),C=new Date(S);break;case"year":x=new Date(S),x.setFullYear(S.getFullYear()-1),C=new Date(S);break;case"custom":x=t.startDate,C=t.endDate,u(!0);break;case"all":default:x=void 0,C=void 0,u(!1);break}const T={...t,startDate:x,endDate:C};a(T)},[t.period,t.startDate,t.endDate]);const f=S=>{i(x=>({...x,period:S})),u(S==="custom")},h=(S,x)=>{if(x){const C=new Date(x);i(T=>({...T,[S]:C}))}},g=S=>S.toISOString().split("T")[0],v=()=>{if(t.period==="all")return"Semua Waktu";if(!t.startDate||!t.endDate)return"";const S=t.startDate.toLocaleDateString("id-ID"),x=t.endDate.toLocaleDateString("id-ID");return`${S} - ${x}`},p=()=>{i({period:"all"}),u(!1)};return o.jsxs("div",{className:"contact-service-filter",children:[o.jsxs("div",{className:"filter-header",children:[o.jsx("span",{className:"filter-label",children:"Filter Periode:"}),o.jsx("button",{onClick:p,className:"clear-btn",title:"Reset ke semua waktu",children:""})]}),o.jsxs("div",{className:"filter-controls",children:[o.jsxs("div",{className:"period-buttons",children:[o.jsx("button",{className:`period-btn ${t.period==="all"?"active":""}`,onClick:()=>f("all"),children:"Semua"}),o.jsx("button",{className:`period-btn ${t.period==="week"?"active":""}`,onClick:()=>f("week"),children:"7 Hari"}),o.jsx("button",{className:`period-btn ${t.period==="month"?"active":""}`,onClick:()=>f("month"),children:"30 Hari"}),o.jsx("button",{className:`period-btn ${t.period==="quarter"?"active":""}`,onClick:()=>f("quarter"),children:"3 Bulan"}),o.jsx("button",{className:`period-btn ${t.period==="year"?"active":""}`,onClick:()=>f("year"),children:"1 Tahun"}),o.jsx("button",{className:`period-btn ${t.period==="custom"?"active":""}`,onClick:()=>f("custom"),children:"Custom"})]}),l&&o.jsxs("div",{className:"custom-dates",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"Dari:"}),o.jsx("input",{type:"date",value:t.startDate?g(t.startDate):"",onChange:S=>h("startDate",S.target.value),className:"date-input"})]}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"Sampai:"}),o.jsx("input",{type:"date",value:t.endDate?g(t.endDate):"",onChange:S=>h("endDate",S.target.value),className:"date-input"})]})]})]}),t.period!=="all"&&o.jsx("div",{className:"filter-summary",children:o.jsx("span",{className:"summary-text",children:v()})})]})},_N=({contact:a,onEdit:n,onDelete:t,onClose:i})=>{const{hasPermission:l}=Vt(),[u,f]=G.useState(!1),[h,g]=G.useState(!1),[v,p]=G.useState(null),[S,x]=G.useState(null),[C,T]=G.useState({period:"all"}),y=G.useCallback(()=>{const X=Wt.getContactServiceSummary(a.id);p(X)},[a.id]),_=G.useCallback(()=>{if(!v){x(null);return}if(C.period==="all"){x(v);return}const X=Wt.getServicesByContact(a.id);let D=X;if(C.startDate&&C.endDate){const H=C.startDate,j=C.endDate;D=X.filter(V=>{const P=new Date(V.date);return P>=H&&P<=j})}const z=new Set(D.map(H=>H.date)).size,ue=D.reduce((H,j)=>H+j.duration,0)/60,be=new Set(D.map(H=>H.userId)).size,Se=D.sort((H,j)=>new Date(j.date).getTime()-new Date(H.date).getTime())[0],ee=Se?new Date(Se.date):void 0,ge=Se?.userId,ke=new Map;D.forEach(H=>{const j=new Date(H.date),V=`${j.getFullYear()}-${(j.getMonth()+1).toString().padStart(2,"0")}`;ke.has(V)||ke.set(V,{serviceCount:new Set,duration:0}),ke.get(V).serviceCount.add(H.date),ke.get(V).duration+=H.duration});const Ne=Array.from(ke.entries()).sort(([H],[j])=>H.localeCompare(j)).slice(-6).map(([H,j])=>({month:H,serviceCount:j.serviceCount.size,duration:j.duration})),Le={contactId:a.id,totalServiceDays:z,totalServiceHours:ue,activeUsers:be,monthlyTrend:Ne};ee&&(Le.lastServiceDate=ee),ge&&(Le.lastServiceUser=ge),x(Le)},[a.id,v,C]);G.useEffect(()=>{y()},[y]),G.useEffect(()=>{_()},[_]),G.useEffect(()=>{const X=()=>{y()};return window.addEventListener("serviceAdded",X),window.addEventListener("serviceUpdated",X),window.addEventListener("serviceDeleted",X),()=>{window.removeEventListener("serviceAdded",X),window.removeEventListener("serviceUpdated",X),window.removeEventListener("serviceDeleted",X)}},[y]);const w=()=>{if(!l("Admin")){alert("Only administrators can delete contacts");return}window.confirm(`Are you sure you want to delete ${a.nama}?`)&&t?.(a.id)},k=()=>{f(!0)},M=X=>{console.log("Service logged:",X)},N=X=>{T(X)},K=X=>{if(X===0)return"0h";if(X<1)return`${Math.round(X*60)}m`;const D=Math.floor(X),z=Math.round((X-D)*60);return z>0?`${D}h ${z}m`:`${D}h`},J=X=>({"New Contact":"#e74c3c","In Progress":"#f39c12","Follow Up":"#3498db",Completed:"#27ae60"})[X]||"#95a5a6",B=X=>X,Z=()=>{const X=new Date,D=new Date(a.createdAt),z=Math.abs(X.getTime()-D.getTime()),ue=Math.ceil(z/(1e3*60*60*24));return ue===1?"1 day ago":ue<30?`${ue} days ago`:ue<365?`${Math.floor(ue/30)} months ago`:`${Math.floor(ue/365)} years ago`},L=()=>{const X=new Date,D=new Date(a.updatedAt);return Math.abs(X.getTime()-D.getTime())/(1e3*60*60)<=24};return o.jsxs("div",{className:"contact-detail-overlay",children:[o.jsxs("div",{className:"contact-detail-container",children:[o.jsxs("div",{className:"contact-detail-header",children:[o.jsxs("div",{className:"contact-detail-title",children:[o.jsx("h2",{children:a.nama}),o.jsxs("div",{className:"contact-status-info",children:[o.jsx("span",{className:"status-badge large",style:{backgroundColor:J(a.statusKontak)},children:B(a.statusKontak)}),L()&&o.jsx("span",{className:"recently-updated",children:"Recently Updated"})]})]}),o.jsx("button",{onClick:i,className:"close-btn",title:"Close",children:""})]}),o.jsxs("div",{className:"contact-detail-content",children:[o.jsxs("div",{className:"contact-info-grid",children:[o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Personal Information"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Full Name"}),o.jsx("div",{className:"info-value",children:a.nama})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Gender"}),o.jsx("div",{className:"info-value",children:a.jenisKelamin||"Not specified"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Religion"}),o.jsx("div",{className:"info-value",children:a.agama})]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Contact Information"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Phone Number"}),o.jsx("div",{className:"info-value",children:a.nomorTelepon||"Not provided"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Address"}),o.jsx("div",{className:"info-value address",children:a.alamat})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Provinsi"}),o.jsx("div",{className:"info-value",children:a.provinsi||"Not specified"})]})]})]}),o.jsxs("div",{className:"info-section full-width",children:[o.jsx("h3",{children:"Contact Reason & Source"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Reason for Contact"}),o.jsx("div",{className:"info-value reason",children:a.alasanMenghubungi})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Sumber"}),o.jsx("div",{className:"info-value",children:o.jsx("span",{className:"sumber-badge",children:a.sumber||"Lainnya"})})]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Priority & Status"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Priority"}),o.jsx("div",{className:"info-value",children:o.jsx("span",{className:`priority-badge priority-${a.prioritas?.toLowerCase()||"sedang"}`,children:a.prioritas||"Sedang"})})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Current Status"}),o.jsx("div",{className:"info-value",children:o.jsx("span",{className:"status-badge",style:{backgroundColor:J(a.statusKontak)},children:a.statusKontak})})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Contact Age"}),o.jsx("div",{className:"info-value",children:Z()})]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Timestamps"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Created"}),o.jsx("div",{className:"info-value timestamp",children:zn(new Date(a.createdAt))})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Last Updated"}),o.jsx("div",{className:"info-value timestamp",children:zn(new Date(a.updatedAt))})]})]})]})]}),o.jsxs("div",{className:"contact-metadata",children:[o.jsxs("div",{className:"metadata-item",children:[o.jsx("span",{className:"metadata-label",children:"Contact ID:"}),o.jsx("span",{className:"metadata-value",children:a.id})]}),o.jsxs("div",{className:"metadata-item",children:[o.jsx("span",{className:"metadata-label",children:"Created by:"}),o.jsx("span",{className:"metadata-value",children:a.createdBy})]})]}),o.jsx(tN,{history:a.history||[],isExpanded:!1,maxEntries:5}),o.jsxs("div",{className:"service-tracking-section",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h3",{children:"Service Tracking"}),o.jsxs("div",{className:"service-actions",children:[o.jsxs("button",{onClick:()=>g(!0),className:"export-service-btn",title:"Export service reports",children:[o.jsx("span",{children:""}),"Export Reports"]}),o.jsxs("button",{onClick:k,className:"log-service-btn",title:"Log new service activity",children:[o.jsx("span",{children:""}),"Log Service"]})]})]}),o.jsx(EN,{onFilterChange:N,initialFilters:C}),S&&S.totalServiceDays>0&&o.jsxs("div",{className:"service-summary",children:[o.jsxs("div",{className:"service-stats",children:[o.jsxs("div",{className:"stat-item",children:[o.jsx("div",{className:"stat-value",children:S.totalServiceDays}),o.jsx("div",{className:"stat-label",children:"Service Days"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("div",{className:"stat-value",children:K(S.totalServiceHours)}),o.jsx("div",{className:"stat-label",children:"Total Time"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("div",{className:"stat-value",children:S.activeUsers}),o.jsx("div",{className:"stat-label",children:"Active Users"})]})]}),S.lastServiceDate&&o.jsxs("div",{className:"last-service-info",children:[o.jsx("span",{className:"last-service-label",children:"Last Service:"}),o.jsx("span",{className:"last-service-date",children:zn(S.lastServiceDate)}),S.lastServiceUser&&o.jsxs("span",{className:"last-service-user",children:["by ",S.lastServiceUser]})]}),S.monthlyTrend&&S.monthlyTrend.length>0&&o.jsxs("div",{className:"monthly-trend",children:[o.jsx("h4",{children:"Recent Activity (Last 6 Months)"}),o.jsx("div",{className:"trend-chart",children:S.monthlyTrend.map(X=>o.jsxs("div",{className:"trend-bar",children:[o.jsx("div",{className:"trend-fill",style:{height:`${Math.max(5,X.serviceCount/Math.max(...S.monthlyTrend.map(D=>D.serviceCount))*100)}%`},title:`${X.month}: ${X.serviceCount} days, ${K(X.duration)}`}),o.jsx("div",{className:"trend-label",children:new Date(X.month+"-01").toLocaleDateString("en-US",{month:"short"})})]},X.month))})]})]}),(!S||S.totalServiceDays===0)&&o.jsxs("div",{className:"no-service-data",children:[o.jsx("p",{children:"No service activities recorded yet."}),o.jsx("p",{children:'Click "Log Service" to start tracking service time for this contact.'})]})]}),o.jsxs("div",{className:"service-calendar-section",children:[o.jsx("h4",{children:"Service Calendar"}),o.jsx("p",{children:"Highlighted dates show when services were provided to this contact"}),o.jsx(yN,{contactId:a.id,onDateClick:(X,D)=>{console.log("Date clicked:",X,"Services:",D)}})]})]}),o.jsxs("div",{className:"contact-detail-actions",children:[o.jsx(vf,{contact:a,variant:"primary",showTemplates:!0,className:"whatsapp-action-btn"}),o.jsxs("button",{onClick:()=>n?.(a),className:"action-btn edit-btn",children:[o.jsx("span",{children:""}),"Edit Contact"]}),l("Admin")&&o.jsxs("button",{onClick:w,className:"action-btn delete-btn",children:[o.jsx("span",{children:""}),"Delete Contact"]}),o.jsx("button",{onClick:i,className:"action-btn close-btn-secondary",children:"Close"})]})]}),u&&o.jsx(SN,{isOpen:u,contactId:a.id,contactName:a.nama,onClose:()=>f(!1),onServiceLogged:M}),h&&o.jsx(TN,{isOpen:h,onClose:()=>g(!1)})]})},wN=({onLogoUpdate:a,maxFileSize:n=2*1024*1024,acceptedFormats:t=["image/png","image/jpeg","image/jpg","image/svg+xml","image/webp"],showPreview:i=!0})=>{const[l,u]=G.useState(!1),[f,h]=G.useState(!1),[g,v]=G.useState(null),[p,S]=G.useState(null),[x,C]=G.useState(null),[T,y]=G.useState(hl.getCurrentLogo()),_=G.useRef(null),{currentUser:w}=Vt(),k=G.useCallback(()=>{S(null),C(null)},[]),M=G.useCallback(async z=>{if(!w){S("You must be logged in to upload logos");return}k(),h(!0);try{const ue=hl.validateLogoFile(z);if(!ue.isValid){S(ue.errors.join(", "));return}if(i){const Se=new FileReader;Se.onload=ee=>{v(ee.target?.result)},Se.readAsDataURL(z)}const be=await hl.updateLogo(z,w.id);y(be),C(`Logo updated successfully! File: ${z.name}`),a?.(be),window.dispatchEvent(new CustomEvent("logoUpdated"))}catch(ue){const be=ue instanceof Error?ue.message:"Failed to upload logo";S(be),v(null)}finally{h(!1)}},[w,a,i,k]),N=G.useCallback(z=>{z.preventDefault(),u(!0)},[]),K=G.useCallback(z=>{z.preventDefault(),u(!1)},[]),J=G.useCallback(z=>{z.preventDefault(),u(!1);const ue=Array.from(z.dataTransfer.files);ue.length>0&&M(ue[0])},[M]),B=G.useCallback(z=>{const ue=z.target.files;ue&&ue.length>0&&M(ue[0])},[M]),Z=G.useCallback(()=>{_.current?.click()},[]),L=G.useCallback(()=>{if(!w){S("You must be logged in to reset logo");return}if(window.confirm("Are you sure you want to reset to the default logo?")){k();const z=hl.resetToDefault();y(z),v(null),C("Logo reset to default successfully!"),a?.(z),window.dispatchEvent(new CustomEvent("logoUpdated"))}},[w,a,k]),X=z=>{if(z===0)return"0 Bytes";const ue=1024,be=["Bytes","KB","MB"],Se=Math.floor(Math.log(z)/Math.log(ue));return parseFloat((z/Math.pow(ue,Se)).toFixed(2))+" "+be[Se]},D=z=>new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(z);return o.jsxs("div",{className:"logo-uploader",children:[o.jsxs("div",{className:"logo-uploader__header",children:[o.jsx("h3",{children:"Logo Management"}),o.jsx("p",{children:"Upload a new logo for your application. Supported formats: PNG, JPG, SVG, WebP"})]}),o.jsxs("div",{className:"logo-uploader__current",children:[o.jsx("h4",{children:"Current Logo"}),o.jsxs("div",{className:"current-logo-display",children:[o.jsx("img",{src:T.logoUrl,alt:"Current Logo",className:"current-logo-image"}),o.jsxs("div",{className:"current-logo-info",children:[o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"Type:"}),o.jsx("span",{className:"value",children:T.logoType==="default"?"Default":"Custom"})]}),o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"File:"}),o.jsx("span",{className:"value",children:T.logoMetadata.originalName})]}),T.logoMetadata.size>0&&o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"Size:"}),o.jsx("span",{className:"value",children:X(T.logoMetadata.size)})]}),o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"Updated:"}),o.jsx("span",{className:"value",children:D(T.logoMetadata.uploadDate)})]})]})]})]}),o.jsxs("div",{className:`logo-uploader__dropzone ${l?"dragging":""} ${f?"uploading":""}`,onDragOver:N,onDragLeave:K,onDrop:J,children:[o.jsx("input",{ref:_,type:"file",accept:t.join(","),onChange:B,className:"logo-uploader__input",disabled:f}),f?o.jsxs("div",{className:"upload-progress",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Uploading logo..."})]}):o.jsxs("div",{className:"upload-content",children:[o.jsx("div",{className:"upload-icon",children:""}),o.jsxs("p",{className:"upload-text",children:["Drag and drop your logo here, or"," ",o.jsx("button",{type:"button",className:"browse-button",onClick:Z,children:"browse files"})]}),o.jsxs("p",{className:"upload-hint",children:["Maximum file size: ",X(n)]})]})]}),i&&g&&o.jsxs("div",{className:"logo-uploader__preview",children:[o.jsx("h4",{children:"Preview"}),o.jsx("div",{className:"preview-container",children:o.jsx("img",{src:g,alt:"Logo Preview",className:"preview-image"})})]}),p&&o.jsxs("div",{className:"logo-uploader__message logo-uploader__message--error",children:[o.jsx("span",{className:"message-icon",children:""}),o.jsx("span",{className:"message-text",children:p}),o.jsx("button",{className:"message-close",onClick:k,children:""})]}),x&&o.jsxs("div",{className:"logo-uploader__message logo-uploader__message--success",children:[o.jsx("span",{className:"message-icon",children:""}),o.jsx("span",{className:"message-text",children:x}),o.jsx("button",{className:"message-close",onClick:k,children:""})]}),o.jsxs("div",{className:"logo-uploader__actions",children:[o.jsx("button",{type:"button",className:"btn btn-secondary",onClick:L,disabled:f||T.logoType==="default",children:"Reset to Default"}),o.jsx("button",{type:"button",className:"btn btn-primary",onClick:Z,disabled:f,children:f?"Uploading...":"Choose New Logo"})]}),o.jsxs("div",{className:"logo-uploader__guidelines",children:[o.jsx("h4",{children:"Logo Guidelines"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Recommended size: 200x100 pixels or 1:1 ratio (square)"}),o.jsx("li",{children:"Supported formats: PNG, JPG, SVG, WebP"}),o.jsxs("li",{children:["Maximum file size: ",X(n)]}),o.jsx("li",{children:"For best results, use SVG format for scalability"}),o.jsx("li",{children:"Ensure logo has good contrast against dark backgrounds"})]})]})]})},bN=()=>{const[a,n]=G.useState([]),[t,i]=G.useState(!1),[l,u]=G.useState(null),[f,h]=G.useState("users"),[g,v]=G.useState({username:"",password:"",confirmPassword:"",role:"Editor"}),[p,S]=G.useState({}),[x,C]=G.useState(!1),{currentUser:T,hasPermission:y}=Vt();G.useEffect(()=>{_()},[]);const _=()=>{const L=Ke.getUsers();n(L)},w=()=>{if(window.confirm(` Are you sure you want to clear all demo data?

This will remove:
 All demo contacts
 All service data
 All demo history

Users and settings will be preserved.

This action cannot be undone!`))try{Ke.clearDemoData(),alert(` Demo data cleared successfully!

The application now starts with clean data for testing.`),window.location.reload()}catch(X){console.error("Error clearing demo data:",X),alert(" Error clearing demo data. Please try again.")}},k=()=>{v({username:"",password:"",confirmPassword:"",role:"Editor"}),S({}),u(null),i(!1)},M=()=>{const L={};return g.username.trim()?g.username.length<3?L.username="Username must be at least 3 characters":g.username.length>20?L.username="Username must be less than 20 characters":a.find(D=>D.username.toLowerCase()===g.username.toLowerCase()&&D.id!==l?.id)&&(L.username="Username already exists"):L.username="Username is required",(!l||g.password)&&(g.password?g.password.length<4&&(L.password="Password must be at least 4 characters"):L.password="Password is required",g.password!==g.confirmPassword&&(L.confirmPassword="Passwords do not match")),g.role||(L.role="Role is required"),S(L),Object.keys(L).length===0},N=(L,X)=>{v(D=>({...D,[L]:X})),p[L]&&S(D=>({...D,[L]:""}))},K=async L=>{if(L.preventDefault(),!!M()){C(!0);try{if(l){const X={...l,username:g.username.trim(),role:g.role};Ke.updateUser(l.id,X),g.password&&Ke.addUserCredential(g.username.trim(),g.password)}else{const X={id:Qi(),username:g.username.trim(),role:g.role,createdAt:new Date};Ke.addUser(X),Ke.addUserCredential(g.username.trim(),g.password)}_(),k()}catch(X){console.error("Error saving user:",X),alert("Failed to save user. Please try again.")}finally{C(!1)}}},J=L=>{u(L),v({username:L.username,password:"",confirmPassword:"",role:L.role}),i(!0)},B=L=>{if(L.id===T?.id){alert("You cannot delete your own account");return}if(window.confirm(`Are you sure you want to delete user "${L.username}"?`))try{Ke.deleteUser(L.id),Ke.removeUserCredential(L.username),_()}catch(X){console.error("Error deleting user:",X),alert("Failed to delete user. Please try again.")}},Z=L=>new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(L));return y("Admin")?o.jsxs("div",{className:"user-management",children:[o.jsx("div",{className:"user-management-header",children:o.jsxs("div",{className:"header-left",children:[o.jsx("h2",{children:"Admin Panel"}),o.jsx("p",{children:"Manage users, settings, and branding"})]})}),o.jsxs("div",{className:"tab-navigation",children:[o.jsxs("button",{className:`tab-button ${f==="users"?"active":""}`,onClick:()=>h("users"),children:[o.jsx("span",{children:""}),"User Management"]}),o.jsxs("button",{className:`tab-button ${f==="branding"?"active":""}`,onClick:()=>h("branding"),children:[o.jsx("span",{children:""}),"Logo & Branding"]})]}),f==="users"&&o.jsxs("div",{className:"tab-content",children:[o.jsxs("div",{className:"section-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h3",{children:"User Management"}),o.jsx("p",{children:"Manage user accounts and permissions"})]}),o.jsxs("div",{className:"header-actions",children:[o.jsxs("button",{onClick:w,className:"btn btn-warning",title:"Clear all demo data for clean testing",children:[o.jsx("span",{children:""}),"Clear Demo Data"]}),o.jsxs("button",{onClick:()=>i(!0),className:"btn btn-primary",disabled:t,children:[o.jsx("span",{children:""}),"Add New User"]})]})]}),t&&o.jsxs("div",{className:"user-form-container",children:[o.jsxs("div",{className:"user-form-header",children:[o.jsx("h3",{children:l?"Edit User":"Add New User"}),o.jsx("button",{onClick:k,className:"close-btn",type:"button",children:""})]}),o.jsxs("form",{onSubmit:K,className:"user-form",children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"username",className:"form-label",children:["Username ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"username",type:"text",value:g.username,onChange:L=>N("username",L.target.value),className:`form-input ${p.username?"error":""}`,placeholder:"Enter username",disabled:x,autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),p.username&&o.jsx("span",{className:"error-message",children:p.username})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"role",className:"form-label",children:["Role ",o.jsx("span",{className:"required",children:"*"})]}),o.jsxs("select",{id:"role",value:g.role,onChange:L=>N("role",L.target.value),className:`form-select ${p.role?"error":""}`,disabled:x,children:[o.jsx("option",{value:"Editor",children:"Editor"}),o.jsx("option",{value:"Admin",children:"Admin"})]}),p.role&&o.jsx("span",{className:"error-message",children:p.role})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"password",className:"form-label",children:[l?"New Password (leave blank to keep current)":"Password",!l&&o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"password",type:"password",value:g.password,onChange:L=>N("password",L.target.value),className:`form-input ${p.password?"error":""}`,placeholder:l?"Leave blank to keep current password":"Enter password",disabled:x,autoComplete:"new-password",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),p.password&&o.jsx("span",{className:"error-message",children:p.password})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"confirmPassword",className:"form-label",children:["Confirm Password",(!l||g.password)&&o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"confirmPassword",type:"password",value:g.confirmPassword,onChange:L=>N("confirmPassword",L.target.value),className:`form-input ${p.confirmPassword?"error":""}`,placeholder:"Confirm password",disabled:x,autoComplete:"new-password",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),p.confirmPassword&&o.jsx("span",{className:"error-message",children:p.confirmPassword})]})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",onClick:k,className:"btn btn-secondary",disabled:x,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x,children:x?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"button-spinner"}),l?"Updating...":"Creating..."]}):l?"Update User":"Create User"})]})]})]}),o.jsxs("div",{className:"users-list",children:[o.jsxs("div",{className:"users-stats",children:[o.jsxs("span",{children:["Total Users: ",a.length]}),o.jsxs("span",{children:["Admins: ",a.filter(L=>L.role==="Admin").length]}),o.jsxs("span",{children:["Editors: ",a.filter(L=>L.role==="Editor").length]})]}),o.jsx("div",{className:"users-table-container",children:o.jsxs("table",{className:"users-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Username"}),o.jsx("th",{children:"Role"}),o.jsx("th",{children:"Created"}),o.jsx("th",{children:"Actions"})]})}),o.jsx("tbody",{children:a.map(L=>o.jsxs("tr",{className:L.id===T?.id?"current-user":"",children:[o.jsx("td",{className:"user-username",children:o.jsxs("div",{className:"username-with-indicator",children:[o.jsx("strong",{children:L.username}),L.id===T?.id&&o.jsx("span",{className:"current-user-badge",children:"You"})]})}),o.jsx("td",{children:o.jsx("span",{className:`role-badge ${L.role.toLowerCase()}`,children:L.role})}),o.jsx("td",{className:"user-created",children:Z(L.createdAt)}),o.jsxs("td",{className:"user-actions",children:[o.jsx("button",{onClick:()=>J(L),className:"action-btn edit-btn",title:"Edit User",children:""}),L.id!==T?.id&&o.jsx("button",{onClick:()=>B(L),className:"action-btn delete-btn",title:"Delete User",children:""})]})]},L.id))})]})})]})]}),f==="branding"&&o.jsxs("div",{className:"tab-content",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{className:"header-left",children:[o.jsx("h3",{children:"Logo & Branding"}),o.jsx("p",{children:"Customize your application's logo and branding"})]})}),o.jsx(wN,{showPreview:!0,onLogoUpdate:L=>{console.log("Logo updated:",L)}})]})]}):o.jsxs("div",{className:"user-management-unauthorized",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:"Only administrators can manage users."})]})};class NN{getDateRange(n){const t=new Date,i=new Date(t);let l;switch(n.type){case"today":l=new Date(t),l.setHours(0,0,0,0),i.setHours(23,59,59,999);break;case"week":l=new Date(t),l.setDate(t.getDate()-7);break;case"month":l=new Date(t),l.setMonth(t.getMonth()-1);break;case"quarter":l=new Date(t),l.setMonth(t.getMonth()-3);break;case"year":l=new Date(t),l.setFullYear(t.getFullYear()-1);break;case"custom":return l=n.startDate||new Date(t.getTime()-720*60*60*1e3),{startDate:l,endDate:n.endDate||i};default:l=new Date(t),l.setMonth(t.getMonth()-1)}return{startDate:l,endDate:i}}async calculateContactMetrics(n={type:"month"}){try{const t=Ke.getContacts(),{startDate:i,endDate:l}=this.getDateRange(n),u=l.getTime()-i.getTime(),f=new Date(i.getTime()-u),h=new Date(i.getTime()-1),g=t.filter(y=>{const _=new Date(y.createdAt);return _>=i&&_<=l}).length,v=t.filter(y=>{const _=new Date(y.createdAt);return _>=f&&_<=h}).length,p=v>0?Math.round((g-v)/v*100):g>0?100:0,S=t.filter(y=>y.statusKontak==="Completed").length,x=t.length>0?Math.round(S/t.length*100):0,C=t.filter(y=>y.statusKontak==="In Progress"||y.statusKontak==="Follow Up").length,T=t.filter(y=>y.prioritas==="Urgent"&&y.statusKontak!=="Completed").length;return{newContactsThisMonth:g,newContactsGrowth:p,conversionRate:x,activeContacts:C,urgentContacts:T,totalContacts:t.length}}catch(t){throw console.error("Error calculating contact metrics:",t),new Error("Failed to calculate contact metrics")}}async calculateServiceMetrics(n={type:"month"}){try{const t=Wt.getAllServices(),i=Ke.getContacts(),{startDate:l,endDate:u}=this.getDateRange(n),f=u.getTime()-l.getTime(),h=new Date(l.getTime()-f),g=new Date(l.getTime()-1),v=t.filter(K=>{const J=new Date(K.date);return J>=l&&J<=u}),p=t.filter(K=>{const J=new Date(K.date);return J>=h&&J<=g}),S=v.reduce((K,J)=>K+J.duration,0),x=Math.round(S/60*100)/100,C=p.reduce((K,J)=>K+J.duration,0),T=Math.round(C/60*100)/100,y=T>0?Math.round((x-T)/T*100):x>0?100:0,w=new Set(v.map(K=>K.date)).size,k=new Set(v.map(K=>K.contactId)),M=k.size>0?Math.round(S/k.size):0,N=i.length>0?Math.round(k.size/i.length*100):0;return{totalServiceHoursThisMonth:x,serviceHoursGrowth:y,activeServiceDays:w,averageServiceTimePerContact:M,serviceCoverage:N,totalServiceSessions:v.length}}catch(t){throw console.error("Error calculating service metrics:",t),new Error("Failed to calculate service metrics")}}async calculateContactDistribution(){try{const n=Ke.getContacts(),t=n.length,i=new Map,l=new Map,u=new Map,f=new Map;n.forEach(S=>{i.set(S.statusKontak,(i.get(S.statusKontak)||0)+1),l.set(S.prioritas,(l.get(S.prioritas)||0)+1),u.set(S.sumber,(u.get(S.sumber)||0)+1),f.set(S.provinsi,(f.get(S.provinsi)||0)+1)});const h=Array.from(i.entries()).map(([S,x])=>({status:S,count:x,percentage:t>0?Math.round(x/t*100):0})),g=Array.from(l.entries()).map(([S,x])=>({priority:S,count:x,percentage:t>0?Math.round(x/t*100):0})),v=Array.from(u.entries()).map(([S,x])=>({source:S,count:x,percentage:t>0?Math.round(x/t*100):0})).sort((S,x)=>x.count-S.count).slice(0,3),p=Array.from(f.entries()).map(([S,x])=>({province:S,count:x,percentage:t>0?Math.round(x/t*100):0})).sort((S,x)=>x.count-S.count).slice(0,5);return{byStatus:h,byPriority:g,bySource:v,byProvince:p}}catch(n){throw console.error("Error calculating contact distribution:",n),new Error("Failed to calculate contact distribution")}}async calculateTeamPerformance(n={type:"month"}){try{const t=Wt.getAllServices(),i=Ke.getContacts(),l=Ke.getUsers(),{startDate:u,endDate:f}=this.getDateRange(n),h=t.filter(T=>{const y=new Date(T.date);return y>=u&&y<=f}),g=new Map,v=new Map;h.forEach(T=>{const y=g.get(T.userId)||0,_=v.get(T.userId)||0;g.set(T.userId,y+T.duration/60),v.set(T.userId,_+1)});let p={userId:"",username:"N/A",serviceHours:0};for(const[T,y]of g.entries())if(y>p.serviceHours){const _=l.find(w=>w.id===T);p={userId:T,username:_?.username||"Unknown",serviceHours:Math.round(y*100)/100}}const S=new Map;i.forEach(T=>{const y=new Date(T.createdAt);if(y>=u&&y<=f){const _=S.get(T.createdBy)||0;S.set(T.createdBy,_+1)}});let x={userId:"",username:"N/A",contactsCreated:0};for(const[T,y]of S.entries())if(y>x.contactsCreated){const _=l.find(w=>w.id===T);x={userId:T,username:_?.username||"Unknown",contactsCreated:y}}const C=Array.from(g.entries()).map(([T,y])=>{const _=l.find(M=>M.id===T),w=v.get(T)||0,k=w>0?Math.round(y*60/w):0;return{userId:T,username:_?.username||"Unknown",averageServiceTime:k,totalServices:w}}).sort((T,y)=>y.totalServices-T.totalServices);return{mostActiveUser:p,topContactCreator:x,userEfficiency:C}}catch(t){throw console.error("Error calculating team performance:",t),new Error("Failed to calculate team performance")}}async generateAlerts(){try{const n=Ke.getContacts(),t=Wt.getAllServices(),i=new Date,l=[],u=new Date(i.getTime()-720*60*60*1e3),f=n.filter(C=>new Date(C.updatedAt)<u&&C.statusKontak!=="Completed");f.length>0&&l.push({id:"stale_contacts",type:"stale_contacts",title:"Stale Contacts",description:`${f.length} contacts have no activity for more than 30 days`,count:f.length,severity:f.length>10?"high":"medium",actionUrl:"/contacts?filter=stale",createdAt:i});const h=new Date(i.getTime()-10080*60*1e3),g=n.filter(C=>{const T=new Date(C.updatedAt);return C.statusKontak==="Follow Up"&&T<h});g.length>0&&l.push({id:"overdue_followups",type:"overdue_followups",title:"Overdue Follow-ups",description:`${g.length} contacts in Follow Up status for more than 7 days`,count:g.length,severity:g.length>5?"critical":"high",actionUrl:"/contacts?filter=overdue_followup",createdAt:i});const v=n.filter(C=>C.prioritas==="Urgent"&&C.statusKontak!=="In Progress"&&C.statusKontak!=="Completed");v.length>0&&l.push({id:"urgent_pending",type:"urgent_pending",title:"Urgent Contacts Pending",description:`${v.length} urgent priority contacts are not in progress`,count:v.length,severity:"critical",actionUrl:"/contacts?filter=urgent_pending",createdAt:i});const p=new Date(i.getTime()-336*60*60*1e3),S=new Set(t.filter(C=>new Date(C.date)>=p).map(C=>C.contactId)),x=n.filter(C=>C.statusKontak==="In Progress"&&!S.has(C.id));return x.length>0&&l.push({id:"service_gaps",type:"service_gaps",title:"Service Gaps",description:`${x.length} active contacts without service in 14 days`,count:x.length,severity:"medium",actionUrl:"/contacts?filter=service_gaps",createdAt:i}),l.sort((C,T)=>{const y={critical:4,high:3,medium:2,low:1};return y[T.severity]-y[C.severity]})}catch(n){throw console.error("Error generating alerts:",n),new Error("Failed to generate alerts")}}async calculateTrends(){try{const n=Ke.getContacts(),t=Wt.getAllServices(),i=[];for(let f=5;f>=0;f--){const h=new Date;h.setMonth(h.getMonth()-f);const g=new Date(h.getFullYear(),h.getMonth(),1),v=new Date(h.getFullYear(),h.getMonth()+1,0),p=n.filter(y=>{const _=new Date(y.createdAt);return _>=g&&_<=v}).length,S=new Date(h.getFullYear(),h.getMonth()-1,1),x=new Date(h.getFullYear(),h.getMonth(),0),C=n.filter(y=>{const _=new Date(y.createdAt);return _>=S&&_<=x}).length,T=C>0?Math.round((p-C)/C*100):p>0?100:0;i.push({month:h.toISOString().slice(0,7),count:p,growth:T})}const l=[];for(let f=29;f>=0;f--){const h=new Date;h.setDate(h.getDate()-f);const g=h.toISOString().split("T")[0],v=t.filter(S=>S.date===g),p=Math.round(v.reduce((S,x)=>S+x.duration,0)/60*100)/100;l.push({date:g,serviceHours:p,sessionCount:v.length})}const u=[];for(let f=5;f>=0;f--){const h=new Date;h.setMonth(h.getMonth()-f),u.push({month:h.toISOString().slice(0,7),newToProgress:3,progressToComplete:7})}return{contactCreationTrend:i,serviceActivityTrend:l,statusProgressionTrend:u}}catch(n){throw console.error("Error calculating trends:",n),new Error("Failed to calculate trends")}}async getDashboardData(n={type:"month"}){try{const[t,i,l,u,f,h]=await Promise.all([this.calculateContactMetrics(n),this.calculateServiceMetrics(n),this.calculateContactDistribution(),this.calculateTeamPerformance(n),this.calculateTrends(),this.generateAlerts()]);return{contactMetrics:t,serviceMetrics:i,contactDistribution:l,teamMetrics:u,trends:f,alerts:h,isLoading:!1,error:null,lastUpdated:new Date}}catch(t){throw console.error("Error getting dashboard data:",t),t}}}const AN=new NN,DN=(a={type:"month"})=>{const[n,t]=G.useState({contactMetrics:{newContactsThisMonth:0,newContactsGrowth:0,conversionRate:0,activeContacts:0,urgentContacts:0,totalContacts:0},serviceMetrics:{totalServiceHoursThisMonth:0,serviceHoursGrowth:0,activeServiceDays:0,averageServiceTimePerContact:0,serviceCoverage:0,totalServiceSessions:0},contactDistribution:{byStatus:[],byPriority:[],bySource:[],byProvince:[]},teamMetrics:{mostActiveUser:{userId:"",username:"N/A",serviceHours:0},topContactCreator:{userId:"",username:"N/A",contactsCreated:0},userEfficiency:[]},trends:{contactCreationTrend:[],serviceActivityTrend:[],statusProgressionTrend:[]},alerts:[],isLoading:!0,error:null,lastUpdated:new Date}),[i,l]=G.useState(!1),[u,f]=G.useState(0),h=G.useMemo(()=>a,[a.type,a.startDate?.getTime(),a.endDate?.getTime()]),g=G.useCallback(async(S=!0)=>{try{S?t(C=>({...C,isLoading:!0,error:null})):l(!0);const x=await AN.getDashboardData(h);t(x),f(0)}catch(x){console.error("Error fetching dashboard data:",x);const C=x instanceof Error?x.message:"Failed to load dashboard data";t(T=>({...T,isLoading:!1,error:C}))}finally{l(!1)}},[h]),v=G.useCallback(async()=>{u<3&&(f(S=>S+1),await g())},[g,u]),p=G.useCallback(async()=>{await g(!1)},[g]);return G.useEffect(()=>{g()},[g]),G.useEffect(()=>{const S=setInterval(()=>{!n.isLoading&&!i&&p()},3e5);return()=>clearInterval(S)},[p,n.isLoading,i]),{...n,isRefreshing:i,retryCount:u,refresh:p,retry:v,canRetry:u<3}},MN=(a={type:"month"})=>{const[n,t]=G.useState(a),i=G.useCallback(f=>{t(f)},[]),l=G.useCallback(f=>{t({type:f})},[]),u=G.useCallback((f,h)=>{t({type:"custom",startDate:f,endDate:h})},[]);return{timeRange:n,updateTimeRange:i,setPresetRange:l,setCustomRange:u}},jN=({metrics:a,isLoading:n,onCardClick:t})=>{const i=u=>{t&&t(u)},l=u=>{const f=u>=0,h=f?"":"",g=f?"positive":"negative";return o.jsxs("span",{className:`growth ${g}`,children:[h," ",Math.abs(u),"%"]})};return n?o.jsxs("div",{className:"contact-pipeline-card loading",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("div",{className:"skeleton-text title"}),o.jsx("div",{className:"skeleton-icon"})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]})]})]}):o.jsxs("div",{className:"contact-pipeline-card",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("h3",{children:"Contact Pipeline"}),o.jsx("span",{className:"card-icon",role:"img","aria-label":"Contacts",children:""})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item clickable",onClick:()=>i("new_contacts"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&i("new_contacts")},"aria-label":`New contacts this month: ${a.newContactsThisMonth}`,children:[o.jsx("span",{className:"metric-label",children:"New Contacts This Month"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.newContactsThisMonth}),l(a.newContactsGrowth)]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>i("conversion_rate"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&i("conversion_rate")},"aria-label":`Conversion rate: ${a.conversionRate}%`,children:[o.jsx("span",{className:"metric-label",children:"Conversion Rate"}),o.jsxs("div",{className:"metric-value",children:[o.jsxs("span",{className:"value",children:[a.conversionRate,"%"]}),o.jsx("div",{className:"conversion-bar",children:o.jsx("div",{className:"conversion-fill",style:{width:`${Math.min(a.conversionRate,100)}%`}})})]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>i("active_contacts"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&i("active_contacts")},"aria-label":`Active contacts: ${a.activeContacts}`,children:[o.jsx("span",{className:"metric-label",children:"Active Contacts"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.activeContacts}),o.jsx("span",{className:"metric-subtitle",children:"In Progress + Follow Up"})]})]}),o.jsxs("div",{className:`metric-item urgent clickable ${a.urgentContacts>0?"has-urgent":""}`,onClick:()=>i("urgent_contacts"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&i("urgent_contacts")},"aria-label":`Urgent contacts: ${a.urgentContacts}`,children:[o.jsxs("span",{className:"metric-label",children:[o.jsx("span",{className:"urgent-icon",children:""}),"Urgent Contacts"]}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.urgentContacts}),a.urgentContacts>0&&o.jsx("span",{className:"urgent-badge",children:"Needs Attention"})]})]})]}),o.jsx("div",{className:"card-footer",children:o.jsxs("div",{className:"total-contacts",children:[o.jsx("span",{className:"total-label",children:"Total Contacts:"}),o.jsx("span",{className:"total-value",children:a.totalContacts})]})})]})},kN=({metrics:a,isLoading:n,onCardClick:t})=>{const i=f=>{t&&t(f)},l=f=>{const h=f>=0,g=h?"":"",v=h?"positive":"negative";return o.jsxs("span",{className:`growth ${v}`,children:[g," ",Math.abs(f),"%"]})},u=f=>{if(f<60)return`${f}min`;const h=Math.floor(f/60),g=f%60;return g>0?`${h}h ${g}m`:`${h}h`};return n?o.jsxs("div",{className:"service-performance-card loading",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("div",{className:"skeleton-text title"}),o.jsx("div",{className:"skeleton-icon"})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]})]})]}):o.jsxs("div",{className:"service-performance-card",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("h3",{children:"Service Performance"}),o.jsx("span",{className:"card-icon",role:"img","aria-label":"Performance",children:""})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item clickable",onClick:()=>i("service_hours"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&i("service_hours")},"aria-label":`Service hours this month: ${a.totalServiceHoursThisMonth} hours`,children:[o.jsx("span",{className:"metric-label",children:"Service Hours This Month"}),o.jsxs("div",{className:"metric-value",children:[o.jsxs("span",{className:"value",children:[a.totalServiceHoursThisMonth,"h"]}),l(a.serviceHoursGrowth)]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>i("active_days"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&i("active_days")},"aria-label":`Active service days: ${a.activeServiceDays} days`,children:[o.jsx("span",{className:"metric-label",children:"Active Service Days"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.activeServiceDays}),o.jsx("span",{className:"metric-subtitle",children:"Days with activity"})]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>i("avg_time"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&i("avg_time")},"aria-label":`Average service time per contact: ${u(a.averageServiceTimePerContact)}`,children:[o.jsx("span",{className:"metric-label",children:"Avg Service Time"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:u(a.averageServiceTimePerContact)}),o.jsx("span",{className:"metric-subtitle",children:"Per contact"})]})]}),o.jsxs("div",{className:"metric-item coverage clickable",onClick:()=>i("coverage"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&i("coverage")},"aria-label":`Service coverage: ${a.serviceCoverage}%`,children:[o.jsxs("span",{className:"metric-label",children:[o.jsx("span",{className:"coverage-icon",children:""}),"Service Coverage"]}),o.jsxs("div",{className:"metric-value",children:[o.jsxs("span",{className:"value",children:[a.serviceCoverage,"%"]}),o.jsx("div",{className:"coverage-bar",children:o.jsx("div",{className:"coverage-fill",style:{width:`${Math.min(a.serviceCoverage,100)}%`}})})]})]})]}),o.jsx("div",{className:"card-footer",children:o.jsxs("div",{className:"session-info",children:[o.jsxs("div",{className:"session-stat",children:[o.jsx("span",{className:"session-label",children:"Total Sessions:"}),o.jsx("span",{className:"session-value",children:a.totalServiceSessions})]}),o.jsxs("div",{className:"session-stat",children:[o.jsx("span",{className:"session-label",children:"Avg per Day:"}),o.jsx("span",{className:"session-value",children:a.activeServiceDays>0?Math.round(a.totalServiceSessions/a.activeServiceDays*10)/10:0})]})]})})]})},wv=({className:a,onNavigate:n})=>{const{currentUser:t}=Vt(),{timeRange:i,setPresetRange:l,setCustomRange:u}=MN(),f=DN(i),h=G.useMemo(()=>$b(f,t),[f,t]),[g,v]=G.useState(!1),[p,S]=G.useState(""),[x,C]=G.useState(""),T=N=>{N==="custom"?v(!0):(v(!1),l(N))},y=()=>{p&&x&&(u(new Date(p),new Date(x)),v(!1))},_=N=>{if(n)switch(N){case"new_contacts":n("contacts",{dateRange:i,filter:"new_this_month"});break;case"conversion_rate":n("contacts",{statusFilter:["Completed"],showConversionAnalysis:!0});break;case"active_contacts":n("contacts",{statusFilter:["In Progress","Follow Up"]});break;case"urgent_contacts":n("contacts",{priorityFilter:["Urgent"],statusFilter:["New Contact","In Progress","Follow Up"]});break;default:n("contacts")}},w=N=>{if(n)switch(N){case"service_hours":n("service-tracking",{dateRange:i,view:"hours_analysis"});break;case"active_days":n("service-tracking",{dateRange:i,view:"daily_activity"});break;case"avg_time":n("service-tracking",{view:"efficiency_analysis"});break;case"coverage":n("service-tracking",{view:"coverage_analysis"});break;default:n("service-tracking")}},k=N=>{if(n)switch(N){case"stale_contacts":n("contacts",{filter:"stale",daysInactive:30});break;case"overdue_followups":n("contacts",{statusFilter:["Follow Up"],filter:"overdue",daysOverdue:7});break;case"urgent_pending":n("contacts",{priorityFilter:["Urgent"],statusFilter:["New Contact","Follow Up"]});break;case"service_gaps":n("contacts",{statusFilter:["In Progress"],filter:"no_recent_service",daysWithoutService:14});break;default:n("contacts")}},M=N=>new Intl.DateTimeFormat("id-ID",{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}).format(N);return h.error?o.jsx("div",{className:`dashboard ${a||""}`,children:o.jsx("div",{className:"dashboard-error",children:o.jsxs("div",{className:"error-content",children:[o.jsx("h2",{children:" Error Loading Dashboard"}),o.jsx("p",{children:h.error}),h.canRetry&&o.jsxs("button",{onClick:h.retry,className:"btn btn-primary",children:["Retry (",3-h.retryCount," attempts left)"]})]})})}):o.jsxs("div",{className:`dashboard ${a||""}`,children:[o.jsxs("div",{className:"dashboard-header",children:[o.jsxs("div",{className:"header-content",children:[o.jsxs("div",{className:"welcome-section",children:[o.jsx("h1",{children:"Dashboard"}),o.jsxs("p",{children:["Welcome back, ",t?.username||"User","!"]}),!h.isLoading&&o.jsxs("span",{className:"last-updated",children:["Last updated: ",M(h.lastUpdated),h.isRefreshing&&o.jsx("span",{className:"refreshing",children:"  Refreshing..."})]})]}),o.jsxs("div",{className:"header-controls",children:[o.jsxs("div",{className:"time-range-selector",children:[o.jsx("label",{htmlFor:"timeRange",children:"Time Period:"}),o.jsxs("select",{id:"timeRange",value:i.type,onChange:N=>T(N.target.value),disabled:h.isLoading||h.isRefreshing,children:[o.jsx("option",{value:"today",children:"Today"}),o.jsx("option",{value:"week",children:"Last Week"}),o.jsx("option",{value:"month",children:"Last Month"}),o.jsx("option",{value:"quarter",children:"Last Quarter"}),o.jsx("option",{value:"year",children:"Last Year"}),o.jsx("option",{value:"custom",children:"Custom Range"})]}),h.isRefreshing&&o.jsx("span",{className:"loading-indicator",children:"Updating..."})]}),o.jsx("button",{onClick:h.refresh,disabled:h.isLoading||h.isRefreshing,className:"refresh-btn",title:"Refresh Dashboard",children:h.isRefreshing?"":""})]})]}),g&&o.jsxs("div",{className:"custom-date-picker",children:[o.jsxs("div",{className:"date-inputs",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"startDate",children:"Start Date:"}),o.jsx("input",{id:"startDate",type:"date",value:p,onChange:N=>S(N.target.value),max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"endDate",children:"End Date:"}),o.jsx("input",{id:"endDate",type:"date",value:x,onChange:N=>C(N.target.value),min:p,max:new Date().toISOString().split("T")[0]})]})]}),o.jsxs("div",{className:"date-actions",children:[o.jsx("button",{onClick:()=>v(!1),className:"btn btn-secondary",children:"Cancel"}),o.jsx("button",{onClick:y,disabled:!p||!x,className:"btn btn-primary",children:"Apply"})]})]})]}),o.jsx("div",{className:"dashboard-content",children:h.isLoading?o.jsx("div",{className:"dashboard-loading",children:o.jsxs("div",{className:"loading-grid",children:[o.jsxs("div",{className:"hero-metrics-skeleton",children:[o.jsx("div",{className:"skeleton-card large"}),o.jsx("div",{className:"skeleton-card large"})]}),o.jsxs("div",{className:"secondary-metrics-skeleton",children:[o.jsx("div",{className:"skeleton-card medium"}),o.jsx("div",{className:"skeleton-card medium"})]}),o.jsxs("div",{className:"charts-skeleton",children:[o.jsx("div",{className:"skeleton-card chart"}),o.jsx("div",{className:"skeleton-card chart"})]}),o.jsxs("div",{className:"alerts-skeleton",children:[o.jsx("div",{className:"skeleton-card small"}),o.jsx("div",{className:"skeleton-card small"}),o.jsx("div",{className:"skeleton-card small"})]})]})}):o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("section",{className:"hero-metrics-section",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Key Performance Indicators"})}),o.jsxs("div",{className:"hero-metrics-grid",children:[o.jsx(jN,{metrics:h.contactMetrics,isLoading:h.isLoading,onCardClick:_}),o.jsx(kN,{metrics:h.serviceMetrics,isLoading:h.isLoading,onCardClick:w})]})]}),h.alerts.length>0&&o.jsxs("section",{className:"alerts-section",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h2",{children:"Action Required"}),o.jsxs("span",{className:"alert-count",children:[h.alerts.length," items"]})]}),o.jsx("div",{className:"alerts-grid",children:h.alerts.slice(0,4).map(N=>o.jsxs("div",{className:`alert-card ${N.severity}`,children:[o.jsxs("div",{className:"alert-header",children:[o.jsx("span",{className:"alert-title",children:N.title}),o.jsx("span",{className:"alert-count",children:N.count})]}),o.jsx("p",{className:"alert-description",children:N.description}),o.jsx("button",{className:"alert-action",onClick:()=>k(N.type),children:"View Details"})]},N.id))})]}),o.jsxs("section",{className:"coming-soon-section",children:[o.jsxs("div",{className:"coming-soon-card",children:[o.jsx("h3",{children:" Advanced Analytics"}),o.jsx("p",{children:"Detailed charts and trend analysis coming soon..."})]}),o.jsxs("div",{className:"coming-soon-card",children:[o.jsx("h3",{children:" Team Performance"}),o.jsx("p",{children:"Individual and team metrics coming soon..."})]})]})]})})]})},UN=({onFilterChange:a,initialFilters:n,contacts:t=[],users:i=[]})=>{const{currentUser:l}=Vt(),[u,f]=G.useState({period:"month",...n}),[h,g]=G.useState(!1);G.useEffect(()=>{const _=new Date;let w,k=new Date(_);switch(u.period){case"day":w=new Date(_),w.setHours(0,0,0,0),k.setHours(23,59,59,999);break;case"week":w=new Date(_),w.setDate(_.getDate()-_.getDay()),w.setHours(0,0,0,0),k=new Date(w),k.setDate(w.getDate()+6),k.setHours(23,59,59,999);break;case"month":w=new Date(_.getFullYear(),_.getMonth(),1),k=new Date(_.getFullYear(),_.getMonth()+1,0),k.setHours(23,59,59,999);break;case"quarter":const N=Math.floor(_.getMonth()/3);w=new Date(_.getFullYear(),N*3,1),k=new Date(_.getFullYear(),N*3+3,0),k.setHours(23,59,59,999);break;case"year":w=new Date(_.getFullYear(),0,1),k=new Date(_.getFullYear(),11,31),k.setHours(23,59,59,999);break;case"custom":w=u.startDate||new Date(_.getFullYear(),_.getMonth(),1),k=u.endDate||new Date,g(!0);break;default:w=new Date(_.getFullYear(),_.getMonth(),1),k=new Date}const M={...u,startDate:w,endDate:k};a(M)},[u.period,u.startDate,u.endDate,u.contactId,u.userId,u.serviceType]);const v=_=>{f(w=>({...w,period:_})),g(_==="custom")},p=_=>{f(w=>({...w,contactId:_||void 0}))},S=_=>{f(w=>({...w,userId:_||void 0}))},x=(_,w)=>{if(w){const k=new Date(w);f(M=>({...M,[_]:k}))}},C=_=>_.toISOString().split("T")[0],T=()=>{if(!u.startDate||!u.endDate)return"";const _=u.startDate.toLocaleDateString("id-ID"),w=u.endDate.toLocaleDateString("id-ID");return u.period==="day"?_:`${_} - ${w}`},y=()=>{f({period:"month"}),g(!1)};return o.jsxs("div",{className:"service-filter",children:[o.jsxs("div",{className:"filter-header",children:[o.jsx("h4",{children:"Filter Pelayanan"}),o.jsx("button",{onClick:y,className:"clear-filters-btn",children:"Reset"})]}),o.jsxs("div",{className:"filter-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Periode Waktu:"}),o.jsxs("select",{value:u.period,onChange:_=>v(_.target.value),className:"filter-select",children:[o.jsx("option",{value:"day",children:"Hari Ini"}),o.jsx("option",{value:"week",children:"Minggu Ini"}),o.jsx("option",{value:"month",children:"Bulan Ini"}),o.jsx("option",{value:"quarter",children:"Kuartal Ini"}),o.jsx("option",{value:"year",children:"Tahun Ini"}),o.jsx("option",{value:"custom",children:"Custom Range"})]})]}),t.length>0&&o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Contact:"}),o.jsxs("select",{value:u.contactId||"",onChange:_=>p(_.target.value),className:"filter-select",children:[o.jsx("option",{value:"",children:"Semua Contact"}),t.map(_=>o.jsx("option",{value:_.id,children:_.nama},_.id))]})]}),i.length>0&&o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"User:"}),Bf(l)?o.jsxs("select",{value:u.userId||"",onChange:_=>S(_.target.value),className:"filter-select",children:[o.jsx("option",{value:"",children:"Semua User"}),i.map(_=>o.jsx("option",{value:_.username,children:_.username},_.username))]}):o.jsxs("div",{className:"filter-select locked-display",children:[o.jsx("span",{className:"locked-user-text",children:l?.username}),o.jsx("span",{className:"lock-icon-inline",children:""})]})]})]}),h&&o.jsxs("div",{className:"filter-row custom-dates",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Tanggal Mulai:"}),o.jsx("input",{type:"date",value:u.startDate?C(u.startDate):"",onChange:_=>x("startDate",_.target.value),className:"filter-input"})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Tanggal Akhir:"}),o.jsx("input",{type:"date",value:u.endDate?C(u.endDate):"",onChange:_=>x("endDate",_.target.value),className:"filter-input"})]})]}),o.jsxs("div",{className:"filter-summary",children:[o.jsx("span",{className:"summary-label",children:"Periode:"}),o.jsx("span",{className:"summary-value",children:T()}),u.contactId&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"summary-separator",children:""}),o.jsxs("span",{className:"summary-value",children:["Contact: ",t.find(_=>_.id===u.contactId)?.nama]})]}),u.userId&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"summary-separator",children:""}),o.jsxs("span",{className:"summary-value",children:["User: ",u.userId]})]})]})]})},ON=({filters:a})=>{const{currentUser:n}=Vt(),[t,i]=G.useState(null),[l,u]=G.useState(!1),[f,h]=G.useState([]),[g,v]=G.useState("summary");G.useEffect(()=>{const C=Ke.getContacts();h(C)},[]),G.useEffect(()=>{if(!(!a.startDate||!a.endDate)){u(!0);try{let C=Wt.getAllServices();C=fp(C,n);let y=C.filter(D=>{const z=new Date(D.date);return z>=a.startDate&&z<=a.endDate});a.contactId&&(y=y.filter(D=>D.contactId===a.contactId)),a.userId&&(y=y.filter(D=>D.userId===a.userId)),a.serviceType&&(y=y.filter(D=>D.serviceType?.toLowerCase().includes(a.serviceType.toLowerCase())||D.description?.toLowerCase().includes(a.serviceType.toLowerCase())));const _=y.length,w=y.reduce((D,z)=>D+z.duration,0),M=new Set(y.map(D=>D.date)).size,K=new Set(y.map(D=>D.contactId)).size,J=_>0?w/_:0,B=new Map,Z=new Map,L=new Map;y.forEach(D=>{B.has(D.contactId)||B.set(D.contactId,[]),B.get(D.contactId).push(D),Z.has(D.userId)||Z.set(D.userId,[]),Z.get(D.userId).push(D),L.has(D.date)||L.set(D.date,[]),L.get(D.date).push(D)}),i({services:y,totalServices:_,totalDuration:w,totalServiceDays:M,contactsServed:K,averageDurationPerService:J,servicesByContact:B,servicesByUser:Z,servicesByDate:L})}catch(C){console.error("Error generating service report:",C)}finally{u(!1)}}},[a]);const p=C=>{if(C===0)return"Chat";if(C<60)return`${C} menit`;const T=Math.floor(C/60),y=C%60;return y>0?`${T}j ${y}m`:`${T} jam`},S=C=>f.find(y=>y.id===C)?.nama||"Unknown Contact",x=()=>{if(!a.startDate||!a.endDate)return"";const C=a.startDate.toLocaleDateString("id-ID"),T=a.endDate.toLocaleDateString("id-ID");return a.period==="day"?`Hari: ${C}`:`Periode: ${C} - ${T}`};return l?o.jsx("div",{className:"service-report loading",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Memuat laporan..."})]})}):t?o.jsxs("div",{className:"service-report",children:[o.jsxs("div",{className:"report-header",children:[o.jsxs("div",{className:"report-title",children:[o.jsx("h3",{children:"Laporan Pelayanan"}),o.jsx("p",{className:"report-period",children:x()})]}),o.jsxs("div",{className:"view-mode-selector",children:[o.jsx("button",{className:`view-btn ${g==="summary"?"active":""}`,onClick:()=>v("summary"),children:"Ringkasan"}),o.jsx("button",{className:`view-btn ${g==="detailed"?"active":""}`,onClick:()=>v("detailed"),children:"Detail"}),o.jsx("button",{className:`view-btn ${g==="calendar"?"active":""}`,onClick:()=>v("calendar"),children:"Kalender"})]})]}),o.jsxs("div",{className:"report-metrics",children:[o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:t.totalServices}),o.jsx("div",{className:"metric-label",children:"Total Pelayanan"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:p(t.totalDuration)}),o.jsx("div",{className:"metric-label",children:"Total Waktu"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:t.totalServiceDays}),o.jsx("div",{className:"metric-label",children:"Hari Pelayanan"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:t.contactsServed}),o.jsx("div",{className:"metric-label",children:"Contact Dilayani"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:p(Math.round(t.averageDurationPerService))}),o.jsx("div",{className:"metric-label",children:"Rata-rata per Pelayanan"})]})]}),g==="summary"&&o.jsxs("div",{className:"report-content",children:[o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Pelayanan per Contact"}),o.jsx("div",{className:"contact-services-list",children:Array.from(t.servicesByContact.entries()).sort(([,C],[,T])=>T.length-C.length).slice(0,10).map(([C,T])=>{const y=T.reduce((_,w)=>_+w.duration,0);return o.jsxs("div",{className:"contact-service-item",children:[o.jsxs("div",{className:"contact-info",children:[o.jsx("span",{className:"contact-name",children:S(C)}),o.jsxs("span",{className:"service-count",children:[T.length," pelayanan"]})]}),o.jsx("div",{className:"service-duration",children:p(y)})]},C)})})]}),o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Pelayanan per User"}),o.jsx("div",{className:"user-services-list",children:Array.from(t.servicesByUser.entries()).sort(([,C],[,T])=>T.length-C.length).map(([C,T])=>{const y=T.reduce((_,w)=>_+w.duration,0);return o.jsxs("div",{className:"user-service-item",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("span",{className:"user-name",children:C}),o.jsxs("span",{className:"service-count",children:[T.length," pelayanan"]})]}),o.jsx("div",{className:"service-duration",children:p(y)})]},C)})})]})]}),g==="detailed"&&o.jsx("div",{className:"report-content",children:o.jsxs("div",{className:"detailed-services",children:[o.jsxs("h4",{children:["Detail Pelayanan (",t.services.length,")"]}),o.jsxs("div",{className:"services-table",children:[o.jsxs("div",{className:"table-header",children:[o.jsx("div",{className:"col-date",children:"Tanggal"}),o.jsx("div",{className:"col-contact",children:"Contact"}),o.jsx("div",{className:"col-user",children:"User"}),o.jsx("div",{className:"col-duration",children:"Durasi"}),o.jsx("div",{className:"col-description",children:"Deskripsi"})]}),o.jsx("div",{className:"table-body",children:t.services.sort((C,T)=>new Date(T.date).getTime()-new Date(C.date).getTime()).map(C=>o.jsxs("div",{className:"table-row",children:[o.jsx("div",{className:"col-date",children:zn(new Date(C.date))}),o.jsx("div",{className:"col-contact",children:S(C.contactId)}),o.jsx("div",{className:"col-user",children:C.userId}),o.jsx("div",{className:"col-duration",children:p(C.duration)}),o.jsx("div",{className:"col-description",children:C.description||"-"})]},C.id))})]})]})}),g==="calendar"&&o.jsx("div",{className:"report-content",children:o.jsxs("div",{className:"calendar-view",children:[o.jsx("h4",{children:"Kalender Pelayanan"}),o.jsx("div",{className:"calendar-services",children:Array.from(t.servicesByDate.entries()).sort(([C],[T])=>new Date(T).getTime()-new Date(C).getTime()).map(([C,T])=>{const y=T.reduce((_,w)=>_+w.duration,0);return o.jsxs("div",{className:"calendar-day-item",children:[o.jsxs("div",{className:"day-header",children:[o.jsx("span",{className:"day-date",children:zn(new Date(C))}),o.jsxs("span",{className:"day-summary",children:[T.length," pelayanan  ",p(y)]})]}),o.jsx("div",{className:"day-services",children:T.map(_=>o.jsxs("div",{className:"day-service-item",children:[o.jsx("span",{className:"service-contact",children:S(_.contactId)}),o.jsxs("span",{className:"service-user",children:["by ",_.userId]}),o.jsx("span",{className:"service-duration",children:p(_.duration)})]},_.id))})]},C)})})]})}),t.services.length===0&&o.jsx("div",{className:"no-data",children:o.jsx("p",{children:"Tidak ada data pelayanan untuk periode yang dipilih"})})]}):o.jsx("div",{className:"service-report empty",children:o.jsx("p",{children:"Pilih filter untuk melihat laporan pelayanan"})})},IN=()=>{const{currentUser:a}=Vt(),[n,t]=G.useState("today"),[i,l]=G.useState(()=>hp(a)),[,u]=G.useState(0);US.useEffect(()=>{u(w=>w+1)},[a?.role,a?.username]);const f=Ke.getUsers(),h=Lf(f,a),g=Bt.getSessions(),v=G.useMemo(()=>{let w=g.filter(N=>N.status==="completed");w=dp(w,a),a?.username==="editor"?w=w.filter(N=>N.userId==="editor"):a?.role==="Admin"&&i!=="all"&&(w=w.filter(N=>N.userId===i));const k=new Date,M=k.toISOString().split("T")[0];switch(n){case"today":w=w.filter(J=>J.serviceDate===M);break;case"week":const N=new Date(k.getTime()-10080*60*1e3);w=w.filter(J=>new Date(J.startTime)>=N);break;case"month":const K=new Date(k.getTime()-720*60*60*1e3);w=w.filter(J=>new Date(J.startTime)>=K);break}return w.sort((N,K)=>K.startTime.getTime()-N.startTime.getTime())},[g,n,i]),p=G.useMemo(()=>{const w=v.length,k=v.reduce((K,J)=>K+(J.duration||0),0),M=new Set(v.map(K=>K.contactId)).size,N=w>0?Math.round(k/w):0;return{totalSessions:w,totalTime:k,uniqueContacts:M,averageTime:N}},[v]),S=G.useMemo(()=>{const w=v.reduce((k,M)=>{const N=M.serviceDate;return k[N]||(k[N]=[]),k[N].push(M),k},{});return Object.entries(w).sort(([k],[M])=>M.localeCompare(k))},[v]),x=w=>{const k=Math.floor(w/3600),M=Math.floor(w%3600/60),N=w%60;return k>0?`${k}h ${M}m ${N}s`:`${M}m ${N}s`},C=w=>new Intl.DateTimeFormat("id-ID",{hour:"2-digit",minute:"2-digit"}).format(w),T=w=>{const k=new Date(w);return new Intl.DateTimeFormat("id-ID",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}).format(k)},y=w=>Ke.getContactById(w)?.nama||"Unknown Contact",_=w=>h.find(M=>M.username===w)?.username||w;return o.jsxs("div",{className:"service-session-report",children:[o.jsxs("div",{className:"report-header",children:[o.jsx("h2",{children:" Service Session Report"}),o.jsx("p",{children:"Laporan detail aktivitas pelayanan dan durasi waktu"}),o.jsxs("div",{className:"permission-indicator",children:[o.jsx("span",{className:"permission-icon",children:a?.role==="Admin"?"":""}),o.jsx("span",{className:"permission-text",children:a?.role==="Admin"?"Admin: Akses semua data user":`Editor: Hanya data ${a?.username}`})]}),o.jsxs("div",{className:"integration-info",children:[o.jsx("span",{className:"info-icon",children:""}),o.jsx("span",{children:"Timer sessions otomatis tersimpan ke Log Service dan Service Calendar"})]})]}),o.jsxs("div",{className:"report-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Periode:"}),o.jsxs("select",{value:n,onChange:w=>t(w.target.value),className:"filter-select",children:[o.jsx("option",{value:"today",children:"Hari Ini"}),o.jsx("option",{value:"week",children:"7 Hari Terakhir"}),o.jsx("option",{value:"month",children:"30 Hari Terakhir"}),o.jsx("option",{value:"all",children:"Semua Waktu"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"User:"}),Bf(a)?o.jsxs("select",{value:i,onChange:w=>l(w.target.value),className:"filter-select",children:[o.jsx("option",{value:"all",children:"Semua User"}),h.map(w=>o.jsxs("option",{value:w.username,children:[w.username," ",w.username===a?.username?"(You)":""]},w.username))]}):o.jsxs("div",{className:"filter-select locked-display",children:[o.jsxs("span",{className:"locked-user-text",children:[a?.username," (You)"]}),o.jsx("span",{className:"lock-icon-inline",children:""})]})]})]}),o.jsxs("div",{className:"report-stats",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:p.totalSessions}),o.jsx("div",{className:"stat-label",children:"Total Sesi"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:x(p.totalTime)}),o.jsx("div",{className:"stat-label",children:"Total Waktu"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:p.uniqueContacts}),o.jsx("div",{className:"stat-label",children:"Contact Dilayani"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:x(p.averageTime)}),o.jsx("div",{className:"stat-label",children:"Rata-rata Durasi"})]})]}),o.jsx("div",{className:"sessions-report",children:S.length===0?o.jsxs("div",{className:"no-sessions",children:[o.jsx("div",{className:"no-sessions-icon",children:""}),o.jsx("h3",{children:"Tidak ada data sesi"}),o.jsx("p",{children:"Belum ada sesi pelayanan untuk periode yang dipilih"})]}):S.map(([w,k])=>o.jsxs("div",{className:"date-group",children:[o.jsxs("div",{className:"date-header",children:[o.jsx("h3",{children:T(w)}),o.jsxs("div",{className:"date-stats",children:[o.jsxs("span",{children:[k.length," sesi"]}),o.jsx("span",{children:x(k.reduce((M,N)=>M+(N.duration||0),0))})]})]}),o.jsx("div",{className:"sessions-list",children:k.map(M=>o.jsxs("div",{className:"session-card",children:[o.jsxs("div",{className:"session-header",children:[o.jsxs("div",{className:"session-contact",children:[o.jsx("strong",{children:y(M.contactId)}),o.jsxs("span",{className:"session-user",children:["oleh ",_(M.userId)]})]}),o.jsx("div",{className:"session-duration",children:x(M.duration||0)})]}),o.jsx("div",{className:"session-details",children:o.jsxs("div",{className:"session-time",children:[o.jsx("span",{className:"time-start",children:C(M.startTime)}),o.jsx("span",{className:"time-separator",children:""}),o.jsx("span",{className:"time-end",children:M.endTime?C(M.endTime):"Ongoing"})]})})]},M.id))})]},w))})]})},RN=()=>{const{currentUser:a}=Vt(),[n,t]=G.useState("sessions"),[i,l]=G.useState({period:"month"}),[u,f]=G.useState([]),[h,g]=G.useState([]);G.useEffect(()=>{const p=Ke.getContacts();f(p);const S=Ke.getUsers(),x=Lf(S,a);g(x)},[a]);const v=p=>{l(p)};return o.jsxs("div",{className:"service-tracking",children:[o.jsxs("div",{className:"service-tracking-header",children:[o.jsxs("div",{className:"header-content",children:[o.jsx("h1",{children:"Service Tracking"}),o.jsx("p",{children:"Monitor dan analisis pelayanan yang diberikan kepada contacts"}),o.jsxs("div",{className:"unified-system-info",children:[o.jsx("span",{className:"system-icon",children:""}),o.jsx("span",{children:"Unified System: Timer Sessions, Manual Log Service, dan Service Calendar terintegrasi"})]})]}),o.jsxs("div",{className:"service-tabs",children:[o.jsx("button",{onClick:()=>t("sessions"),className:`tab-btn ${n==="sessions"?"active":""}`,children:" Service Sessions"}),o.jsx("button",{onClick:()=>t("manual"),className:`tab-btn ${n==="manual"?"active":""}`,children:" Manual Reports"})]})]}),o.jsx("div",{className:"service-tracking-content",children:n==="sessions"?o.jsx(IN,{}):o.jsxs(o.Fragment,{children:[o.jsx(UN,{onFilterChange:v,initialFilters:i,contacts:u,users:h}),o.jsx(ON,{filters:i})]})})]})},FN=({onReturnToService:a})=>{const[n,t]=G.useState(null),[i,l]=G.useState(null),[u,f]=G.useState(0),[h,g]=G.useState(!1),{currentUser:v}=Vt();G.useEffect(()=>{const y=()=>{if(!v)return;const w=Bt.getActiveSession(v.username);if(w){t(w);const k=Ke.getContactById(w.contactId);l(k);const M=new Date,N=new Date(w.startTime),K=Math.floor((M.getTime()-N.getTime())/1e3);f(K)}else t(null),l(null),f(0)};y();const _=setInterval(y,1e3);return()=>clearInterval(_)},[v]);const p=y=>{const _=Math.floor(y/3600),w=Math.floor(y%3600/60),k=y%60;return _>0?`${_.toString().padStart(2,"0")}:${w.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`:`${w.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`},S=y=>y>3600?"critical":y>1800?"warning":"normal",x=()=>{n&&a(n.contactId)},C=()=>{n&&window.confirm("Apakah Anda yakin ingin mengakhiri pelayanan ini?")&&(Bt.endSession(n.id),t(null),l(null),f(0))};if(!n||!i)return null;const T=S(u);return o.jsxs("div",{className:`active-service-banner ${T} ${h?"minimized":""}`,children:[o.jsxs("div",{className:"banner-content",children:[!h&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"service-info",children:[o.jsxs("div",{className:"service-status",children:[o.jsx("span",{className:"status-indicator",children:""}),o.jsx("span",{className:"status-text",children:"Pelayanan Aktif"})]}),o.jsxs("div",{className:"contact-info",children:[o.jsx("span",{className:"contact-name",children:i.nama}),o.jsx("span",{className:"contact-phone",children:i.nomorTelepon})]}),o.jsxs("div",{className:"service-duration",children:[o.jsx("span",{className:"duration-label",children:"Durasi:"}),o.jsx("span",{className:"duration-time",children:p(u)})]})]}),o.jsxs("div",{className:"banner-actions",children:[o.jsxs("button",{onClick:x,className:"btn btn-primary btn-sm",title:"Kembali ke Service Mode",children:[o.jsx("span",{children:""}),"Kembali ke Pelayanan"]}),o.jsxs("button",{onClick:C,className:"btn btn-danger btn-sm",title:"Akhiri Pelayanan",children:[o.jsx("span",{children:""}),"Akhiri"]})]})]}),o.jsx("button",{onClick:()=>g(!h),className:"minimize-btn",title:h?"Expand Banner":"Minimize Banner",children:h?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"status-indicator-mini",children:""}),o.jsx("span",{className:"duration-mini",children:p(u)}),o.jsx("span",{children:""})]}):o.jsx("span",{children:""})})]}),T==="warning"&&!h&&o.jsx("div",{className:"warning-message",children:" Pelayanan sudah berjalan lebih dari 30 menit"}),T==="critical"&&!h&&o.jsx("div",{className:"critical-message",children:" Pelayanan sudah berjalan lebih dari 1 jam! Pertimbangkan untuk mengakhiri."})]})},LN=()=>{const{filters:a,updateFilter:n}=fs(),[t,i]=G.useState(""),[l,u]=G.useState(""),[f,h]=G.useState(!0),[g,v]=G.useState("");G.useEffect(()=>{a.dateRange?(i(on(a.dateRange.startDate)),u(on(a.dateRange.endDate))):(i(""),u(""))},[a.dateRange]);const p=(_,w)=>{if(!_&&!w)return v(""),h(!0),!0;if(_&&!w)return v("Please select an end date"),h(!1),!1;if(!_&&w)return v("Please select a start date"),h(!1),!1;const k=new Date(_),M=new Date(w);return k>M?(v("Start date must be before end date"),h(!1),!1):k>new Date?(v("Start date cannot be in the future"),h(!1),!1):(v(""),h(!0),!0)},S=_=>{i(_),p(_,l)&&(_&&l?n("dateRange",{startDate:new Date(_),endDate:new Date(l)}):!_&&!l&&n("dateRange",void 0))},x=_=>{u(_),p(t,_)&&(t&&_?n("dateRange",{startDate:new Date(t),endDate:new Date(_)}):!t&&!_&&n("dateRange",void 0))},C=()=>{i(""),u(""),v(""),h(!0),n("dateRange",void 0)},T=_=>{const w=new Date,k=new Date(w.getTime()-_*24*60*60*1e3),M=on(k),N=on(w);i(M),u(N),v(""),h(!0),n("dateRange",{startDate:k,endDate:w})},y=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90},{label:"Last 365 days",days:365}];return o.jsxs("div",{className:"date-range-picker",children:[o.jsxs("div",{className:"date-inputs",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"start-date",children:"From"}),o.jsx("input",{id:"start-date",type:"date",value:t,onChange:_=>S(_.target.value),className:`date-input ${f?"":"error"}`,max:on(new Date)})]}),o.jsx("div",{className:"date-separator",children:"to"}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"end-date",children:"To"}),o.jsx("input",{id:"end-date",type:"date",value:l,onChange:_=>x(_.target.value),className:`date-input ${f?"":"error"}`,max:on(new Date),min:t})]}),(t||l)&&o.jsx("button",{onClick:C,className:"clear-dates-btn",title:"Clear dates",children:""})]}),g&&o.jsx("div",{className:"date-error",children:g}),o.jsxs("div",{className:"date-presets",children:[o.jsx("span",{className:"presets-label",children:"Quick select:"}),o.jsx("div",{className:"preset-buttons",children:y.map(_=>o.jsx("button",{onClick:()=>T(_.days),className:"preset-btn",children:_.label},_.days))})]}),a.dateRange&&o.jsxs("div",{className:"date-summary",children:[o.jsx("span",{className:"summary-label",children:"Selected range:"}),o.jsxs("span",{className:"summary-value",children:[a.dateRange.startDate.toLocaleDateString()," - ",a.dateRange.endDate.toLocaleDateString()]})]})]})},BN=()=>{const{filters:a,updateFilter:n}=fs(),[t,i]=G.useState(!1),l=G.useRef(null),u=a.statusKontak||[];G.useEffect(()=>{const x=C=>{l.current&&!l.current.contains(C.target)&&i(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const f=x=>{const C=u;let T;C.includes(x)?T=C.filter(y=>y!==x):T=[...C,x],n("statusKontak",T.length>0?T:void 0)},h=()=>{n("statusKontak",[...Tr])},g=()=>{n("statusKontak",void 0)},v=x=>({"New Contact":"#e74c3c","In Progress":"#f39c12","Follow Up":"#3498db",Completed:"#27ae60"})[x]||"#95a5a6",p=x=>x,S=()=>u.length===0?"Select status...":u.length===1?p(u[0]):u.length===Tr.length?"All statuses":`${u.length} statuses selected`;return o.jsxs("div",{className:"status-filter",ref:l,children:[o.jsxs("button",{onClick:()=>i(!t),className:`status-select-btn ${t?"open":""} ${u.length>0?"has-selection":""}`,children:[o.jsx("span",{className:"select-text",children:S()}),o.jsx("span",{className:"select-arrow",children:t?"":""})]}),t&&o.jsxs("div",{className:"status-dropdown",children:[o.jsxs("div",{className:"dropdown-header",children:[o.jsx("span",{className:"dropdown-title",children:"Select Status"}),o.jsxs("div",{className:"dropdown-actions",children:[o.jsx("button",{onClick:h,className:"action-btn select-all",disabled:u.length===Tr.length,children:"All"}),o.jsx("button",{onClick:g,className:"action-btn clear-all",disabled:u.length===0,children:"None"})]})]}),o.jsx("div",{className:"status-options",children:Tr.map(x=>o.jsxs("label",{className:`status-option ${u.includes(x)?"selected":""}`,children:[o.jsx("input",{type:"checkbox",checked:u.includes(x),onChange:()=>f(x),className:"status-checkbox"}),o.jsxs("div",{className:"status-info",children:[o.jsx("span",{className:"status-indicator",style:{backgroundColor:v(x)}}),o.jsx("span",{className:"status-name",children:p(x)}),o.jsxs("span",{className:"status-code",children:["(",x,")"]})]})]},x))}),u.length>0&&o.jsx("div",{className:"dropdown-footer",children:o.jsxs("div",{className:"selected-summary",children:[u.length," of ",Tr.length," selected"]})})]}),u.length>0&&o.jsx("div",{className:"selected-status-tags",children:u.map(x=>o.jsxs("span",{className:"status-tag",style:{backgroundColor:v(x)},children:[p(x),o.jsx("button",{onClick:()=>f(x),className:"remove-status-btn",children:""})]},x))})]})},fl=({field:a,placeholder:n="Enter search term...",value:t,debounceMs:i=150,minLength:l=1})=>{const{updateFilter:u}=fs(),[f,h]=G.useState(t),[g,v]=G.useState(!1),p=G.useCallback(GS(y=>{(y.length>=l||y.length===0)&&u(a,y||void 0)},i),[a,u,l,i]);G.useEffect(()=>{g||h(t)},[t,g]);const S=y=>{h(y),p(y)},x=()=>{h(""),u(a,void 0)},C=y=>{y.key==="Enter"&&(y.preventDefault(),u(a,f||void 0)),y.key==="Escape"&&x()},T=y=>({nama:"Name",nomorTelepon:"Phone Number",alamat:"Address",provinsi:"Province",agama:"Religion",alasanMenghubungi:"Reason for Contact",dateRange:"Date Range"})[y]||y.toString();return o.jsxs("div",{className:`text-filter ${g?"focused":""} ${f?"has-value":""}`,children:[o.jsxs("div",{className:"input-container",children:[o.jsx("input",{type:"text",value:f,onChange:y=>S(y.target.value),onFocus:()=>v(!0),onBlur:()=>v(!1),onKeyDown:C,placeholder:n,className:"filter-input","aria-label":`Filter by ${T(a)}`,autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),o.jsxs("div",{className:"input-actions",children:[f&&o.jsx("button",{onClick:x,className:"clear-btn",title:"Clear filter",type:"button",children:""}),o.jsx("div",{className:"search-icon",children:""})]})]}),f&&f.length<l&&o.jsxs("div",{className:"filter-hint",children:["Enter at least ",l," character",l>1?"s":""," to search"]}),f&&f.length>=l&&o.jsxs("div",{className:"filter-status",children:["Filtering by ",T(a).toLowerCase(),': "',f,'"']})]})},bv=({placeholder:a="Search by name or phone number...",className:n=""})=>{const{filters:t,updateFilter:i}=fs(),[l,u]=G.useState(t.globalSearch||""),[f,h]=G.useState(!1),g=G.useRef(void 0),v=G.useCallback(y=>{g.current&&window.clearTimeout(g.current),g.current=window.setTimeout(()=>{const _=y.trim();i("globalSearch",_||void 0)},200)},[i]);G.useEffect(()=>()=>{g.current&&window.clearTimeout(g.current)},[]),G.useEffect(()=>{u(t.globalSearch||"")},[t.globalSearch]);const p=G.useCallback(y=>{if(f)return;const _=y.target.value;u(w=>w===_?w:_),v(_)},[f,v]),S=G.useCallback(()=>{h(!0)},[]),x=G.useCallback(y=>{h(!1);const _=y.currentTarget.value;u(w=>w===_?w:_),v(_)},[v]),C=G.useCallback(()=>{u(""),i("globalSearch",void 0)},[i]),T=G.useCallback(y=>{y.key==="Escape"&&C()},[C]);return o.jsxs("div",{className:`global-search-filter ${n}`,children:[o.jsxs("div",{className:"search-input-container",children:[o.jsx("div",{className:"search-icon",children:""}),o.jsx("input",{type:"text",value:l,onChange:p,onCompositionStart:S,onCompositionEnd:x,onKeyDown:T,placeholder:a,className:"search-input",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),l&&o.jsx("button",{onClick:C,className:"clear-search-btn",type:"button","aria-label":"Clear search",children:""})]}),l&&o.jsx("div",{className:"search-info",children:o.jsxs("span",{className:"search-hint",children:["Searching in: ",o.jsx("strong",{children:"Name"})," and ",o.jsx("strong",{children:"Phone Number"})]})})]})},KN=({isCollapsed:a=!1,onToggle:n})=>{const{filters:t,clearFilters:i,hasActiveFilters:l,filterCount:u,filterSummary:f,applyQuickFilter:h,totalContacts:g,filteredCount:v}=fs(),[p,S]=G.useState("basic"),x=(T,y)=>{h(T,y)},C=[{label:"Recent (24h)",action:()=>x("recent")},{label:"This Week",action:()=>x("thisWeek")},{label:"This Month",action:()=>x("thisMonth")},{label:"New Contact",action:()=>x("byStatus","New Contact")},{label:"In Progress",action:()=>x("byStatus","In Progress")},{label:"Follow Up",action:()=>x("byStatus","Follow Up")},{label:"Completed",action:()=>x("byStatus","Completed")}];return o.jsxs("div",{className:`filter-panel ${a?"collapsed":"expanded"}`,children:[o.jsxs("div",{className:"filter-header",children:[o.jsxs("div",{className:"filter-title",children:[o.jsx("h3",{children:"Filters"}),l&&o.jsxs("span",{className:"filter-count",children:[u," active"]})]}),o.jsxs("div",{className:"filter-actions",children:[l&&o.jsx("button",{onClick:i,className:"clear-filters-btn",children:"Clear All"}),n&&o.jsx("button",{onClick:n,className:"toggle-btn",children:a?"":""})]})]}),!a&&o.jsxs("div",{className:"filter-content",children:[o.jsxs("div",{className:"filter-stats",children:[o.jsxs("span",{className:"results-count",children:["Showing ",v," of ",g," contacts"]}),l&&o.jsx("div",{className:"filter-summary",children:f.map((T,y)=>o.jsx("span",{className:"filter-tag",children:T},y))})]}),o.jsxs("div",{className:"filter-tabs",children:[o.jsx("button",{onClick:()=>S("basic"),className:`tab-btn ${p==="basic"?"active":""}`,children:"Basic"}),o.jsx("button",{onClick:()=>S("advanced"),className:`tab-btn ${p==="advanced"?"active":""}`,children:"Advanced"}),o.jsx("button",{onClick:()=>S("quick"),className:`tab-btn ${p==="quick"?"active":""}`,children:"Quick Filters"})]}),o.jsxs("div",{className:"filter-body",children:[p==="basic"&&o.jsxs("div",{className:"basic-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Search Contacts"}),o.jsx(bv,{placeholder:"Search by name or phone number..."})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Contact Status"}),o.jsx(BN,{})]})]}),p==="advanced"&&o.jsxs("div",{className:"advanced-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Global Search"}),o.jsx(bv,{placeholder:"Search by name or phone number..."})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Date Range"}),o.jsx(LN,{})]}),o.jsxs("div",{className:"filter-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Address"}),o.jsx(fl,{field:"alamat",placeholder:"Search by address...",value:t.alamat||""})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Religion"}),o.jsx(fl,{field:"agama",placeholder:"Search by religion...",value:t.agama||""})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Reason for Contact"}),o.jsx(fl,{field:"alasanMenghubungi",placeholder:"Search by reason...",value:t.alasanMenghubungi||""})]}),!t.globalSearch&&o.jsxs("div",{className:"individual-search-note",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Note:"})," Individual name/phone search available when global search is empty"]}),o.jsxs("div",{className:"filter-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Name Only"}),o.jsx(fl,{field:"nama",placeholder:"Search by name only...",value:t.nama||""})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Phone Only"}),o.jsx(fl,{field:"nomorTelepon",placeholder:"Search by phone only...",value:t.nomorTelepon||""})]})]})]})]}),p==="quick"&&o.jsxs("div",{className:"quick-filters",children:[o.jsx("div",{className:"quick-filter-grid",children:C.map((T,y)=>o.jsx("button",{onClick:T.action,className:"quick-filter-btn",children:T.label},y))}),o.jsx("div",{className:"quick-filter-info",children:o.jsx("p",{children:"Quick filters provide instant filtering options for common use cases."})})]})]})]})]})},PN=({initialView:a="dashboard"})=>{const[n,t]=G.useState(a),[i,l]=G.useState(null),[u,f]=G.useState(null),[h,g]=G.useState(!1),[v,p]=G.useState(null);G.useEffect(()=>{const K=J=>{p(J.detail),t("add-contact"),f(null)};return window.addEventListener("navigateToAddContact",K),()=>{window.removeEventListener("navigateToAddContact",K)}},[]);const S=K=>{t(K),l(null),f(null),g(!1),K!=="add-contact"&&p(null)},x=K=>{l(K),g(!0)},C=K=>{f(K),t("add-contact")},T=()=>{g(!1),l(null)},y=K=>{u&&(f(null),t("contacts")),!u&&K&&p(null)},_=()=>{f(null),p(null),t("contacts")},w=()=>{g(!1),l(null)},k=(K,J)=>{switch(console.log("Dashboard navigation:",K,J),K){case"contacts":t("contacts");break;case"service-tracking":console.log("Service tracking navigation not yet implemented");break;default:t("contacts")}},M=K=>{const J=Ke.getContactById(K);J&&(f(J),t("add-contact"),p(null),g(!1),l(null))},N=()=>{switch(n){case"dashboard":return o.jsx(wv,{onNavigate:k});case"contacts":return o.jsx(eN,{children:o.jsxs("div",{className:"contacts-with-filters",children:[o.jsx(KN,{}),o.jsx(iN,{onContactSelect:x,onContactEdit:C,onContactDelete:T})]})});case"add-contact":return o.jsx(pN,{contact:u,mode:u?"edit":"create",onSave:y,onCancel:_,initialData:v});case"service-tracking":return o.jsx(RN,{});case"users":return o.jsx(bN,{});default:return o.jsx(wv,{onNavigate:k})}};return o.jsxs("div",{className:"main-layout",children:[o.jsx(FN,{onReturnToService:M}),o.jsx(Yb,{currentView:n,onViewChange:S}),o.jsx("main",{className:"main-content",children:N()}),h&&i&&o.jsx(_N,{contact:i,onEdit:C,onDelete:T,onClose:w})]})};function zN(){return G.useEffect(()=>{Ke.initializeStorage(),Bt.initializeRecovery(),console.log("CRM Application initialized with recovery system")},[]),o.jsx($S,{children:o.jsx(ZS,{children:o.jsx(PN,{})})})}kS.createRoot(document.getElementById("root")).render(o.jsx(zN,{}));
