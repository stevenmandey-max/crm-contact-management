(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();function _S(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Y0={exports:{}},ll={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1;function wS(){if(b1)return ll;b1=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(s,l,u){var f=null;if(u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),"key"in l){u={};for(var h in l)h!=="key"&&(u[h]=l[h])}else u=l;return l=u.ref,{$$typeof:a,type:s,key:f,ref:l!==void 0?l:null,props:u}}return ll.Fragment=n,ll.jsx=t,ll.jsxs=t,ll}var N1;function bS(){return N1||(N1=1,Y0.exports=wS()),Y0.exports}var o=bS(),X0={exports:{}},cl={},J0={exports:{}},q0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A1;function NS(){return A1||(A1=1,(function(a){function n(ee,ge){var ke=ee.length;ee.push(ge);e:for(;0<ke;){var Ne=ke-1>>>1,Le=ee[Ne];if(0<l(Le,ge))ee[Ne]=ge,ee[ke]=Le,ke=Ne;else break e}}function t(ee){return ee.length===0?null:ee[0]}function s(ee){if(ee.length===0)return null;var ge=ee[0],ke=ee.pop();if(ke!==ge){ee[0]=ke;e:for(var Ne=0,Le=ee.length,G=Le>>>1;Ne<G;){var j=2*(Ne+1)-1,V=ee[j],P=j+1,Y=ee[P];if(0>l(V,ke))P<Le&&0>l(Y,V)?(ee[Ne]=Y,ee[P]=ke,Ne=P):(ee[Ne]=V,ee[j]=ke,Ne=j);else if(P<Le&&0>l(Y,ke))ee[Ne]=Y,ee[P]=ke,Ne=P;else break e}}return ge}function l(ee,ge){var ke=ee.sortIndex-ge.sortIndex;return ke!==0?ke:ee.id-ge.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;a.unstable_now=function(){return u.now()}}else{var f=Date,h=f.now();a.unstable_now=function(){return f.now()-h}}var g=[],m=[],p=1,S=null,x=3,C=!1,T=!1,y=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function b(ee){for(var ge=t(m);ge!==null;){if(ge.callback===null)s(m);else if(ge.startTime<=ee)s(m),ge.sortIndex=ge.expirationTime,n(g,ge);else break;ge=t(m)}}function K(ee){if(y=!1,b(ee),!T)if(t(g)!==null)T=!0,q||(q=!0,H());else{var ge=t(m);ge!==null&&Se(K,ge.startTime-ee)}}var q=!1,B=-1,Z=5,L=-1;function X(){return _?!0:!(a.unstable_now()-L<Z)}function M(){if(_=!1,q){var ee=a.unstable_now();L=ee;var ge=!0;try{e:{T=!1,y&&(y=!1,k(B),B=-1),C=!0;var ke=x;try{t:{for(b(ee),S=t(g);S!==null&&!(S.expirationTime>ee&&X());){var Ne=S.callback;if(typeof Ne=="function"){S.callback=null,x=S.priorityLevel;var Le=Ne(S.expirationTime<=ee);if(ee=a.unstable_now(),typeof Le=="function"){S.callback=Le,b(ee),ge=!0;break t}S===t(g)&&s(g),b(ee)}else s(g);S=t(g)}if(S!==null)ge=!0;else{var G=t(m);G!==null&&Se(K,G.startTime-ee),ge=!1}}break e}finally{S=null,x=ke,C=!1}ge=void 0}}finally{ge?H():q=!1}}}var H;if(typeof D=="function")H=function(){D(M)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,be=ue.port2;ue.port1.onmessage=M,H=function(){be.postMessage(null)}}else H=function(){w(M,0)};function Se(ee,ge){B=w(function(){ee(a.unstable_now())},ge)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(ee){ee.callback=null},a.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<ee?Math.floor(1e3/ee):5},a.unstable_getCurrentPriorityLevel=function(){return x},a.unstable_next=function(ee){switch(x){case 1:case 2:case 3:var ge=3;break;default:ge=x}var ke=x;x=ge;try{return ee()}finally{x=ke}},a.unstable_requestPaint=function(){_=!0},a.unstable_runWithPriority=function(ee,ge){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ke=x;x=ee;try{return ge()}finally{x=ke}},a.unstable_scheduleCallback=function(ee,ge,ke){var Ne=a.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?Ne+ke:Ne):ke=Ne,ee){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ke+Le,ee={id:p++,callback:ge,priorityLevel:ee,startTime:ke,expirationTime:Le,sortIndex:-1},ke>Ne?(ee.sortIndex=ke,n(m,ee),t(g)===null&&ee===t(m)&&(y?(k(B),B=-1):y=!0,Se(K,ke-Ne))):(ee.sortIndex=Le,n(g,ee),T||C||(T=!0,q||(q=!0,H()))),ee},a.unstable_shouldYield=X,a.unstable_wrapCallback=function(ee){var ge=x;return function(){var ke=x;x=ge;try{return ee.apply(this,arguments)}finally{x=ke}}}})(q0)),q0}var D1;function AS(){return D1||(D1=1,J0.exports=NS()),J0.exports}var $0={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1;function DS(){if(M1)return Pe;M1=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),x=Symbol.iterator;function C(G){return G===null||typeof G!="object"?null:(G=x&&G[x]||G["@@iterator"],typeof G=="function"?G:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function w(G,j,V){this.props=G,this.context=j,this.refs=_,this.updater=V||T}w.prototype.isReactComponent={},w.prototype.setState=function(G,j){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,j,"setState")},w.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function k(){}k.prototype=w.prototype;function D(G,j,V){this.props=G,this.context=j,this.refs=_,this.updater=V||T}var b=D.prototype=new k;b.constructor=D,y(b,w.prototype),b.isPureReactComponent=!0;var K=Array.isArray;function q(){}var B={H:null,A:null,T:null,S:null},Z=Object.prototype.hasOwnProperty;function L(G,j,V){var P=V.ref;return{$$typeof:a,type:G,key:j,ref:P!==void 0?P:null,props:V}}function X(G,j){return L(G.type,j,G.props)}function M(G){return typeof G=="object"&&G!==null&&G.$$typeof===a}function H(G){var j={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(V){return j[V]})}var ue=/\/+/g;function be(G,j){return typeof G=="object"&&G!==null&&G.key!=null?H(""+G.key):j.toString(36)}function Se(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(q,q):(G.status="pending",G.then(function(j){G.status==="pending"&&(G.status="fulfilled",G.value=j)},function(j){G.status==="pending"&&(G.status="rejected",G.reason=j)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function ee(G,j,V,P,Y){var ce=typeof G;(ce==="undefined"||ce==="boolean")&&(G=null);var Ce=!1;if(G===null)Ce=!0;else switch(ce){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch(G.$$typeof){case a:case n:Ce=!0;break;case p:return Ce=G._init,ee(Ce(G._payload),j,V,P,Y)}}if(Ce)return Y=Y(G),Ce=P===""?"."+be(G,0):P,K(Y)?(V="",Ce!=null&&(V=Ce.replace(ue,"$&/")+"/"),ee(Y,j,V,"",function(Ae){return Ae})):Y!=null&&(M(Y)&&(Y=X(Y,V+(Y.key==null||G&&G.key===Y.key?"":(""+Y.key).replace(ue,"$&/")+"/")+Ce)),j.push(Y)),1;Ce=0;var je=P===""?".":P+":";if(K(G))for(var we=0;we<G.length;we++)P=G[we],ce=je+be(P,we),Ce+=ee(P,j,V,ce,Y);else if(we=C(G),typeof we=="function")for(G=we.call(G),we=0;!(P=G.next()).done;)P=P.value,ce=je+be(P,we++),Ce+=ee(P,j,V,ce,Y);else if(ce==="object"){if(typeof G.then=="function")return ee(Se(G),j,V,P,Y);throw j=String(G),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function ge(G,j,V){if(G==null)return G;var P=[],Y=0;return ee(G,P,"","",function(ce){return j.call(V,ce,Y++)}),P}function ke(G){if(G._status===-1){var j=G._result;j=j(),j.then(function(V){(G._status===0||G._status===-1)&&(G._status=1,G._result=V)},function(V){(G._status===0||G._status===-1)&&(G._status=2,G._result=V)}),G._status===-1&&(G._status=0,G._result=j)}if(G._status===1)return G._result.default;throw G._result}var Ne=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},Le={map:ge,forEach:function(G,j,V){ge(G,function(){j.apply(this,arguments)},V)},count:function(G){var j=0;return ge(G,function(){j++}),j},toArray:function(G){return ge(G,function(j){return j})||[]},only:function(G){if(!M(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return Pe.Activity=S,Pe.Children=Le,Pe.Component=w,Pe.Fragment=t,Pe.Profiler=l,Pe.PureComponent=D,Pe.StrictMode=s,Pe.Suspense=g,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(G){return B.H.useMemoCache(G)}},Pe.cache=function(G){return function(){return G.apply(null,arguments)}},Pe.cacheSignal=function(){return null},Pe.cloneElement=function(G,j,V){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var P=y({},G.props),Y=G.key;if(j!=null)for(ce in j.key!==void 0&&(Y=""+j.key),j)!Z.call(j,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&j.ref===void 0||(P[ce]=j[ce]);var ce=arguments.length-2;if(ce===1)P.children=V;else if(1<ce){for(var Ce=Array(ce),je=0;je<ce;je++)Ce[je]=arguments[je+2];P.children=Ce}return L(G.type,Y,P)},Pe.createContext=function(G){return G={$$typeof:f,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:u,_context:G},G},Pe.createElement=function(G,j,V){var P,Y={},ce=null;if(j!=null)for(P in j.key!==void 0&&(ce=""+j.key),j)Z.call(j,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(Y[P]=j[P]);var Ce=arguments.length-2;if(Ce===1)Y.children=V;else if(1<Ce){for(var je=Array(Ce),we=0;we<Ce;we++)je[we]=arguments[we+2];Y.children=je}if(G&&G.defaultProps)for(P in Ce=G.defaultProps,Ce)Y[P]===void 0&&(Y[P]=Ce[P]);return L(G,ce,Y)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(G){return{$$typeof:h,render:G}},Pe.isValidElement=M,Pe.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:ke}},Pe.memo=function(G,j){return{$$typeof:m,type:G,compare:j===void 0?null:j}},Pe.startTransition=function(G){var j=B.T,V={};B.T=V;try{var P=G(),Y=B.S;Y!==null&&Y(V,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(q,Ne)}catch(ce){Ne(ce)}finally{j!==null&&V.types!==null&&(j.types=V.types),B.T=j}},Pe.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Pe.use=function(G){return B.H.use(G)},Pe.useActionState=function(G,j,V){return B.H.useActionState(G,j,V)},Pe.useCallback=function(G,j){return B.H.useCallback(G,j)},Pe.useContext=function(G){return B.H.useContext(G)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(G,j){return B.H.useDeferredValue(G,j)},Pe.useEffect=function(G,j){return B.H.useEffect(G,j)},Pe.useEffectEvent=function(G){return B.H.useEffectEvent(G)},Pe.useId=function(){return B.H.useId()},Pe.useImperativeHandle=function(G,j,V){return B.H.useImperativeHandle(G,j,V)},Pe.useInsertionEffect=function(G,j){return B.H.useInsertionEffect(G,j)},Pe.useLayoutEffect=function(G,j){return B.H.useLayoutEffect(G,j)},Pe.useMemo=function(G,j){return B.H.useMemo(G,j)},Pe.useOptimistic=function(G,j){return B.H.useOptimistic(G,j)},Pe.useReducer=function(G,j,V){return B.H.useReducer(G,j,V)},Pe.useRef=function(G){return B.H.useRef(G)},Pe.useState=function(G){return B.H.useState(G)},Pe.useSyncExternalStore=function(G,j,V){return B.H.useSyncExternalStore(G,j,V)},Pe.useTransition=function(){return B.H.useTransition()},Pe.version="19.2.0",Pe}var j1;function pf(){return j1||(j1=1,$0.exports=DS()),$0.exports}var Q0={exports:{}},ra={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k1;function MS(){if(k1)return ra;k1=1;var a=pf();function n(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,m,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:S==null?null:""+S,children:g,containerInfo:m,implementation:p}}var f=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ra.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ra.createPortal=function(g,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(n(299));return u(g,m,null,p)},ra.flushSync=function(g){var m=f.T,p=s.p;try{if(f.T=null,s.p=2,g)return g()}finally{f.T=m,s.p=p,s.d.f()}},ra.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(g,m))},ra.prefetchDNS=function(g){typeof g=="string"&&s.d.D(g)},ra.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var p=m.as,S=h(p,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,C=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?s.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:S,integrity:x,fetchPriority:C}):p==="script"&&s.d.X(g,{crossOrigin:S,integrity:x,fetchPriority:C,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ra.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=h(m.as,m.crossOrigin);s.d.M(g,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(g)},ra.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,S=h(p,m.crossOrigin);s.d.L(g,p,{crossOrigin:S,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ra.preloadModule=function(g,m){if(typeof g=="string")if(m){var p=h(m.as,m.crossOrigin);s.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(g)},ra.requestFormReset=function(g){s.d.r(g)},ra.unstable_batchedUpdates=function(g,m){return g(m)},ra.useFormState=function(g,m,p){return f.H.useFormState(g,m,p)},ra.useFormStatus=function(){return f.H.useHostTransitionStatus()},ra.version="19.2.0",ra}var U1;function jS(){if(U1)return Q0.exports;U1=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),Q0.exports=MS(),Q0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O1;function kS(){if(O1)return cl;O1=1;var a=AS(),n=pf(),t=jS();function s(e){var r="https://react.dev/errors/"+e;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)r+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var r=e,i=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,(r.flags&4098)!==0&&(i=r.return),e=r.return;while(e)}return r.tag===3?i:null}function f(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function h(e){if(e.tag===31){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function g(e){if(u(e)!==e)throw Error(s(188))}function m(e){var r=e.alternate;if(!r){if(r=u(e),r===null)throw Error(s(188));return r!==e?null:e}for(var i=e,c=r;;){var d=i.return;if(d===null)break;var v=d.alternate;if(v===null){if(c=d.return,c!==null){i=c;continue}break}if(d.child===v.child){for(v=d.child;v;){if(v===i)return g(d),e;if(v===c)return g(d),r;v=v.sibling}throw Error(s(188))}if(i.return!==c.return)i=d,c=v;else{for(var E=!1,A=d.child;A;){if(A===i){E=!0,i=d,c=v;break}if(A===c){E=!0,c=d,i=v;break}A=A.sibling}if(!E){for(A=v.child;A;){if(A===i){E=!0,i=v,c=d;break}if(A===c){E=!0,c=v,i=d;break}A=A.sibling}if(!E)throw Error(s(189))}}if(i.alternate!==c)throw Error(s(190))}if(i.tag!==3)throw Error(s(188));return i.stateNode.current===i?e:r}function p(e){var r=e.tag;if(r===5||r===26||r===27||r===6)return e;for(e=e.child;e!==null;){if(r=p(e),r!==null)return r;e=e.sibling}return null}var S=Object.assign,x=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),D=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function H(e){return e===null||typeof e!="object"?null:(e=M&&e[M]||e["@@iterator"],typeof e=="function"?e:null)}var ue=Symbol.for("react.client.reference");function be(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ue?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case y:return"Fragment";case w:return"Profiler";case _:return"StrictMode";case K:return"Suspense";case q:return"SuspenseList";case L:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case T:return"Portal";case D:return e.displayName||"Context";case k:return(e._context.displayName||"Context")+".Consumer";case b:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case B:return r=e.displayName||null,r!==null?r:be(e.type)||"Memo";case Z:r=e._payload,e=e._init;try{return be(e(r))}catch{}}return null}var Se=Array.isArray,ee=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ke={pending:!1,data:null,method:null,action:null},Ne=[],Le=-1;function G(e){return{current:e}}function j(e){0>Le||(e.current=Ne[Le],Ne[Le]=null,Le--)}function V(e,r){Le++,Ne[Le]=e.current,e.current=r}var P=G(null),Y=G(null),ce=G(null),Ce=G(null);function je(e,r){switch(V(ce,r),V(Y,e),V(P,null),r.nodeType){case 9:case 11:e=(e=r.documentElement)&&(e=e.namespaceURI)?Jm(e):0;break;default:if(e=r.tagName,r=r.namespaceURI)r=Jm(r),e=qm(r,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}j(P),V(P,e)}function we(){j(P),j(Y),j(ce)}function Ae(e){e.memoizedState!==null&&V(Ce,e);var r=P.current,i=qm(r,e.type);r!==i&&(V(Y,e),V(P,i))}function Qe(e){Y.current===e&&(j(P),j(Y)),Ce.current===e&&(j(Ce),nl._currentValue=ke)}var Ve,Kt;function We(e){if(Ve===void 0)try{throw Error()}catch(i){var r=i.stack.trim().match(/\n( *(at )?)/);Ve=r&&r[1]||"",Kt=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ve+e+Kt}var _a=!1;function vt(e,r){if(!e||_a)return"";_a=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(oe){var ie=oe}Reflect.construct(e,[],ve)}else{try{ve.call()}catch(oe){ie=oe}e.call(ve.prototype)}}else{try{throw Error()}catch(oe){ie=oe}(ve=e())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(oe){if(oe&&ie&&typeof oe.stack=="string")return[oe.stack,ie.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),E=v[0],A=v[1];if(E&&A){var W=E.split(`
`),ae=A.split(`
`);for(d=c=0;c<W.length&&!W[c].includes("DetermineComponentFrameRoot");)c++;for(;d<ae.length&&!ae[d].includes("DetermineComponentFrameRoot");)d++;if(c===W.length||d===ae.length)for(c=W.length-1,d=ae.length-1;1<=c&&0<=d&&W[c]!==ae[d];)d--;for(;1<=c&&0<=d;c--,d--)if(W[c]!==ae[d]){if(c!==1||d!==1)do if(c--,d--,0>d||W[c]!==ae[d]){var de=`
`+W[c].replace(" at new "," at ");return e.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",e.displayName)),de}while(1<=c&&0<=d);break}}}finally{_a=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?We(i):""}function Ue(e,r){switch(e.tag){case 26:case 27:case 5:return We(e.type);case 16:return We("Lazy");case 13:return e.child!==r&&r!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return vt(e.type,!1);case 11:return vt(e.type.render,!1);case 1:return vt(e.type,!0);case 31:return We("Activity");default:return""}}function ca(e){try{var r="",i=null;do r+=Ue(e,i),i=e,e=e.return;while(e);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var wa=Object.prototype.hasOwnProperty,en=a.unstable_scheduleCallback,hn=a.unstable_cancelCallback,Ol=a.unstable_shouldYield,mi=a.unstable_requestPaint,Ct=a.unstable_now,ls=a.unstable_getCurrentPriorityLevel,cs=a.unstable_ImmediatePriority,os=a.unstable_UserBlockingPriority,La=a.unstable_NormalPriority,Ro=a.unstable_LowPriority,vi=a.unstable_IdlePriority,Il=a.log,Rl=a.unstable_setDisableYieldValue,Jn=null,na=null;function tn(e){if(typeof Il=="function"&&Rl(e),na&&typeof na.setStrictMode=="function")try{na.setStrictMode(Jn,e)}catch{}}var oa=Math.clz32?Math.clz32:Ll,Fo=Math.log,Fl=Math.LN2;function Ll(e){return e>>>=0,e===0?32:31-(Fo(e)/Fl|0)|0}var Dr=256,us=262144,fs=4194304;function Ba(e){var r=e&42;if(r!==0)return r;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ds(e,r,i){var c=e.pendingLanes;if(c===0)return 0;var d=0,v=e.suspendedLanes,E=e.pingedLanes;e=e.warmLanes;var A=c&134217727;return A!==0?(c=A&~v,c!==0?d=Ba(c):(E&=A,E!==0?d=Ba(E):i||(i=A&~e,i!==0&&(d=Ba(i))))):(A=c&~v,A!==0?d=Ba(A):E!==0?d=Ba(E):i||(i=c&~e,i!==0&&(d=Ba(i)))),d===0?0:r!==0&&r!==d&&(r&v)===0&&(v=d&-d,i=r&-r,v>=i||v===32&&(i&4194048)!==0)?r:d}function Mr(e,r){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&r)===0}function Lo(e,r){switch(e){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bl(){var e=fs;return fs<<=1,(fs&62914560)===0&&(fs=4194304),e}function gi(e){for(var r=[],i=0;31>i;i++)r.push(e);return r}function jr(e,r){e.pendingLanes|=r,r!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Bo(e,r,i,c,d,v){var E=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var A=e.entanglements,W=e.expirationTimes,ae=e.hiddenUpdates;for(i=E&~i;0<i;){var de=31-oa(i),ve=1<<de;A[de]=0,W[de]=-1;var ie=ae[de];if(ie!==null)for(ae[de]=null,de=0;de<ie.length;de++){var oe=ie[de];oe!==null&&(oe.lane&=-536870913)}i&=~ve}c!==0&&Kl(e,c,0),v!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=v&~(E&~r))}function Kl(e,r,i){e.pendingLanes|=r,e.suspendedLanes&=~r;var c=31-oa(r);e.entangledLanes|=r,e.entanglements[c]=e.entanglements[c]|1073741824|i&261930}function hs(e,r){var i=e.entangledLanes|=r;for(e=e.entanglements;i;){var c=31-oa(i),d=1<<c;d&r|e[c]&r&&(e[c]|=r),i&=~d}}function Pl(e,r){var i=r&-r;return i=(i&42)!==0?1:pi(i),(i&(e.suspendedLanes|r))!==0?0:i}function pi(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function xi(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function N(){var e=ge.p;return e!==0?e:(e=window.event,e===void 0?32:S1(e.type))}function R(e,r){var i=ge.p;try{return ge.p=e,r()}finally{ge.p=i}}var U=Math.random().toString(36).slice(2),O="__reactFiber$"+U,I="__reactProps$"+U,F="__reactContainer$"+U,ne="__reactEvents$"+U,he="__reactListeners$"+U,re="__reactHandles$"+U,se="__reactResources$"+U,le="__reactMarker$"+U;function xe(e){delete e[O],delete e[I],delete e[ne],delete e[he],delete e[re]}function Te(e){var r=e[O];if(r)return r;for(var i=e.parentNode;i;){if(r=i[F]||i[O]){if(i=r.alternate,r.child!==null||i!==null&&i.child!==null)for(e=n1(e);e!==null;){if(i=e[O])return i;e=n1(e)}return r}e=i,i=e.parentNode}return null}function Me(e){if(e=e[O]||e[F]){var r=e.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return e}return null}function ye(e){var r=e.tag;if(r===5||r===26||r===27||r===6)return e.stateNode;throw Error(s(33))}function De(e){var r=e[se];return r||(r=e[se]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Ie(e){e[le]=!0}var gt=new Set,pt={};function Tt(e,r){Ka(e,r),Ka(e+"Capture",r)}function Ka(e,r){for(pt[e]=r,e=0;e<r.length;e++)gt.add(r[e])}var kr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qn={},mn={};function Si(e){return wa.call(mn,e)?!0:wa.call(qn,e)?!1:kr.test(e)?mn[e]=!0:(qn[e]=!0,!1)}function ma(e,r,i){if(Si(r))if(i===null)e.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(r);return}}e.setAttribute(r,""+i)}}function zl(e,r,i){if(i===null)e.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttribute(r,""+i)}}function En(e,r,i,c){if(c===null)e.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(r,i,""+c)}}function Pa(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Pf(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function pp(e,r,i){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,r);if(!e.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var d=c.get,v=c.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return d.call(this)},set:function(E){i=""+E,v.call(this,E)}}),Object.defineProperty(e,r,{enumerable:c.enumerable}),{getValue:function(){return i},setValue:function(E){i=""+E},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function Ko(e){if(!e._valueTracker){var r=Pf(e)?"checked":"value";e._valueTracker=pp(e,r,""+e[r])}}function zf(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var i=r.getValue(),c="";return e&&(c=Pf(e)?e.checked?"true":"false":e.value),e=c,e!==i?(r.setValue(e),!0):!1}function Hl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var xp=/[\n"\\]/g;function za(e){return e.replace(xp,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Po(e,r,i,c,d,v,E,A){e.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.type=E:e.removeAttribute("type"),r!=null?E==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+Pa(r)):e.value!==""+Pa(r)&&(e.value=""+Pa(r)):E!=="submit"&&E!=="reset"||e.removeAttribute("value"),r!=null?zo(e,E,Pa(r)):i!=null?zo(e,E,Pa(i)):c!=null&&e.removeAttribute("value"),d==null&&v!=null&&(e.defaultChecked=!!v),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?e.name=""+Pa(A):e.removeAttribute("name")}function Hf(e,r,i,c,d,v,E,A){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.type=v),r!=null||i!=null){if(!(v!=="submit"&&v!=="reset"||r!=null)){Ko(e);return}i=i!=null?""+Pa(i):"",r=r!=null?""+Pa(r):i,A||r===e.value||(e.value=r),e.defaultValue=r}c=c??d,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=A?e.checked:!!c,e.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(e.name=E),Ko(e)}function zo(e,r,i){r==="number"&&Hl(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function ms(e,r,i,c){if(e=e.options,r){r={};for(var d=0;d<i.length;d++)r["$"+i[d]]=!0;for(i=0;i<e.length;i++)d=r.hasOwnProperty("$"+e[i].value),e[i].selected!==d&&(e[i].selected=d),d&&c&&(e[i].defaultSelected=!0)}else{for(i=""+Pa(i),r=null,d=0;d<e.length;d++){if(e[d].value===i){e[d].selected=!0,c&&(e[d].defaultSelected=!0);return}r!==null||e[d].disabled||(r=e[d])}r!==null&&(r.selected=!0)}}function Gf(e,r,i){if(r!=null&&(r=""+Pa(r),r!==e.value&&(e.value=r),i==null)){e.defaultValue!==r&&(e.defaultValue=r);return}e.defaultValue=i!=null?""+Pa(i):""}function Wf(e,r,i,c){if(r==null){if(c!=null){if(i!=null)throw Error(s(92));if(Se(c)){if(1<c.length)throw Error(s(93));c=c[0]}i=c}i==null&&(i=""),r=i}i=Pa(r),e.defaultValue=i,c=e.textContent,c===i&&c!==""&&c!==null&&(e.value=c),Ko(e)}function vs(e,r){if(r){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=r;return}}e.textContent=r}var Sp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vf(e,r,i){var c=r.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="":c?e.setProperty(r,i):typeof i!="number"||i===0||Sp.has(r)?r==="float"?e.cssFloat=i:e[r]=(""+i).trim():e[r]=i+"px"}function Yf(e,r,i){if(r!=null&&typeof r!="object")throw Error(s(62));if(e=e.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var d in r)c=r[d],r.hasOwnProperty(d)&&i[d]!==c&&Vf(e,d,c)}else for(var v in r)r.hasOwnProperty(v)&&Vf(e,v,r[v])}function Ho(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Cp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gl(e){return Cp.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function _n(){}var Go=null;function Wo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gs=null,ps=null;function Xf(e){var r=Me(e);if(r&&(e=r.stateNode)){var i=e[I]||null;e:switch(e=r.stateNode,r.type){case"input":if(Po(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),r=i.name,i.type==="radio"&&r!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+za(""+r)+'"][type="radio"]'),r=0;r<i.length;r++){var c=i[r];if(c!==e&&c.form===e.form){var d=c[I]||null;if(!d)throw Error(s(90));Po(c,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(r=0;r<i.length;r++)c=i[r],c.form===e.form&&zf(c)}break e;case"textarea":Gf(e,i.value,i.defaultValue);break e;case"select":r=i.value,r!=null&&ms(e,!!i.multiple,r,!1)}}}var Vo=!1;function Jf(e,r,i){if(Vo)return e(r,i);Vo=!0;try{var c=e(r);return c}finally{if(Vo=!1,(gs!==null||ps!==null)&&(jc(),gs&&(r=gs,e=ps,ps=gs=null,Xf(r),e)))for(r=0;r<e.length;r++)Xf(e[r])}}function yi(e,r){var i=e.stateNode;if(i===null)return null;var c=i[I]||null;if(c===null)return null;i=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(s(231,r,typeof i));return i}var wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yo=!1;if(wn)try{var Ci={};Object.defineProperty(Ci,"passive",{get:function(){Yo=!0}}),window.addEventListener("test",Ci,Ci),window.removeEventListener("test",Ci,Ci)}catch{Yo=!1}var $n=null,Xo=null,Wl=null;function qf(){if(Wl)return Wl;var e,r=Xo,i=r.length,c,d="value"in $n?$n.value:$n.textContent,v=d.length;for(e=0;e<i&&r[e]===d[e];e++);var E=i-e;for(c=1;c<=E&&r[i-c]===d[v-c];c++);return Wl=d.slice(e,1<c?1-c:void 0)}function Vl(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function Yl(){return!0}function $f(){return!1}function va(e){function r(i,c,d,v,E){this._reactName=i,this._targetInst=d,this.type=c,this.nativeEvent=v,this.target=E,this.currentTarget=null;for(var A in e)e.hasOwnProperty(A)&&(i=e[A],this[A]=i?i(v):v[A]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Yl:$f,this.isPropagationStopped=$f,this}return S(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Yl)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Yl)},persist:function(){},isPersistent:Yl}),r}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xl=va(Ur),Ti=S({},Ur,{view:0,detail:0}),Tp=va(Ti),Jo,qo,Ei,Jl=S({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ei&&(Ei&&e.type==="mousemove"?(Jo=e.screenX-Ei.screenX,qo=e.screenY-Ei.screenY):qo=Jo=0,Ei=e),Jo)},movementY:function(e){return"movementY"in e?e.movementY:qo}}),Qf=va(Jl),Ep=S({},Jl,{dataTransfer:0}),_p=va(Ep),wp=S({},Ti,{relatedTarget:0}),$o=va(wp),bp=S({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),Np=va(bp),Ap=S({},Ur,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Dp=va(Ap),Mp=S({},Ur,{data:0}),Zf=va(Mp),jp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Up={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Op(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=Up[e])?!!r[e]:!1}function Qo(){return Op}var Ip=S({},Ti,{key:function(e){if(e.key){var r=jp[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=Vl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?kp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qo,charCode:function(e){return e.type==="keypress"?Vl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Vl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rp=va(Ip),Fp=S({},Jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ed=va(Fp),Lp=S({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qo}),Bp=va(Lp),Kp=S({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pp=va(Kp),zp=S({},Jl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Hp=va(zp),Gp=S({},Ur,{newState:0,oldState:0}),Wp=va(Gp),Vp=[9,13,27,32],Zo=wn&&"CompositionEvent"in window,_i=null;wn&&"documentMode"in document&&(_i=document.documentMode);var Yp=wn&&"TextEvent"in window&&!_i,td=wn&&(!Zo||_i&&8<_i&&11>=_i),ad=" ",nd=!1;function rd(e,r){switch(e){case"keyup":return Vp.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xs=!1;function Xp(e,r){switch(e){case"compositionend":return sd(r);case"keypress":return r.which!==32?null:(nd=!0,ad);case"textInput":return e=r.data,e===ad&&nd?null:e;default:return null}}function Jp(e,r){if(xs)return e==="compositionend"||!Zo&&rd(e,r)?(e=qf(),Wl=Xo=$n=null,xs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return td&&r.locale!=="ko"?null:r.data;default:return null}}var qp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function id(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!qp[e.type]:r==="textarea"}function ld(e,r,i,c){gs?ps?ps.push(c):ps=[c]:gs=c,r=Lc(r,"onChange"),0<r.length&&(i=new Xl("onChange","change",null,i,c),e.push({event:i,listeners:r}))}var wi=null,bi=null;function $p(e){Hm(e,0)}function ql(e){var r=ye(e);if(zf(r))return e}function cd(e,r){if(e==="change")return r}var od=!1;if(wn){var eu;if(wn){var tu="oninput"in document;if(!tu){var ud=document.createElement("div");ud.setAttribute("oninput","return;"),tu=typeof ud.oninput=="function"}eu=tu}else eu=!1;od=eu&&(!document.documentMode||9<document.documentMode)}function fd(){wi&&(wi.detachEvent("onpropertychange",dd),bi=wi=null)}function dd(e){if(e.propertyName==="value"&&ql(bi)){var r=[];ld(r,bi,e,Wo(e)),Jf($p,r)}}function Qp(e,r,i){e==="focusin"?(fd(),wi=r,bi=i,wi.attachEvent("onpropertychange",dd)):e==="focusout"&&fd()}function Zp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ql(bi)}function ex(e,r){if(e==="click")return ql(r)}function tx(e,r){if(e==="input"||e==="change")return ql(r)}function ax(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var ba=typeof Object.is=="function"?Object.is:ax;function Ni(e,r){if(ba(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var i=Object.keys(e),c=Object.keys(r);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var d=i[c];if(!wa.call(r,d)||!ba(e[d],r[d]))return!1}return!0}function hd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function md(e,r){var i=hd(e);e=0;for(var c;i;){if(i.nodeType===3){if(c=e+i.textContent.length,e<=r&&c>=r)return{node:i,offset:r-e};e=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=hd(i)}}function vd(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?vd(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function gd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var r=Hl(e.document);r instanceof e.HTMLIFrameElement;){try{var i=typeof r.contentWindow.location.href=="string"}catch{i=!1}if(i)e=r.contentWindow;else break;r=Hl(e.document)}return r}function au(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}var nx=wn&&"documentMode"in document&&11>=document.documentMode,Ss=null,nu=null,Ai=null,ru=!1;function pd(e,r,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;ru||Ss==null||Ss!==Hl(c)||(c=Ss,"selectionStart"in c&&au(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ai&&Ni(Ai,c)||(Ai=c,c=Lc(nu,"onSelect"),0<c.length&&(r=new Xl("onSelect","select",null,r,i),e.push({event:r,listeners:c}),r.target=Ss)))}function Or(e,r){var i={};return i[e.toLowerCase()]=r.toLowerCase(),i["Webkit"+e]="webkit"+r,i["Moz"+e]="moz"+r,i}var ys={animationend:Or("Animation","AnimationEnd"),animationiteration:Or("Animation","AnimationIteration"),animationstart:Or("Animation","AnimationStart"),transitionrun:Or("Transition","TransitionRun"),transitionstart:Or("Transition","TransitionStart"),transitioncancel:Or("Transition","TransitionCancel"),transitionend:Or("Transition","TransitionEnd")},su={},xd={};wn&&(xd=document.createElement("div").style,"AnimationEvent"in window||(delete ys.animationend.animation,delete ys.animationiteration.animation,delete ys.animationstart.animation),"TransitionEvent"in window||delete ys.transitionend.transition);function Ir(e){if(su[e])return su[e];if(!ys[e])return e;var r=ys[e],i;for(i in r)if(r.hasOwnProperty(i)&&i in xd)return su[e]=r[i];return e}var Sd=Ir("animationend"),yd=Ir("animationiteration"),Cd=Ir("animationstart"),rx=Ir("transitionrun"),sx=Ir("transitionstart"),ix=Ir("transitioncancel"),Td=Ir("transitionend"),Ed=new Map,iu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");iu.push("scrollEnd");function an(e,r){Ed.set(e,r),Tt(r,[e])}var $l=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ha=[],Cs=0,lu=0;function Ql(){for(var e=Cs,r=lu=Cs=0;r<e;){var i=Ha[r];Ha[r++]=null;var c=Ha[r];Ha[r++]=null;var d=Ha[r];Ha[r++]=null;var v=Ha[r];if(Ha[r++]=null,c!==null&&d!==null){var E=c.pending;E===null?d.next=d:(d.next=E.next,E.next=d),c.pending=d}v!==0&&_d(i,d,v)}}function Zl(e,r,i,c){Ha[Cs++]=e,Ha[Cs++]=r,Ha[Cs++]=i,Ha[Cs++]=c,lu|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function cu(e,r,i,c){return Zl(e,r,i,c),ec(e)}function Rr(e,r){return Zl(e,null,null,r),ec(e)}function _d(e,r,i){e.lanes|=i;var c=e.alternate;c!==null&&(c.lanes|=i);for(var d=!1,v=e.return;v!==null;)v.childLanes|=i,c=v.alternate,c!==null&&(c.childLanes|=i),v.tag===22&&(e=v.stateNode,e===null||e._visibility&1||(d=!0)),e=v,v=v.return;return e.tag===3?(v=e.stateNode,d&&r!==null&&(d=31-oa(i),e=v.hiddenUpdates,c=e[d],c===null?e[d]=[r]:c.push(r),r.lane=i|536870912),v):null}function ec(e){if(50<qi)throw qi=0,p0=null,Error(s(185));for(var r=e.return;r!==null;)e=r,r=e.return;return e.tag===3?e.stateNode:null}var Ts={};function lx(e,r,i,c){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Na(e,r,i,c){return new lx(e,r,i,c)}function ou(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bn(e,r){var i=e.alternate;return i===null?(i=Na(e.tag,r,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=r,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,r=e.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function wd(e,r){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=r,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,r=i.dependencies,e.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),e}function tc(e,r,i,c,d,v){var E=0;if(c=e,typeof e=="function")ou(e)&&(E=1);else if(typeof e=="string")E=dS(e,i,P.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case L:return e=Na(31,i,r,d),e.elementType=L,e.lanes=v,e;case y:return Fr(i.children,d,v,r);case _:E=8,d|=24;break;case w:return e=Na(12,i,r,d|2),e.elementType=w,e.lanes=v,e;case K:return e=Na(13,i,r,d),e.elementType=K,e.lanes=v,e;case q:return e=Na(19,i,r,d),e.elementType=q,e.lanes=v,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case D:E=10;break e;case k:E=9;break e;case b:E=11;break e;case B:E=14;break e;case Z:E=16,c=null;break e}E=29,i=Error(s(130,e===null?"null":typeof e,"")),c=null}return r=Na(E,i,r,d),r.elementType=e,r.type=c,r.lanes=v,r}function Fr(e,r,i,c){return e=Na(7,e,c,r),e.lanes=i,e}function uu(e,r,i){return e=Na(6,e,null,r),e.lanes=i,e}function bd(e){var r=Na(18,null,null,0);return r.stateNode=e,r}function fu(e,r,i){return r=Na(4,e.children!==null?e.children:[],e.key,r),r.lanes=i,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}var Nd=new WeakMap;function Ga(e,r){if(typeof e=="object"&&e!==null){var i=Nd.get(e);return i!==void 0?i:(r={value:e,source:r,stack:ca(r)},Nd.set(e,r),r)}return{value:e,source:r,stack:ca(r)}}var Es=[],_s=0,ac=null,Di=0,Wa=[],Va=0,Qn=null,vn=1,gn="";function Nn(e,r){Es[_s++]=Di,Es[_s++]=ac,ac=e,Di=r}function Ad(e,r,i){Wa[Va++]=vn,Wa[Va++]=gn,Wa[Va++]=Qn,Qn=e;var c=vn;e=gn;var d=32-oa(c)-1;c&=~(1<<d),i+=1;var v=32-oa(r)+d;if(30<v){var E=d-d%5;v=(c&(1<<E)-1).toString(32),c>>=E,d-=E,vn=1<<32-oa(r)+d|i<<d|c,gn=v+e}else vn=1<<v|i<<d|c,gn=e}function du(e){e.return!==null&&(Nn(e,1),Ad(e,1,0))}function hu(e){for(;e===ac;)ac=Es[--_s],Es[_s]=null,Di=Es[--_s],Es[_s]=null;for(;e===Qn;)Qn=Wa[--Va],Wa[Va]=null,gn=Wa[--Va],Wa[Va]=null,vn=Wa[--Va],Wa[Va]=null}function Dd(e,r){Wa[Va++]=vn,Wa[Va++]=gn,Wa[Va++]=Qn,vn=r.id,gn=r.overflow,Qn=e}var Yt=null,xt=null,$e=!1,Zn=null,Ya=!1,mu=Error(s(519));function er(e){var r=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Mi(Ga(r,e)),mu}function Md(e){var r=e.stateNode,i=e.type,c=e.memoizedProps;switch(r[O]=e,r[I]=c,i){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(i=0;i<Qi.length;i++)Xe(Qi[i],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":Xe("invalid",r),Hf(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Xe("invalid",r);break;case"textarea":Xe("invalid",r),Wf(r,c.value,c.defaultValue,c.children)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||r.textContent===""+i||c.suppressHydrationWarning===!0||Ym(r.textContent,i)?(c.popover!=null&&(Xe("beforetoggle",r),Xe("toggle",r)),c.onScroll!=null&&Xe("scroll",r),c.onScrollEnd!=null&&Xe("scrollend",r),c.onClick!=null&&(r.onclick=_n),r=!0):r=!1,r||er(e,!0)}function jd(e){for(Yt=e.return;Yt;)switch(Yt.tag){case 5:case 31:case 13:Ya=!1;return;case 27:case 3:Ya=!0;return;default:Yt=Yt.return}}function ws(e){if(e!==Yt)return!1;if(!$e)return jd(e),$e=!0,!1;var r=e.tag,i;if((i=r!==3&&r!==27)&&((i=r===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||k0(e.type,e.memoizedProps)),i=!i),i&&xt&&er(e),jd(e),r===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));xt=a1(e)}else if(r===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));xt=a1(e)}else r===27?(r=xt,mr(e.type)?(e=F0,F0=null,xt=e):xt=r):xt=Yt?Ja(e.stateNode.nextSibling):null;return!0}function Lr(){xt=Yt=null,$e=!1}function vu(){var e=Zn;return e!==null&&(Sa===null?Sa=e:Sa.push.apply(Sa,e),Zn=null),e}function Mi(e){Zn===null?Zn=[e]:Zn.push(e)}var gu=G(null),Br=null,An=null;function tr(e,r,i){V(gu,r._currentValue),r._currentValue=i}function Dn(e){e._currentValue=gu.current,j(gu)}function pu(e,r,i){for(;e!==null;){var c=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),e===i)break;e=e.return}}function xu(e,r,i,c){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var v=d.dependencies;if(v!==null){var E=d.child;v=v.firstContext;e:for(;v!==null;){var A=v;v=d;for(var W=0;W<r.length;W++)if(A.context===r[W]){v.lanes|=i,A=v.alternate,A!==null&&(A.lanes|=i),pu(v.return,i,e),c||(E=null);break e}v=A.next}}else if(d.tag===18){if(E=d.return,E===null)throw Error(s(341));E.lanes|=i,v=E.alternate,v!==null&&(v.lanes|=i),pu(E,i,e),E=null}else E=d.child;if(E!==null)E.return=d;else for(E=d;E!==null;){if(E===e){E=null;break}if(d=E.sibling,d!==null){d.return=E.return,E=d;break}E=E.return}d=E}}function bs(e,r,i,c){e=null;for(var d=r,v=!1;d!==null;){if(!v){if((d.flags&524288)!==0)v=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var E=d.alternate;if(E===null)throw Error(s(387));if(E=E.memoizedProps,E!==null){var A=d.type;ba(d.pendingProps.value,E.value)||(e!==null?e.push(A):e=[A])}}else if(d===Ce.current){if(E=d.alternate,E===null)throw Error(s(387));E.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(nl):e=[nl])}d=d.return}e!==null&&xu(r,e,i,c),r.flags|=262144}function nc(e){for(e=e.firstContext;e!==null;){if(!ba(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Kr(e){Br=e,An=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Xt(e){return kd(Br,e)}function rc(e,r){return Br===null&&Kr(e),kd(e,r)}function kd(e,r){var i=r._currentValue;if(r={context:r,memoizedValue:i,next:null},An===null){if(e===null)throw Error(s(308));An=r,e.dependencies={lanes:0,firstContext:r},e.flags|=524288}else An=An.next=r;return i}var cx=typeof AbortController<"u"?AbortController:function(){var e=[],r=this.signal={aborted:!1,addEventListener:function(i,c){e.push(c)}};this.abort=function(){r.aborted=!0,e.forEach(function(i){return i()})}},ox=a.unstable_scheduleCallback,ux=a.unstable_NormalPriority,Mt={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Su(){return{controller:new cx,data:new Map,refCount:0}}function ji(e){e.refCount--,e.refCount===0&&ox(ux,function(){e.controller.abort()})}var ki=null,yu=0,Ns=0,As=null;function fx(e,r){if(ki===null){var i=ki=[];yu=0,Ns=E0(),As={status:"pending",value:void 0,then:function(c){i.push(c)}}}return yu++,r.then(Ud,Ud),r}function Ud(){if(--yu===0&&ki!==null){As!==null&&(As.status="fulfilled");var e=ki;ki=null,Ns=0,As=null;for(var r=0;r<e.length;r++)(0,e[r])()}}function dx(e,r){var i=[],c={status:"pending",value:null,reason:null,then:function(d){i.push(d)}};return e.then(function(){c.status="fulfilled",c.value=r;for(var d=0;d<i.length;d++)(0,i[d])(r)},function(d){for(c.status="rejected",c.reason=d,d=0;d<i.length;d++)(0,i[d])(void 0)}),c}var Od=ee.S;ee.S=function(e,r){pm=Ct(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&fx(e,r),Od!==null&&Od(e,r)};var Pr=G(null);function Cu(){var e=Pr.current;return e!==null?e:mt.pooledCache}function sc(e,r){r===null?V(Pr,Pr.current):V(Pr,r.pool)}function Id(){var e=Cu();return e===null?null:{parent:Mt._currentValue,pool:e}}var Ds=Error(s(460)),Tu=Error(s(474)),ic=Error(s(542)),lc={then:function(){}};function Rd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Fd(e,r,i){switch(i=e[i],i===void 0?e.push(r):i!==r&&(r.then(_n,_n),r=i),r.status){case"fulfilled":return r.value;case"rejected":throw e=r.reason,Bd(e),e;default:if(typeof r.status=="string")r.then(_n,_n);else{if(e=mt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=r,e.status="pending",e.then(function(c){if(r.status==="pending"){var d=r;d.status="fulfilled",d.value=c}},function(c){if(r.status==="pending"){var d=r;d.status="rejected",d.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw e=r.reason,Bd(e),e}throw Hr=r,Ds}}function zr(e){try{var r=e._init;return r(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Hr=i,Ds):i}}var Hr=null;function Ld(){if(Hr===null)throw Error(s(459));var e=Hr;return Hr=null,e}function Bd(e){if(e===Ds||e===ic)throw Error(s(483))}var Ms=null,Ui=0;function cc(e){var r=Ui;return Ui+=1,Ms===null&&(Ms=[]),Fd(Ms,e,r)}function Oi(e,r){r=r.props.ref,e.ref=r!==void 0?r:null}function oc(e,r){throw r.$$typeof===x?Error(s(525)):(e=Object.prototype.toString.call(r),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)))}function Kd(e){function r(Q,J){if(e){var te=Q.deletions;te===null?(Q.deletions=[J],Q.flags|=16):te.push(J)}}function i(Q,J){if(!e)return null;for(;J!==null;)r(Q,J),J=J.sibling;return null}function c(Q){for(var J=new Map;Q!==null;)Q.key!==null?J.set(Q.key,Q):J.set(Q.index,Q),Q=Q.sibling;return J}function d(Q,J){return Q=bn(Q,J),Q.index=0,Q.sibling=null,Q}function v(Q,J,te){return Q.index=te,e?(te=Q.alternate,te!==null?(te=te.index,te<J?(Q.flags|=67108866,J):te):(Q.flags|=67108866,J)):(Q.flags|=1048576,J)}function E(Q){return e&&Q.alternate===null&&(Q.flags|=67108866),Q}function A(Q,J,te,me){return J===null||J.tag!==6?(J=uu(te,Q.mode,me),J.return=Q,J):(J=d(J,te),J.return=Q,J)}function W(Q,J,te,me){var Fe=te.type;return Fe===y?de(Q,J,te.props.children,me,te.key):J!==null&&(J.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===Z&&zr(Fe)===J.type)?(J=d(J,te.props),Oi(J,te),J.return=Q,J):(J=tc(te.type,te.key,te.props,null,Q.mode,me),Oi(J,te),J.return=Q,J)}function ae(Q,J,te,me){return J===null||J.tag!==4||J.stateNode.containerInfo!==te.containerInfo||J.stateNode.implementation!==te.implementation?(J=fu(te,Q.mode,me),J.return=Q,J):(J=d(J,te.children||[]),J.return=Q,J)}function de(Q,J,te,me,Fe){return J===null||J.tag!==7?(J=Fr(te,Q.mode,me,Fe),J.return=Q,J):(J=d(J,te),J.return=Q,J)}function ve(Q,J,te){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=uu(""+J,Q.mode,te),J.return=Q,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case C:return te=tc(J.type,J.key,J.props,null,Q.mode,te),Oi(te,J),te.return=Q,te;case T:return J=fu(J,Q.mode,te),J.return=Q,J;case Z:return J=zr(J),ve(Q,J,te)}if(Se(J)||H(J))return J=Fr(J,Q.mode,te,null),J.return=Q,J;if(typeof J.then=="function")return ve(Q,cc(J),te);if(J.$$typeof===D)return ve(Q,rc(Q,J),te);oc(Q,J)}return null}function ie(Q,J,te,me){var Fe=J!==null?J.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Fe!==null?null:A(Q,J,""+te,me);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case C:return te.key===Fe?W(Q,J,te,me):null;case T:return te.key===Fe?ae(Q,J,te,me):null;case Z:return te=zr(te),ie(Q,J,te,me)}if(Se(te)||H(te))return Fe!==null?null:de(Q,J,te,me,null);if(typeof te.then=="function")return ie(Q,J,cc(te),me);if(te.$$typeof===D)return ie(Q,J,rc(Q,te),me);oc(Q,te)}return null}function oe(Q,J,te,me,Fe){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Q=Q.get(te)||null,A(J,Q,""+me,Fe);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case C:return Q=Q.get(me.key===null?te:me.key)||null,W(J,Q,me,Fe);case T:return Q=Q.get(me.key===null?te:me.key)||null,ae(J,Q,me,Fe);case Z:return me=zr(me),oe(Q,J,te,me,Fe)}if(Se(me)||H(me))return Q=Q.get(te)||null,de(J,Q,me,Fe,null);if(typeof me.then=="function")return oe(Q,J,te,cc(me),Fe);if(me.$$typeof===D)return oe(Q,J,te,rc(J,me),Fe);oc(J,me)}return null}function Oe(Q,J,te,me){for(var Fe=null,Ze=null,Re=J,He=J=0,qe=null;Re!==null&&He<te.length;He++){Re.index>He?(qe=Re,Re=null):qe=Re.sibling;var et=ie(Q,Re,te[He],me);if(et===null){Re===null&&(Re=qe);break}e&&Re&&et.alternate===null&&r(Q,Re),J=v(et,J,He),Ze===null?Fe=et:Ze.sibling=et,Ze=et,Re=qe}if(He===te.length)return i(Q,Re),$e&&Nn(Q,He),Fe;if(Re===null){for(;He<te.length;He++)Re=ve(Q,te[He],me),Re!==null&&(J=v(Re,J,He),Ze===null?Fe=Re:Ze.sibling=Re,Ze=Re);return $e&&Nn(Q,He),Fe}for(Re=c(Re);He<te.length;He++)qe=oe(Re,Q,He,te[He],me),qe!==null&&(e&&qe.alternate!==null&&Re.delete(qe.key===null?He:qe.key),J=v(qe,J,He),Ze===null?Fe=qe:Ze.sibling=qe,Ze=qe);return e&&Re.forEach(function(Sr){return r(Q,Sr)}),$e&&Nn(Q,He),Fe}function Be(Q,J,te,me){if(te==null)throw Error(s(151));for(var Fe=null,Ze=null,Re=J,He=J=0,qe=null,et=te.next();Re!==null&&!et.done;He++,et=te.next()){Re.index>He?(qe=Re,Re=null):qe=Re.sibling;var Sr=ie(Q,Re,et.value,me);if(Sr===null){Re===null&&(Re=qe);break}e&&Re&&Sr.alternate===null&&r(Q,Re),J=v(Sr,J,He),Ze===null?Fe=Sr:Ze.sibling=Sr,Ze=Sr,Re=qe}if(et.done)return i(Q,Re),$e&&Nn(Q,He),Fe;if(Re===null){for(;!et.done;He++,et=te.next())et=ve(Q,et.value,me),et!==null&&(J=v(et,J,He),Ze===null?Fe=et:Ze.sibling=et,Ze=et);return $e&&Nn(Q,He),Fe}for(Re=c(Re);!et.done;He++,et=te.next())et=oe(Re,Q,He,et.value,me),et!==null&&(e&&et.alternate!==null&&Re.delete(et.key===null?He:et.key),J=v(et,J,He),Ze===null?Fe=et:Ze.sibling=et,Ze=et);return e&&Re.forEach(function(ES){return r(Q,ES)}),$e&&Nn(Q,He),Fe}function dt(Q,J,te,me){if(typeof te=="object"&&te!==null&&te.type===y&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case C:e:{for(var Fe=te.key;J!==null;){if(J.key===Fe){if(Fe=te.type,Fe===y){if(J.tag===7){i(Q,J.sibling),me=d(J,te.props.children),me.return=Q,Q=me;break e}}else if(J.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===Z&&zr(Fe)===J.type){i(Q,J.sibling),me=d(J,te.props),Oi(me,te),me.return=Q,Q=me;break e}i(Q,J);break}else r(Q,J);J=J.sibling}te.type===y?(me=Fr(te.props.children,Q.mode,me,te.key),me.return=Q,Q=me):(me=tc(te.type,te.key,te.props,null,Q.mode,me),Oi(me,te),me.return=Q,Q=me)}return E(Q);case T:e:{for(Fe=te.key;J!==null;){if(J.key===Fe)if(J.tag===4&&J.stateNode.containerInfo===te.containerInfo&&J.stateNode.implementation===te.implementation){i(Q,J.sibling),me=d(J,te.children||[]),me.return=Q,Q=me;break e}else{i(Q,J);break}else r(Q,J);J=J.sibling}me=fu(te,Q.mode,me),me.return=Q,Q=me}return E(Q);case Z:return te=zr(te),dt(Q,J,te,me)}if(Se(te))return Oe(Q,J,te,me);if(H(te)){if(Fe=H(te),typeof Fe!="function")throw Error(s(150));return te=Fe.call(te),Be(Q,J,te,me)}if(typeof te.then=="function")return dt(Q,J,cc(te),me);if(te.$$typeof===D)return dt(Q,J,rc(Q,te),me);oc(Q,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,J!==null&&J.tag===6?(i(Q,J.sibling),me=d(J,te),me.return=Q,Q=me):(i(Q,J),me=uu(te,Q.mode,me),me.return=Q,Q=me),E(Q)):i(Q,J)}return function(Q,J,te,me){try{Ui=0;var Fe=dt(Q,J,te,me);return Ms=null,Fe}catch(Re){if(Re===Ds||Re===ic)throw Re;var Ze=Na(29,Re,null,Q.mode);return Ze.lanes=me,Ze.return=Q,Ze}finally{}}}var Gr=Kd(!0),Pd=Kd(!1),ar=!1;function Eu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _u(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function nr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function rr(e,r,i){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(at&2)!==0){var d=c.pending;return d===null?r.next=r:(r.next=d.next,d.next=r),c.pending=r,r=ec(e),_d(e,null,i),r}return Zl(e,c,r,i),ec(e)}function Ii(e,r,i){if(r=r.updateQueue,r!==null&&(r=r.shared,(i&4194048)!==0)){var c=r.lanes;c&=e.pendingLanes,i|=c,r.lanes=i,hs(e,i)}}function wu(e,r){var i=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var d=null,v=null;if(i=i.firstBaseUpdate,i!==null){do{var E={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};v===null?d=v=E:v=v.next=E,i=i.next}while(i!==null);v===null?d=v=r:v=v.next=r}else d=v=r;i={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=r:e.next=r,i.lastBaseUpdate=r}var bu=!1;function Ri(){if(bu){var e=As;if(e!==null)throw e}}function Fi(e,r,i,c){bu=!1;var d=e.updateQueue;ar=!1;var v=d.firstBaseUpdate,E=d.lastBaseUpdate,A=d.shared.pending;if(A!==null){d.shared.pending=null;var W=A,ae=W.next;W.next=null,E===null?v=ae:E.next=ae,E=W;var de=e.alternate;de!==null&&(de=de.updateQueue,A=de.lastBaseUpdate,A!==E&&(A===null?de.firstBaseUpdate=ae:A.next=ae,de.lastBaseUpdate=W))}if(v!==null){var ve=d.baseState;E=0,de=ae=W=null,A=v;do{var ie=A.lane&-536870913,oe=ie!==A.lane;if(oe?(Je&ie)===ie:(c&ie)===ie){ie!==0&&ie===Ns&&(bu=!0),de!==null&&(de=de.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Oe=e,Be=A;ie=r;var dt=i;switch(Be.tag){case 1:if(Oe=Be.payload,typeof Oe=="function"){ve=Oe.call(dt,ve,ie);break e}ve=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Be.payload,ie=typeof Oe=="function"?Oe.call(dt,ve,ie):Oe,ie==null)break e;ve=S({},ve,ie);break e;case 2:ar=!0}}ie=A.callback,ie!==null&&(e.flags|=64,oe&&(e.flags|=8192),oe=d.callbacks,oe===null?d.callbacks=[ie]:oe.push(ie))}else oe={lane:ie,tag:A.tag,payload:A.payload,callback:A.callback,next:null},de===null?(ae=de=oe,W=ve):de=de.next=oe,E|=ie;if(A=A.next,A===null){if(A=d.shared.pending,A===null)break;oe=A,A=oe.next,oe.next=null,d.lastBaseUpdate=oe,d.shared.pending=null}}while(!0);de===null&&(W=ve),d.baseState=W,d.firstBaseUpdate=ae,d.lastBaseUpdate=de,v===null&&(d.shared.lanes=0),or|=E,e.lanes=E,e.memoizedState=ve}}function zd(e,r){if(typeof e!="function")throw Error(s(191,e));e.call(r)}function Hd(e,r){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)zd(i[e],r)}var js=G(null),uc=G(0);function Gd(e,r){e=Ln,V(uc,e),V(js,r),Ln=e|r.baseLanes}function Nu(){V(uc,Ln),V(js,js.current)}function Au(){Ln=uc.current,j(js),j(uc)}var Aa=G(null),Xa=null;function sr(e){var r=e.alternate;V(At,At.current&1),V(Aa,e),Xa===null&&(r===null||js.current!==null||r.memoizedState!==null)&&(Xa=e)}function Du(e){V(At,At.current),V(Aa,e),Xa===null&&(Xa=e)}function Wd(e){e.tag===22?(V(At,At.current),V(Aa,e),Xa===null&&(Xa=e)):ir()}function ir(){V(At,At.current),V(Aa,Aa.current)}function Da(e){j(Aa),Xa===e&&(Xa=null),j(At)}var At=G(0);function fc(e){for(var r=e;r!==null;){if(r.tag===13){var i=r.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||I0(i)||R0(i)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Mn=0,ze=null,ut=null,jt=null,dc=!1,ks=!1,Wr=!1,hc=0,Li=0,Us=null,hx=0;function _t(){throw Error(s(321))}function Mu(e,r){if(r===null)return!1;for(var i=0;i<r.length&&i<e.length;i++)if(!ba(e[i],r[i]))return!1;return!0}function ju(e,r,i,c,d,v){return Mn=v,ze=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ee.H=e===null||e.memoizedState===null?Ah:Vu,Wr=!1,v=i(c,d),Wr=!1,ks&&(v=Yd(r,i,c,d)),Vd(e),v}function Vd(e){ee.H=Pi;var r=ut!==null&&ut.next!==null;if(Mn=0,jt=ut=ze=null,dc=!1,Li=0,Us=null,r)throw Error(s(300));e===null||kt||(e=e.dependencies,e!==null&&nc(e)&&(kt=!0))}function Yd(e,r,i,c){ze=e;var d=0;do{if(ks&&(Us=null),Li=0,ks=!1,25<=d)throw Error(s(301));if(d+=1,jt=ut=null,e.updateQueue!=null){var v=e.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ee.H=Dh,v=r(i,c)}while(ks);return v}function mx(){var e=ee.H,r=e.useState()[0];return r=typeof r.then=="function"?Bi(r):r,e=e.useState()[0],(ut!==null?ut.memoizedState:null)!==e&&(ze.flags|=1024),r}function ku(){var e=hc!==0;return hc=0,e}function Uu(e,r,i){r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~i}function Ou(e){if(dc){for(e=e.memoizedState;e!==null;){var r=e.queue;r!==null&&(r.pending=null),e=e.next}dc=!1}Mn=0,jt=ut=ze=null,ks=!1,Li=hc=0,Us=null}function ua(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?ze.memoizedState=jt=e:jt=jt.next=e,jt}function Dt(){if(ut===null){var e=ze.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var r=jt===null?ze.memoizedState:jt.next;if(r!==null)jt=r,ut=e;else{if(e===null)throw ze.alternate===null?Error(s(467)):Error(s(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},jt===null?ze.memoizedState=jt=e:jt=jt.next=e}return jt}function mc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bi(e){var r=Li;return Li+=1,Us===null&&(Us=[]),e=Fd(Us,e,r),r=ze,(jt===null?r.memoizedState:jt.next)===null&&(r=r.alternate,ee.H=r===null||r.memoizedState===null?Ah:Vu),e}function vc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Bi(e);if(e.$$typeof===D)return Xt(e)}throw Error(s(438,String(e)))}function Iu(e){var r=null,i=ze.updateQueue;if(i!==null&&(r=i.memoCache),r==null){var c=ze.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(d){return d.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),i===null&&(i=mc(),ze.updateQueue=i),i.memoCache=r,i=r.data[r.index],i===void 0)for(i=r.data[r.index]=Array(e),c=0;c<e;c++)i[c]=X;return r.index++,i}function jn(e,r){return typeof r=="function"?r(e):r}function gc(e){var r=Dt();return Ru(r,ut,e)}function Ru(e,r,i){var c=e.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=i;var d=e.baseQueue,v=c.pending;if(v!==null){if(d!==null){var E=d.next;d.next=v.next,v.next=E}r.baseQueue=d=v,c.pending=null}if(v=e.baseState,d===null)e.memoizedState=v;else{r=d.next;var A=E=null,W=null,ae=r,de=!1;do{var ve=ae.lane&-536870913;if(ve!==ae.lane?(Je&ve)===ve:(Mn&ve)===ve){var ie=ae.revertLane;if(ie===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),ve===Ns&&(de=!0);else if((Mn&ie)===ie){ae=ae.next,ie===Ns&&(de=!0);continue}else ve={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},W===null?(A=W=ve,E=v):W=W.next=ve,ze.lanes|=ie,or|=ie;ve=ae.action,Wr&&i(v,ve),v=ae.hasEagerState?ae.eagerState:i(v,ve)}else ie={lane:ve,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},W===null?(A=W=ie,E=v):W=W.next=ie,ze.lanes|=ve,or|=ve;ae=ae.next}while(ae!==null&&ae!==r);if(W===null?E=v:W.next=A,!ba(v,e.memoizedState)&&(kt=!0,de&&(i=As,i!==null)))throw i;e.memoizedState=v,e.baseState=E,e.baseQueue=W,c.lastRenderedState=v}return d===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function Fu(e){var r=Dt(),i=r.queue;if(i===null)throw Error(s(311));i.lastRenderedReducer=e;var c=i.dispatch,d=i.pending,v=r.memoizedState;if(d!==null){i.pending=null;var E=d=d.next;do v=e(v,E.action),E=E.next;while(E!==d);ba(v,r.memoizedState)||(kt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),i.lastRenderedState=v}return[v,c]}function Xd(e,r,i){var c=ze,d=Dt(),v=$e;if(v){if(i===void 0)throw Error(s(407));i=i()}else i=r();var E=!ba((ut||d).memoizedState,i);if(E&&(d.memoizedState=i,kt=!0),d=d.queue,Ku($d.bind(null,c,d,e),[e]),d.getSnapshot!==r||E||jt!==null&&jt.memoizedState.tag&1){if(c.flags|=2048,Os(9,{destroy:void 0},qd.bind(null,c,d,i,r),null),mt===null)throw Error(s(349));v||(Mn&127)!==0||Jd(c,r,i)}return i}function Jd(e,r,i){e.flags|=16384,e={getSnapshot:r,value:i},r=ze.updateQueue,r===null?(r=mc(),ze.updateQueue=r,r.stores=[e]):(i=r.stores,i===null?r.stores=[e]:i.push(e))}function qd(e,r,i,c){r.value=i,r.getSnapshot=c,Qd(r)&&Zd(e)}function $d(e,r,i){return i(function(){Qd(r)&&Zd(e)})}function Qd(e){var r=e.getSnapshot;e=e.value;try{var i=r();return!ba(e,i)}catch{return!0}}function Zd(e){var r=Rr(e,2);r!==null&&ya(r,e,2)}function Lu(e){var r=ua();if(typeof e=="function"){var i=e;if(e=i(),Wr){tn(!0);try{i()}finally{tn(!1)}}}return r.memoizedState=r.baseState=e,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:e},r}function eh(e,r,i,c){return e.baseState=i,Ru(e,ut,typeof c=="function"?c:jn)}function vx(e,r,i,c,d){if(Sc(e))throw Error(s(485));if(e=r.action,e!==null){var v={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){v.listeners.push(E)}};ee.T!==null?i(!0):v.isTransition=!1,c(v),i=r.pending,i===null?(v.next=r.pending=v,th(r,v)):(v.next=i.next,r.pending=i.next=v)}}function th(e,r){var i=r.action,c=r.payload,d=e.state;if(r.isTransition){var v=ee.T,E={};ee.T=E;try{var A=i(d,c),W=ee.S;W!==null&&W(E,A),ah(e,r,A)}catch(ae){Bu(e,r,ae)}finally{v!==null&&E.types!==null&&(v.types=E.types),ee.T=v}}else try{v=i(d,c),ah(e,r,v)}catch(ae){Bu(e,r,ae)}}function ah(e,r,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){nh(e,r,c)},function(c){return Bu(e,r,c)}):nh(e,r,i)}function nh(e,r,i){r.status="fulfilled",r.value=i,rh(r),e.state=i,r=e.pending,r!==null&&(i=r.next,i===r?e.pending=null:(i=i.next,r.next=i,th(e,i)))}function Bu(e,r,i){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=i,rh(r),r=r.next;while(r!==c)}e.action=null}function rh(e){e=e.listeners;for(var r=0;r<e.length;r++)(0,e[r])()}function sh(e,r){return r}function ih(e,r){if($e){var i=mt.formState;if(i!==null){e:{var c=ze;if($e){if(xt){t:{for(var d=xt,v=Ya;d.nodeType!==8;){if(!v){d=null;break t}if(d=Ja(d.nextSibling),d===null){d=null;break t}}v=d.data,d=v==="F!"||v==="F"?d:null}if(d){xt=Ja(d.nextSibling),c=d.data==="F!";break e}}er(c)}c=!1}c&&(r=i[0])}}return i=ua(),i.memoizedState=i.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sh,lastRenderedState:r},i.queue=c,i=wh.bind(null,ze,c),c.dispatch=i,c=Lu(!1),v=Wu.bind(null,ze,!1,c.queue),c=ua(),d={state:r,dispatch:null,action:e,pending:null},c.queue=d,i=vx.bind(null,ze,d,v,i),d.dispatch=i,c.memoizedState=e,[r,i,!1]}function lh(e){var r=Dt();return ch(r,ut,e)}function ch(e,r,i){if(r=Ru(e,r,sh)[0],e=gc(jn)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Bi(r)}catch(E){throw E===Ds?ic:E}else c=r;r=Dt();var d=r.queue,v=d.dispatch;return i!==r.memoizedState&&(ze.flags|=2048,Os(9,{destroy:void 0},gx.bind(null,d,i),null)),[c,v,e]}function gx(e,r){e.action=r}function oh(e){var r=Dt(),i=ut;if(i!==null)return ch(r,i,e);Dt(),r=r.memoizedState,i=Dt();var c=i.queue.dispatch;return i.memoizedState=e,[r,c,!1]}function Os(e,r,i,c){return e={tag:e,create:i,deps:c,inst:r,next:null},r=ze.updateQueue,r===null&&(r=mc(),ze.updateQueue=r),i=r.lastEffect,i===null?r.lastEffect=e.next=e:(c=i.next,i.next=e,e.next=c,r.lastEffect=e),e}function uh(){return Dt().memoizedState}function pc(e,r,i,c){var d=ua();ze.flags|=e,d.memoizedState=Os(1|r,{destroy:void 0},i,c===void 0?null:c)}function xc(e,r,i,c){var d=Dt();c=c===void 0?null:c;var v=d.memoizedState.inst;ut!==null&&c!==null&&Mu(c,ut.memoizedState.deps)?d.memoizedState=Os(r,v,i,c):(ze.flags|=e,d.memoizedState=Os(1|r,v,i,c))}function fh(e,r){pc(8390656,8,e,r)}function Ku(e,r){xc(2048,8,e,r)}function px(e){ze.flags|=4;var r=ze.updateQueue;if(r===null)r=mc(),ze.updateQueue=r,r.events=[e];else{var i=r.events;i===null?r.events=[e]:i.push(e)}}function dh(e){var r=Dt().memoizedState;return px({ref:r,nextImpl:e}),function(){if((at&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}function hh(e,r){return xc(4,2,e,r)}function mh(e,r){return xc(4,4,e,r)}function vh(e,r){if(typeof r=="function"){e=e();var i=r(e);return function(){typeof i=="function"?i():r(null)}}if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function gh(e,r,i){i=i!=null?i.concat([e]):null,xc(4,4,vh.bind(null,r,e),i)}function Pu(){}function ph(e,r){var i=Dt();r=r===void 0?null:r;var c=i.memoizedState;return r!==null&&Mu(r,c[1])?c[0]:(i.memoizedState=[e,r],e)}function xh(e,r){var i=Dt();r=r===void 0?null:r;var c=i.memoizedState;if(r!==null&&Mu(r,c[1]))return c[0];if(c=e(),Wr){tn(!0);try{e()}finally{tn(!1)}}return i.memoizedState=[c,r],c}function zu(e,r,i){return i===void 0||(Mn&1073741824)!==0&&(Je&261930)===0?e.memoizedState=r:(e.memoizedState=i,e=Sm(),ze.lanes|=e,or|=e,i)}function Sh(e,r,i,c){return ba(i,r)?i:js.current!==null?(e=zu(e,i,c),ba(e,r)||(kt=!0),e):(Mn&42)===0||(Mn&1073741824)!==0&&(Je&261930)===0?(kt=!0,e.memoizedState=i):(e=Sm(),ze.lanes|=e,or|=e,r)}function yh(e,r,i,c,d){var v=ge.p;ge.p=v!==0&&8>v?v:8;var E=ee.T,A={};ee.T=A,Wu(e,!1,r,i);try{var W=d(),ae=ee.S;if(ae!==null&&ae(A,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var de=dx(W,c);Ki(e,r,de,ka(e))}else Ki(e,r,c,ka(e))}catch(ve){Ki(e,r,{then:function(){},status:"rejected",reason:ve},ka())}finally{ge.p=v,E!==null&&A.types!==null&&(E.types=A.types),ee.T=E}}function xx(){}function Hu(e,r,i,c){if(e.tag!==5)throw Error(s(476));var d=Ch(e).queue;yh(e,d,r,ke,i===null?xx:function(){return Th(e),i(c)})}function Ch(e){var r=e.memoizedState;if(r!==null)return r;r={memoizedState:ke,baseState:ke,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:ke},next:null};var i={};return r.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:i},next:null},e.memoizedState=r,e=e.alternate,e!==null&&(e.memoizedState=r),r}function Th(e){var r=Ch(e);r.next===null&&(r=e.alternate.memoizedState),Ki(e,r.next.queue,{},ka())}function Gu(){return Xt(nl)}function Eh(){return Dt().memoizedState}function _h(){return Dt().memoizedState}function Sx(e){for(var r=e.return;r!==null;){switch(r.tag){case 24:case 3:var i=ka();e=nr(i);var c=rr(r,e,i);c!==null&&(ya(c,r,i),Ii(c,r,i)),r={cache:Su()},e.payload=r;return}r=r.return}}function yx(e,r,i){var c=ka();i={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Sc(e)?bh(r,i):(i=cu(e,r,i,c),i!==null&&(ya(i,e,c),Nh(i,r,c)))}function wh(e,r,i){var c=ka();Ki(e,r,i,c)}function Ki(e,r,i,c){var d={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(Sc(e))bh(r,d);else{var v=e.alternate;if(e.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var E=r.lastRenderedState,A=v(E,i);if(d.hasEagerState=!0,d.eagerState=A,ba(A,E))return Zl(e,r,d,0),mt===null&&Ql(),!1}catch{}finally{}if(i=cu(e,r,d,c),i!==null)return ya(i,e,c),Nh(i,r,c),!0}return!1}function Wu(e,r,i,c){if(c={lane:2,revertLane:E0(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Sc(e)){if(r)throw Error(s(479))}else r=cu(e,i,c,2),r!==null&&ya(r,e,2)}function Sc(e){var r=e.alternate;return e===ze||r!==null&&r===ze}function bh(e,r){ks=dc=!0;var i=e.pending;i===null?r.next=r:(r.next=i.next,i.next=r),e.pending=r}function Nh(e,r,i){if((i&4194048)!==0){var c=r.lanes;c&=e.pendingLanes,i|=c,r.lanes=i,hs(e,i)}}var Pi={readContext:Xt,use:vc,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useLayoutEffect:_t,useInsertionEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useSyncExternalStore:_t,useId:_t,useHostTransitionStatus:_t,useFormState:_t,useActionState:_t,useOptimistic:_t,useMemoCache:_t,useCacheRefresh:_t};Pi.useEffectEvent=_t;var Ah={readContext:Xt,use:vc,useCallback:function(e,r){return ua().memoizedState=[e,r===void 0?null:r],e},useContext:Xt,useEffect:fh,useImperativeHandle:function(e,r,i){i=i!=null?i.concat([e]):null,pc(4194308,4,vh.bind(null,r,e),i)},useLayoutEffect:function(e,r){return pc(4194308,4,e,r)},useInsertionEffect:function(e,r){pc(4,2,e,r)},useMemo:function(e,r){var i=ua();r=r===void 0?null:r;var c=e();if(Wr){tn(!0);try{e()}finally{tn(!1)}}return i.memoizedState=[c,r],c},useReducer:function(e,r,i){var c=ua();if(i!==void 0){var d=i(r);if(Wr){tn(!0);try{i(r)}finally{tn(!1)}}}else d=r;return c.memoizedState=c.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},c.queue=e,e=e.dispatch=yx.bind(null,ze,e),[c.memoizedState,e]},useRef:function(e){var r=ua();return e={current:e},r.memoizedState=e},useState:function(e){e=Lu(e);var r=e.queue,i=wh.bind(null,ze,r);return r.dispatch=i,[e.memoizedState,i]},useDebugValue:Pu,useDeferredValue:function(e,r){var i=ua();return zu(i,e,r)},useTransition:function(){var e=Lu(!1);return e=yh.bind(null,ze,e.queue,!0,!1),ua().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,r,i){var c=ze,d=ua();if($e){if(i===void 0)throw Error(s(407));i=i()}else{if(i=r(),mt===null)throw Error(s(349));(Je&127)!==0||Jd(c,r,i)}d.memoizedState=i;var v={value:i,getSnapshot:r};return d.queue=v,fh($d.bind(null,c,v,e),[e]),c.flags|=2048,Os(9,{destroy:void 0},qd.bind(null,c,v,i,r),null),i},useId:function(){var e=ua(),r=mt.identifierPrefix;if($e){var i=gn,c=vn;i=(c&~(1<<32-oa(c)-1)).toString(32)+i,r="_"+r+"R_"+i,i=hc++,0<i&&(r+="H"+i.toString(32)),r+="_"}else i=hx++,r="_"+r+"r_"+i.toString(32)+"_";return e.memoizedState=r},useHostTransitionStatus:Gu,useFormState:ih,useActionState:ih,useOptimistic:function(e){var r=ua();r.memoizedState=r.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=i,r=Wu.bind(null,ze,!0,i),i.dispatch=r,[e,r]},useMemoCache:Iu,useCacheRefresh:function(){return ua().memoizedState=Sx.bind(null,ze)},useEffectEvent:function(e){var r=ua(),i={impl:e};return r.memoizedState=i,function(){if((at&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}},Vu={readContext:Xt,use:vc,useCallback:ph,useContext:Xt,useEffect:Ku,useImperativeHandle:gh,useInsertionEffect:hh,useLayoutEffect:mh,useMemo:xh,useReducer:gc,useRef:uh,useState:function(){return gc(jn)},useDebugValue:Pu,useDeferredValue:function(e,r){var i=Dt();return Sh(i,ut.memoizedState,e,r)},useTransition:function(){var e=gc(jn)[0],r=Dt().memoizedState;return[typeof e=="boolean"?e:Bi(e),r]},useSyncExternalStore:Xd,useId:Eh,useHostTransitionStatus:Gu,useFormState:lh,useActionState:lh,useOptimistic:function(e,r){var i=Dt();return eh(i,ut,e,r)},useMemoCache:Iu,useCacheRefresh:_h};Vu.useEffectEvent=dh;var Dh={readContext:Xt,use:vc,useCallback:ph,useContext:Xt,useEffect:Ku,useImperativeHandle:gh,useInsertionEffect:hh,useLayoutEffect:mh,useMemo:xh,useReducer:Fu,useRef:uh,useState:function(){return Fu(jn)},useDebugValue:Pu,useDeferredValue:function(e,r){var i=Dt();return ut===null?zu(i,e,r):Sh(i,ut.memoizedState,e,r)},useTransition:function(){var e=Fu(jn)[0],r=Dt().memoizedState;return[typeof e=="boolean"?e:Bi(e),r]},useSyncExternalStore:Xd,useId:Eh,useHostTransitionStatus:Gu,useFormState:oh,useActionState:oh,useOptimistic:function(e,r){var i=Dt();return ut!==null?eh(i,ut,e,r):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:Iu,useCacheRefresh:_h};Dh.useEffectEvent=dh;function Yu(e,r,i,c){r=e.memoizedState,i=i(c,r),i=i==null?r:S({},r,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Xu={enqueueSetState:function(e,r,i){e=e._reactInternals;var c=ka(),d=nr(c);d.payload=r,i!=null&&(d.callback=i),r=rr(e,d,c),r!==null&&(ya(r,e,c),Ii(r,e,c))},enqueueReplaceState:function(e,r,i){e=e._reactInternals;var c=ka(),d=nr(c);d.tag=1,d.payload=r,i!=null&&(d.callback=i),r=rr(e,d,c),r!==null&&(ya(r,e,c),Ii(r,e,c))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var i=ka(),c=nr(i);c.tag=2,r!=null&&(c.callback=r),r=rr(e,c,i),r!==null&&(ya(r,e,i),Ii(r,e,i))}};function Mh(e,r,i,c,d,v,E){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,v,E):r.prototype&&r.prototype.isPureReactComponent?!Ni(i,c)||!Ni(d,v):!0}function jh(e,r,i,c){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(i,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(i,c),r.state!==e&&Xu.enqueueReplaceState(r,r.state,null)}function Vr(e,r){var i=r;if("ref"in r){i={};for(var c in r)c!=="ref"&&(i[c]=r[c])}if(e=e.defaultProps){i===r&&(i=S({},i));for(var d in e)i[d]===void 0&&(i[d]=e[d])}return i}function kh(e){$l(e)}function Uh(e){console.error(e)}function Oh(e){$l(e)}function yc(e,r){try{var i=e.onUncaughtError;i(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Ih(e,r,i){try{var c=e.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Ju(e,r,i){return i=nr(i),i.tag=3,i.payload={element:null},i.callback=function(){yc(e,r)},i}function Rh(e){return e=nr(e),e.tag=3,e}function Fh(e,r,i,c){var d=i.type.getDerivedStateFromError;if(typeof d=="function"){var v=c.value;e.payload=function(){return d(v)},e.callback=function(){Ih(r,i,c)}}var E=i.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(e.callback=function(){Ih(r,i,c),typeof d!="function"&&(ur===null?ur=new Set([this]):ur.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})})}function Cx(e,r,i,c,d){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=i.alternate,r!==null&&bs(r,i,d,!0),i=Aa.current,i!==null){switch(i.tag){case 31:case 13:return Xa===null?kc():i.alternate===null&&wt===0&&(wt=3),i.flags&=-257,i.flags|=65536,i.lanes=d,c===lc?i.flags|=16384:(r=i.updateQueue,r===null?i.updateQueue=new Set([c]):r.add(c),y0(e,c,d)),!1;case 22:return i.flags|=65536,c===lc?i.flags|=16384:(r=i.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=r):(i=r.retryQueue,i===null?r.retryQueue=new Set([c]):i.add(c)),y0(e,c,d)),!1}throw Error(s(435,i.tag))}return y0(e,c,d),kc(),!1}if($e)return r=Aa.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=d,c!==mu&&(e=Error(s(422),{cause:c}),Mi(Ga(e,i)))):(c!==mu&&(r=Error(s(423),{cause:c}),Mi(Ga(r,i))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,c=Ga(c,i),d=Ju(e.stateNode,c,d),wu(e,d),wt!==4&&(wt=2)),!1;var v=Error(s(520),{cause:c});if(v=Ga(v,i),Ji===null?Ji=[v]:Ji.push(v),wt!==4&&(wt=2),r===null)return!0;c=Ga(c,i),i=r;do{switch(i.tag){case 3:return i.flags|=65536,e=d&-d,i.lanes|=e,e=Ju(i.stateNode,c,e),wu(i,e),!1;case 1:if(r=i.type,v=i.stateNode,(i.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ur===null||!ur.has(v))))return i.flags|=65536,d&=-d,i.lanes|=d,d=Rh(d),Fh(d,e,i,c),wu(i,d),!1}i=i.return}while(i!==null);return!1}var qu=Error(s(461)),kt=!1;function Jt(e,r,i,c){r.child=e===null?Pd(r,null,i,c):Gr(r,e.child,i,c)}function Lh(e,r,i,c,d){i=i.render;var v=r.ref;if("ref"in c){var E={};for(var A in c)A!=="ref"&&(E[A]=c[A])}else E=c;return Kr(r),c=ju(e,r,i,E,v,d),A=ku(),e!==null&&!kt?(Uu(e,r,d),kn(e,r,d)):($e&&A&&du(r),r.flags|=1,Jt(e,r,c,d),r.child)}function Bh(e,r,i,c,d){if(e===null){var v=i.type;return typeof v=="function"&&!ou(v)&&v.defaultProps===void 0&&i.compare===null?(r.tag=15,r.type=v,Kh(e,r,v,c,d)):(e=tc(i.type,null,c,r,r.mode,d),e.ref=r.ref,e.return=r,r.child=e)}if(v=e.child,!r0(e,d)){var E=v.memoizedProps;if(i=i.compare,i=i!==null?i:Ni,i(E,c)&&e.ref===r.ref)return kn(e,r,d)}return r.flags|=1,e=bn(v,c),e.ref=r.ref,e.return=r,r.child=e}function Kh(e,r,i,c,d){if(e!==null){var v=e.memoizedProps;if(Ni(v,c)&&e.ref===r.ref)if(kt=!1,r.pendingProps=c=v,r0(e,d))(e.flags&131072)!==0&&(kt=!0);else return r.lanes=e.lanes,kn(e,r,d)}return $u(e,r,i,c,d)}function Ph(e,r,i,c){var d=c.children,v=e!==null?e.memoizedState:null;if(e===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(v=v!==null?v.baseLanes|i:i,e!==null){for(c=r.child=e.child,d=0;c!==null;)d=d|c.lanes|c.childLanes,c=c.sibling;c=d&~v}else c=0,r.child=null;return zh(e,r,v,i,c)}if((i&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},e!==null&&sc(r,v!==null?v.cachePool:null),v!==null?Gd(r,v):Nu(),Wd(r);else return c=r.lanes=536870912,zh(e,r,v!==null?v.baseLanes|i:i,i,c)}else v!==null?(sc(r,v.cachePool),Gd(r,v),ir(),r.memoizedState=null):(e!==null&&sc(r,null),Nu(),ir());return Jt(e,r,d,i),r.child}function zi(e,r){return e!==null&&e.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function zh(e,r,i,c,d){var v=Cu();return v=v===null?null:{parent:Mt._currentValue,pool:v},r.memoizedState={baseLanes:i,cachePool:v},e!==null&&sc(r,null),Nu(),Wd(r),e!==null&&bs(e,r,c,!0),r.childLanes=d,null}function Cc(e,r){return r=Ec({mode:r.mode,children:r.children},e.mode),r.ref=e.ref,e.child=r,r.return=e,r}function Hh(e,r,i){return Gr(r,e.child,null,i),e=Cc(r,r.pendingProps),e.flags|=2,Da(r),r.memoizedState=null,e}function Tx(e,r,i){var c=r.pendingProps,d=(r.flags&128)!==0;if(r.flags&=-129,e===null){if($e){if(c.mode==="hidden")return e=Cc(r,c),r.lanes=536870912,zi(null,e);if(Du(r),(e=xt)?(e=t1(e,Ya),e=e!==null&&e.data==="&"?e:null,e!==null&&(r.memoizedState={dehydrated:e,treeContext:Qn!==null?{id:vn,overflow:gn}:null,retryLane:536870912,hydrationErrors:null},i=bd(e),i.return=r,r.child=i,Yt=r,xt=null)):e=null,e===null)throw er(r);return r.lanes=536870912,null}return Cc(r,c)}var v=e.memoizedState;if(v!==null){var E=v.dehydrated;if(Du(r),d)if(r.flags&256)r.flags&=-257,r=Hh(e,r,i);else if(r.memoizedState!==null)r.child=e.child,r.flags|=128,r=null;else throw Error(s(558));else if(kt||bs(e,r,i,!1),d=(i&e.childLanes)!==0,kt||d){if(c=mt,c!==null&&(E=Pl(c,i),E!==0&&E!==v.retryLane))throw v.retryLane=E,Rr(e,E),ya(c,e,E),qu;kc(),r=Hh(e,r,i)}else e=v.treeContext,xt=Ja(E.nextSibling),Yt=r,$e=!0,Zn=null,Ya=!1,e!==null&&Dd(r,e),r=Cc(r,c),r.flags|=4096;return r}return e=bn(e.child,{mode:c.mode,children:c.children}),e.ref=r.ref,r.child=e,e.return=r,e}function Tc(e,r){var i=r.ref;if(i===null)e!==null&&e.ref!==null&&(r.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(s(284));(e===null||e.ref!==i)&&(r.flags|=4194816)}}function $u(e,r,i,c,d){return Kr(r),i=ju(e,r,i,c,void 0,d),c=ku(),e!==null&&!kt?(Uu(e,r,d),kn(e,r,d)):($e&&c&&du(r),r.flags|=1,Jt(e,r,i,d),r.child)}function Gh(e,r,i,c,d,v){return Kr(r),r.updateQueue=null,i=Yd(r,c,i,d),Vd(e),c=ku(),e!==null&&!kt?(Uu(e,r,v),kn(e,r,v)):($e&&c&&du(r),r.flags|=1,Jt(e,r,i,v),r.child)}function Wh(e,r,i,c,d){if(Kr(r),r.stateNode===null){var v=Ts,E=i.contextType;typeof E=="object"&&E!==null&&(v=Xt(E)),v=new i(c,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Xu,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=c,v.state=r.memoizedState,v.refs={},Eu(r),E=i.contextType,v.context=typeof E=="object"&&E!==null?Xt(E):Ts,v.state=r.memoizedState,E=i.getDerivedStateFromProps,typeof E=="function"&&(Yu(r,i,E,c),v.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(E=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),E!==v.state&&Xu.enqueueReplaceState(v,v.state,null),Fi(r,c,v,d),Ri(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(e===null){v=r.stateNode;var A=r.memoizedProps,W=Vr(i,A);v.props=W;var ae=v.context,de=i.contextType;E=Ts,typeof de=="object"&&de!==null&&(E=Xt(de));var ve=i.getDerivedStateFromProps;de=typeof ve=="function"||typeof v.getSnapshotBeforeUpdate=="function",A=r.pendingProps!==A,de||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A||ae!==E)&&jh(r,v,c,E),ar=!1;var ie=r.memoizedState;v.state=ie,Fi(r,c,v,d),Ri(),ae=r.memoizedState,A||ie!==ae||ar?(typeof ve=="function"&&(Yu(r,i,ve,c),ae=r.memoizedState),(W=ar||Mh(r,i,W,c,ie,ae,E))?(de||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ae),v.props=c,v.state=ae,v.context=E,c=W):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{v=r.stateNode,_u(e,r),E=r.memoizedProps,de=Vr(i,E),v.props=de,ve=r.pendingProps,ie=v.context,ae=i.contextType,W=Ts,typeof ae=="object"&&ae!==null&&(W=Xt(ae)),A=i.getDerivedStateFromProps,(ae=typeof A=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(E!==ve||ie!==W)&&jh(r,v,c,W),ar=!1,ie=r.memoizedState,v.state=ie,Fi(r,c,v,d),Ri();var oe=r.memoizedState;E!==ve||ie!==oe||ar||e!==null&&e.dependencies!==null&&nc(e.dependencies)?(typeof A=="function"&&(Yu(r,i,A,c),oe=r.memoizedState),(de=ar||Mh(r,i,de,c,ie,oe,W)||e!==null&&e.dependencies!==null&&nc(e.dependencies))?(ae||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,oe,W),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,oe,W)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||E===e.memoizedProps&&ie===e.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&ie===e.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=oe),v.props=c,v.state=oe,v.context=W,c=de):(typeof v.componentDidUpdate!="function"||E===e.memoizedProps&&ie===e.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&ie===e.memoizedState||(r.flags|=1024),c=!1)}return v=c,Tc(e,r),c=(r.flags&128)!==0,v||c?(v=r.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,e!==null&&c?(r.child=Gr(r,e.child,null,d),r.child=Gr(r,null,i,d)):Jt(e,r,i,d),r.memoizedState=v.state,e=r.child):e=kn(e,r,d),e}function Vh(e,r,i,c){return Lr(),r.flags|=256,Jt(e,r,i,c),r.child}var Qu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zu(e){return{baseLanes:e,cachePool:Id()}}function e0(e,r,i){return e=e!==null?e.childLanes&~i:0,r&&(e|=ja),e}function Yh(e,r,i){var c=r.pendingProps,d=!1,v=(r.flags&128)!==0,E;if((E=v)||(E=e!==null&&e.memoizedState===null?!1:(At.current&2)!==0),E&&(d=!0,r.flags&=-129),E=(r.flags&32)!==0,r.flags&=-33,e===null){if($e){if(d?sr(r):ir(),(e=xt)?(e=t1(e,Ya),e=e!==null&&e.data!=="&"?e:null,e!==null&&(r.memoizedState={dehydrated:e,treeContext:Qn!==null?{id:vn,overflow:gn}:null,retryLane:536870912,hydrationErrors:null},i=bd(e),i.return=r,r.child=i,Yt=r,xt=null)):e=null,e===null)throw er(r);return R0(e)?r.lanes=32:r.lanes=536870912,null}var A=c.children;return c=c.fallback,d?(ir(),d=r.mode,A=Ec({mode:"hidden",children:A},d),c=Fr(c,d,i,null),A.return=r,c.return=r,A.sibling=c,r.child=A,c=r.child,c.memoizedState=Zu(i),c.childLanes=e0(e,E,i),r.memoizedState=Qu,zi(null,c)):(sr(r),t0(r,A))}var W=e.memoizedState;if(W!==null&&(A=W.dehydrated,A!==null)){if(v)r.flags&256?(sr(r),r.flags&=-257,r=a0(e,r,i)):r.memoizedState!==null?(ir(),r.child=e.child,r.flags|=128,r=null):(ir(),A=c.fallback,d=r.mode,c=Ec({mode:"visible",children:c.children},d),A=Fr(A,d,i,null),A.flags|=2,c.return=r,A.return=r,c.sibling=A,r.child=c,Gr(r,e.child,null,i),c=r.child,c.memoizedState=Zu(i),c.childLanes=e0(e,E,i),r.memoizedState=Qu,r=zi(null,c));else if(sr(r),R0(A)){if(E=A.nextSibling&&A.nextSibling.dataset,E)var ae=E.dgst;E=ae,c=Error(s(419)),c.stack="",c.digest=E,Mi({value:c,source:null,stack:null}),r=a0(e,r,i)}else if(kt||bs(e,r,i,!1),E=(i&e.childLanes)!==0,kt||E){if(E=mt,E!==null&&(c=Pl(E,i),c!==0&&c!==W.retryLane))throw W.retryLane=c,Rr(e,c),ya(E,e,c),qu;I0(A)||kc(),r=a0(e,r,i)}else I0(A)?(r.flags|=192,r.child=e.child,r=null):(e=W.treeContext,xt=Ja(A.nextSibling),Yt=r,$e=!0,Zn=null,Ya=!1,e!==null&&Dd(r,e),r=t0(r,c.children),r.flags|=4096);return r}return d?(ir(),A=c.fallback,d=r.mode,W=e.child,ae=W.sibling,c=bn(W,{mode:"hidden",children:c.children}),c.subtreeFlags=W.subtreeFlags&65011712,ae!==null?A=bn(ae,A):(A=Fr(A,d,i,null),A.flags|=2),A.return=r,c.return=r,c.sibling=A,r.child=c,zi(null,c),c=r.child,A=e.child.memoizedState,A===null?A=Zu(i):(d=A.cachePool,d!==null?(W=Mt._currentValue,d=d.parent!==W?{parent:W,pool:W}:d):d=Id(),A={baseLanes:A.baseLanes|i,cachePool:d}),c.memoizedState=A,c.childLanes=e0(e,E,i),r.memoizedState=Qu,zi(e.child,c)):(sr(r),i=e.child,e=i.sibling,i=bn(i,{mode:"visible",children:c.children}),i.return=r,i.sibling=null,e!==null&&(E=r.deletions,E===null?(r.deletions=[e],r.flags|=16):E.push(e)),r.child=i,r.memoizedState=null,i)}function t0(e,r){return r=Ec({mode:"visible",children:r},e.mode),r.return=e,e.child=r}function Ec(e,r){return e=Na(22,e,null,r),e.lanes=0,e}function a0(e,r,i){return Gr(r,e.child,null,i),e=t0(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function Xh(e,r,i){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r),pu(e.return,r,i)}function n0(e,r,i,c,d,v){var E=e.memoizedState;E===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:d,treeForkCount:v}:(E.isBackwards=r,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=i,E.tailMode=d,E.treeForkCount=v)}function Jh(e,r,i){var c=r.pendingProps,d=c.revealOrder,v=c.tail;c=c.children;var E=At.current,A=(E&2)!==0;if(A?(E=E&1|2,r.flags|=128):E&=1,V(At,E),Jt(e,r,c,i),c=$e?Di:0,!A&&e!==null&&(e.flags&128)!==0)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xh(e,i,r);else if(e.tag===19)Xh(e,i,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(i=r.child,d=null;i!==null;)e=i.alternate,e!==null&&fc(e)===null&&(d=i),i=i.sibling;i=d,i===null?(d=r.child,r.child=null):(d=i.sibling,i.sibling=null),n0(r,!1,d,i,v,c);break;case"backwards":case"unstable_legacy-backwards":for(i=null,d=r.child,r.child=null;d!==null;){if(e=d.alternate,e!==null&&fc(e)===null){r.child=d;break}e=d.sibling,d.sibling=i,i=d,d=e}n0(r,!0,i,null,v,c);break;case"together":n0(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function kn(e,r,i){if(e!==null&&(r.dependencies=e.dependencies),or|=r.lanes,(i&r.childLanes)===0)if(e!==null){if(bs(e,r,i,!1),(i&r.childLanes)===0)return null}else return null;if(e!==null&&r.child!==e.child)throw Error(s(153));if(r.child!==null){for(e=r.child,i=bn(e,e.pendingProps),r.child=i,i.return=r;e.sibling!==null;)e=e.sibling,i=i.sibling=bn(e,e.pendingProps),i.return=r;i.sibling=null}return r.child}function r0(e,r){return(e.lanes&r)!==0?!0:(e=e.dependencies,!!(e!==null&&nc(e)))}function Ex(e,r,i){switch(r.tag){case 3:je(r,r.stateNode.containerInfo),tr(r,Mt,e.memoizedState.cache),Lr();break;case 27:case 5:Ae(r);break;case 4:je(r,r.stateNode.containerInfo);break;case 10:tr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Du(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(sr(r),r.flags|=128,null):(i&r.child.childLanes)!==0?Yh(e,r,i):(sr(r),e=kn(e,r,i),e!==null?e.sibling:null);sr(r);break;case 19:var d=(e.flags&128)!==0;if(c=(i&r.childLanes)!==0,c||(bs(e,r,i,!1),c=(i&r.childLanes)!==0),d){if(c)return Jh(e,r,i);r.flags|=128}if(d=r.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),V(At,At.current),c)break;return null;case 22:return r.lanes=0,Ph(e,r,i,r.pendingProps);case 24:tr(r,Mt,e.memoizedState.cache)}return kn(e,r,i)}function qh(e,r,i){if(e!==null)if(e.memoizedProps!==r.pendingProps)kt=!0;else{if(!r0(e,i)&&(r.flags&128)===0)return kt=!1,Ex(e,r,i);kt=(e.flags&131072)!==0}else kt=!1,$e&&(r.flags&1048576)!==0&&Ad(r,Di,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(e=zr(r.elementType),r.type=e,typeof e=="function")ou(e)?(c=Vr(e,c),r.tag=1,r=Wh(null,r,e,c,i)):(r.tag=0,r=$u(null,r,e,c,i));else{if(e!=null){var d=e.$$typeof;if(d===b){r.tag=11,r=Lh(null,r,e,c,i);break e}else if(d===B){r.tag=14,r=Bh(null,r,e,c,i);break e}}throw r=be(e)||e,Error(s(306,r,""))}}return r;case 0:return $u(e,r,r.type,r.pendingProps,i);case 1:return c=r.type,d=Vr(c,r.pendingProps),Wh(e,r,c,d,i);case 3:e:{if(je(r,r.stateNode.containerInfo),e===null)throw Error(s(387));c=r.pendingProps;var v=r.memoizedState;d=v.element,_u(e,r),Fi(r,c,null,i);var E=r.memoizedState;if(c=E.cache,tr(r,Mt,c),c!==v.cache&&xu(r,[Mt],i,!0),Ri(),c=E.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:E.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=Vh(e,r,c,i);break e}else if(c!==d){d=Ga(Error(s(424)),r),Mi(d),r=Vh(e,r,c,i);break e}else{switch(e=r.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(xt=Ja(e.firstChild),Yt=r,$e=!0,Zn=null,Ya=!0,i=Pd(r,null,c,i),r.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(Lr(),c===d){r=kn(e,r,i);break e}Jt(e,r,c,i)}r=r.child}return r;case 26:return Tc(e,r),e===null?(i=l1(r.type,null,r.pendingProps,null))?r.memoizedState=i:$e||(i=r.type,e=r.pendingProps,c=Bc(ce.current).createElement(i),c[O]=r,c[I]=e,qt(c,i,e),Ie(c),r.stateNode=c):r.memoizedState=l1(r.type,e.memoizedProps,r.pendingProps,e.memoizedState),null;case 27:return Ae(r),e===null&&$e&&(c=r.stateNode=r1(r.type,r.pendingProps,ce.current),Yt=r,Ya=!0,d=xt,mr(r.type)?(F0=d,xt=Ja(c.firstChild)):xt=d),Jt(e,r,r.pendingProps.children,i),Tc(e,r),e===null&&(r.flags|=4194304),r.child;case 5:return e===null&&$e&&((d=c=xt)&&(c=Zx(c,r.type,r.pendingProps,Ya),c!==null?(r.stateNode=c,Yt=r,xt=Ja(c.firstChild),Ya=!1,d=!0):d=!1),d||er(r)),Ae(r),d=r.type,v=r.pendingProps,E=e!==null?e.memoizedProps:null,c=v.children,k0(d,v)?c=null:E!==null&&k0(d,E)&&(r.flags|=32),r.memoizedState!==null&&(d=ju(e,r,mx,null,null,i),nl._currentValue=d),Tc(e,r),Jt(e,r,c,i),r.child;case 6:return e===null&&$e&&((e=i=xt)&&(i=eS(i,r.pendingProps,Ya),i!==null?(r.stateNode=i,Yt=r,xt=null,e=!0):e=!1),e||er(r)),null;case 13:return Yh(e,r,i);case 4:return je(r,r.stateNode.containerInfo),c=r.pendingProps,e===null?r.child=Gr(r,null,c,i):Jt(e,r,c,i),r.child;case 11:return Lh(e,r,r.type,r.pendingProps,i);case 7:return Jt(e,r,r.pendingProps,i),r.child;case 8:return Jt(e,r,r.pendingProps.children,i),r.child;case 12:return Jt(e,r,r.pendingProps.children,i),r.child;case 10:return c=r.pendingProps,tr(r,r.type,c.value),Jt(e,r,c.children,i),r.child;case 9:return d=r.type._context,c=r.pendingProps.children,Kr(r),d=Xt(d),c=c(d),r.flags|=1,Jt(e,r,c,i),r.child;case 14:return Bh(e,r,r.type,r.pendingProps,i);case 15:return Kh(e,r,r.type,r.pendingProps,i);case 19:return Jh(e,r,i);case 31:return Tx(e,r,i);case 22:return Ph(e,r,i,r.pendingProps);case 24:return Kr(r),c=Xt(Mt),e===null?(d=Cu(),d===null&&(d=mt,v=Su(),d.pooledCache=v,v.refCount++,v!==null&&(d.pooledCacheLanes|=i),d=v),r.memoizedState={parent:c,cache:d},Eu(r),tr(r,Mt,d)):((e.lanes&i)!==0&&(_u(e,r),Fi(r,null,null,i),Ri()),d=e.memoizedState,v=r.memoizedState,d.parent!==c?(d={parent:c,cache:c},r.memoizedState=d,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=d),tr(r,Mt,c)):(c=v.cache,tr(r,Mt,c),c!==d.cache&&xu(r,[Mt],i,!0))),Jt(e,r,r.pendingProps.children,i),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function Un(e){e.flags|=4}function s0(e,r,i,c,d){if((r=(e.mode&32)!==0)&&(r=!1),r){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(Em())e.flags|=8192;else throw Hr=lc,Tu}else e.flags&=-16777217}function $h(e,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!d1(r))if(Em())e.flags|=8192;else throw Hr=lc,Tu}function _c(e,r){r!==null&&(e.flags|=4),e.flags&16384&&(r=e.tag!==22?Bl():536870912,e.lanes|=r,Ls|=r)}function Hi(e,r){if(!$e)switch(e.tailMode){case"hidden":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function St(e){var r=e.alternate!==null&&e.alternate.child===e.child,i=0,c=0;if(r)for(var d=e.child;d!==null;)i|=d.lanes|d.childLanes,c|=d.subtreeFlags&65011712,c|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)i|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=c,e.childLanes=i,r}function _x(e,r,i){var c=r.pendingProps;switch(hu(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(r),null;case 1:return St(r),null;case 3:return i=r.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Dn(Mt),we(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(ws(r)?Un(r):e===null||e.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,vu())),St(r),null;case 26:var d=r.type,v=r.memoizedState;return e===null?(Un(r),v!==null?(St(r),$h(r,v)):(St(r),s0(r,d,null,c,i))):v?v!==e.memoizedState?(Un(r),St(r),$h(r,v)):(St(r),r.flags&=-16777217):(e=e.memoizedProps,e!==c&&Un(r),St(r),s0(r,d,e,c,i)),null;case 27:if(Qe(r),i=ce.current,d=r.type,e!==null&&r.stateNode!=null)e.memoizedProps!==c&&Un(r);else{if(!c){if(r.stateNode===null)throw Error(s(166));return St(r),null}e=P.current,ws(r)?Md(r):(e=r1(d,c,i),r.stateNode=e,Un(r))}return St(r),null;case 5:if(Qe(r),d=r.type,e!==null&&r.stateNode!=null)e.memoizedProps!==c&&Un(r);else{if(!c){if(r.stateNode===null)throw Error(s(166));return St(r),null}if(v=P.current,ws(r))Md(r);else{var E=Bc(ce.current);switch(v){case 1:v=E.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:v=E.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":v=E.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":v=E.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":v=E.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?v.multiple=!0:c.size&&(v.size=c.size);break;default:v=typeof c.is=="string"?E.createElement(d,{is:c.is}):E.createElement(d)}}v[O]=r,v[I]=c;e:for(E=r.child;E!==null;){if(E.tag===5||E.tag===6)v.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===r)break e;for(;E.sibling===null;){if(E.return===null||E.return===r)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}r.stateNode=v;e:switch(qt(v,d,c),d){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Un(r)}}return St(r),s0(r,r.type,e===null?null:e.memoizedProps,r.pendingProps,i),null;case 6:if(e&&r.stateNode!=null)e.memoizedProps!==c&&Un(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(s(166));if(e=ce.current,ws(r)){if(e=r.stateNode,i=r.memoizedProps,c=null,d=Yt,d!==null)switch(d.tag){case 27:case 5:c=d.memoizedProps}e[O]=r,e=!!(e.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||Ym(e.nodeValue,i)),e||er(r,!0)}else e=Bc(e).createTextNode(c),e[O]=r,r.stateNode=e}return St(r),null;case 31:if(i=r.memoizedState,e===null||e.memoizedState!==null){if(c=ws(r),i!==null){if(e===null){if(!c)throw Error(s(318));if(e=r.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[O]=r}else Lr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;St(r),e=!1}else i=vu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return r.flags&256?(Da(r),r):(Da(r),null);if((r.flags&128)!==0)throw Error(s(558))}return St(r),null;case 13:if(c=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=ws(r),c!==null&&c.dehydrated!==null){if(e===null){if(!d)throw Error(s(318));if(d=r.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[O]=r}else Lr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;St(r),d=!1}else d=vu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return r.flags&256?(Da(r),r):(Da(r),null)}return Da(r),(r.flags&128)!==0?(r.lanes=i,r):(i=c!==null,e=e!==null&&e.memoizedState!==null,i&&(c=r.child,d=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(d=c.alternate.memoizedState.cachePool.pool),v=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==d&&(c.flags|=2048)),i!==e&&i&&(r.child.flags|=8192),_c(r,r.updateQueue),St(r),null);case 4:return we(),e===null&&N0(r.stateNode.containerInfo),St(r),null;case 10:return Dn(r.type),St(r),null;case 19:if(j(At),c=r.memoizedState,c===null)return St(r),null;if(d=(r.flags&128)!==0,v=c.rendering,v===null)if(d)Hi(c,!1);else{if(wt!==0||e!==null&&(e.flags&128)!==0)for(e=r.child;e!==null;){if(v=fc(e),v!==null){for(r.flags|=128,Hi(c,!1),e=v.updateQueue,r.updateQueue=e,_c(r,e),r.subtreeFlags=0,e=i,i=r.child;i!==null;)wd(i,e),i=i.sibling;return V(At,At.current&1|2),$e&&Nn(r,c.treeForkCount),r.child}e=e.sibling}c.tail!==null&&Ct()>Dc&&(r.flags|=128,d=!0,Hi(c,!1),r.lanes=4194304)}else{if(!d)if(e=fc(v),e!==null){if(r.flags|=128,d=!0,e=e.updateQueue,r.updateQueue=e,_c(r,e),Hi(c,!0),c.tail===null&&c.tailMode==="hidden"&&!v.alternate&&!$e)return St(r),null}else 2*Ct()-c.renderingStartTime>Dc&&i!==536870912&&(r.flags|=128,d=!0,Hi(c,!1),r.lanes=4194304);c.isBackwards?(v.sibling=r.child,r.child=v):(e=c.last,e!==null?e.sibling=v:r.child=v,c.last=v)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=Ct(),e.sibling=null,i=At.current,V(At,d?i&1|2:i&1),$e&&Nn(r,c.treeForkCount),e):(St(r),null);case 22:case 23:return Da(r),Au(),c=r.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(i&536870912)!==0&&(r.flags&128)===0&&(St(r),r.subtreeFlags&6&&(r.flags|=8192)):St(r),i=r.updateQueue,i!==null&&_c(r,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==i&&(r.flags|=2048),e!==null&&j(Pr),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),r.memoizedState.cache!==i&&(r.flags|=2048),Dn(Mt),St(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function wx(e,r){switch(hu(r),r.tag){case 1:return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Dn(Mt),we(),e=r.flags,(e&65536)!==0&&(e&128)===0?(r.flags=e&-65537|128,r):null;case 26:case 27:case 5:return Qe(r),null;case 31:if(r.memoizedState!==null){if(Da(r),r.alternate===null)throw Error(s(340));Lr()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 13:if(Da(r),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(s(340));Lr()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return j(At),null;case 4:return we(),null;case 10:return Dn(r.type),null;case 22:case 23:return Da(r),Au(),e!==null&&j(Pr),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 24:return Dn(Mt),null;case 25:return null;default:return null}}function Qh(e,r){switch(hu(r),r.tag){case 3:Dn(Mt),we();break;case 26:case 27:case 5:Qe(r);break;case 4:we();break;case 31:r.memoizedState!==null&&Da(r);break;case 13:Da(r);break;case 19:j(At);break;case 10:Dn(r.type);break;case 22:case 23:Da(r),Au(),e!==null&&j(Pr);break;case 24:Dn(Mt)}}function Gi(e,r){try{var i=r.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var d=c.next;i=d;do{if((i.tag&e)===e){c=void 0;var v=i.create,E=i.inst;c=v(),E.destroy=c}i=i.next}while(i!==d)}}catch(A){st(r,r.return,A)}}function lr(e,r,i){try{var c=r.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var v=d.next;c=v;do{if((c.tag&e)===e){var E=c.inst,A=E.destroy;if(A!==void 0){E.destroy=void 0,d=r;var W=i,ae=A;try{ae()}catch(de){st(d,W,de)}}}c=c.next}while(c!==v)}}catch(de){st(r,r.return,de)}}function Zh(e){var r=e.updateQueue;if(r!==null){var i=e.stateNode;try{Hd(r,i)}catch(c){st(e,e.return,c)}}}function em(e,r,i){i.props=Vr(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(c){st(e,r,c)}}function Wi(e,r){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof i=="function"?e.refCleanup=i(c):i.current=c}}catch(d){st(e,r,d)}}function pn(e,r){var i=e.ref,c=e.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(d){st(e,r,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(d){st(e,r,d)}else i.current=null}function tm(e){var r=e.type,i=e.memoizedProps,c=e.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(d){st(e,e.return,d)}}function i0(e,r,i){try{var c=e.stateNode;Yx(c,e.type,i,r),c[I]=r}catch(d){st(e,e.return,d)}}function am(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&mr(e.type)||e.tag===4}function l0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||am(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&mr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function c0(e,r,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,r):(r=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,r.appendChild(e),i=i._reactRootContainer,i!=null||r.onclick!==null||(r.onclick=_n));else if(c!==4&&(c===27&&mr(e.type)&&(i=e.stateNode,r=null),e=e.child,e!==null))for(c0(e,r,i),e=e.sibling;e!==null;)c0(e,r,i),e=e.sibling}function wc(e,r,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?i.insertBefore(e,r):i.appendChild(e);else if(c!==4&&(c===27&&mr(e.type)&&(i=e.stateNode),e=e.child,e!==null))for(wc(e,r,i),e=e.sibling;e!==null;)wc(e,r,i),e=e.sibling}function nm(e){var r=e.stateNode,i=e.memoizedProps;try{for(var c=e.type,d=r.attributes;d.length;)r.removeAttributeNode(d[0]);qt(r,c,i),r[O]=e,r[I]=i}catch(v){st(e,e.return,v)}}var On=!1,Ut=!1,o0=!1,rm=typeof WeakSet=="function"?WeakSet:Set,Pt=null;function bx(e,r){if(e=e.containerInfo,M0=Vc,e=gd(e),au(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var d=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{i.nodeType,v.nodeType}catch{i=null;break e}var E=0,A=-1,W=-1,ae=0,de=0,ve=e,ie=null;t:for(;;){for(var oe;ve!==i||d!==0&&ve.nodeType!==3||(A=E+d),ve!==v||c!==0&&ve.nodeType!==3||(W=E+c),ve.nodeType===3&&(E+=ve.nodeValue.length),(oe=ve.firstChild)!==null;)ie=ve,ve=oe;for(;;){if(ve===e)break t;if(ie===i&&++ae===d&&(A=E),ie===v&&++de===c&&(W=E),(oe=ve.nextSibling)!==null)break;ve=ie,ie=ve.parentNode}ve=oe}i=A===-1||W===-1?null:{start:A,end:W}}else i=null}i=i||{start:0,end:0}}else i=null;for(j0={focusedElem:e,selectionRange:i},Vc=!1,Pt=r;Pt!==null;)if(r=Pt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Pt=e;else for(;Pt!==null;){switch(r=Pt,v=r.alternate,e=r.flags,r.tag){case 0:if((e&4)!==0&&(e=r.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)d=e[i],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&v!==null){e=void 0,i=r,d=v.memoizedProps,v=v.memoizedState,c=i.stateNode;try{var Oe=Vr(i.type,d);e=c.getSnapshotBeforeUpdate(Oe,v),c.__reactInternalSnapshotBeforeUpdate=e}catch(Be){st(i,i.return,Be)}}break;case 3:if((e&1024)!==0){if(e=r.stateNode.containerInfo,i=e.nodeType,i===9)O0(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":O0(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=r.sibling,e!==null){e.return=r.return,Pt=e;break}Pt=r.return}}function sm(e,r,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:Rn(e,i),c&4&&Gi(5,i);break;case 1:if(Rn(e,i),c&4)if(e=i.stateNode,r===null)try{e.componentDidMount()}catch(E){st(i,i.return,E)}else{var d=Vr(i.type,r.memoizedProps);r=r.memoizedState;try{e.componentDidUpdate(d,r,e.__reactInternalSnapshotBeforeUpdate)}catch(E){st(i,i.return,E)}}c&64&&Zh(i),c&512&&Wi(i,i.return);break;case 3:if(Rn(e,i),c&64&&(e=i.updateQueue,e!==null)){if(r=null,i.child!==null)switch(i.child.tag){case 27:case 5:r=i.child.stateNode;break;case 1:r=i.child.stateNode}try{Hd(e,r)}catch(E){st(i,i.return,E)}}break;case 27:r===null&&c&4&&nm(i);case 26:case 5:Rn(e,i),r===null&&c&4&&tm(i),c&512&&Wi(i,i.return);break;case 12:Rn(e,i);break;case 31:Rn(e,i),c&4&&cm(e,i);break;case 13:Rn(e,i),c&4&&om(e,i),c&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=Ix.bind(null,i),tS(e,i))));break;case 22:if(c=i.memoizedState!==null||On,!c){r=r!==null&&r.memoizedState!==null||Ut,d=On;var v=Ut;On=c,(Ut=r)&&!v?Fn(e,i,(i.subtreeFlags&8772)!==0):Rn(e,i),On=d,Ut=v}break;case 30:break;default:Rn(e,i)}}function im(e){var r=e.alternate;r!==null&&(e.alternate=null,im(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&xe(r)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Et=null,ga=!1;function In(e,r,i){for(i=i.child;i!==null;)lm(e,r,i),i=i.sibling}function lm(e,r,i){if(na&&typeof na.onCommitFiberUnmount=="function")try{na.onCommitFiberUnmount(Jn,i)}catch{}switch(i.tag){case 26:Ut||pn(i,r),In(e,r,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:Ut||pn(i,r);var c=Et,d=ga;mr(i.type)&&(Et=i.stateNode,ga=!1),In(e,r,i),el(i.stateNode),Et=c,ga=d;break;case 5:Ut||pn(i,r);case 6:if(c=Et,d=ga,Et=null,In(e,r,i),Et=c,ga=d,Et!==null)if(ga)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(i.stateNode)}catch(v){st(i,r,v)}else try{Et.removeChild(i.stateNode)}catch(v){st(i,r,v)}break;case 18:Et!==null&&(ga?(e=Et,Zm(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),Vs(e)):Zm(Et,i.stateNode));break;case 4:c=Et,d=ga,Et=i.stateNode.containerInfo,ga=!0,In(e,r,i),Et=c,ga=d;break;case 0:case 11:case 14:case 15:lr(2,i,r),Ut||lr(4,i,r),In(e,r,i);break;case 1:Ut||(pn(i,r),c=i.stateNode,typeof c.componentWillUnmount=="function"&&em(i,r,c)),In(e,r,i);break;case 21:In(e,r,i);break;case 22:Ut=(c=Ut)||i.memoizedState!==null,In(e,r,i),Ut=c;break;default:In(e,r,i)}}function cm(e,r){if(r.memoizedState===null&&(e=r.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Vs(e)}catch(i){st(r,r.return,i)}}}function om(e,r){if(r.memoizedState===null&&(e=r.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Vs(e)}catch(i){st(r,r.return,i)}}function Nx(e){switch(e.tag){case 31:case 13:case 19:var r=e.stateNode;return r===null&&(r=e.stateNode=new rm),r;case 22:return e=e.stateNode,r=e._retryCache,r===null&&(r=e._retryCache=new rm),r;default:throw Error(s(435,e.tag))}}function bc(e,r){var i=Nx(e);r.forEach(function(c){if(!i.has(c)){i.add(c);var d=Rx.bind(null,e,c);c.then(d,d)}})}function pa(e,r){var i=r.deletions;if(i!==null)for(var c=0;c<i.length;c++){var d=i[c],v=e,E=r,A=E;e:for(;A!==null;){switch(A.tag){case 27:if(mr(A.type)){Et=A.stateNode,ga=!1;break e}break;case 5:Et=A.stateNode,ga=!1;break e;case 3:case 4:Et=A.stateNode.containerInfo,ga=!0;break e}A=A.return}if(Et===null)throw Error(s(160));lm(v,E,d),Et=null,ga=!1,v=d.alternate,v!==null&&(v.return=null),d.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)um(r,e),r=r.sibling}var nn=null;function um(e,r){var i=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:pa(r,e),xa(e),c&4&&(lr(3,e,e.return),Gi(3,e),lr(5,e,e.return));break;case 1:pa(r,e),xa(e),c&512&&(Ut||i===null||pn(i,i.return)),c&64&&On&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var d=nn;if(pa(r,e),xa(e),c&512&&(Ut||i===null||pn(i,i.return)),c&4){var v=i!==null?i.memoizedState:null;if(c=e.memoizedState,i===null)if(c===null)if(e.stateNode===null){e:{c=e.type,i=e.memoizedProps,d=d.ownerDocument||d;t:switch(c){case"title":v=d.getElementsByTagName("title")[0],(!v||v[le]||v[O]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=d.createElement(c),d.head.insertBefore(v,d.querySelector("head > title"))),qt(v,c,i),v[O]=e,Ie(v),c=v;break e;case"link":var E=u1("link","href",d).get(c+(i.href||""));if(E){for(var A=0;A<E.length;A++)if(v=E[A],v.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&v.getAttribute("rel")===(i.rel==null?null:i.rel)&&v.getAttribute("title")===(i.title==null?null:i.title)&&v.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){E.splice(A,1);break t}}v=d.createElement(c),qt(v,c,i),d.head.appendChild(v);break;case"meta":if(E=u1("meta","content",d).get(c+(i.content||""))){for(A=0;A<E.length;A++)if(v=E[A],v.getAttribute("content")===(i.content==null?null:""+i.content)&&v.getAttribute("name")===(i.name==null?null:i.name)&&v.getAttribute("property")===(i.property==null?null:i.property)&&v.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&v.getAttribute("charset")===(i.charSet==null?null:i.charSet)){E.splice(A,1);break t}}v=d.createElement(c),qt(v,c,i),d.head.appendChild(v);break;default:throw Error(s(468,c))}v[O]=e,Ie(v),c=v}e.stateNode=c}else f1(d,e.type,e.stateNode);else e.stateNode=o1(d,c,e.memoizedProps);else v!==c?(v===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):v.count--,c===null?f1(d,e.type,e.stateNode):o1(d,c,e.memoizedProps)):c===null&&e.stateNode!==null&&i0(e,e.memoizedProps,i.memoizedProps)}break;case 27:pa(r,e),xa(e),c&512&&(Ut||i===null||pn(i,i.return)),i!==null&&c&4&&i0(e,e.memoizedProps,i.memoizedProps);break;case 5:if(pa(r,e),xa(e),c&512&&(Ut||i===null||pn(i,i.return)),e.flags&32){d=e.stateNode;try{vs(d,"")}catch(Oe){st(e,e.return,Oe)}}c&4&&e.stateNode!=null&&(d=e.memoizedProps,i0(e,d,i!==null?i.memoizedProps:d)),c&1024&&(o0=!0);break;case 6:if(pa(r,e),xa(e),c&4){if(e.stateNode===null)throw Error(s(162));c=e.memoizedProps,i=e.stateNode;try{i.nodeValue=c}catch(Oe){st(e,e.return,Oe)}}break;case 3:if(zc=null,d=nn,nn=Kc(r.containerInfo),pa(r,e),nn=d,xa(e),c&4&&i!==null&&i.memoizedState.isDehydrated)try{Vs(r.containerInfo)}catch(Oe){st(e,e.return,Oe)}o0&&(o0=!1,fm(e));break;case 4:c=nn,nn=Kc(e.stateNode.containerInfo),pa(r,e),xa(e),nn=c;break;case 12:pa(r,e),xa(e);break;case 31:pa(r,e),xa(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,bc(e,c)));break;case 13:pa(r,e),xa(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(Ac=Ct()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,bc(e,c)));break;case 22:d=e.memoizedState!==null;var W=i!==null&&i.memoizedState!==null,ae=On,de=Ut;if(On=ae||d,Ut=de||W,pa(r,e),Ut=de,On=ae,xa(e),c&8192)e:for(r=e.stateNode,r._visibility=d?r._visibility&-2:r._visibility|1,d&&(i===null||W||On||Ut||Yr(e)),i=null,r=e;;){if(r.tag===5||r.tag===26){if(i===null){W=i=r;try{if(v=W.stateNode,d)E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{A=W.stateNode;var ve=W.memoizedProps.style,ie=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;A.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(Oe){st(W,W.return,Oe)}}}else if(r.tag===6){if(i===null){W=r;try{W.stateNode.nodeValue=d?"":W.memoizedProps}catch(Oe){st(W,W.return,Oe)}}}else if(r.tag===18){if(i===null){W=r;try{var oe=W.stateNode;d?e1(oe,!0):e1(W.stateNode,!1)}catch(Oe){st(W,W.return,Oe)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===e)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;i===r&&(i=null),r=r.return}i===r&&(i=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=e.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,bc(e,i))));break;case 19:pa(r,e),xa(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,bc(e,c)));break;case 30:break;case 21:break;default:pa(r,e),xa(e)}}function xa(e){var r=e.flags;if(r&2){try{for(var i,c=e.return;c!==null;){if(am(c)){i=c;break}c=c.return}if(i==null)throw Error(s(160));switch(i.tag){case 27:var d=i.stateNode,v=l0(e);wc(e,v,d);break;case 5:var E=i.stateNode;i.flags&32&&(vs(E,""),i.flags&=-33);var A=l0(e);wc(e,A,E);break;case 3:case 4:var W=i.stateNode.containerInfo,ae=l0(e);c0(e,ae,W);break;default:throw Error(s(161))}}catch(de){st(e,e.return,de)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function fm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var r=e;fm(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),e=e.sibling}}function Rn(e,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)sm(e,r.alternate,r),r=r.sibling}function Yr(e){for(e=e.child;e!==null;){var r=e;switch(r.tag){case 0:case 11:case 14:case 15:lr(4,r,r.return),Yr(r);break;case 1:pn(r,r.return);var i=r.stateNode;typeof i.componentWillUnmount=="function"&&em(r,r.return,i),Yr(r);break;case 27:el(r.stateNode);case 26:case 5:pn(r,r.return),Yr(r);break;case 22:r.memoizedState===null&&Yr(r);break;case 30:Yr(r);break;default:Yr(r)}e=e.sibling}}function Fn(e,r,i){for(i=i&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,d=e,v=r,E=v.flags;switch(v.tag){case 0:case 11:case 15:Fn(d,v,i),Gi(4,v);break;case 1:if(Fn(d,v,i),c=v,d=c.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(ae){st(c,c.return,ae)}if(c=v,d=c.updateQueue,d!==null){var A=c.stateNode;try{var W=d.shared.hiddenCallbacks;if(W!==null)for(d.shared.hiddenCallbacks=null,d=0;d<W.length;d++)zd(W[d],A)}catch(ae){st(c,c.return,ae)}}i&&E&64&&Zh(v),Wi(v,v.return);break;case 27:nm(v);case 26:case 5:Fn(d,v,i),i&&c===null&&E&4&&tm(v),Wi(v,v.return);break;case 12:Fn(d,v,i);break;case 31:Fn(d,v,i),i&&E&4&&cm(d,v);break;case 13:Fn(d,v,i),i&&E&4&&om(d,v);break;case 22:v.memoizedState===null&&Fn(d,v,i),Wi(v,v.return);break;case 30:break;default:Fn(d,v,i)}r=r.sibling}}function u0(e,r){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(e=r.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&ji(i))}function f0(e,r){e=null,r.alternate!==null&&(e=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==e&&(r.refCount++,e!=null&&ji(e))}function rn(e,r,i,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)dm(e,r,i,c),r=r.sibling}function dm(e,r,i,c){var d=r.flags;switch(r.tag){case 0:case 11:case 15:rn(e,r,i,c),d&2048&&Gi(9,r);break;case 1:rn(e,r,i,c);break;case 3:rn(e,r,i,c),d&2048&&(e=null,r.alternate!==null&&(e=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==e&&(r.refCount++,e!=null&&ji(e)));break;case 12:if(d&2048){rn(e,r,i,c),e=r.stateNode;try{var v=r.memoizedProps,E=v.id,A=v.onPostCommit;typeof A=="function"&&A(E,r.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(W){st(r,r.return,W)}}else rn(e,r,i,c);break;case 31:rn(e,r,i,c);break;case 13:rn(e,r,i,c);break;case 23:break;case 22:v=r.stateNode,E=r.alternate,r.memoizedState!==null?v._visibility&2?rn(e,r,i,c):Vi(e,r):v._visibility&2?rn(e,r,i,c):(v._visibility|=2,Is(e,r,i,c,(r.subtreeFlags&10256)!==0||!1)),d&2048&&u0(E,r);break;case 24:rn(e,r,i,c),d&2048&&f0(r.alternate,r);break;default:rn(e,r,i,c)}}function Is(e,r,i,c,d){for(d=d&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var v=e,E=r,A=i,W=c,ae=E.flags;switch(E.tag){case 0:case 11:case 15:Is(v,E,A,W,d),Gi(8,E);break;case 23:break;case 22:var de=E.stateNode;E.memoizedState!==null?de._visibility&2?Is(v,E,A,W,d):Vi(v,E):(de._visibility|=2,Is(v,E,A,W,d)),d&&ae&2048&&u0(E.alternate,E);break;case 24:Is(v,E,A,W,d),d&&ae&2048&&f0(E.alternate,E);break;default:Is(v,E,A,W,d)}r=r.sibling}}function Vi(e,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var i=e,c=r,d=c.flags;switch(c.tag){case 22:Vi(i,c),d&2048&&u0(c.alternate,c);break;case 24:Vi(i,c),d&2048&&f0(c.alternate,c);break;default:Vi(i,c)}r=r.sibling}}var Yi=8192;function Rs(e,r,i){if(e.subtreeFlags&Yi)for(e=e.child;e!==null;)hm(e,r,i),e=e.sibling}function hm(e,r,i){switch(e.tag){case 26:Rs(e,r,i),e.flags&Yi&&e.memoizedState!==null&&hS(i,nn,e.memoizedState,e.memoizedProps);break;case 5:Rs(e,r,i);break;case 3:case 4:var c=nn;nn=Kc(e.stateNode.containerInfo),Rs(e,r,i),nn=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=Yi,Yi=16777216,Rs(e,r,i),Yi=c):Rs(e,r,i));break;default:Rs(e,r,i)}}function mm(e){var r=e.alternate;if(r!==null&&(e=r.child,e!==null)){r.child=null;do r=e.sibling,e.sibling=null,e=r;while(e!==null)}}function Xi(e){var r=e.deletions;if((e.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Pt=c,gm(c,e)}mm(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)vm(e),e=e.sibling}function vm(e){switch(e.tag){case 0:case 11:case 15:Xi(e),e.flags&2048&&lr(9,e,e.return);break;case 3:Xi(e);break;case 12:Xi(e);break;case 22:var r=e.stateNode;e.memoizedState!==null&&r._visibility&2&&(e.return===null||e.return.tag!==13)?(r._visibility&=-3,Nc(e)):Xi(e);break;default:Xi(e)}}function Nc(e){var r=e.deletions;if((e.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Pt=c,gm(c,e)}mm(e)}for(e=e.child;e!==null;){switch(r=e,r.tag){case 0:case 11:case 15:lr(8,r,r.return),Nc(r);break;case 22:i=r.stateNode,i._visibility&2&&(i._visibility&=-3,Nc(r));break;default:Nc(r)}e=e.sibling}}function gm(e,r){for(;Pt!==null;){var i=Pt;switch(i.tag){case 0:case 11:case 15:lr(8,i,r);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:ji(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,Pt=c;else e:for(i=e;Pt!==null;){c=Pt;var d=c.sibling,v=c.return;if(im(c),c===i){Pt=null;break e}if(d!==null){d.return=v,Pt=d;break e}Pt=v}}}var Ax={getCacheForType:function(e){var r=Xt(Mt),i=r.data.get(e);return i===void 0&&(i=e(),r.data.set(e,i)),i},cacheSignal:function(){return Xt(Mt).controller.signal}},Dx=typeof WeakMap=="function"?WeakMap:Map,at=0,mt=null,Ye=null,Je=0,rt=0,Ma=null,cr=!1,Fs=!1,d0=!1,Ln=0,wt=0,or=0,Xr=0,h0=0,ja=0,Ls=0,Ji=null,Sa=null,m0=!1,Ac=0,pm=0,Dc=1/0,Mc=null,ur=null,Ft=0,fr=null,Bs=null,Bn=0,v0=0,g0=null,xm=null,qi=0,p0=null;function ka(){return(at&2)!==0&&Je!==0?Je&-Je:ee.T!==null?E0():N()}function Sm(){if(ja===0)if((Je&536870912)===0||$e){var e=us;us<<=1,(us&3932160)===0&&(us=262144),ja=e}else ja=536870912;return e=Aa.current,e!==null&&(e.flags|=32),ja}function ya(e,r,i){(e===mt&&(rt===2||rt===9)||e.cancelPendingCommit!==null)&&(Ks(e,0),dr(e,Je,ja,!1)),jr(e,i),((at&2)===0||e!==mt)&&(e===mt&&((at&2)===0&&(Xr|=i),wt===4&&dr(e,Je,ja,!1)),xn(e))}function ym(e,r,i){if((at&6)!==0)throw Error(s(327));var c=!i&&(r&127)===0&&(r&e.expiredLanes)===0||Mr(e,r),d=c?kx(e,r):S0(e,r,!0),v=c;do{if(d===0){Fs&&!c&&dr(e,r,0,!1);break}else{if(i=e.current.alternate,v&&!Mx(i)){d=S0(e,r,!1),v=!1;continue}if(d===2){if(v=r,e.errorRecoveryDisabledLanes&v)var E=0;else E=e.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){r=E;e:{var A=e;d=Ji;var W=A.current.memoizedState.isDehydrated;if(W&&(Ks(A,E).flags|=256),E=S0(A,E,!1),E!==2){if(d0&&!W){A.errorRecoveryDisabledLanes|=v,Xr|=v,d=4;break e}v=Sa,Sa=d,v!==null&&(Sa===null?Sa=v:Sa.push.apply(Sa,v))}d=E}if(v=!1,d!==2)continue}}if(d===1){Ks(e,0),dr(e,r,0,!0);break}e:{switch(c=e,v=d,v){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:dr(c,r,ja,!cr);break e;case 2:Sa=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(d=Ac+300-Ct(),10<d)){if(dr(c,r,ja,!cr),ds(c,0,!0)!==0)break e;Bn=r,c.timeoutHandle=$m(Cm.bind(null,c,i,Sa,Mc,m0,r,ja,Xr,Ls,cr,v,"Throttled",-0,0),d);break e}Cm(c,i,Sa,Mc,m0,r,ja,Xr,Ls,cr,v,null,-0,0)}}break}while(!0);xn(e)}function Cm(e,r,i,c,d,v,E,A,W,ae,de,ve,ie,oe){if(e.timeoutHandle=-1,ve=r.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_n},hm(r,v,ve);var Oe=(v&62914560)===v?Ac-Ct():(v&4194048)===v?pm-Ct():0;if(Oe=mS(ve,Oe),Oe!==null){Bn=v,e.cancelPendingCommit=Oe(Dm.bind(null,e,r,v,i,c,d,E,A,W,de,ve,null,ie,oe)),dr(e,v,E,!ae);return}}Dm(e,r,v,i,c,d,E,A,W)}function Mx(e){for(var r=e;;){var i=r.tag;if((i===0||i===11||i===15)&&r.flags&16384&&(i=r.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var d=i[c],v=d.getSnapshot;d=d.value;try{if(!ba(v(),d))return!1}catch{return!1}}if(i=r.child,r.subtreeFlags&16384&&i!==null)i.return=r,r=i;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function dr(e,r,i,c){r&=~h0,r&=~Xr,e.suspendedLanes|=r,e.pingedLanes&=~r,c&&(e.warmLanes|=r),c=e.expirationTimes;for(var d=r;0<d;){var v=31-oa(d),E=1<<v;c[v]=-1,d&=~E}i!==0&&Kl(e,i,r)}function jc(){return(at&6)===0?($i(0),!1):!0}function x0(){if(Ye!==null){if(rt===0)var e=Ye.return;else e=Ye,An=Br=null,Ou(e),Ms=null,Ui=0,e=Ye;for(;e!==null;)Qh(e.alternate,e),e=e.return;Ye=null}}function Ks(e,r){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,qx(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),Bn=0,x0(),mt=e,Ye=i=bn(e.current,null),Je=r,rt=0,Ma=null,cr=!1,Fs=Mr(e,r),d0=!1,Ls=ja=h0=Xr=or=wt=0,Sa=Ji=null,m0=!1,(r&8)!==0&&(r|=r&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=r;0<c;){var d=31-oa(c),v=1<<d;r|=e[d],c&=~v}return Ln=r,Ql(),i}function Tm(e,r){ze=null,ee.H=Pi,r===Ds||r===ic?(r=Ld(),rt=3):r===Tu?(r=Ld(),rt=4):rt=r===qu?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ma=r,Ye===null&&(wt=1,yc(e,Ga(r,e.current)))}function Em(){var e=Aa.current;return e===null?!0:(Je&4194048)===Je?Xa===null:(Je&62914560)===Je||(Je&536870912)!==0?e===Xa:!1}function _m(){var e=ee.H;return ee.H=Pi,e===null?Pi:e}function wm(){var e=ee.A;return ee.A=Ax,e}function kc(){wt=4,cr||(Je&4194048)!==Je&&Aa.current!==null||(Fs=!0),(or&134217727)===0&&(Xr&134217727)===0||mt===null||dr(mt,Je,ja,!1)}function S0(e,r,i){var c=at;at|=2;var d=_m(),v=wm();(mt!==e||Je!==r)&&(Mc=null,Ks(e,r)),r=!1;var E=wt;e:do try{if(rt!==0&&Ye!==null){var A=Ye,W=Ma;switch(rt){case 8:x0(),E=6;break e;case 3:case 2:case 9:case 6:Aa.current===null&&(r=!0);var ae=rt;if(rt=0,Ma=null,Ps(e,A,W,ae),i&&Fs){E=0;break e}break;default:ae=rt,rt=0,Ma=null,Ps(e,A,W,ae)}}jx(),E=wt;break}catch(de){Tm(e,de)}while(!0);return r&&e.shellSuspendCounter++,An=Br=null,at=c,ee.H=d,ee.A=v,Ye===null&&(mt=null,Je=0,Ql()),E}function jx(){for(;Ye!==null;)bm(Ye)}function kx(e,r){var i=at;at|=2;var c=_m(),d=wm();mt!==e||Je!==r?(Mc=null,Dc=Ct()+500,Ks(e,r)):Fs=Mr(e,r);e:do try{if(rt!==0&&Ye!==null){r=Ye;var v=Ma;t:switch(rt){case 1:rt=0,Ma=null,Ps(e,r,v,1);break;case 2:case 9:if(Rd(v)){rt=0,Ma=null,Nm(r);break}r=function(){rt!==2&&rt!==9||mt!==e||(rt=7),xn(e)},v.then(r,r);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:Rd(v)?(rt=0,Ma=null,Nm(r)):(rt=0,Ma=null,Ps(e,r,v,7));break;case 5:var E=null;switch(Ye.tag){case 26:E=Ye.memoizedState;case 5:case 27:var A=Ye;if(E?d1(E):A.stateNode.complete){rt=0,Ma=null;var W=A.sibling;if(W!==null)Ye=W;else{var ae=A.return;ae!==null?(Ye=ae,Uc(ae)):Ye=null}break t}}rt=0,Ma=null,Ps(e,r,v,5);break;case 6:rt=0,Ma=null,Ps(e,r,v,6);break;case 8:x0(),wt=6;break e;default:throw Error(s(462))}}Ux();break}catch(de){Tm(e,de)}while(!0);return An=Br=null,ee.H=c,ee.A=d,at=i,Ye!==null?0:(mt=null,Je=0,Ql(),wt)}function Ux(){for(;Ye!==null&&!Ol();)bm(Ye)}function bm(e){var r=qh(e.alternate,e,Ln);e.memoizedProps=e.pendingProps,r===null?Uc(e):Ye=r}function Nm(e){var r=e,i=r.alternate;switch(r.tag){case 15:case 0:r=Gh(i,r,r.pendingProps,r.type,void 0,Je);break;case 11:r=Gh(i,r,r.pendingProps,r.type.render,r.ref,Je);break;case 5:Ou(r);default:Qh(i,r),r=Ye=wd(r,Ln),r=qh(i,r,Ln)}e.memoizedProps=e.pendingProps,r===null?Uc(e):Ye=r}function Ps(e,r,i,c){An=Br=null,Ou(r),Ms=null,Ui=0;var d=r.return;try{if(Cx(e,d,r,i,Je)){wt=1,yc(e,Ga(i,e.current)),Ye=null;return}}catch(v){if(d!==null)throw Ye=d,v;wt=1,yc(e,Ga(i,e.current)),Ye=null;return}r.flags&32768?($e||c===1?e=!0:Fs||(Je&536870912)!==0?e=!1:(cr=e=!0,(c===2||c===9||c===3||c===6)&&(c=Aa.current,c!==null&&c.tag===13&&(c.flags|=16384))),Am(r,e)):Uc(r)}function Uc(e){var r=e;do{if((r.flags&32768)!==0){Am(r,cr);return}e=r.return;var i=_x(r.alternate,r,Ln);if(i!==null){Ye=i;return}if(r=r.sibling,r!==null){Ye=r;return}Ye=r=e}while(r!==null);wt===0&&(wt=5)}function Am(e,r){do{var i=wx(e.alternate,e);if(i!==null){i.flags&=32767,Ye=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!r&&(e=e.sibling,e!==null)){Ye=e;return}Ye=e=i}while(e!==null);wt=6,Ye=null}function Dm(e,r,i,c,d,v,E,A,W){e.cancelPendingCommit=null;do Oc();while(Ft!==0);if((at&6)!==0)throw Error(s(327));if(r!==null){if(r===e.current)throw Error(s(177));if(v=r.lanes|r.childLanes,v|=lu,Bo(e,i,v,E,A,W),e===mt&&(Ye=mt=null,Je=0),Bs=r,fr=e,Bn=i,v0=v,g0=d,xm=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Fx(La,function(){return Om(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=ee.T,ee.T=null,d=ge.p,ge.p=2,E=at,at|=4;try{bx(e,r,i)}finally{at=E,ge.p=d,ee.T=c}}Ft=1,Mm(),jm(),km()}}function Mm(){if(Ft===1){Ft=0;var e=fr,r=Bs,i=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||i){i=ee.T,ee.T=null;var c=ge.p;ge.p=2;var d=at;at|=4;try{um(r,e);var v=j0,E=gd(e.containerInfo),A=v.focusedElem,W=v.selectionRange;if(E!==A&&A&&A.ownerDocument&&vd(A.ownerDocument.documentElement,A)){if(W!==null&&au(A)){var ae=W.start,de=W.end;if(de===void 0&&(de=ae),"selectionStart"in A)A.selectionStart=ae,A.selectionEnd=Math.min(de,A.value.length);else{var ve=A.ownerDocument||document,ie=ve&&ve.defaultView||window;if(ie.getSelection){var oe=ie.getSelection(),Oe=A.textContent.length,Be=Math.min(W.start,Oe),dt=W.end===void 0?Be:Math.min(W.end,Oe);!oe.extend&&Be>dt&&(E=dt,dt=Be,Be=E);var Q=md(A,Be),J=md(A,dt);if(Q&&J&&(oe.rangeCount!==1||oe.anchorNode!==Q.node||oe.anchorOffset!==Q.offset||oe.focusNode!==J.node||oe.focusOffset!==J.offset)){var te=ve.createRange();te.setStart(Q.node,Q.offset),oe.removeAllRanges(),Be>dt?(oe.addRange(te),oe.extend(J.node,J.offset)):(te.setEnd(J.node,J.offset),oe.addRange(te))}}}}for(ve=[],oe=A;oe=oe.parentNode;)oe.nodeType===1&&ve.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<ve.length;A++){var me=ve[A];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}Vc=!!M0,j0=M0=null}finally{at=d,ge.p=c,ee.T=i}}e.current=r,Ft=2}}function jm(){if(Ft===2){Ft=0;var e=fr,r=Bs,i=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||i){i=ee.T,ee.T=null;var c=ge.p;ge.p=2;var d=at;at|=4;try{sm(e,r.alternate,r)}finally{at=d,ge.p=c,ee.T=i}}Ft=3}}function km(){if(Ft===4||Ft===3){Ft=0,mi();var e=fr,r=Bs,i=Bn,c=xm;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ft=5:(Ft=0,Bs=fr=null,Um(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(ur=null),xi(i),r=r.stateNode,na&&typeof na.onCommitFiberRoot=="function")try{na.onCommitFiberRoot(Jn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=ee.T,d=ge.p,ge.p=2,ee.T=null;try{for(var v=e.onRecoverableError,E=0;E<c.length;E++){var A=c[E];v(A.value,{componentStack:A.stack})}}finally{ee.T=r,ge.p=d}}(Bn&3)!==0&&Oc(),xn(e),d=e.pendingLanes,(i&261930)!==0&&(d&42)!==0?e===p0?qi++:(qi=0,p0=e):qi=0,$i(0)}}function Um(e,r){(e.pooledCacheLanes&=r)===0&&(r=e.pooledCache,r!=null&&(e.pooledCache=null,ji(r)))}function Oc(){return Mm(),jm(),km(),Om()}function Om(){if(Ft!==5)return!1;var e=fr,r=v0;v0=0;var i=xi(Bn),c=ee.T,d=ge.p;try{ge.p=32>i?32:i,ee.T=null,i=g0,g0=null;var v=fr,E=Bn;if(Ft=0,Bs=fr=null,Bn=0,(at&6)!==0)throw Error(s(331));var A=at;if(at|=4,vm(v.current),dm(v,v.current,E,i),at=A,$i(0,!1),na&&typeof na.onPostCommitFiberRoot=="function")try{na.onPostCommitFiberRoot(Jn,v)}catch{}return!0}finally{ge.p=d,ee.T=c,Um(e,r)}}function Im(e,r,i){r=Ga(i,r),r=Ju(e.stateNode,r,2),e=rr(e,r,2),e!==null&&(jr(e,2),xn(e))}function st(e,r,i){if(e.tag===3)Im(e,e,i);else for(;r!==null;){if(r.tag===3){Im(r,e,i);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ur===null||!ur.has(c))){e=Ga(i,e),i=Rh(2),c=rr(r,i,2),c!==null&&(Fh(i,c,r,e),jr(c,2),xn(c));break}}r=r.return}}function y0(e,r,i){var c=e.pingCache;if(c===null){c=e.pingCache=new Dx;var d=new Set;c.set(r,d)}else d=c.get(r),d===void 0&&(d=new Set,c.set(r,d));d.has(i)||(d0=!0,d.add(i),e=Ox.bind(null,e,r,i),r.then(e,e))}function Ox(e,r,i){var c=e.pingCache;c!==null&&c.delete(r),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,mt===e&&(Je&i)===i&&(wt===4||wt===3&&(Je&62914560)===Je&&300>Ct()-Ac?(at&2)===0&&Ks(e,0):h0|=i,Ls===Je&&(Ls=0)),xn(e)}function Rm(e,r){r===0&&(r=Bl()),e=Rr(e,r),e!==null&&(jr(e,r),xn(e))}function Ix(e){var r=e.memoizedState,i=0;r!==null&&(i=r.retryLane),Rm(e,i)}function Rx(e,r){var i=0;switch(e.tag){case 31:case 13:var c=e.stateNode,d=e.memoizedState;d!==null&&(i=d.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(r),Rm(e,i)}function Fx(e,r){return en(e,r)}var Ic=null,zs=null,C0=!1,Rc=!1,T0=!1,hr=0;function xn(e){e!==zs&&e.next===null&&(zs===null?Ic=zs=e:zs=zs.next=e),Rc=!0,C0||(C0=!0,Bx())}function $i(e,r){if(!T0&&Rc){T0=!0;do for(var i=!1,c=Ic;c!==null;){if(e!==0){var d=c.pendingLanes;if(d===0)var v=0;else{var E=c.suspendedLanes,A=c.pingedLanes;v=(1<<31-oa(42|e)+1)-1,v&=d&~(E&~A),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(i=!0,Km(c,v))}else v=Je,v=ds(c,c===mt?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||Mr(c,v)||(i=!0,Km(c,v));c=c.next}while(i);T0=!1}}function Lx(){Fm()}function Fm(){Rc=C0=!1;var e=0;hr!==0&&Jx()&&(e=hr);for(var r=Ct(),i=null,c=Ic;c!==null;){var d=c.next,v=Lm(c,r);v===0?(c.next=null,i===null?Ic=d:i.next=d,d===null&&(zs=i)):(i=c,(e!==0||(v&3)!==0)&&(Rc=!0)),c=d}Ft!==0&&Ft!==5||$i(e),hr!==0&&(hr=0)}function Lm(e,r){for(var i=e.suspendedLanes,c=e.pingedLanes,d=e.expirationTimes,v=e.pendingLanes&-62914561;0<v;){var E=31-oa(v),A=1<<E,W=d[E];W===-1?((A&i)===0||(A&c)!==0)&&(d[E]=Lo(A,r)):W<=r&&(e.expiredLanes|=A),v&=~A}if(r=mt,i=Je,i=ds(e,e===r?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,i===0||e===r&&(rt===2||rt===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&hn(c),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||Mr(e,i)){if(r=i&-i,r===e.callbackPriority)return r;switch(c!==null&&hn(c),xi(i)){case 2:case 8:i=os;break;case 32:i=La;break;case 268435456:i=vi;break;default:i=La}return c=Bm.bind(null,e),i=en(i,c),e.callbackPriority=r,e.callbackNode=i,r}return c!==null&&c!==null&&hn(c),e.callbackPriority=2,e.callbackNode=null,2}function Bm(e,r){if(Ft!==0&&Ft!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(Oc()&&e.callbackNode!==i)return null;var c=Je;return c=ds(e,e===mt?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(ym(e,c,r),Lm(e,Ct()),e.callbackNode!=null&&e.callbackNode===i?Bm.bind(null,e):null)}function Km(e,r){if(Oc())return null;ym(e,r,!0)}function Bx(){$x(function(){(at&6)!==0?en(cs,Lx):Fm()})}function E0(){if(hr===0){var e=Ns;e===0&&(e=Dr,Dr<<=1,(Dr&261888)===0&&(Dr=256)),hr=e}return hr}function Pm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Gl(""+e)}function zm(e,r){var i=r.ownerDocument.createElement("input");return i.name=r.name,i.value=r.value,e.id&&i.setAttribute("form",e.id),r.parentNode.insertBefore(i,r),e=new FormData(e),i.parentNode.removeChild(i),e}function Kx(e,r,i,c,d){if(r==="submit"&&i&&i.stateNode===d){var v=Pm((d[I]||null).action),E=c.submitter;E&&(r=(r=E[I]||null)?Pm(r.formAction):E.getAttribute("formAction"),r!==null&&(v=r,E=null));var A=new Xl("action","action",null,c,d);e.push({event:A,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(hr!==0){var W=E?zm(d,E):new FormData(d);Hu(i,{pending:!0,data:W,method:d.method,action:v},null,W)}}else typeof v=="function"&&(A.preventDefault(),W=E?zm(d,E):new FormData(d),Hu(i,{pending:!0,data:W,method:d.method,action:v},v,W))},currentTarget:d}]})}}for(var _0=0;_0<iu.length;_0++){var w0=iu[_0],Px=w0.toLowerCase(),zx=w0[0].toUpperCase()+w0.slice(1);an(Px,"on"+zx)}an(Sd,"onAnimationEnd"),an(yd,"onAnimationIteration"),an(Cd,"onAnimationStart"),an("dblclick","onDoubleClick"),an("focusin","onFocus"),an("focusout","onBlur"),an(rx,"onTransitionRun"),an(sx,"onTransitionStart"),an(ix,"onTransitionCancel"),an(Td,"onTransitionEnd"),Ka("onMouseEnter",["mouseout","mouseover"]),Ka("onMouseLeave",["mouseout","mouseover"]),Ka("onPointerEnter",["pointerout","pointerover"]),Ka("onPointerLeave",["pointerout","pointerover"]),Tt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Tt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Tt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Tt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Tt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Tt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qi));function Hm(e,r){r=(r&4)!==0;for(var i=0;i<e.length;i++){var c=e[i],d=c.event;c=c.listeners;e:{var v=void 0;if(r)for(var E=c.length-1;0<=E;E--){var A=c[E],W=A.instance,ae=A.currentTarget;if(A=A.listener,W!==v&&d.isPropagationStopped())break e;v=A,d.currentTarget=ae;try{v(d)}catch(de){$l(de)}d.currentTarget=null,v=W}else for(E=0;E<c.length;E++){if(A=c[E],W=A.instance,ae=A.currentTarget,A=A.listener,W!==v&&d.isPropagationStopped())break e;v=A,d.currentTarget=ae;try{v(d)}catch(de){$l(de)}d.currentTarget=null,v=W}}}}function Xe(e,r){var i=r[ne];i===void 0&&(i=r[ne]=new Set);var c=e+"__bubble";i.has(c)||(Gm(r,e,2,!1),i.add(c))}function b0(e,r,i){var c=0;r&&(c|=4),Gm(i,e,c,r)}var Fc="_reactListening"+Math.random().toString(36).slice(2);function N0(e){if(!e[Fc]){e[Fc]=!0,gt.forEach(function(i){i!=="selectionchange"&&(Hx.has(i)||b0(i,!1,e),b0(i,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[Fc]||(r[Fc]=!0,b0("selectionchange",!1,r))}}function Gm(e,r,i,c){switch(S1(r)){case 2:var d=pS;break;case 8:d=xS;break;default:d=z0}i=d.bind(null,r,i,e),d=void 0,!Yo||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(d=!0),c?d!==void 0?e.addEventListener(r,i,{capture:!0,passive:d}):e.addEventListener(r,i,!0):d!==void 0?e.addEventListener(r,i,{passive:d}):e.addEventListener(r,i,!1)}function A0(e,r,i,c,d){var v=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var A=c.stateNode.containerInfo;if(A===d)break;if(E===4)for(E=c.return;E!==null;){var W=E.tag;if((W===3||W===4)&&E.stateNode.containerInfo===d)return;E=E.return}for(;A!==null;){if(E=Te(A),E===null)return;if(W=E.tag,W===5||W===6||W===26||W===27){c=v=E;continue e}A=A.parentNode}}c=c.return}Jf(function(){var ae=v,de=Wo(i),ve=[];e:{var ie=Ed.get(e);if(ie!==void 0){var oe=Xl,Oe=e;switch(e){case"keypress":if(Vl(i)===0)break e;case"keydown":case"keyup":oe=Rp;break;case"focusin":Oe="focus",oe=$o;break;case"focusout":Oe="blur",oe=$o;break;case"beforeblur":case"afterblur":oe=$o;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Qf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=_p;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=Bp;break;case Sd:case yd:case Cd:oe=Np;break;case Td:oe=Pp;break;case"scroll":case"scrollend":oe=Tp;break;case"wheel":oe=Hp;break;case"copy":case"cut":case"paste":oe=Dp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=ed;break;case"toggle":case"beforetoggle":oe=Wp}var Be=(r&4)!==0,dt=!Be&&(e==="scroll"||e==="scrollend"),Q=Be?ie!==null?ie+"Capture":null:ie;Be=[];for(var J=ae,te;J!==null;){var me=J;if(te=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||te===null||Q===null||(me=yi(J,Q),me!=null&&Be.push(Zi(J,me,te))),dt)break;J=J.return}0<Be.length&&(ie=new oe(ie,Oe,null,i,de),ve.push({event:ie,listeners:Be}))}}if((r&7)===0){e:{if(ie=e==="mouseover"||e==="pointerover",oe=e==="mouseout"||e==="pointerout",ie&&i!==Go&&(Oe=i.relatedTarget||i.fromElement)&&(Te(Oe)||Oe[F]))break e;if((oe||ie)&&(ie=de.window===de?de:(ie=de.ownerDocument)?ie.defaultView||ie.parentWindow:window,oe?(Oe=i.relatedTarget||i.toElement,oe=ae,Oe=Oe?Te(Oe):null,Oe!==null&&(dt=u(Oe),Be=Oe.tag,Oe!==dt||Be!==5&&Be!==27&&Be!==6)&&(Oe=null)):(oe=null,Oe=ae),oe!==Oe)){if(Be=Qf,me="onMouseLeave",Q="onMouseEnter",J="mouse",(e==="pointerout"||e==="pointerover")&&(Be=ed,me="onPointerLeave",Q="onPointerEnter",J="pointer"),dt=oe==null?ie:ye(oe),te=Oe==null?ie:ye(Oe),ie=new Be(me,J+"leave",oe,i,de),ie.target=dt,ie.relatedTarget=te,me=null,Te(de)===ae&&(Be=new Be(Q,J+"enter",Oe,i,de),Be.target=te,Be.relatedTarget=dt,me=Be),dt=me,oe&&Oe)t:{for(Be=Gx,Q=oe,J=Oe,te=0,me=Q;me;me=Be(me))te++;me=0;for(var Fe=J;Fe;Fe=Be(Fe))me++;for(;0<te-me;)Q=Be(Q),te--;for(;0<me-te;)J=Be(J),me--;for(;te--;){if(Q===J||J!==null&&Q===J.alternate){Be=Q;break t}Q=Be(Q),J=Be(J)}Be=null}else Be=null;oe!==null&&Wm(ve,ie,oe,Be,!1),Oe!==null&&dt!==null&&Wm(ve,dt,Oe,Be,!0)}}e:{if(ie=ae?ye(ae):window,oe=ie.nodeName&&ie.nodeName.toLowerCase(),oe==="select"||oe==="input"&&ie.type==="file")var Ze=cd;else if(id(ie))if(od)Ze=tx;else{Ze=Zp;var Re=Qp}else oe=ie.nodeName,!oe||oe.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?ae&&Ho(ae.elementType)&&(Ze=cd):Ze=ex;if(Ze&&(Ze=Ze(e,ae))){ld(ve,Ze,i,de);break e}Re&&Re(e,ie,ae),e==="focusout"&&ae&&ie.type==="number"&&ae.memoizedProps.value!=null&&zo(ie,"number",ie.value)}switch(Re=ae?ye(ae):window,e){case"focusin":(id(Re)||Re.contentEditable==="true")&&(Ss=Re,nu=ae,Ai=null);break;case"focusout":Ai=nu=Ss=null;break;case"mousedown":ru=!0;break;case"contextmenu":case"mouseup":case"dragend":ru=!1,pd(ve,i,de);break;case"selectionchange":if(nx)break;case"keydown":case"keyup":pd(ve,i,de)}var He;if(Zo)e:{switch(e){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else xs?rd(e,i)&&(qe="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(qe="onCompositionStart");qe&&(td&&i.locale!=="ko"&&(xs||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&xs&&(He=qf()):($n=de,Xo="value"in $n?$n.value:$n.textContent,xs=!0)),Re=Lc(ae,qe),0<Re.length&&(qe=new Zf(qe,e,null,i,de),ve.push({event:qe,listeners:Re}),He?qe.data=He:(He=sd(i),He!==null&&(qe.data=He)))),(He=Yp?Xp(e,i):Jp(e,i))&&(qe=Lc(ae,"onBeforeInput"),0<qe.length&&(Re=new Zf("onBeforeInput","beforeinput",null,i,de),ve.push({event:Re,listeners:qe}),Re.data=He)),Kx(ve,e,ae,i,de)}Hm(ve,r)})}function Zi(e,r,i){return{instance:e,listener:r,currentTarget:i}}function Lc(e,r){for(var i=r+"Capture",c=[];e!==null;){var d=e,v=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||v===null||(d=yi(e,i),d!=null&&c.unshift(Zi(e,d,v)),d=yi(e,r),d!=null&&c.push(Zi(e,d,v))),e.tag===3)return c;e=e.return}return[]}function Gx(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Wm(e,r,i,c,d){for(var v=r._reactName,E=[];i!==null&&i!==c;){var A=i,W=A.alternate,ae=A.stateNode;if(A=A.tag,W!==null&&W===c)break;A!==5&&A!==26&&A!==27||ae===null||(W=ae,d?(ae=yi(i,v),ae!=null&&E.unshift(Zi(i,ae,W))):d||(ae=yi(i,v),ae!=null&&E.push(Zi(i,ae,W)))),i=i.return}E.length!==0&&e.push({event:r,listeners:E})}var Wx=/\r\n?/g,Vx=/\u0000|\uFFFD/g;function Vm(e){return(typeof e=="string"?e:""+e).replace(Wx,`
`).replace(Vx,"")}function Ym(e,r){return r=Vm(r),Vm(e)===r}function ft(e,r,i,c,d,v){switch(i){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||vs(e,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&vs(e,""+c);break;case"className":zl(e,"class",c);break;case"tabIndex":zl(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":zl(e,i,c);break;case"style":Yf(e,c,v);break;case"data":if(r!=="object"){zl(e,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||i!=="href")){e.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(i);break}c=Gl(""+c),e.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(i==="formAction"?(r!=="input"&&ft(e,r,"name",d.name,d,null),ft(e,r,"formEncType",d.formEncType,d,null),ft(e,r,"formMethod",d.formMethod,d,null),ft(e,r,"formTarget",d.formTarget,d,null)):(ft(e,r,"encType",d.encType,d,null),ft(e,r,"method",d.method,d,null),ft(e,r,"target",d.target,d,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(i);break}c=Gl(""+c),e.setAttribute(i,c);break;case"onClick":c!=null&&(e.onclick=_n);break;case"onScroll":c!=null&&Xe("scroll",e);break;case"onScrollEnd":c!=null&&Xe("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(i=c.__html,i!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=i}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}i=Gl(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(i,""+c):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":c===!0?e.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(i,c):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(i,c):e.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(i):e.setAttribute(i,c);break;case"popover":Xe("beforetoggle",e),Xe("toggle",e),ma(e,"popover",c);break;case"xlinkActuate":En(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":En(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":En(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":En(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":En(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":En(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":En(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":En(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":En(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ma(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=yp.get(i)||i,ma(e,i,c))}}function D0(e,r,i,c,d,v){switch(i){case"style":Yf(e,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(i=c.__html,i!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=i}}break;case"children":typeof c=="string"?vs(e,c):(typeof c=="number"||typeof c=="bigint")&&vs(e,""+c);break;case"onScroll":c!=null&&Xe("scroll",e);break;case"onScrollEnd":c!=null&&Xe("scrollend",e);break;case"onClick":c!=null&&(e.onclick=_n);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pt.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(d=i.endsWith("Capture"),r=i.slice(2,d?i.length-7:void 0),v=e[I]||null,v=v!=null?v[i]:null,typeof v=="function"&&e.removeEventListener(r,v,d),typeof c=="function")){typeof v!="function"&&v!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(r,c,d);break e}i in e?e[i]=c:c===!0?e.setAttribute(i,""):ma(e,i,c)}}}function qt(e,r,i){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xe("error",e),Xe("load",e);var c=!1,d=!1,v;for(v in i)if(i.hasOwnProperty(v)){var E=i[v];if(E!=null)switch(v){case"src":c=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:ft(e,r,v,E,i,null)}}d&&ft(e,r,"srcSet",i.srcSet,i,null),c&&ft(e,r,"src",i.src,i,null);return;case"input":Xe("invalid",e);var A=v=E=d=null,W=null,ae=null;for(c in i)if(i.hasOwnProperty(c)){var de=i[c];if(de!=null)switch(c){case"name":d=de;break;case"type":E=de;break;case"checked":W=de;break;case"defaultChecked":ae=de;break;case"value":v=de;break;case"defaultValue":A=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(s(137,r));break;default:ft(e,r,c,de,i,null)}}Hf(e,v,A,W,ae,E,d,!1);return;case"select":Xe("invalid",e),c=E=v=null;for(d in i)if(i.hasOwnProperty(d)&&(A=i[d],A!=null))switch(d){case"value":v=A;break;case"defaultValue":E=A;break;case"multiple":c=A;default:ft(e,r,d,A,i,null)}r=v,i=E,e.multiple=!!c,r!=null?ms(e,!!c,r,!1):i!=null&&ms(e,!!c,i,!0);return;case"textarea":Xe("invalid",e),v=d=c=null;for(E in i)if(i.hasOwnProperty(E)&&(A=i[E],A!=null))switch(E){case"value":c=A;break;case"defaultValue":d=A;break;case"children":v=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(s(91));break;default:ft(e,r,E,A,i,null)}Wf(e,c,d,v);return;case"option":for(W in i)if(i.hasOwnProperty(W)&&(c=i[W],c!=null))switch(W){case"selected":e.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:ft(e,r,W,c,i,null)}return;case"dialog":Xe("beforetoggle",e),Xe("toggle",e),Xe("cancel",e),Xe("close",e);break;case"iframe":case"object":Xe("load",e);break;case"video":case"audio":for(c=0;c<Qi.length;c++)Xe(Qi[c],e);break;case"image":Xe("error",e),Xe("load",e);break;case"details":Xe("toggle",e);break;case"embed":case"source":case"link":Xe("error",e),Xe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in i)if(i.hasOwnProperty(ae)&&(c=i[ae],c!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:ft(e,r,ae,c,i,null)}return;default:if(Ho(r)){for(de in i)i.hasOwnProperty(de)&&(c=i[de],c!==void 0&&D0(e,r,de,c,i,void 0));return}}for(A in i)i.hasOwnProperty(A)&&(c=i[A],c!=null&&ft(e,r,A,c,i,null))}function Yx(e,r,i,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,v=null,E=null,A=null,W=null,ae=null,de=null;for(oe in i){var ve=i[oe];if(i.hasOwnProperty(oe)&&ve!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":W=ve;default:c.hasOwnProperty(oe)||ft(e,r,oe,null,c,ve)}}for(var ie in c){var oe=c[ie];if(ve=i[ie],c.hasOwnProperty(ie)&&(oe!=null||ve!=null))switch(ie){case"type":v=oe;break;case"name":d=oe;break;case"checked":ae=oe;break;case"defaultChecked":de=oe;break;case"value":E=oe;break;case"defaultValue":A=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(s(137,r));break;default:oe!==ve&&ft(e,r,ie,oe,c,ve)}}Po(e,E,A,W,ae,de,v,d);return;case"select":oe=E=A=ie=null;for(v in i)if(W=i[v],i.hasOwnProperty(v)&&W!=null)switch(v){case"value":break;case"multiple":oe=W;default:c.hasOwnProperty(v)||ft(e,r,v,null,c,W)}for(d in c)if(v=c[d],W=i[d],c.hasOwnProperty(d)&&(v!=null||W!=null))switch(d){case"value":ie=v;break;case"defaultValue":A=v;break;case"multiple":E=v;default:v!==W&&ft(e,r,d,v,c,W)}r=A,i=E,c=oe,ie!=null?ms(e,!!i,ie,!1):!!c!=!!i&&(r!=null?ms(e,!!i,r,!0):ms(e,!!i,i?[]:"",!1));return;case"textarea":oe=ie=null;for(A in i)if(d=i[A],i.hasOwnProperty(A)&&d!=null&&!c.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:ft(e,r,A,null,c,d)}for(E in c)if(d=c[E],v=i[E],c.hasOwnProperty(E)&&(d!=null||v!=null))switch(E){case"value":ie=d;break;case"defaultValue":oe=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==v&&ft(e,r,E,d,c,v)}Gf(e,ie,oe);return;case"option":for(var Oe in i)if(ie=i[Oe],i.hasOwnProperty(Oe)&&ie!=null&&!c.hasOwnProperty(Oe))switch(Oe){case"selected":e.selected=!1;break;default:ft(e,r,Oe,null,c,ie)}for(W in c)if(ie=c[W],oe=i[W],c.hasOwnProperty(W)&&ie!==oe&&(ie!=null||oe!=null))switch(W){case"selected":e.selected=ie&&typeof ie!="function"&&typeof ie!="symbol";break;default:ft(e,r,W,ie,c,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in i)ie=i[Be],i.hasOwnProperty(Be)&&ie!=null&&!c.hasOwnProperty(Be)&&ft(e,r,Be,null,c,ie);for(ae in c)if(ie=c[ae],oe=i[ae],c.hasOwnProperty(ae)&&ie!==oe&&(ie!=null||oe!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(s(137,r));break;default:ft(e,r,ae,ie,c,oe)}return;default:if(Ho(r)){for(var dt in i)ie=i[dt],i.hasOwnProperty(dt)&&ie!==void 0&&!c.hasOwnProperty(dt)&&D0(e,r,dt,void 0,c,ie);for(de in c)ie=c[de],oe=i[de],!c.hasOwnProperty(de)||ie===oe||ie===void 0&&oe===void 0||D0(e,r,de,ie,c,oe);return}}for(var Q in i)ie=i[Q],i.hasOwnProperty(Q)&&ie!=null&&!c.hasOwnProperty(Q)&&ft(e,r,Q,null,c,ie);for(ve in c)ie=c[ve],oe=i[ve],!c.hasOwnProperty(ve)||ie===oe||ie==null&&oe==null||ft(e,r,ve,ie,c,oe)}function Xm(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Xx(){if(typeof performance.getEntriesByType=="function"){for(var e=0,r=0,i=performance.getEntriesByType("resource"),c=0;c<i.length;c++){var d=i[c],v=d.transferSize,E=d.initiatorType,A=d.duration;if(v&&A&&Xm(E)){for(E=0,A=d.responseEnd,c+=1;c<i.length;c++){var W=i[c],ae=W.startTime;if(ae>A)break;var de=W.transferSize,ve=W.initiatorType;de&&Xm(ve)&&(W=W.responseEnd,E+=de*(W<A?1:(A-ae)/(W-ae)))}if(--c,r+=8*(v+E)/(d.duration/1e3),e++,10<e)break}}if(0<e)return r/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var M0=null,j0=null;function Bc(e){return e.nodeType===9?e:e.ownerDocument}function Jm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qm(e,r){if(e===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&r==="foreignObject"?0:e}function k0(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var U0=null;function Jx(){var e=window.event;return e&&e.type==="popstate"?e===U0?!1:(U0=e,!0):(U0=null,!1)}var $m=typeof setTimeout=="function"?setTimeout:void 0,qx=typeof clearTimeout=="function"?clearTimeout:void 0,Qm=typeof Promise=="function"?Promise:void 0,$x=typeof queueMicrotask=="function"?queueMicrotask:typeof Qm<"u"?function(e){return Qm.resolve(null).then(e).catch(Qx)}:$m;function Qx(e){setTimeout(function(){throw e})}function mr(e){return e==="head"}function Zm(e,r){var i=r,c=0;do{var d=i.nextSibling;if(e.removeChild(i),d&&d.nodeType===8)if(i=d.data,i==="/$"||i==="/&"){if(c===0){e.removeChild(d),Vs(r);return}c--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")c++;else if(i==="html")el(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,el(i);for(var v=i.firstChild;v;){var E=v.nextSibling,A=v.nodeName;v[le]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&v.rel.toLowerCase()==="stylesheet"||i.removeChild(v),v=E}}else i==="body"&&el(e.ownerDocument.body);i=d}while(i);Vs(r)}function e1(e,r){var i=e;e=0;do{var c=i.nextSibling;if(i.nodeType===1?r?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(r?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=c}while(i)}function O0(e){var r=e.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var i=r;switch(r=r.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":O0(i),xe(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function Zx(e,r,i,c){for(;e.nodeType===1;){var d=i;if(e.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[le])switch(r){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(v=e.getAttribute("rel"),v==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(v!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(v=e.getAttribute("src"),(v!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&v&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(r==="input"&&e.type==="hidden"){var v=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===v)return e}else return e;if(e=Ja(e.nextSibling),e===null)break}return null}function eS(e,r,i){if(r==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=Ja(e.nextSibling),e===null))return null;return e}function t1(e,r){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Ja(e.nextSibling),e===null))return null;return e}function I0(e){return e.data==="$?"||e.data==="$~"}function R0(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function tS(e,r){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=r;else if(e.data!=="$?"||i.readyState!=="loading")r();else{var c=function(){r(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function Ja(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return e}var F0=null;function a1(e){e=e.nextSibling;for(var r=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(r===0)return Ja(e.nextSibling);r--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||r++}e=e.nextSibling}return null}function n1(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(r===0)return e;r--}else i!=="/$"&&i!=="/&"||r++}e=e.previousSibling}return null}function r1(e,r,i){switch(r=Bc(i),e){case"html":if(e=r.documentElement,!e)throw Error(s(452));return e;case"head":if(e=r.head,!e)throw Error(s(453));return e;case"body":if(e=r.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function el(e){for(var r=e.attributes;r.length;)e.removeAttributeNode(r[0]);xe(e)}var qa=new Map,s1=new Set;function Kc(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Kn=ge.d;ge.d={f:aS,r:nS,D:rS,C:sS,L:iS,m:lS,X:oS,S:cS,M:uS};function aS(){var e=Kn.f(),r=jc();return e||r}function nS(e){var r=Me(e);r!==null&&r.tag===5&&r.type==="form"?Th(r):Kn.r(e)}var Hs=typeof document>"u"?null:document;function i1(e,r,i){var c=Hs;if(c&&typeof r=="string"&&r){var d=za(r);d='link[rel="'+e+'"][href="'+d+'"]',typeof i=="string"&&(d+='[crossorigin="'+i+'"]'),s1.has(d)||(s1.add(d),e={rel:e,crossOrigin:i,href:r},c.querySelector(d)===null&&(r=c.createElement("link"),qt(r,"link",e),Ie(r),c.head.appendChild(r)))}}function rS(e){Kn.D(e),i1("dns-prefetch",e,null)}function sS(e,r){Kn.C(e,r),i1("preconnect",e,r)}function iS(e,r,i){Kn.L(e,r,i);var c=Hs;if(c&&e&&r){var d='link[rel="preload"][as="'+za(r)+'"]';r==="image"&&i&&i.imageSrcSet?(d+='[imagesrcset="'+za(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(d+='[imagesizes="'+za(i.imageSizes)+'"]')):d+='[href="'+za(e)+'"]';var v=d;switch(r){case"style":v=Gs(e);break;case"script":v=Ws(e)}qa.has(v)||(e=S({rel:"preload",href:r==="image"&&i&&i.imageSrcSet?void 0:e,as:r},i),qa.set(v,e),c.querySelector(d)!==null||r==="style"&&c.querySelector(tl(v))||r==="script"&&c.querySelector(al(v))||(r=c.createElement("link"),qt(r,"link",e),Ie(r),c.head.appendChild(r)))}}function lS(e,r){Kn.m(e,r);var i=Hs;if(i&&e){var c=r&&typeof r.as=="string"?r.as:"script",d='link[rel="modulepreload"][as="'+za(c)+'"][href="'+za(e)+'"]',v=d;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Ws(e)}if(!qa.has(v)&&(e=S({rel:"modulepreload",href:e},r),qa.set(v,e),i.querySelector(d)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(al(v)))return}c=i.createElement("link"),qt(c,"link",e),Ie(c),i.head.appendChild(c)}}}function cS(e,r,i){Kn.S(e,r,i);var c=Hs;if(c&&e){var d=De(c).hoistableStyles,v=Gs(e);r=r||"default";var E=d.get(v);if(!E){var A={loading:0,preload:null};if(E=c.querySelector(tl(v)))A.loading=5;else{e=S({rel:"stylesheet",href:e,"data-precedence":r},i),(i=qa.get(v))&&L0(e,i);var W=E=c.createElement("link");Ie(W),qt(W,"link",e),W._p=new Promise(function(ae,de){W.onload=ae,W.onerror=de}),W.addEventListener("load",function(){A.loading|=1}),W.addEventListener("error",function(){A.loading|=2}),A.loading|=4,Pc(E,r,c)}E={type:"stylesheet",instance:E,count:1,state:A},d.set(v,E)}}}function oS(e,r){Kn.X(e,r);var i=Hs;if(i&&e){var c=De(i).hoistableScripts,d=Ws(e),v=c.get(d);v||(v=i.querySelector(al(d)),v||(e=S({src:e,async:!0},r),(r=qa.get(d))&&B0(e,r),v=i.createElement("script"),Ie(v),qt(v,"link",e),i.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(d,v))}}function uS(e,r){Kn.M(e,r);var i=Hs;if(i&&e){var c=De(i).hoistableScripts,d=Ws(e),v=c.get(d);v||(v=i.querySelector(al(d)),v||(e=S({src:e,async:!0,type:"module"},r),(r=qa.get(d))&&B0(e,r),v=i.createElement("script"),Ie(v),qt(v,"link",e),i.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(d,v))}}function l1(e,r,i,c){var d=(d=ce.current)?Kc(d):null;if(!d)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(r=Gs(i.href),i=De(d).hoistableStyles,c=i.get(r),c||(c={type:"style",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=Gs(i.href);var v=De(d).hoistableStyles,E=v.get(e);if(E||(d=d.ownerDocument||d,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(e,E),(v=d.querySelector(tl(e)))&&!v._p&&(E.instance=v,E.state.loading=5),qa.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},qa.set(e,i),v||fS(d,e,i,E.state))),r&&c===null)throw Error(s(528,""));return E}if(r&&c!==null)throw Error(s(529,""));return null;case"script":return r=i.async,i=i.src,typeof i=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Ws(i),i=De(d).hoistableScripts,c=i.get(r),c||(c={type:"script",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Gs(e){return'href="'+za(e)+'"'}function tl(e){return'link[rel="stylesheet"]['+e+"]"}function c1(e){return S({},e,{"data-precedence":e.precedence,precedence:null})}function fS(e,r,i,c){e.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=e.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),qt(r,"link",i),Ie(r),e.head.appendChild(r))}function Ws(e){return'[src="'+za(e)+'"]'}function al(e){return"script[async]"+e}function o1(e,r,i){if(r.count++,r.instance===null)switch(r.type){case"style":var c=e.querySelector('style[data-href~="'+za(i.href)+'"]');if(c)return r.instance=c,Ie(c),c;var d=S({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),Ie(c),qt(c,"style",d),Pc(c,i.precedence,e),r.instance=c;case"stylesheet":d=Gs(i.href);var v=e.querySelector(tl(d));if(v)return r.state.loading|=4,r.instance=v,Ie(v),v;c=c1(i),(d=qa.get(d))&&L0(c,d),v=(e.ownerDocument||e).createElement("link"),Ie(v);var E=v;return E._p=new Promise(function(A,W){E.onload=A,E.onerror=W}),qt(v,"link",c),r.state.loading|=4,Pc(v,i.precedence,e),r.instance=v;case"script":return v=Ws(i.src),(d=e.querySelector(al(v)))?(r.instance=d,Ie(d),d):(c=i,(d=qa.get(v))&&(c=S({},i),B0(c,d)),e=e.ownerDocument||e,d=e.createElement("script"),Ie(d),qt(d,"link",c),e.head.appendChild(d),r.instance=d);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Pc(c,i.precedence,e));return r.instance}function Pc(e,r,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=c.length?c[c.length-1]:null,v=d,E=0;E<c.length;E++){var A=c[E];if(A.dataset.precedence===r)v=A;else if(v!==d)break}v?v.parentNode.insertBefore(e,v.nextSibling):(r=i.nodeType===9?i.head:i,r.insertBefore(e,r.firstChild))}function L0(e,r){e.crossOrigin==null&&(e.crossOrigin=r.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=r.referrerPolicy),e.title==null&&(e.title=r.title)}function B0(e,r){e.crossOrigin==null&&(e.crossOrigin=r.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=r.referrerPolicy),e.integrity==null&&(e.integrity=r.integrity)}var zc=null;function u1(e,r,i){if(zc===null){var c=new Map,d=zc=new Map;d.set(i,c)}else d=zc,c=d.get(i),c||(c=new Map,d.set(i,c));if(c.has(e))return c;for(c.set(e,null),i=i.getElementsByTagName(e),d=0;d<i.length;d++){var v=i[d];if(!(v[le]||v[O]||e==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var E=v.getAttribute(r)||"";E=e+E;var A=c.get(E);A?A.push(v):c.set(E,[v])}}return c}function f1(e,r,i){e=e.ownerDocument||e,e.head.insertBefore(i,r==="title"?e.querySelector("head > title"):null)}function dS(e,r,i){if(i===1||r.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return e=r.disabled,typeof r.precedence=="string"&&e==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function d1(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function hS(e,r,i,c){if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var d=Gs(c.href),v=r.querySelector(tl(d));if(v){r=v._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(e.count++,e=Hc.bind(e),r.then(e,e)),i.state.loading|=4,i.instance=v,Ie(v);return}v=r.ownerDocument||r,c=c1(c),(d=qa.get(d))&&L0(c,d),v=v.createElement("link"),Ie(v);var E=v;E._p=new Promise(function(A,W){E.onload=A,E.onerror=W}),qt(v,"link",c),i.instance=v}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,r),(r=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=Hc.bind(e),r.addEventListener("load",i),r.addEventListener("error",i))}}var K0=0;function mS(e,r){return e.stylesheets&&e.count===0&&Wc(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var c=setTimeout(function(){if(e.stylesheets&&Wc(e,e.stylesheets),e.unsuspend){var v=e.unsuspend;e.unsuspend=null,v()}},6e4+r);0<e.imgBytes&&K0===0&&(K0=62500*Xx());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Wc(e,e.stylesheets),e.unsuspend)){var v=e.unsuspend;e.unsuspend=null,v()}},(e.imgBytes>K0?50:800)+r);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(d)}}:null}function Hc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Gc=null;function Wc(e,r){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Gc=new Map,r.forEach(vS,e),Gc=null,Hc.call(e))}function vS(e,r){if(!(r.state.loading&4)){var i=Gc.get(e);if(i)var c=i.get(null);else{i=new Map,Gc.set(e,i);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<d.length;v++){var E=d[v];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(i.set(E.dataset.precedence,E),c=E)}c&&i.set(null,c)}d=r.instance,E=d.getAttribute("data-precedence"),v=i.get(E)||c,v===c&&i.set(null,d),i.set(E,d),this.count++,c=Hc.bind(this),d.addEventListener("load",c),d.addEventListener("error",c),v?v.parentNode.insertBefore(d,v.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),r.state.loading|=4}}var nl={$$typeof:D,Provider:null,Consumer:null,_currentValue:ke,_currentValue2:ke,_threadCount:0};function gS(e,r,i,c,d,v,E,A,W){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gi(0),this.hiddenUpdates=gi(null),this.identifierPrefix=c,this.onUncaughtError=d,this.onCaughtError=v,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function h1(e,r,i,c,d,v,E,A,W,ae,de,ve){return e=new gS(e,r,i,E,W,ae,de,ve,A),r=1,v===!0&&(r|=24),v=Na(3,null,null,r),e.current=v,v.stateNode=e,r=Su(),r.refCount++,e.pooledCache=r,r.refCount++,v.memoizedState={element:c,isDehydrated:i,cache:r},Eu(v),e}function m1(e){return e?(e=Ts,e):Ts}function v1(e,r,i,c,d,v){d=m1(d),c.context===null?c.context=d:c.pendingContext=d,c=nr(r),c.payload={element:i},v=v===void 0?null:v,v!==null&&(c.callback=v),i=rr(e,c,r),i!==null&&(ya(i,e,r),Ii(i,e,r))}function g1(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<r?i:r}}function P0(e,r){g1(e,r),(e=e.alternate)&&g1(e,r)}function p1(e){if(e.tag===13||e.tag===31){var r=Rr(e,67108864);r!==null&&ya(r,e,67108864),P0(e,67108864)}}function x1(e){if(e.tag===13||e.tag===31){var r=ka();r=pi(r);var i=Rr(e,r);i!==null&&ya(i,e,r),P0(e,r)}}var Vc=!0;function pS(e,r,i,c){var d=ee.T;ee.T=null;var v=ge.p;try{ge.p=2,z0(e,r,i,c)}finally{ge.p=v,ee.T=d}}function xS(e,r,i,c){var d=ee.T;ee.T=null;var v=ge.p;try{ge.p=8,z0(e,r,i,c)}finally{ge.p=v,ee.T=d}}function z0(e,r,i,c){if(Vc){var d=H0(c);if(d===null)A0(e,r,c,Yc,i),y1(e,c);else if(yS(d,e,r,i,c))c.stopPropagation();else if(y1(e,c),r&4&&-1<SS.indexOf(e)){for(;d!==null;){var v=Me(d);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var E=Ba(v.pendingLanes);if(E!==0){var A=v;for(A.pendingLanes|=2,A.entangledLanes|=2;E;){var W=1<<31-oa(E);A.entanglements[1]|=W,E&=~W}xn(v),(at&6)===0&&(Dc=Ct()+500,$i(0))}}break;case 31:case 13:A=Rr(v,2),A!==null&&ya(A,v,2),jc(),P0(v,2)}if(v=H0(c),v===null&&A0(e,r,c,Yc,i),v===d)break;d=v}d!==null&&c.stopPropagation()}else A0(e,r,c,null,i)}}function H0(e){return e=Wo(e),G0(e)}var Yc=null;function G0(e){if(Yc=null,e=Te(e),e!==null){var r=u(e);if(r===null)e=null;else{var i=r.tag;if(i===13){if(e=f(r),e!==null)return e;e=null}else if(i===31){if(e=h(r),e!==null)return e;e=null}else if(i===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null)}}return Yc=e,null}function S1(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ls()){case cs:return 2;case os:return 8;case La:case Ro:return 32;case vi:return 268435456;default:return 32}default:return 32}}var W0=!1,vr=null,gr=null,pr=null,rl=new Map,sl=new Map,xr=[],SS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function y1(e,r){switch(e){case"focusin":case"focusout":vr=null;break;case"dragenter":case"dragleave":gr=null;break;case"mouseover":case"mouseout":pr=null;break;case"pointerover":case"pointerout":rl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":sl.delete(r.pointerId)}}function il(e,r,i,c,d,v){return e===null||e.nativeEvent!==v?(e={blockedOn:r,domEventName:i,eventSystemFlags:c,nativeEvent:v,targetContainers:[d]},r!==null&&(r=Me(r),r!==null&&p1(r)),e):(e.eventSystemFlags|=c,r=e.targetContainers,d!==null&&r.indexOf(d)===-1&&r.push(d),e)}function yS(e,r,i,c,d){switch(r){case"focusin":return vr=il(vr,e,r,i,c,d),!0;case"dragenter":return gr=il(gr,e,r,i,c,d),!0;case"mouseover":return pr=il(pr,e,r,i,c,d),!0;case"pointerover":var v=d.pointerId;return rl.set(v,il(rl.get(v)||null,e,r,i,c,d)),!0;case"gotpointercapture":return v=d.pointerId,sl.set(v,il(sl.get(v)||null,e,r,i,c,d)),!0}return!1}function C1(e){var r=Te(e.target);if(r!==null){var i=u(r);if(i!==null){if(r=i.tag,r===13){if(r=f(i),r!==null){e.blockedOn=r,R(e.priority,function(){x1(i)});return}}else if(r===31){if(r=h(i),r!==null){e.blockedOn=r,R(e.priority,function(){x1(i)});return}}else if(r===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var i=H0(e.nativeEvent);if(i===null){i=e.nativeEvent;var c=new i.constructor(i.type,i);Go=c,i.target.dispatchEvent(c),Go=null}else return r=Me(i),r!==null&&p1(r),e.blockedOn=i,!1;r.shift()}return!0}function T1(e,r,i){Xc(e)&&i.delete(r)}function CS(){W0=!1,vr!==null&&Xc(vr)&&(vr=null),gr!==null&&Xc(gr)&&(gr=null),pr!==null&&Xc(pr)&&(pr=null),rl.forEach(T1),sl.forEach(T1)}function Jc(e,r){e.blockedOn===r&&(e.blockedOn=null,W0||(W0=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,CS)))}var qc=null;function E1(e){qc!==e&&(qc=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){qc===e&&(qc=null);for(var r=0;r<e.length;r+=3){var i=e[r],c=e[r+1],d=e[r+2];if(typeof c!="function"){if(G0(c||i)===null)continue;break}var v=Me(i);v!==null&&(e.splice(r,3),r-=3,Hu(v,{pending:!0,data:d,method:i.method,action:c},c,d))}}))}function Vs(e){function r(W){return Jc(W,e)}vr!==null&&Jc(vr,e),gr!==null&&Jc(gr,e),pr!==null&&Jc(pr,e),rl.forEach(r),sl.forEach(r);for(var i=0;i<xr.length;i++){var c=xr[i];c.blockedOn===e&&(c.blockedOn=null)}for(;0<xr.length&&(i=xr[0],i.blockedOn===null);)C1(i),i.blockedOn===null&&xr.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var d=i[c],v=i[c+1],E=d[I]||null;if(typeof v=="function")E||E1(i);else if(E){var A=null;if(v&&v.hasAttribute("formAction")){if(d=v,E=v[I]||null)A=E.formAction;else if(G0(d)!==null)continue}else A=E.action;typeof A=="function"?i[c+1]=A:(i.splice(c,3),c-=3),E1(i)}}}function _1(){function e(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(E){return d=E})},focusReset:"manual",scroll:"manual"})}function r(){d!==null&&(d(),d=null),c||setTimeout(i,20)}function i(){if(!c&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(i,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),d!==null&&(d(),d=null)}}}function V0(e){this._internalRoot=e}$c.prototype.render=V0.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(s(409));var i=r.current,c=ka();v1(i,c,e,r,null,null)},$c.prototype.unmount=V0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;v1(e.current,2,null,e,null,null),jc(),r[F]=null}};function $c(e){this._internalRoot=e}$c.prototype.unstable_scheduleHydration=function(e){if(e){var r=N();e={blockedOn:null,target:e,priority:r};for(var i=0;i<xr.length&&r!==0&&r<xr[i].priority;i++);xr.splice(i,0,e),i===0&&C1(e)}};var w1=n.version;if(w1!=="19.2.0")throw Error(s(527,w1,"19.2.0"));ge.findDOMNode=function(e){var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=m(r),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var TS={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qc.isDisabled&&Qc.supportsFiber)try{Jn=Qc.inject(TS),na=Qc}catch{}}return cl.createRoot=function(e,r){if(!l(e))throw Error(s(299));var i=!1,c="",d=kh,v=Uh,E=Oh;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(d=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError)),r=h1(e,1,!1,null,null,i,c,null,d,v,E,_1),e[F]=r.current,N0(e),new V0(r)},cl.hydrateRoot=function(e,r,i){if(!l(e))throw Error(s(299));var c=!1,d="",v=kh,E=Uh,A=Oh,W=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(v=i.onUncaughtError),i.onCaughtError!==void 0&&(E=i.onCaughtError),i.onRecoverableError!==void 0&&(A=i.onRecoverableError),i.formState!==void 0&&(W=i.formState)),r=h1(e,1,!0,r,i??null,c,d,W,v,E,A,_1),r.context=m1(null),i=r.current,c=ka(),c=pi(c),d=nr(c),d.callback=null,rr(i,d,c),i=c,r.current.lanes=i,jr(r,i),xn(r),e[F]=r.current,N0(e),new $c(r)},cl.version="19.2.0",cl}var I1;function US(){if(I1)return X0.exports;I1=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),X0.exports=kS(),X0.exports}var OS=US(),z=pf();const IS=_S(z),RS="modulepreload",FS=function(a){return"/"+a},R1={},LS=function(n,t,s){let l=Promise.resolve();if(t&&t.length>0){let m=function(p){return Promise.all(p.map(S=>Promise.resolve(S).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};var f=m;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),g=h?.nonce||h?.getAttribute("nonce");l=m(t.map(p=>{if(p=FS(p),p in R1)return;R1[p]=!0;const S=p.endsWith(".css"),x=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${x}`))return;const C=document.createElement("link");if(C.rel=S?"stylesheet":RS,S||(C.as="script"),C.crossOrigin="",C.href=p,g&&C.setAttribute("nonce",g),document.head.appendChild(C),S)return new Promise((T,y)=>{C.addEventListener("load",T),C.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(h){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=h,window.dispatchEvent(g),!g.defaultPrevented)throw h}return l.then(h=>{for(const g of h||[])g.status==="rejected"&&u(g.reason);return n().catch(u)})},Tr=["New Contact","In Progress","Follow Up","Completed"],BS=["Islam","Protestan","Katolik","Hindu","Buddha","Konghucu","Advent"],KS=["Gereja Kristen Indonesia  GKI","Gereja Kristen Jawa  GKJ","Gereja Bethel Indonesia  GBI","Gereja Pantekosta di Indonesia  GPdI","Gereja Protestan di Indonesia bagian Barat  GPIB","Gereja Protestan Maluku  GPM","Huria Kristen Batak Protestan  HKBP","Gereja Huria Kristen Indonesia  HKI","Gereja Methodis Indonesia  GMI","Gereja Sidang-Sidang Jemaat Allah di Indonesia  GSJA","Gereja Reformed Injili Indonesia  GRII","Gereja Kristen Bethel Indonesia  GKBI","Gereja Kristen Nazarene Indonesia  GKNI","Gereja Isa Almasih  GIA","Gereja Kristen Protestan Simalungun  GKPS","Gereja Kristen Protestan Angkola  GKPA","Gereja Kristen Protestan Indonesia  GKPI","Gereja Toraja  GT","Gereja Toraja Mamasa  GTM","Gereja Kristen Sulawesi Tengah  GKST","Gereja Kristen Celebes  GKC","Gereja Kristen Kalimantan Barat  GKKB","Gereja Kalimantan Evangelis  GKE","Gereja Kristen Indonesia di Tanah Papua  GKI Papua","Gereja Kemah Injil Indonesia  GKII","Gereja Bala Keselamatan  BK","Gereja Kristen Indonesia Jawa Barat  GKI Jabar","Gereja Kristen Jawa Tengah  GKJT","Gereja Kristen Jawa Wetan  GKJW","Gereja Kristen Baptis Indonesia  GKBI atau GKBI Baptis","Gereja Baptis Indonesia  GBI Baptis","Gereja Pantekosta Serikat Indonesia  GPSI","Gereja Pantekosta Tabernakel  GPT","Gereja Masehi Injili di Timor  GMIT","Gereja Masehi Injili di Minahasa  GMIM","Gereja Masehi Injili di Halmahera  GMIH","Gereja Masehi Injili Sangihe Talaud  GMIST","Gereja Masehi Injili di Bolaang Mongondow  GMIBM","Gereja Masehi Injili di Talaud  GMITa","Gereja Kristen Oikoumene di Indonesia  GKOI","Gereja Persekutuan Kristen Alkitab Indonesia  GPKAI","Gereja Pentakosta Pusat Surabaya  GPPS","Gereja Kristen Setia Indonesia  GKSI","Gereja Sidang Jemaat Kristus  GSJK","Gereja Kristen Anugerah Indonesia  GKAI","Gereja Alkitab Anugerah  GAA","Gereja Kristen Kerasulan Baru  GKNB","Gereja Pantekosta Isa Almasih  GPIA"],Av=["Laki-laki","Perempuan"],Dv=["Rendah","Sedang","Tinggi","Urgent"],Mv=["Parabola","IndiHome","Youtube","Facebook","Instagram","Website","Search Engine","Layanan Doa"],PS=["Menikah","Tidak Menikah"],zS=["WhatsApp Chat","WhatsApp Call","Telepon","SMS"],Cr={maxDurationPerSession:480,maxDurationPerDay:960,maxFutureDate:0,maxPastDate:365},HS=[{label:"15 min",value:15},{label:"30 min",value:30},{label:"1 hour",value:60},{label:"2 hours",value:120}],Zc={SERVICES:"crm_services",SERVICE_METRICS:"crm_service_metrics"},sn={CONTACTS:"crm_contacts",USERS:"crm_users",SETTINGS:"crm_settings",CURRENT_USER:"crm_current_user"},ol=["id","createdAt","nama","nomorTelepon","jenisKelamin","alamat","provinsi","agama","subAgama","alasanMenghubungi","sumber","prioritas","statusKontak","updatedAt","createdBy"],Z0="1.0.0",Zs=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),zn=a=>{if(!a||isNaN(a.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch(n){return console.error("Error formatting date:",n,a),"Invalid Date"}},ef=a=>{if(!a||isNaN(a.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch(n){return console.error("Error formatting date:",n,a),"Invalid Date"}},on=a=>a.toISOString().split("T")[0],GS=(a,n)=>a.filter(t=>{try{if(n.dateRange){const s=new Date(t.createdAt),l=new Date(n.dateRange.startDate),u=new Date(n.dateRange.endDate);if(s<l||s>u)return!1}if(n.globalSearch){const s=n.globalSearch.toLowerCase(),l=t.nama?.toLowerCase().includes(s)||!1,u=t.nomorTelepon?.toLowerCase().includes(s)||!1;if(!l&&!u)return!1}if(!n.globalSearch&&(n.nama&&t.nama&&!t.nama.toLowerCase().includes(n.nama.toLowerCase())||n.nomorTelepon&&t.nomorTelepon&&!t.nomorTelepon.toLowerCase().includes(n.nomorTelepon.toLowerCase()))||n.alamat&&t.alamat&&!t.alamat.toLowerCase().includes(n.alamat.toLowerCase())||n.agama&&t.agama&&!t.agama.toLowerCase().includes(n.agama.toLowerCase())||n.alasanMenghubungi&&t.alasanMenghubungi&&!t.alasanMenghubungi.toLowerCase().includes(n.alasanMenghubungi.toLowerCase()))return!1}catch(s){return console.error("Error filtering contact:",s,t),!0}return!(n.statusKontak&&n.statusKontak.length>0&&!n.statusKontak.includes(t.statusKontak))}),WS=a=>[...a].sort((n,t)=>{try{const s=new Date(n.createdAt),l=new Date(t.createdAt);return isNaN(s.getTime())&&isNaN(l.getTime())?0:isNaN(s.getTime())?1:isNaN(l.getTime())?-1:l.getTime()-s.getTime()}catch(s){return console.error("Error sorting contacts by date:",s),0}}),VS=(a,n)=>{let t;return(...s)=>{clearTimeout(t),t=setTimeout(()=>a(...s),n)}},YS=a=>{const n=[];return(!a.nama||a.nama.trim()==="")&&n.push("Nama is required"),(!a.nomorTelepon||a.nomorTelepon.trim()==="")&&n.push("Nomor telepon is required"),a.jenisKelamin?Av.includes(a.jenisKelamin)||n.push("Invalid jenis kelamin"):n.push("Jenis kelamin is required"),(!a.alamat||a.alamat.trim()==="")&&n.push("Alamat is required"),(!a.provinsi||a.provinsi.trim()==="")&&n.push("Provinsi is required"),(!a.agama||a.agama.trim()==="")&&n.push("Agama is required"),(!a.alasanMenghubungi||a.alasanMenghubungi.trim()==="")&&n.push("Alasan menghubungi is required"),a.sumber?Mv.includes(a.sumber)||n.push("Invalid sumber"):n.push("Sumber is required"),a.prioritas?Dv.includes(a.prioritas)||n.push("Invalid prioritas"):n.push("Prioritas is required"),a.statusKontak?Tr.includes(a.statusKontak)||n.push("Invalid status kontak"):n.push("Status kontak is required"),a.nama&&a.nama.length>100&&n.push("Nama must be less than 100 characters"),a.nomorTelepon&&a.nomorTelepon.length>20&&n.push("Nomor telepon must be less than 20 characters"),a.alamat&&a.alamat.length>200&&n.push("Alamat must be less than 200 characters"),a.agama&&a.agama.length>50&&n.push("Agama must be less than 50 characters"),a.alasanMenghubungi&&a.alasanMenghubungi.length>500&&n.push("Alasan menghubungi must be less than 500 characters"),{isValid:n.length===0,errors:n}};class ti{id;createdAt;nama;nomorTelepon;jenisKelamin;usia;profesi;statusPernikahan;mediaKomunikasi;mission;alamat;provinsi;kabKota;uni;agama;subAgama;alasanMenghubungi;sumber;prioritas;statusKontak;updatedAt;createdBy;history;constructor(n,t,s,l,u,f,h,g,m,p,S,x,C,T,y,_,w,k,D,b,K,q,B){this.id=b||Zs(),this.nama=n.trim(),this.nomorTelepon=t.trim(),this.jenisKelamin=s,this.usia=x,this.profesi=C?.trim(),this.statusPernikahan=T,this.mediaKomunikasi=y,this.mission=_,this.alamat=l.trim(),this.provinsi=u.trim(),this.kabKota=k?.trim(),this.uni=D?.trim(),this.agama=f.trim(),this.subAgama=w?.trim(),this.alasanMenghubungi=h.trim(),this.sumber=g,this.prioritas=m,this.statusKontak=p,this.createdBy=S,this.createdAt=K||new Date,this.updatedAt=q||new Date,this.history=B||[{id:Zs(),timestamp:this.createdAt,action:"created",updatedBy:S,notes:"Contact created"}]}static validate(n){return YS(n)}static fromObject(n){const t=n.history?n.history.map(s=>({...s,timestamp:new Date(s.timestamp)})):void 0;return new ti(n.nama||"",n.nomorTelepon||"",n.jenisKelamin||"Laki-laki",n.alamat||"",n.provinsi||"",n.agama||"",n.alasanMenghubungi||"",n.sumber||"Parabola",n.prioritas||"Urgent",n.statusKontak||"New Contact",n.createdBy||"",n.usia,n.profesi,n.statusPernikahan,n.mediaKomunikasi,n.mission,n.subAgama,n.kabKota,n.uni,n.id,n.createdAt?new Date(n.createdAt):void 0,n.updatedAt?new Date(n.updatedAt):void 0,t)}static fromJSON(n){try{const t=JSON.parse(n);return ti.fromObject(t)}catch{throw new Error("Invalid JSON format for Contact")}}validate(){return ti.validate(this)}update(n,t){const s=[];n.nama!==void 0&&n.nama.trim()!==this.nama&&(s.push({field:"nama",oldValue:this.nama,newValue:n.nama.trim()}),this.nama=n.nama.trim()),n.nomorTelepon!==void 0&&n.nomorTelepon.trim()!==this.nomorTelepon&&(s.push({field:"nomorTelepon",oldValue:this.nomorTelepon,newValue:n.nomorTelepon.trim()}),this.nomorTelepon=n.nomorTelepon.trim()),n.jenisKelamin!==void 0&&n.jenisKelamin!==this.jenisKelamin&&(s.push({field:"jenisKelamin",oldValue:this.jenisKelamin,newValue:n.jenisKelamin}),this.jenisKelamin=n.jenisKelamin),n.usia!==void 0&&n.usia!==this.usia&&(s.push({field:"usia",oldValue:String(this.usia||""),newValue:String(n.usia)}),this.usia=n.usia),n.profesi!==void 0&&n.profesi?.trim()!==this.profesi&&(s.push({field:"profesi",oldValue:this.profesi||"",newValue:n.profesi.trim()}),this.profesi=n.profesi.trim()),n.statusPernikahan!==void 0&&n.statusPernikahan!==this.statusPernikahan&&(s.push({field:"statusPernikahan",oldValue:this.statusPernikahan||"",newValue:n.statusPernikahan}),this.statusPernikahan=n.statusPernikahan),n.mediaKomunikasi!==void 0&&n.mediaKomunikasi!==this.mediaKomunikasi&&(s.push({field:"mediaKomunikasi",oldValue:this.mediaKomunikasi||"",newValue:n.mediaKomunikasi}),this.mediaKomunikasi=n.mediaKomunikasi),n.mission!==void 0&&n.mission!==this.mission&&(s.push({field:"mission",oldValue:this.mission||"",newValue:n.mission}),this.mission=n.mission),n.alamat!==void 0&&n.alamat.trim()!==this.alamat&&(s.push({field:"alamat",oldValue:this.alamat,newValue:n.alamat.trim()}),this.alamat=n.alamat.trim()),n.provinsi!==void 0&&n.provinsi.trim()!==this.provinsi&&(s.push({field:"provinsi",oldValue:this.provinsi,newValue:n.provinsi.trim()}),this.provinsi=n.provinsi.trim()),n.agama!==void 0&&n.agama.trim()!==this.agama&&(s.push({field:"agama",oldValue:this.agama,newValue:n.agama.trim()}),this.agama=n.agama.trim()),n.subAgama!==void 0&&n.subAgama?.trim()!==this.subAgama&&(s.push({field:"subAgama",oldValue:this.subAgama||"",newValue:n.subAgama.trim()}),this.subAgama=n.subAgama.trim()),n.alasanMenghubungi!==void 0&&n.alasanMenghubungi.trim()!==this.alasanMenghubungi&&(s.push({field:"alasanMenghubungi",oldValue:this.alasanMenghubungi,newValue:n.alasanMenghubungi.trim()}),this.alasanMenghubungi=n.alasanMenghubungi.trim()),n.sumber!==void 0&&n.sumber!==this.sumber&&(s.push({field:"sumber",oldValue:this.sumber,newValue:n.sumber}),this.sumber=n.sumber),n.prioritas!==void 0&&n.prioritas!==this.prioritas&&(s.push({field:"prioritas",oldValue:this.prioritas,newValue:n.prioritas}),this.prioritas=n.prioritas),n.statusKontak!==void 0&&n.statusKontak!==this.statusKontak&&(s.push({field:"statusKontak",oldValue:this.statusKontak,newValue:n.statusKontak}),this.statusKontak=n.statusKontak),s.length>0&&(this.updatedAt=new Date,s.forEach(l=>{const u={id:Zs(),timestamp:this.updatedAt,action:l.field==="statusKontak"?"status_changed":"updated",field:l.field,oldValue:l.oldValue,newValue:l.newValue,updatedBy:t,notes:`${this.getFieldDisplayName(l.field)} diubah dari "${l.oldValue}" menjadi "${l.newValue}"`};this.history.push(u)}))}getFieldDisplayName(n){return{nama:"Nama",nomorTelepon:"Nomor Telepon",jenisKelamin:"Jenis Kelamin",usia:"Usia",profesi:"Profesi",statusPernikahan:"Status Pernikahan",mediaKomunikasi:"Media Komunikasi",mission:"Mission",alamat:"Alamat",provinsi:"Provinsi",agama:"Agama",subAgama:"Sub Agama",alasanMenghubungi:"Alasan Menghubungi",sumber:"Sumber",prioritas:"Prioritas",statusKontak:"Status Kontak"}[n]||n}addHistoryEntry(n,t,s,l,u,f){const h={id:Zs(),timestamp:new Date,action:n,field:l,oldValue:u,newValue:f,updatedBy:t,notes:s||`Contact ${n}`};this.history.push(h)}getHistory(){return[...this.history].sort((n,t)=>t.timestamp.getTime()-n.timestamp.getTime())}getRecentHistory(n=5){return this.getHistory().slice(0,n)}toObject(){return{id:this.id,createdAt:this.createdAt,nama:this.nama,nomorTelepon:this.nomorTelepon,jenisKelamin:this.jenisKelamin,usia:this.usia,profesi:this.profesi,statusPernikahan:this.statusPernikahan,mediaKomunikasi:this.mediaKomunikasi,mission:this.mission,alamat:this.alamat,provinsi:this.provinsi,agama:this.agama,subAgama:this.subAgama,alasanMenghubungi:this.alasanMenghubungi,sumber:this.sumber,prioritas:this.prioritas,statusKontak:this.statusKontak,updatedAt:this.updatedAt,createdBy:this.createdBy,history:this.history}}toJSON(){return JSON.stringify(this.toObject())}matchesSearch(n){const t=n.toLowerCase();return this.nama.toLowerCase().includes(t)||this.nomorTelepon.toLowerCase().includes(t)||this.jenisKelamin.toLowerCase().includes(t)||this.usia&&String(this.usia).includes(t)||this.profesi&&this.profesi.toLowerCase().includes(t)||this.statusPernikahan&&this.statusPernikahan.toLowerCase().includes(t)||this.mediaKomunikasi&&this.mediaKomunikasi.toLowerCase().includes(t)||this.mission&&this.mission.toLowerCase().includes(t)||this.alamat.toLowerCase().includes(t)||this.provinsi.toLowerCase().includes(t)||this.agama.toLowerCase().includes(t)||this.subAgama&&this.subAgama.toLowerCase().includes(t)||this.alasanMenghubungi.toLowerCase().includes(t)||this.sumber.toLowerCase().includes(t)||this.prioritas.toLowerCase().includes(t)||this.statusKontak.toLowerCase().includes(t)}getAgeInDays(){const t=Math.abs(new Date().getTime()-this.createdAt.getTime());return Math.ceil(t/(1e3*60*60*24))}isRecentlyUpdated(){return Math.abs(new Date().getTime()-this.updatedAt.getTime())/(1e3*60*60)<=24}}const XS=[{id:"contact-1",nama:"Sarah Johnson",nomorTelepon:"08123456789",jenisKelamin:"Perempuan",usia:28,alamat:"Jl. Sudirman No. 123, Jakarta Pusat",provinsi:"DKI Jakarta",agama:"Protestan",profesi:"Project Manager",statusPernikahan:"Tidak Menikah",alasanMenghubungi:"Konsultasi karir dan stress kerja",sumber:"Website",mediaKomunikasi:"WhatsApp Chat",prioritas:"Sedang",statusKontak:"New Contact",createdAt:new Date("2024-10-20"),updatedAt:new Date("2024-10-20"),createdBy:"admin",history:[{id:"hist-contact-1",timestamp:new Date("2024-10-20"),action:"created",updatedBy:"admin",notes:"Contact created"}]},{id:"contact-2",nama:"Michael Chen",nomorTelepon:"08567891234",jenisKelamin:"Laki-laki",usia:35,alamat:"Jl. Gatot Subroto No. 456, Bandung",provinsi:"Jawa Barat",agama:"Katolik",profesi:"Marketing Director",statusPernikahan:"Menikah",alasanMenghubungi:"Konseling keluarga",sumber:"Facebook",mediaKomunikasi:"WhatsApp Chat",prioritas:"Tinggi",statusKontak:"In Progress",createdAt:new Date("2024-10-18"),updatedAt:new Date("2024-10-19"),createdBy:"editor",history:[{id:"hist-contact-2",timestamp:new Date("2024-10-18"),action:"created",updatedBy:"editor",notes:"Contact created"},{id:"hist-contact-2-update",timestamp:new Date("2024-10-19"),action:"status_changed",field:"statusKontak",oldValue:"New Contact",newValue:"In Progress",updatedBy:"editor",notes:'Status Kontak diubah dari "New Contact" menjadi "In Progress"'}]},{id:"contact-3",nama:"Amanda Rodriguez",nomorTelepon:"62812345678",jenisKelamin:"Perempuan",usia:32,alamat:"Jl. Diponegoro No. 789, Surabaya",provinsi:"Jawa Timur",agama:"Islam",profesi:"Creative Director",statusPernikahan:"Menikah",alasanMenghubungi:"Terapi trauma dan kecemasan",sumber:"Instagram",mediaKomunikasi:"WhatsApp Chat",prioritas:"Tinggi",statusKontak:"Follow Up",createdAt:new Date("2024-10-15"),updatedAt:new Date("2024-10-20"),createdBy:"admin",history:[{id:"hist-contact-3",timestamp:new Date("2024-10-15"),action:"created",updatedBy:"admin",notes:"Contact created"},{id:"hist-contact-3-update",timestamp:new Date("2024-10-20"),action:"status_changed",field:"statusKontak",oldValue:"New Contact",newValue:"Follow Up",updatedBy:"admin",notes:'Status Kontak diubah dari "New Contact" menjadi "Follow Up"'}]},{id:"contact-4",nama:"David Kim",nomorTelepon:"8123456789",jenisKelamin:"Laki-laki",usia:29,alamat:"Jl. Ahmad Yani No. 321, Yogyakarta",provinsi:"DI Yogyakarta",agama:"Protestan",profesi:"CTO",statusPernikahan:"Tidak Menikah",alasanMenghubungi:"Konsultasi burnout dan work-life balance",sumber:"Website",mediaKomunikasi:"WhatsApp Chat",prioritas:"Sedang",statusKontak:"Completed",createdAt:new Date("2024-10-10"),updatedAt:new Date("2024-10-18"),createdBy:"editor",history:[{id:"hist-contact-4",timestamp:new Date("2024-10-10"),action:"created",updatedBy:"editor",notes:"Contact created"},{id:"hist-contact-4-update",timestamp:new Date("2024-10-18"),action:"status_changed",field:"statusKontak",oldValue:"In Progress",newValue:"Completed",updatedBy:"editor",notes:'Status Kontak diubah dari "In Progress" menjadi "Completed"'}]},{id:"contact-5",nama:"Lisa Thompson",nomorTelepon:"08234567890",jenisKelamin:"Perempuan",usia:26,alamat:"Jl. Thamrin No. 567, Jakarta",provinsi:"DKI Jakarta",agama:"Islam",profesi:"Sales Manager",statusPernikahan:"Tidak Menikah",alasanMenghubungi:"Konseling hubungan dan self-esteem",sumber:"Youtube",mediaKomunikasi:"WhatsApp Chat",prioritas:"Sedang",statusKontak:"New Contact",createdAt:new Date("2024-10-12"),updatedAt:new Date("2024-10-21"),createdBy:"admin",history:[{id:"hist-contact-5",timestamp:new Date("2024-10-12"),action:"created",updatedBy:"admin",notes:"Contact created"}]},{id:"contact-6",nama:"Robert Wilson",nomorTelepon:"08345678901",jenisKelamin:"Laki-laki",usia:41,alamat:"Jl. Kuningan No. 890, Jakarta Selatan",provinsi:"DKI Jakarta",agama:"Katolik",profesi:"Senior Consultant",statusPernikahan:"Menikah",alasanMenghubungi:"Terapi depresi dan anxiety",sumber:"Website",mediaKomunikasi:"WhatsApp Chat",prioritas:"Tinggi",statusKontak:"In Progress",createdAt:new Date("2024-10-14"),updatedAt:new Date("2024-10-22"),createdBy:"editor",history:[{id:"hist-contact-6",timestamp:new Date("2024-10-14"),action:"created",updatedBy:"editor",notes:"Contact created"},{id:"hist-contact-6-update",timestamp:new Date("2024-10-22"),action:"status_changed",field:"statusKontak",oldValue:"New Contact",newValue:"In Progress",updatedBy:"editor",notes:'Status Kontak diubah dari "New Contact" menjadi "In Progress"'}]}];class JS{getStorageData(n,t){try{const s=localStorage.getItem(n);if(s===null)return t;const l=JSON.parse(s);return n===sn.CONTACTS&&Array.isArray(l)?l.map(u=>({...u,createdAt:new Date(u.createdAt),updatedAt:new Date(u.updatedAt),history:u.history?u.history.map(f=>({...f,timestamp:new Date(f.timestamp)})):[]})):l}catch(s){return console.error(`Error reading from localStorage key ${n}:`,s),t}}setStorageData(n,t){try{localStorage.setItem(n,JSON.stringify(t))}catch(s){throw console.error(`Error writing to localStorage key ${n}:`,s),new Error("Storage quota exceeded or storage unavailable")}}getContacts(){return this.getStorageData(sn.CONTACTS,[]).map(t=>({...t,nomorTelepon:t.nomorTelepon||"",jenisKelamin:t.jenisKelamin||"Laki-laki",provinsi:t.provinsi||t.kotaKabupaten||"",sumber:t.sumber||"Lainnya",prioritas:t.prioritas||"Sedang",history:t.history||[{id:"migration-"+Date.now(),timestamp:t.createdAt||new Date,action:"created",updatedBy:t.createdBy||"system",notes:"Contact migrated to new format"}]}))}saveContacts(n){this.setStorageData(sn.CONTACTS,n)}addContact(n){const t=this.getContacts();t.push(n),this.saveContacts(t)}updateContact(n,t){const s=this.getContacts(),l=s.findIndex(u=>u.id===n);l!==-1&&(s[l]={...s[l],...t,updatedAt:new Date},this.saveContacts(s))}updateContactWithHistory(n,t,s){const l=this.getContacts(),u=l.findIndex(f=>f.id===n);if(u!==-1){const f=l[u],h=ti.fromObject(f);h.update(t,s),l[u]=h.toObject(),this.saveContacts(l)}}deleteContact(n){const s=this.getContacts().filter(l=>l.id!==n);this.saveContacts(s)}getUsers(){return this.getStorageData(sn.USERS,this.getDefaultUsers())}saveUsers(n){this.setStorageData(sn.USERS,n)}getCurrentUser(){return this.getStorageData(sn.CURRENT_USER,null)}setCurrentUser(n){this.setStorageData(sn.CURRENT_USER,n)}getUserCredentials(){return this.getStorageData("user_credentials",[{username:"admin",password:"admin123"},{username:"editor",password:"editor123"}])}saveUserCredentials(n){this.setStorageData("user_credentials",n)}addUserCredential(n,t){const s=this.getUserCredentials(),l=s.findIndex(u=>u.username===n);l!==-1?s[l].password=t:s.push({username:n,password:t}),this.saveUserCredentials(s)}removeUserCredential(n){const s=this.getUserCredentials().filter(l=>l.username!==n);this.saveUserCredentials(s)}getSettings(){return this.getStorageData(sn.SETTINGS,this.getDefaultSettings())}saveSettings(n){this.setStorageData(sn.SETTINGS,n)}getDefaultUsers(){const n=new Date("2024-01-01T00:00:00Z");return[{id:"admin-consistent-id",username:"admin",role:"Admin",createdAt:n},{id:"editor-consistent-id",username:"editor",role:"Editor",createdAt:n}]}getDeviceType(){const n=navigator.userAgent;return/Mobile|Android|iPhone|iPad/.test(n)?"Mobile":"Desktop"}getOrCreateDeviceId(){const n=this.getStorageData("device_id",null);if(!n){const t="device-"+Date.now()+"-"+Math.random().toString(36).substr(2,9);return this.setStorageData("device_id",t),t}return n}getDeviceInfo(){return{deviceId:this.getOrCreateDeviceId(),deviceType:this.getDeviceType(),userAgent:navigator.userAgent}}getDefaultSettings(){return{contactStatuses:Tr,exportFormats:["csv","excel"],defaultFilters:{}}}getStorageUsage(){let n=0;for(let l in localStorage)localStorage.hasOwnProperty(l)&&(n+=localStorage[l].length+l.length);const t=5*1024*1024,s=n/t*100;return{used:n,total:t,percentage:s}}initializeDemoData(){console.log("Initializing demo contacts with WhatsApp numbers..."),this.saveContacts(XS),LS(async()=>{const{serviceStorage:n}=await Promise.resolve().then(()=>sN);return{serviceStorage:n}},void 0).then(({serviceStorage:n})=>{n.initializeDemoServiceData()})}clearAllData(){Object.values(sn).forEach(n=>{localStorage.removeItem(n)})}clearContactData(){localStorage.removeItem(sn.CONTACTS),console.log(" Contact data cleared")}clearDemoData(){this.clearContactData(),localStorage.removeItem("crm_services"),localStorage.removeItem("crm_service_sessions"),console.log(" All demo data cleared")}loadDemoData(){this.initializeDemoData(),console.log(" Demo data loaded")}getContactById(n){return this.getContacts().find(s=>s.id===n)||null}getContactsByUser(n){return this.getContacts().filter(s=>s.createdBy===n)}getContactsByStatus(n){return this.getContacts().filter(s=>s.statusKontak===n)}getContactsCount(){return this.getContacts().length}getUserById(n){return this.getUsers().find(s=>s.id===n)||null}getUserByUsername(n){return this.getUsers().find(s=>s.username.toLowerCase()===n.toLowerCase())||null}addUser(n){const t=this.getUsers();t.push(n),this.saveUsers(t)}updateUser(n,t){const s=this.getUsers(),l=s.findIndex(u=>u.id===n);l!==-1&&(s[l]={...s[l],...t},this.saveUsers(s))}deleteUser(n){const s=this.getUsers().filter(l=>l.id!==n);this.saveUsers(s)}isStorageAvailable(){try{const n="__storage_test__";return localStorage.setItem(n,"test"),localStorage.removeItem(n),!0}catch{return!1}}getStorageInfo(){return{isAvailable:this.isStorageAvailable(),usage:this.getStorageUsage(),contactsCount:this.getContactsCount(),usersCount:this.getUsers().length}}validateStorageData(){const n=[];try{this.getContacts().forEach((u,f)=>{(!u.id||!u.nama||!u.alamat||!u.agama||!u.alasanMenghubungi||!u.statusKontak)&&n.push(`Contact at index ${f} is missing required fields`)}),this.getUsers().forEach((u,f)=>{(!u.id||!u.username||!u.role)&&n.push(`User at index ${f} is missing required fields`)});const l=this.getSettings();(!l.contactStatuses||!Array.isArray(l.contactStatuses))&&n.push("Settings contactStatuses is invalid")}catch(t){n.push(`Storage validation error: ${t instanceof Error?t.message:"Unknown error"}`)}return{isValid:n.length===0,errors:n}}initializeStorage(){if(this.getContacts().length===0){const t=[{id:"sample-1",createdAt:new Date,nama:"John Doe",nomorTelepon:"081234567890",jenisKelamin:"Laki-laki",alamat:"Jl. Contoh No. 123, Jakarta",provinsi:"DKI Jakarta",agama:"Islam",alasanMenghubungi:"Konsultasi produk",sumber:"Website",prioritas:"Tinggi",statusKontak:"New Contact",updatedAt:new Date,createdBy:"admin-1",history:[{id:"hist-1",timestamp:new Date,action:"created",updatedBy:"admin-1",notes:"Contact created"}]},{id:"sample-2",createdAt:new Date(Date.now()-864e5),nama:"Jane Smith",nomorTelepon:"087654321098",jenisKelamin:"Perempuan",alamat:"Jl. Sample No. 456, Bandung",provinsi:"Jawa Barat",agama:"Kristen",alasanMenghubungi:"Keluhan layanan",sumber:"Facebook",prioritas:"Urgent",statusKontak:"In Progress",updatedAt:new Date(Date.now()-864e5),createdBy:"editor-1",history:[{id:"hist-2",timestamp:new Date(Date.now()-864e5),action:"created",updatedBy:"editor-1",notes:"Contact created"}]}];this.saveContacts(t)}this.getUsers().length===0&&this.saveUsers(this.getDefaultUsers()),this.getSettings().contactStatuses||this.saveSettings(this.getDefaultSettings())}exportBackup(){const n={contacts:this.getContacts(),users:this.getUsers(),settings:this.getSettings(),version:Z0};return JSON.stringify(n,null,2)}exportBackupFile(){try{const n=this.exportBackup(),s=`crm-backup-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,l=new Blob([n],{type:"application/json"}),u=URL.createObjectURL(l),f=document.createElement("a");f.href=u,f.download=s,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(u)}catch{throw new Error("Failed to export backup file")}}importBackup(n){const t=[];try{const s=JSON.parse(n);if(s.version!==Z0&&t.push(`Backup version (${s.version}) differs from current version (${Z0})`),!s.contacts||!Array.isArray(s.contacts))throw new Error("Invalid backup: contacts data is missing or invalid");if(!s.users||!Array.isArray(s.users))throw new Error("Invalid backup: users data is missing or invalid");if(!s.settings||typeof s.settings!="object")throw new Error("Invalid backup: settings data is missing or invalid");const l=this.exportBackup();this.setStorageData("__recovery_backup__",l),this.saveContacts(s.contacts),this.saveUsers(s.users),this.saveSettings(s.settings);const u=this.validateStorageData();return u.isValid||t.push("Some imported data may be invalid: "+u.errors.join(", ")),{success:!0,message:"Backup imported successfully",warnings:t}}catch(s){return{success:!1,message:s instanceof Error?s.message:"Unknown error during backup import",warnings:t}}}importBackupFromFile(n){return new Promise(t=>{const s=new FileReader;s.onload=l=>{try{const u=l.target?.result,f=this.importBackup(u);t(f)}catch{t({success:!1,message:"Failed to read backup file",warnings:[]})}},s.onerror=()=>{t({success:!1,message:"Error reading backup file",warnings:[]})},s.readAsText(n)})}hasRecoveryBackup(){try{return localStorage.getItem("__recovery_backup__")!==null}catch{return!1}}restoreFromRecovery(){try{const n=localStorage.getItem("__recovery_backup__");if(!n)return{success:!1,message:"No recovery backup available"};const t=this.importBackup(n);return t.success?(localStorage.removeItem("__recovery_backup__"),{success:!0,message:"Data restored from recovery backup"}):{success:!1,message:t.message}}catch{return{success:!1,message:"Failed to restore from recovery backup"}}}clearRecoveryBackup(){localStorage.removeItem("__recovery_backup__")}detectCorruption(){const n=[];try{this.isStorageAvailable()||n.push("LocalStorage is not available");const t=this.validateStorageData();t.isValid||n.push(...t.errors);const s=this.getContacts(),l=this.getUsers(),u=this.getSettings();Array.isArray(s)||n.push("Contacts data is corrupted"),(!Array.isArray(l)||l.length===0)&&n.push("Users data is missing or corrupted"),(!u||!u.contactStatuses)&&n.push("Settings data is corrupted")}catch(t){n.push(`Data corruption detected: ${t instanceof Error?t.message:"Unknown error"}`)}return{isCorrupted:n.length>0,issues:n}}repairCorruption(){const n=[];try{if(this.hasRecoveryBackup()&&this.restoreFromRecovery().success)return n.push("Restored data from recovery backup"),{success:!0,message:"Data corruption repaired using recovery backup",actionsPerformed:n};const t=this.detectCorruption();return t.issues.includes("Users data is missing or corrupted")&&(this.saveUsers(this.getDefaultUsers()),n.push("Restored default users")),t.issues.includes("Settings data is corrupted")&&(this.saveSettings(this.getDefaultSettings()),n.push("Restored default settings")),t.issues.includes("Contacts data is corrupted")&&(this.saveContacts([]),n.push("Reset contacts data (data may be lost)")),{success:!0,message:"Data corruption repaired with default values",actionsPerformed:n}}catch{return{success:!1,message:"Failed to repair data corruption",actionsPerformed:n}}}}const Ke=new JS;class qS{async login(n,t){const s=Ke.getUsers();if(Ke.getUserCredentials().some(f=>f.username===n&&f.password===t)){const f=s.find(h=>h.username===n);if(f)return Ke.setCurrentUser(f),f}return null}logout(){Ke.setCurrentUser(null)}getCurrentUser(){return Ke.getCurrentUser()}isAuthenticated(){return this.getCurrentUser()!==null}hasPermission(n){const t=this.getCurrentUser();return t?t.role==="Admin"||t.role==="Editor"&&n==="Editor":!1}canManageUsers(){return this.hasPermission("Admin")}canManageContacts(){return this.hasPermission("Editor")}canExportData(){return this.hasPermission("Editor")}}const Jr=new qS,$S={currentUser:null,isAuthenticated:!1,isLoading:!0,error:null},QS=(a,n)=>{switch(n.type){case"LOGIN_START":return{...a,isLoading:!0,error:null};case"LOGIN_SUCCESS":return{...a,currentUser:n.payload,isAuthenticated:!0,isLoading:!1,error:null};case"LOGIN_FAILURE":return{...a,currentUser:null,isAuthenticated:!1,isLoading:!1,error:n.payload};case"LOGOUT":return{...a,currentUser:null,isAuthenticated:!1,isLoading:!1,error:null};case"CLEAR_ERROR":return{...a,error:null};case"SET_LOADING":return{...a,isLoading:n.payload};default:return a}},No=z.createContext(void 0),ZS=({children:a})=>{const[n,t]=z.useReducer(QS,$S);z.useEffect(()=>{(()=>{try{const x=Jr.getCurrentUser();t(x?{type:"LOGIN_SUCCESS",payload:x}:{type:"SET_LOADING",payload:!1})}catch(x){console.error("Error checking authentication:",x),t({type:"SET_LOADING",payload:!1})}})()},[]);const s=async(S,x)=>{t({type:"LOGIN_START"});try{const C=await Jr.login(S,x);return C?(t({type:"LOGIN_SUCCESS",payload:C}),!0):(t({type:"LOGIN_FAILURE",payload:"Username atau password salah"}),!1)}catch(C){const T=C instanceof Error?C.message:"Login gagal";return t({type:"LOGIN_FAILURE",payload:T}),!1}},l=()=>{try{Jr.logout(),t({type:"LOGOUT"})}catch(S){console.error("Error during logout:",S),t({type:"LOGOUT"})}},u=()=>{t({type:"CLEAR_ERROR"})},f=S=>Jr.hasPermission(S),h=()=>Jr.canManageUsers(),g=()=>Jr.canManageContacts(),m=()=>Jr.canExportData(),p={currentUser:n.currentUser,isAuthenticated:n.isAuthenticated,login:s,logout:l,isLoading:n.isLoading,error:n.error,clearError:u,hasPermission:f,canManageUsers:h,canManageContacts:g,canExportData:m};return o.jsx(No.Provider,{value:p,children:a})};class Ys{static generateSyncURL(){const n={users:JSON.parse(localStorage.getItem("users")||"[]"),userCredentials:JSON.parse(localStorage.getItem("user_credentials")||"[]"),contacts:JSON.parse(localStorage.getItem("contacts")||"[]"),timestamp:new Date().toISOString()},t=btoa(JSON.stringify(n));return`${window.location.origin+window.location.pathname}?sync=${t}`}static importFromURL(){const t=new URLSearchParams(window.location.search).get("sync");if(!t)return!1;try{const s=atob(t),l=JSON.parse(s);if(!l.users||!l.userCredentials)throw new Error("Invalid sync data");return localStorage.setItem("users",JSON.stringify(l.users)),localStorage.setItem("user_credentials",JSON.stringify(l.userCredentials)),localStorage.setItem("contacts",JSON.stringify(l.contacts)),localStorage.setItem("sync_imported_at",new Date().toISOString()),window.history.replaceState({},document.title,window.location.pathname),!0}catch(s){return console.error("Error importing sync data:",s),!1}}static generateQRData(){return this.generateSyncURL()}static exportData(){const n={users:JSON.parse(localStorage.getItem("users")||"[]"),userCredentials:JSON.parse(localStorage.getItem("user_credentials")||"[]"),contacts:JSON.parse(localStorage.getItem("contacts")||"[]"),timestamp:new Date().toISOString()};return JSON.stringify(n,null,2)}static importData(n){try{const t=JSON.parse(n);if(!t.users||!t.userCredentials)throw new Error("Invalid data format");return localStorage.setItem("users",JSON.stringify(t.users)),localStorage.setItem("user_credentials",JSON.stringify(t.userCredentials)),localStorage.setItem("contacts",JSON.stringify(t.contacts)),localStorage.setItem("sync_imported_at",new Date().toISOString()),!0}catch(t){return console.error("Error importing data:",t),!1}}static hasSyncDataInURL(){return new URLSearchParams(window.location.search).has("sync")}static getSyncStatus(){return{lastImport:localStorage.getItem("sync_imported_at"),hasUrlData:this.hasSyncDataInURL()}}}const jv=({onSyncComplete:a})=>{const[n,t]=z.useState(!1),[s,l]=z.useState({lastImport:null,hasUrlData:!1}),[u,f]=z.useState(!1),[h,g]=z.useState(""),[m,p]=z.useState(""),[S,x]=z.useState("");z.useEffect(()=>{C(),T()},[]);const C=()=>{const b=Ys.getSyncStatus();l(b)},T=()=>{Ys.hasSyncDataInURL()&&confirm(" Sync data detected in URL! Import this data to sync with another device?")&&(Ys.importFromURL()?(alert(" Data successfully synced from URL!"),C(),a?.()):alert(" Failed to import sync data from URL."))},y=()=>{t(!0);try{const b=Ys.generateSyncURL();x(b),alert(" Sync URL generated! Copy and open on your other device.")}catch(b){alert(" Error generating sync URL: "+b)}finally{t(!1)}},_=()=>{S&&(navigator.clipboard.writeText(S),alert(" Sync URL copied to clipboard! Paste and open on your other device."))},w=()=>{const b=Ys.exportData();g(b),f(!0)},k=()=>{if(!m.trim()){alert(" Masukkan data untuk diimport!");return}if(!confirm(" Ini akan mengganti semua data lokal. Lanjutkan?"))return;Ys.importData(m)?(alert(" Data berhasil diimport! Silakan refresh halaman."),window.location.reload()):alert(" Gagal import data. Periksa format data.")},D=()=>{navigator.clipboard.writeText(h),alert(" Data disalin ke clipboard!")};return o.jsxs("div",{className:"cloud-sync",children:[o.jsxs("div",{className:"sync-header",children:[o.jsx("h3",{children:" Device Synchronization"}),o.jsxs("div",{className:"sync-status",children:[o.jsx("div",{className:"status-indicator online",children:" Ready to Sync"}),s.lastImport&&o.jsxs("div",{className:"last-sync",children:["Last import: ",new Date(s.lastImport).toLocaleString()]})]})]}),o.jsxs("div",{className:"sync-actions",children:[o.jsx("button",{onClick:y,disabled:n,className:"sync-btn primary",children:n?" Generating...":" Generate Sync URL"}),S&&o.jsx("button",{onClick:_,className:"sync-btn secondary",children:" Copy Sync URL"})]}),S&&o.jsxs("div",{className:"sync-url-display",children:[o.jsx("h4",{children:" Sync URL Generated"}),o.jsx("p",{children:"Copy this URL and open it on your other device to sync data:"}),o.jsxs("div",{className:"url-container",children:[o.jsx("input",{type:"text",value:S,readOnly:!0,className:"sync-url-input"}),o.jsx("button",{onClick:_,className:"copy-url-btn",children:" Copy"})]})]}),o.jsxs("div",{className:"manual-sync",children:[o.jsx("h4",{children:" Manual Device Sync"}),o.jsx("p",{children:"For syncing data between devices manually:"}),o.jsxs("div",{className:"manual-actions",children:[o.jsx("button",{onClick:w,className:"export-btn",children:" Export Data"}),o.jsxs("div",{className:"import-section",children:[o.jsx("textarea",{value:m,onChange:b=>p(b.target.value),placeholder:"Paste exported data here...",className:"import-textarea"}),o.jsx("button",{onClick:k,className:"import-btn",children:" Import Data"})]})]})]}),u&&o.jsx("div",{className:"export-modal",children:o.jsxs("div",{className:"export-content",children:[o.jsx("h4",{children:" Exported Data"}),o.jsx("p",{children:"Copy this data and paste it on your other device:"}),o.jsx("textarea",{value:h,readOnly:!0,className:"export-data"}),o.jsxs("div",{className:"export-actions",children:[o.jsx("button",{onClick:D,className:"copy-btn",children:" Copy to Clipboard"}),o.jsx("button",{onClick:()=>f(!1),className:"close-btn",children:" Close"})]})]})})]})},e2=({onLoginSuccess:a})=>{const[n,t]=z.useState(""),[s,l]=z.useState(""),[u,f]=z.useState(!1),h=z.useContext(No);if(!h)throw new Error("Login must be used within an AuthProvider");const{login:g,error:m,clearError:p,isLoading:S}=h;z.useEffect(()=>{m&&p()},[n,s,p]);const x=async C=>{if(C.preventDefault(),!(!n.trim()||!s.trim())){f(!0);try{await g(n.trim(),s)&&a?.()}catch(T){console.error("Login error:",T)}finally{f(!1)}}};return S?o.jsx("div",{className:"login-container",children:o.jsx("div",{className:"login-card",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Checking authentication..."})]})})}):o.jsx("div",{className:"login-container",children:o.jsxs("div",{className:"login-card",children:[o.jsxs("div",{className:"login-header",children:[o.jsx("h1",{children:"Hopeline Care"}),o.jsx("p",{children:"Contact Management System"}),o.jsxs("div",{className:"device-indicator",children:[" ",navigator.userAgent.includes("Mobile")?"Mobile":"Desktop"," Device"]})]}),o.jsxs("form",{onSubmit:x,className:"login-form",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"username",children:"Username"}),o.jsx("input",{id:"username",type:"text",value:n,onChange:C=>t(C.target.value),placeholder:"Masukkan username",disabled:u,required:!0,autoComplete:"username",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"password",children:"Password"}),o.jsx("input",{id:"password",type:"password",value:s,onChange:C=>l(C.target.value),placeholder:"Masukkan password",disabled:u,required:!0,autoComplete:"current-password",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"})]}),m&&o.jsx("div",{className:"error-message",children:m}),o.jsx("button",{type:"submit",className:"login-button",disabled:u||!n.trim()||!s.trim(),children:u?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"button-spinner"}),"Logging in..."]}):"Login"})]}),o.jsxs("div",{className:"login-info",children:[o.jsx(jv,{onSyncComplete:()=>window.location.reload()}),o.jsxs("div",{className:"storage-notice",children:[o.jsx("h4",{children:" Current Device Status"}),o.jsxs("div",{className:"default-credentials",children:[o.jsx("strong",{children:"Available Accounts (This Device):"}),o.jsx("div",{className:"credentials-list",children:Ke.getUserCredentials().map((C,T)=>o.jsxs("div",{className:"credential-item",children:[" ",C.username," / ",C.password]},T))})]}),o.jsxs("div",{className:"sync-info",children:[o.jsx("h5",{children:" Quick Password Update"}),o.jsx("p",{children:"If you changed your password on another device, update it here:"}),o.jsx("div",{className:"sync-options",children:o.jsx("button",{type:"button",className:"sync-btn",onClick:()=>{const C=prompt("Enter the new admin password from your other device:");C&&(Ke.addUserCredential("admin",C),alert("Password updated! You can now login with the new password."),window.location.reload())},children:" Update Admin Password"})})]})]})]})]})})},t2=({children:a,requiredRole:n,fallback:t})=>{const s=z.useContext(No);if(!s)throw new Error("ProtectedRoute must be used within an AuthProvider");const{isAuthenticated:l,isLoading:u,hasPermission:f,currentUser:h}=s;return u?o.jsx("div",{className:"loading-container",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading..."})]})}):l?n&&!f(n)?o.jsx("div",{className:"access-denied",children:o.jsxs("div",{className:"access-denied-content",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:"You don't have permission to access this page."}),o.jsxs("p",{children:["Required role: ",o.jsx("strong",{children:n})]}),o.jsxs("p",{children:["Your role: ",o.jsx("strong",{children:h?.role})]}),o.jsx("div",{className:"access-denied-actions",children:o.jsx("button",{onClick:()=>window.history.back(),className:"back-button",children:"Go Back"})})]})}):o.jsx(o.Fragment,{children:a}):t||o.jsx(e2,{})},Vt=()=>{const a=z.useContext(No);if(a===void 0)throw new Error("useAuth must be used within an AuthProvider");return a};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var oo={};oo.version="0.18.5";var kv=1252,a2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Uv=function(a){a2.indexOf(a)!=-1&&(kv=a)};function n2(){Uv(1252)}var Cl=function(a){Uv(a)};function r2(){Cl(1200),n2()}var eo=function(n){return String.fromCharCode(n)},F1=function(n){return String.fromCharCode(n)},uo,Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tl(a){for(var n="",t=0,s=0,l=0,u=0,f=0,h=0,g=0,m=0;m<a.length;)t=a.charCodeAt(m++),u=t>>2,s=a.charCodeAt(m++),f=(t&3)<<4|s>>4,l=a.charCodeAt(m++),h=(s&15)<<2|l>>6,g=l&63,isNaN(s)?h=g=64:isNaN(l)&&(g=64),n+=Er.charAt(u)+Er.charAt(f)+Er.charAt(h)+Er.charAt(g);return n}function Vn(a){var n="",t=0,s=0,l=0,u=0,f=0,h=0,g=0;a=a.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<a.length;)u=Er.indexOf(a.charAt(m++)),f=Er.indexOf(a.charAt(m++)),t=u<<2|f>>4,n+=String.fromCharCode(t),h=Er.indexOf(a.charAt(m++)),s=(f&15)<<4|h>>2,h!==64&&(n+=String.fromCharCode(s)),g=Er.indexOf(a.charAt(m++)),l=(h&3)<<6|g,g!==64&&(n+=String.fromCharCode(l));return n}var nt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Xn=(function(){if(typeof Buffer<"u"){var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch{a=!0}return a?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Zr(a){return nt?Buffer.alloc?Buffer.alloc(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}function L1(a){return nt?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}var un=function(n){return nt?Xn(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function Ao(a){if(typeof ArrayBuffer>"u")return un(a);for(var n=new ArrayBuffer(a.length),t=new Uint8Array(n),s=0;s!=a.length;++s)t[s]=a.charCodeAt(s)&255;return n}function Al(a){if(Array.isArray(a))return a.map(function(s){return String.fromCharCode(s)}).join("");for(var n=[],t=0;t<a.length;++t)n[t]=String.fromCharCode(a[t]);return n.join("")}function s2(a){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(a)}var Zt=nt?function(a){return Buffer.concat(a.map(function(n){return Buffer.isBuffer(n)?n:Xn(n)}))}:function(a){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<a.length;++n)t+=a[n].length;var s=new Uint8Array(t),l=0;for(n=0,t=0;n<a.length;t+=l,++n)if(l=a[n].length,a[n]instanceof Uint8Array)s.set(a[n],t);else{if(typeof a[n]=="string")throw"wtf";s.set(new Uint8Array(a[n]),t)}return s}return[].concat.apply([],a.map(function(u){return Array.isArray(u)?u:[].slice.call(u)}))};function i2(a){for(var n=[],t=0,s=a.length+250,l=Zr(a.length+255),u=0;u<a.length;++u){var f=a.charCodeAt(u);if(f<128)l[t++]=f;else if(f<2048)l[t++]=192|f>>6&31,l[t++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var h=a.charCodeAt(++u)&1023;l[t++]=240|f>>8&7,l[t++]=128|f>>2&63,l[t++]=128|h>>6&15|(f&3)<<4,l[t++]=128|h&63}else l[t++]=224|f>>12&15,l[t++]=128|f>>6&63,l[t++]=128|f&63;t>s&&(n.push(l.slice(0,t)),t=0,l=Zr(65535),s=65530)}return n.push(l.slice(0,t)),Zt(n)}var vl=/\u0000/g,to=/[\u0001-\u0006]/g;function ai(a){for(var n="",t=a.length-1;t>=0;)n+=a.charAt(t--);return n}function fn(a,n){var t=""+a;return t.length>=n?t:bt("0",n-t.length)+t}function xf(a,n){var t=""+a;return t.length>=n?t:bt(" ",n-t.length)+t}function fo(a,n){var t=""+a;return t.length>=n?t:t+bt(" ",n-t.length)}function l2(a,n){var t=""+Math.round(a);return t.length>=n?t:bt("0",n-t.length)+t}function c2(a,n){var t=""+a;return t.length>=n?t:bt("0",n-t.length)+t}var B1=Math.pow(2,32);function Xs(a,n){if(a>B1||a<-B1)return l2(a,n);var t=Math.round(a);return c2(t,n)}function ho(a,n){return n=n||0,a.length>=7+n&&(a.charCodeAt(n)|32)===103&&(a.charCodeAt(n+1)|32)===101&&(a.charCodeAt(n+2)|32)===110&&(a.charCodeAt(n+3)|32)===101&&(a.charCodeAt(n+4)|32)===114&&(a.charCodeAt(n+5)|32)===97&&(a.charCodeAt(n+6)|32)===108}var K1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],tf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function o2(a){return a||(a={}),a[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"/ "hh""mm""ss" "',a}var Nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},P1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},u2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mo(a,n,t){for(var s=a<0?-1:1,l=a*s,u=0,f=1,h=0,g=1,m=0,p=0,S=Math.floor(l);m<n&&(S=Math.floor(l),h=S*f+u,p=S*m+g,!(l-S<5e-8));)l=1/(l-S),u=f,f=h,g=m,m=p;if(p>n&&(m>n?(p=g,h=u):(p=m,h=f)),!t)return[0,s*h,p];var x=Math.floor(s*h/p);return[x,s*h-x*p,p]}function ao(a,n,t){if(a>2958465||a<0)return null;var s=a|0,l=Math.floor(86400*(a-s)),u=0,f=[],h={D:s,T:l,u:86400*(a-s)-l,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),n&&n.date1904&&(s+=1462),h.u>.9999&&(h.u=0,++l==86400&&(h.T=l=0,++s,++h.D)),s===60)f=t?[1317,10,29]:[1900,2,29],u=3;else if(s===0)f=t?[1317,8,29]:[1900,1,0],u=6;else{s>60&&--s;var g=new Date(1900,0,1);g.setDate(g.getDate()+s-1),f=[g.getFullYear(),g.getMonth()+1,g.getDate()],u=g.getDay(),s<60&&(u=(u+6)%7),t&&(u=p2(g,f))}return h.y=f[0],h.m=f[1],h.d=f[2],h.S=l%60,l=Math.floor(l/60),h.M=l%60,l=Math.floor(l/60),h.H=l,h.q=u,h}var Ov=new Date(1899,11,31,0,0,0),f2=Ov.getTime(),d2=new Date(1900,2,1,0,0,0);function Iv(a,n){var t=a.getTime();return n?t-=1461*24*60*60*1e3:a>=d2&&(t+=1440*60*1e3),(t-(f2+(a.getTimezoneOffset()-Ov.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Sf(a){return a.indexOf(".")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function h2(a){return a.indexOf("E")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function m2(a){var n=a<0?12:11,t=Sf(a.toFixed(12));return t.length<=n||(t=a.toPrecision(10),t.length<=n)?t:a.toExponential(5)}function v2(a){var n=Sf(a.toFixed(11));return n.length>(a<0?12:11)||n==="0"||n==="-0"?a.toPrecision(6):n}function g2(a){var n=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),t;return n>=-4&&n<=-1?t=a.toPrecision(10+n):Math.abs(n)<=9?t=m2(a):n===10?t=a.toFixed(10).substr(0,12):t=v2(a),Sf(h2(t.toUpperCase()))}function df(a,n){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(a|0)===a?a.toString(10):g2(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return wr(14,Iv(a,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+a)}function p2(a,n){n[0]-=581;var t=a.getDay();return a<60&&(t=(t+6)%7),t}function x2(a,n,t,s){var l="",u=0,f=0,h=t.y,g,m=0;switch(a){case 98:h=t.y+543;case 121:switch(n.length){case 1:case 2:g=h%100,m=2;break;default:g=h%1e4,m=4;break}break;case 109:switch(n.length){case 1:case 2:g=t.m,m=n.length;break;case 3:return tf[t.m-1][1];case 5:return tf[t.m-1][0];default:return tf[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:g=t.d,m=n.length;break;case 3:return K1[t.q][0];default:return K1[t.q][1]}break;case 104:switch(n.length){case 1:case 2:g=1+(t.H+11)%12,m=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:g=t.H,m=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:g=t.M,m=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?fn(t.S,n.length):(s>=2?f=s===3?1e3:100:f=s===1?10:1,u=Math.round(f*(t.S+t.u)),u>=60*f&&(u=0),n==="s"?u===0?"0":""+u/f:(l=fn(u,2+s),n==="ss"?l.substr(0,2):"."+l.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":g=t.D*24+t.H;break;case"[m]":case"[mm]":g=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":g=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}m=n.length===3?1:2;break;case 101:g=h,m=1;break}var p=m>0?fn(g,m):"";return p}function _r(a){var n=3;if(a.length<=n)return a;for(var t=a.length%n,s=a.substr(0,t);t!=a.length;t+=n)s+=(s.length>0?",":"")+a.substr(t,n);return s}var Rv=/%/g;function S2(a,n,t){var s=n.replace(Rv,""),l=n.length-s.length;return Hn(a,s,t*Math.pow(10,2*l))+bt("%",l)}function y2(a,n,t){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return Hn(a,n.substr(0,s),t/Math.pow(10,3*(n.length-s)))}function Fv(a,n){var t,s=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Fv(a,-n);var l=a.indexOf(".");l===-1&&(l=a.indexOf("E"));var u=Math.floor(Math.log(n)*Math.LOG10E)%l;if(u<0&&(u+=l),t=(n/Math.pow(10,u)).toPrecision(s+1+(l+u)%l),t.indexOf("e")===-1){var f=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+u):t+="E+"+(f-u);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,l)+"."+t.substr(2+l),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,m,p){return g+m+p.substr(0,(l+u)%l)+"."+p.substr(u)+"E"})}else t=n.toExponential(s);return a.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),a.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Lv=/# (\?+)( ?)\/( ?)(\d+)/;function C2(a,n,t){var s=parseInt(a[4],10),l=Math.round(n*s),u=Math.floor(l/s),f=l-u*s,h=s;return t+(u===0?"":""+u)+" "+(f===0?bt(" ",a[1].length+1+a[4].length):xf(f,a[1].length)+a[2]+"/"+a[3]+fn(h,a[4].length))}function T2(a,n,t){return t+(n===0?"":""+n)+bt(" ",a[1].length+2+a[4].length)}var Bv=/^#*0*\.([0#]+)/,Kv=/\).*[0#]/,Pv=/\(###\) ###\\?-####/;function fa(a){for(var n="",t,s=0;s!=a.length;++s)switch(t=a.charCodeAt(s)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function z1(a,n){var t=Math.pow(10,n);return""+Math.round(a*t)/t}function H1(a,n){var t=a-Math.floor(a),s=Math.pow(10,n);return n<(""+Math.round(t*s)).length?0:Math.round(t*s)}function E2(a,n){return n<(""+Math.round((a-Math.floor(a))*Math.pow(10,n))).length?1:0}function _2(a){return a<2147483647&&a>-2147483648?""+(a>=0?a|0:a-1|0):""+Math.floor(a)}function $a(a,n,t){if(a.charCodeAt(0)===40&&!n.match(Kv)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?$a("n",s,t):"("+$a("n",s,-t)+")"}if(n.charCodeAt(n.length-1)===44)return y2(a,n,t);if(n.indexOf("%")!==-1)return S2(a,n,t);if(n.indexOf("E")!==-1)return Fv(n,t);if(n.charCodeAt(0)===36)return"$"+$a(a,n.substr(n.charAt(1)==" "?2:1),t);var l,u,f,h,g=Math.abs(t),m=t<0?"-":"";if(n.match(/^00+$/))return m+Xs(g,n.length);if(n.match(/^[#?]+$/))return l=Xs(t,0),l==="0"&&(l=""),l.length>n.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(Lv))return C2(u,g,m);if(n.match(/^#+0+$/))return m+Xs(g,n.length-n.indexOf("0"));if(u=n.match(Bv))return l=z1(t,u[1].length).replace(/^([^\.]+)$/,"$1."+fa(u[1])).replace(/\.$/,"."+fa(u[1])).replace(/\.(\d*)$/,function(T,y){return"."+y+bt("0",fa(u[1]).length-y.length)}),n.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),u=n.match(/^(0*)\.(#*)$/))return m+z1(g,u[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=n.match(/^#{1,3},##0(\.?)$/))return m+_r(Xs(g,0));if(u=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+$a(a,n,-t):_r(""+(Math.floor(t)+E2(t,u[1].length)))+"."+fn(H1(t,u[1].length),u[1].length);if(u=n.match(/^#,#*,#0/))return $a(a,n.replace(/^#,#*,/,""),t);if(u=n.match(/^([0#]+)(\\?-([0#]+))+$/))return l=ai($a(a,n.replace(/[\\-]/g,""),t)),f=0,ai(ai(n.replace(/\\/g,"")).replace(/[0#]/g,function(T){return f<l.length?l.charAt(f++):T==="0"?"0":""}));if(n.match(Pv))return l=$a(a,"##########",t),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var p="";if(u=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(u[4].length,7),h=mo(g,Math.pow(10,f)-1,!1),l=""+m,p=Hn("n",u[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),l+=p+u[2]+"/"+u[3],p=fo(h[2],f),p.length<u[4].length&&(p=fa(u[4].substr(u[4].length-p.length))+p),l+=p,l;if(u=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(u[1].length,u[4].length),7),h=mo(g,Math.pow(10,f)-1,!0),m+(h[0]||(h[1]?"":"0"))+" "+(h[1]?xf(h[1],f)+u[2]+"/"+u[3]+fo(h[2],f):bt(" ",2*f+1+u[2].length+u[3].length));if(u=n.match(/^[#0?]+$/))return l=Xs(t,0),n.length<=l.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(/^([#0?]+)\.([#0]+)$/)){l=""+t.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),f=l.indexOf(".");var S=n.indexOf(".")-f,x=n.length-l.length-S;return fa(n.substr(0,S)+l+n.substr(n.length-x))}if(u=n.match(/^00,000\.([#0]*0)$/))return f=H1(t,u[1].length),t<0?"-"+$a(a,n,-t):_r(_2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?fn(0,3-T.length):"")+T})+"."+fn(f,u[1].length);switch(n){case"###,##0.00":return $a(a,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var C=_r(Xs(g,0));return C!=="0"?m+C:"";case"###,###.00":return $a(a,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return $a(a,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function w2(a,n,t){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return Hn(a,n.substr(0,s),t/Math.pow(10,3*(n.length-s)))}function b2(a,n,t){var s=n.replace(Rv,""),l=n.length-s.length;return Hn(a,s,t*Math.pow(10,2*l))+bt("%",l)}function zv(a,n){var t,s=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+zv(a,-n);var l=a.indexOf(".");l===-1&&(l=a.indexOf("E"));var u=Math.floor(Math.log(n)*Math.LOG10E)%l;if(u<0&&(u+=l),t=(n/Math.pow(10,u)).toPrecision(s+1+(l+u)%l),!t.match(/[Ee]/)){var f=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+u):t+="E+"+(f-u),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,m,p){return g+m+p.substr(0,(l+u)%l)+"."+p.substr(u)+"E"})}else t=n.toExponential(s);return a.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),a.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sn(a,n,t){if(a.charCodeAt(0)===40&&!n.match(Kv)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sn("n",s,t):"("+Sn("n",s,-t)+")"}if(n.charCodeAt(n.length-1)===44)return w2(a,n,t);if(n.indexOf("%")!==-1)return b2(a,n,t);if(n.indexOf("E")!==-1)return zv(n,t);if(n.charCodeAt(0)===36)return"$"+Sn(a,n.substr(n.charAt(1)==" "?2:1),t);var l,u,f,h,g=Math.abs(t),m=t<0?"-":"";if(n.match(/^00+$/))return m+fn(g,n.length);if(n.match(/^[#?]+$/))return l=""+t,t===0&&(l=""),l.length>n.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(Lv))return T2(u,g,m);if(n.match(/^#+0+$/))return m+fn(g,n.length-n.indexOf("0"));if(u=n.match(Bv))return l=(""+t).replace(/^([^\.]+)$/,"$1."+fa(u[1])).replace(/\.$/,"."+fa(u[1])),l=l.replace(/\.(\d*)$/,function(T,y){return"."+y+bt("0",fa(u[1]).length-y.length)}),n.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),u=n.match(/^(0*)\.(#*)$/))return m+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=n.match(/^#{1,3},##0(\.?)$/))return m+_r(""+g);if(u=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sn(a,n,-t):_r(""+t)+"."+bt("0",u[1].length);if(u=n.match(/^#,#*,#0/))return Sn(a,n.replace(/^#,#*,/,""),t);if(u=n.match(/^([0#]+)(\\?-([0#]+))+$/))return l=ai(Sn(a,n.replace(/[\\-]/g,""),t)),f=0,ai(ai(n.replace(/\\/g,"")).replace(/[0#]/g,function(T){return f<l.length?l.charAt(f++):T==="0"?"0":""}));if(n.match(Pv))return l=Sn(a,"##########",t),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var p="";if(u=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(u[4].length,7),h=mo(g,Math.pow(10,f)-1,!1),l=""+m,p=Hn("n",u[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),l+=p+u[2]+"/"+u[3],p=fo(h[2],f),p.length<u[4].length&&(p=fa(u[4].substr(u[4].length-p.length))+p),l+=p,l;if(u=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(u[1].length,u[4].length),7),h=mo(g,Math.pow(10,f)-1,!0),m+(h[0]||(h[1]?"":"0"))+" "+(h[1]?xf(h[1],f)+u[2]+"/"+u[3]+fo(h[2],f):bt(" ",2*f+1+u[2].length+u[3].length));if(u=n.match(/^[#0?]+$/))return l=""+t,n.length<=l.length?l:fa(n.substr(0,n.length-l.length))+l;if(u=n.match(/^([#0]+)\.([#0]+)$/)){l=""+t.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),f=l.indexOf(".");var S=n.indexOf(".")-f,x=n.length-l.length-S;return fa(n.substr(0,S)+l+n.substr(n.length-x))}if(u=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sn(a,n,-t):_r(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?fn(0,3-T.length):"")+T})+"."+fn(0,u[1].length);switch(n){case"###,###":case"##,###":case"#,###":var C=_r(""+g);return C!=="0"?m+C:"";default:if(n.match(/\.[0#?]*$/))return Sn(a,n.slice(0,n.lastIndexOf(".")),t)+fa(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Hn(a,n,t){return(t|0)===t?Sn(a,n,t):$a(a,n,t)}function N2(a){for(var n=[],t=!1,s=0,l=0;s<a.length;++s)switch(a.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:n[n.length]=a.substr(l,s-l),l=s+1}if(n[n.length]=a.substr(l),t===!0)throw new Error("Format |"+a+"| unterminated string ");return n}var Hv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Gv(a){for(var n=0,t="",s="";n<a.length;)switch(t=a.charAt(n)){case"G":ho(a,n)&&(n+=6),n++;break;case'"':for(;a.charCodeAt(++n)!==34&&n<a.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(a.charAt(n+1)==="1"||a.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(a.substr(n,3).toUpperCase()==="A/P"||a.substr(n,5).toUpperCase()==="AM/PM"||a.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(s=t;a.charAt(n++)!=="]"&&n<a.length;)s+=a.charAt(n);if(s.match(Hv))return!0;break;case".":case"0":case"#":for(;n<a.length&&("0#?.,E+-%".indexOf(t=a.charAt(++n))>-1||t=="\\"&&a.charAt(n+1)=="-"&&"0#".indexOf(a.charAt(n+2))>-1););break;case"?":for(;a.charAt(++n)===t;);break;case"*":++n,(a.charAt(n)==" "||a.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<a.length&&"0123456789".indexOf(a.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function A2(a,n,t,s){for(var l=[],u="",f=0,h="",g="t",m,p,S,x="H";f<a.length;)switch(h=a.charAt(f)){case"G":if(!ho(a,f))throw new Error("unrecognized character "+h+" in "+a);l[l.length]={t:"G",v:"General"},f+=7;break;case'"':for(u="";(S=a.charCodeAt(++f))!==34&&f<a.length;)u+=String.fromCharCode(S);l[l.length]={t:"t",v:u},++f;break;case"\\":var C=a.charAt(++f),T=C==="("||C===")"?C:"t";l[l.length]={t:T,v:C},++f;break;case"_":l[l.length]={t:"t",v:" "},f+=2;break;case"@":l[l.length]={t:"T",v:n},++f;break;case"B":case"b":if(a.charAt(f+1)==="1"||a.charAt(f+1)==="2"){if(m==null&&(m=ao(n,t,a.charAt(f+1)==="2"),m==null))return"";l[l.length]={t:"X",v:a.substr(f,2)},g=h,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||m==null&&(m=ao(n,t),m==null))return"";for(u=h;++f<a.length&&a.charAt(f).toLowerCase()===h;)u+=h;h==="m"&&g.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=x),l[l.length]={t:h,v:u},g=h;break;case"A":case"a":case"":var y={t:h,v:h};if(m==null&&(m=ao(n,t)),a.substr(f,3).toUpperCase()==="A/P"?(m!=null&&(y.v=m.H>=12?"P":"A"),y.t="T",x="h",f+=3):a.substr(f,5).toUpperCase()==="AM/PM"?(m!=null&&(y.v=m.H>=12?"PM":"AM"),y.t="T",f+=5,x="h"):a.substr(f,5).toUpperCase()==="/"?(m!=null&&(y.v=m.H>=12?"":""),y.t="T",f+=5,x="h"):(y.t="t",++f),m==null&&y.t==="T")return"";l[l.length]=y,g=h;break;case"[":for(u=h;a.charAt(f++)!=="]"&&f<a.length;)u+=a.charAt(f);if(u.slice(-1)!=="]")throw'unterminated "[" block: |'+u+"|";if(u.match(Hv)){if(m==null&&(m=ao(n,t),m==null))return"";l[l.length]={t:"Z",v:u.toLowerCase()},g=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",Gv(a)||(l[l.length]={t:"t",v:u}));break;case".":if(m!=null){for(u=h;++f<a.length&&(h=a.charAt(f))==="0";)u+=h;l[l.length]={t:"s",v:u};break}case"0":case"#":for(u=h;++f<a.length&&"0#?.,E+-%".indexOf(h=a.charAt(f))>-1;)u+=h;l[l.length]={t:"n",v:u};break;case"?":for(u=h;a.charAt(++f)===h;)u+=h;l[l.length]={t:h,v:u},g=h;break;case"*":++f,(a.charAt(f)==" "||a.charAt(f)=="*")&&++f;break;case"(":case")":l[l.length]={t:s===1?"t":h,v:h},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=h;f<a.length&&"0123456789".indexOf(a.charAt(++f))>-1;)u+=a.charAt(f);l[l.length]={t:"D",v:u};break;case" ":l[l.length]={t:h,v:h},++f;break;case"$":l[l.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+a);l[l.length]={t:"t",v:h},++f;break}var _=0,w=0,k;for(f=l.length-1,g="t";f>=0;--f)switch(l[f].t){case"h":case"H":l[f].t=x,g="h",_<1&&(_=1);break;case"s":(k=l[f].v.match(/\.0+$/))&&(w=Math.max(w,k[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":g=l[f].t;break;case"m":g==="s"&&(l[f].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&l[f].v.match(/[Hh]/)&&(_=1),_<2&&l[f].v.match(/[Mm]/)&&(_=2),_<3&&l[f].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var D="",b;for(f=0;f<l.length;++f)switch(l[f].t){case"t":case"T":case" ":case"D":break;case"X":l[f].v="",l[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[f].v=x2(l[f].t.charCodeAt(0),l[f].v,m,w),l[f].t="t";break;case"n":case"?":for(b=f+1;l[b]!=null&&((h=l[b].t)==="?"||h==="D"||(h===" "||h==="t")&&l[b+1]!=null&&(l[b+1].t==="?"||l[b+1].t==="t"&&l[b+1].v==="/")||l[f].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(l[b].v==="/"||l[b].v===" "&&l[b+1]!=null&&l[b+1].t=="?"));)l[f].v+=l[b].v,l[b]={v:"",t:";"},++b;D+=l[f].v,f=b-1;break;case"G":l[f].t="t",l[f].v=df(n,t);break}var K="",q,B;if(D.length>0){D.charCodeAt(0)==40?(q=n<0&&D.charCodeAt(0)===45?-n:n,B=Hn("n",D,q)):(q=n<0&&s>1?-n:n,B=Hn("n",D,q),q<0&&l[0]&&l[0].t=="t"&&(B=B.substr(1),l[0].v="-"+l[0].v)),b=B.length-1;var Z=l.length;for(f=0;f<l.length;++f)if(l[f]!=null&&l[f].t!="t"&&l[f].v.indexOf(".")>-1){Z=f;break}var L=l.length;if(Z===l.length&&B.indexOf("E")===-1){for(f=l.length-1;f>=0;--f)l[f]==null||"n?".indexOf(l[f].t)===-1||(b>=l[f].v.length-1?(b-=l[f].v.length,l[f].v=B.substr(b+1,l[f].v.length)):b<0?l[f].v="":(l[f].v=B.substr(0,b+1),b=-1),l[f].t="t",L=f);b>=0&&L<l.length&&(l[L].v=B.substr(0,b+1)+l[L].v)}else if(Z!==l.length&&B.indexOf("E")===-1){for(b=B.indexOf(".")-1,f=Z;f>=0;--f)if(!(l[f]==null||"n?".indexOf(l[f].t)===-1)){for(p=l[f].v.indexOf(".")>-1&&f===Z?l[f].v.indexOf(".")-1:l[f].v.length-1,K=l[f].v.substr(p+1);p>=0;--p)b>=0&&(l[f].v.charAt(p)==="0"||l[f].v.charAt(p)==="#")&&(K=B.charAt(b--)+K);l[f].v=K,l[f].t="t",L=f}for(b>=0&&L<l.length&&(l[L].v=B.substr(0,b+1)+l[L].v),b=B.indexOf(".")+1,f=Z;f<l.length;++f)if(!(l[f]==null||"n?(".indexOf(l[f].t)===-1&&f!==Z)){for(p=l[f].v.indexOf(".")>-1&&f===Z?l[f].v.indexOf(".")+1:0,K=l[f].v.substr(0,p);p<l[f].v.length;++p)b<B.length&&(K+=B.charAt(b++));l[f].v=K,l[f].t="t",L=f}}}for(f=0;f<l.length;++f)l[f]!=null&&"n?".indexOf(l[f].t)>-1&&(q=s>1&&n<0&&f>0&&l[f-1].v==="-"?-n:n,l[f].v=Hn(l[f].t,l[f].v,q),l[f].t="t");var X="";for(f=0;f!==l.length;++f)l[f]!=null&&(X+=l[f].v);return X}var G1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function W1(a,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(a==t)return!0;break;case">":if(a>t)return!0;break;case"<":if(a<t)return!0;break;case"<>":if(a!=t)return!0;break;case">=":if(a>=t)return!0;break;case"<=":if(a<=t)return!0;break}return!1}function D2(a,n){var t=N2(a),s=t.length,l=t[s-1].indexOf("@");if(s<4&&l>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||l>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=l>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=l>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=l>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var u=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[s,u];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var f=t[0].match(G1),h=t[1].match(G1);return W1(n,f)?[s,t[0]]:W1(n,h)?[s,t[1]]:[s,t[f!=null&&h!=null?2:1]]}return[s,u]}function wr(a,n,t){t==null&&(t={});var s="";switch(typeof a){case"string":a=="m/d/yy"&&t.dateNF?s=t.dateNF:s=a;break;case"number":a==14&&t.dateNF?s=t.dateNF:s=(t.table!=null?t.table:Nt)[a],s==null&&(s=t.table&&t.table[P1[a]]||Nt[P1[a]]),s==null&&(s=u2[a]||"General");break}if(ho(s,0))return df(n,t);n instanceof Date&&(n=Iv(n,t.date1904));var l=D2(s,n);if(ho(l[1]))return df(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return A2(l[1],n,t,l[0])}function Wv(a,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(Nt[t]==null){n<0&&(n=t);continue}if(Nt[t]==a){n=t;break}}n<0&&(n=391)}return Nt[n]=a,n}function Do(a){for(var n=0;n!=392;++n)a[n]!==void 0&&Wv(a[n],n)}function Mo(){Nt=o2()}var Vv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function M2(a){var n=typeof a=="number"?Nt[a]:a;return n=n.replace(Vv,"(\\d+)"),new RegExp("^"+n+"$")}function j2(a,n,t){var s=-1,l=-1,u=-1,f=-1,h=-1,g=-1;(n.match(Vv)||[]).forEach(function(S,x){var C=parseInt(t[x+1],10);switch(S.toLowerCase().charAt(0)){case"y":s=C;break;case"d":u=C;break;case"h":f=C;break;case"s":g=C;break;case"m":f>=0?h=C:l=C;break}}),g>=0&&h==-1&&l>=0&&(h=l,l=-1);var m=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(l>=1?l:1)).slice(-2)+"-"+("00"+(u>=1?u:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return f==-1&&h==-1&&g==-1?m:s==-1&&l==-1&&u==-1?p:m+"T"+p}var k2=(function(){var a={};a.version="1.2.0";function n(){for(var B=0,Z=new Array(256),L=0;L!=256;++L)B=L,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,Z[L]=B;return typeof Int32Array<"u"?new Int32Array(Z):Z}var t=n();function s(B){var Z=0,L=0,X=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)M[X]=B[X];for(X=0;X!=256;++X)for(L=B[X],Z=256+X;Z<4096;Z+=256)L=M[Z]=L>>>8^B[L&255];var H=[];for(X=1;X!=16;++X)H[X-1]=typeof Int32Array<"u"?M.subarray(X*256,X*256+256):M.slice(X*256,X*256+256);return H}var l=s(t),u=l[0],f=l[1],h=l[2],g=l[3],m=l[4],p=l[5],S=l[6],x=l[7],C=l[8],T=l[9],y=l[10],_=l[11],w=l[12],k=l[13],D=l[14];function b(B,Z){for(var L=Z^-1,X=0,M=B.length;X<M;)L=L>>>8^t[(L^B.charCodeAt(X++))&255];return~L}function K(B,Z){for(var L=Z^-1,X=B.length-15,M=0;M<X;)L=D[B[M++]^L&255]^k[B[M++]^L>>8&255]^w[B[M++]^L>>16&255]^_[B[M++]^L>>>24]^y[B[M++]]^T[B[M++]]^C[B[M++]]^x[B[M++]]^S[B[M++]]^p[B[M++]]^m[B[M++]]^g[B[M++]]^h[B[M++]]^f[B[M++]]^u[B[M++]]^t[B[M++]];for(X+=15;M<X;)L=L>>>8^t[(L^B[M++])&255];return~L}function q(B,Z){for(var L=Z^-1,X=0,M=B.length,H=0,ue=0;X<M;)H=B.charCodeAt(X++),H<128?L=L>>>8^t[(L^H)&255]:H<2048?(L=L>>>8^t[(L^(192|H>>6&31))&255],L=L>>>8^t[(L^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,ue=B.charCodeAt(X++)&1023,L=L>>>8^t[(L^(240|H>>8&7))&255],L=L>>>8^t[(L^(128|H>>2&63))&255],L=L>>>8^t[(L^(128|ue>>6&15|(H&3)<<4))&255],L=L>>>8^t[(L^(128|ue&63))&255]):(L=L>>>8^t[(L^(224|H>>12&15))&255],L=L>>>8^t[(L^(128|H>>6&63))&255],L=L>>>8^t[(L^(128|H&63))&255]);return~L}return a.table=t,a.bstr=b,a.buf=K,a.str=q,a})(),ht=(function(){var n={};n.version="1.2.1";function t(N,R){for(var U=N.split("/"),O=R.split("/"),I=0,F=0,ne=Math.min(U.length,O.length);I<ne;++I){if(F=U[I].length-O[I].length)return F;if(U[I]!=O[I])return U[I]<O[I]?-1:1}return U.length-O.length}function s(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:s(N.slice(0,-1));var R=N.lastIndexOf("/");return R===-1?N:N.slice(0,R+1)}function l(N){if(N.charAt(N.length-1)=="/")return l(N.slice(0,-1));var R=N.lastIndexOf("/");return R===-1?N:N.slice(R+1)}function u(N,R){typeof R=="string"&&(R=new Date(R));var U=R.getHours();U=U<<6|R.getMinutes(),U=U<<5|R.getSeconds()>>>1,N.write_shift(2,U);var O=R.getFullYear()-1980;O=O<<4|R.getMonth()+1,O=O<<5|R.getDate(),N.write_shift(2,O)}function f(N){var R=N.read_shift(2)&65535,U=N.read_shift(2)&65535,O=new Date,I=U&31;U>>>=5;var F=U&15;U>>>=4,O.setMilliseconds(0),O.setFullYear(U+1980),O.setMonth(F-1),O.setDate(I);var ne=R&31;R>>>=5;var he=R&63;return R>>>=6,O.setHours(R),O.setMinutes(he),O.setSeconds(ne<<1),O}function h(N){Oa(N,0);for(var R={},U=0;N.l<=N.length-4;){var O=N.read_shift(2),I=N.read_shift(2),F=N.l+I,ne={};switch(O){case 21589:U=N.read_shift(1),U&1&&(ne.mtime=N.read_shift(4)),I>5&&(U&2&&(ne.atime=N.read_shift(4)),U&4&&(ne.ctime=N.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}N.l=F,R[O]=ne}return R}var g;function m(){return g||(g={})}function p(N,R){if(N[0]==80&&N[1]==75)return Dr(N,R);if((N[0]|32)==109&&(N[1]|32)==105)return jr(N,R);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var U=3,O=512,I=0,F=0,ne=0,he=0,re=0,se=[],le=N.slice(0,512);Oa(le,0);var xe=S(le);switch(U=xe[0],U){case 3:O=512;break;case 4:O=4096;break;case 0:if(xe[1]==0)return Dr(N,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}O!==512&&(le=N.slice(0,O),Oa(le,28));var Te=N.slice(0,O);x(le,U);var Me=le.read_shift(4,"i");if(U===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),he=le.read_shift(4,"i"),I=le.read_shift(4,"i"),re=le.read_shift(4,"i"),F=le.read_shift(4,"i");for(var ye=-1,De=0;De<109&&(ye=le.read_shift(4,"i"),!(ye<0));++De)se[De]=ye;var Ie=C(N,O);_(re,F,Ie,O,se);var gt=k(Ie,ne,se,O);gt[ne].name="!Directory",I>0&&he!==ue&&(gt[he].name="!MiniFAT"),gt[se[0]].name="!FAT",gt.fat_addrs=se,gt.ssz=O;var pt={},Tt=[],Ka=[],kr=[];D(ne,gt,Ie,Tt,I,pt,Ka,he),T(Ka,kr,Tt),Tt.shift();var qn={FileIndex:Ka,FullPaths:kr};return R&&R.raw&&(qn.raw={header:Te,sectors:Ie}),qn}function S(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(be,"Header Signature: "),N.l+=16;var R=N.read_shift(2,"u");return[N.read_shift(2,"u"),R]}function x(N,R){var U=9;switch(N.l+=2,U=N.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function C(N,R){for(var U=Math.ceil(N.length/R)-1,O=[],I=1;I<U;++I)O[I-1]=N.slice(I*R,(I+1)*R);return O[U-1]=N.slice(U*R),O}function T(N,R,U){for(var O=0,I=0,F=0,ne=0,he=0,re=U.length,se=[],le=[];O<re;++O)se[O]=le[O]=O,R[O]=U[O];for(;he<le.length;++he)O=le[he],I=N[O].L,F=N[O].R,ne=N[O].C,se[O]===O&&(I!==-1&&se[I]!==I&&(se[O]=se[I]),F!==-1&&se[F]!==F&&(se[O]=se[F])),ne!==-1&&(se[ne]=O),I!==-1&&O!=se[O]&&(se[I]=se[O],le.lastIndexOf(I)<he&&le.push(I)),F!==-1&&O!=se[O]&&(se[F]=se[O],le.lastIndexOf(F)<he&&le.push(F));for(O=1;O<re;++O)se[O]===O&&(F!==-1&&se[F]!==F?se[O]=se[F]:I!==-1&&se[I]!==I&&(se[O]=se[I]));for(O=1;O<re;++O)if(N[O].type!==0){if(he=O,he!=se[he])do he=se[he],R[O]=R[he]+"/"+R[O];while(he!==0&&se[he]!==-1&&he!=se[he]);se[O]=-1}for(R[0]+="/",O=1;O<re;++O)N[O].type!==2&&(R[O]+="/")}function y(N,R,U){for(var O=N.start,I=N.size,F=[],ne=O;U&&I>0&&ne>=0;)F.push(R.slice(ne*H,ne*H+H)),I-=H,ne=qr(U,ne*4);return F.length===0?fe(0):Zt(F).slice(0,N.size)}function _(N,R,U,O,I){var F=ue;if(N===ue){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ne=U[N],he=(O>>>2)-1;if(!ne)return;for(var re=0;re<he&&(F=qr(ne,re*4))!==ue;++re)I.push(F);_(qr(ne,O-4),R-1,U,O,I)}}function w(N,R,U,O,I){var F=[],ne=[];I||(I=[]);var he=O-1,re=0,se=0;for(re=R;re>=0;){I[re]=!0,F[F.length]=re,ne.push(N[re]);var le=U[Math.floor(re*4/O)];if(se=re*4&he,O<4+se)throw new Error("FAT boundary crossed: "+re+" 4 "+O);if(!N[le])break;re=qr(N[le],se)}return{nodes:F,data:Z1([ne])}}function k(N,R,U,O){var I=N.length,F=[],ne=[],he=[],re=[],se=O-1,le=0,xe=0,Te=0,Me=0;for(le=0;le<I;++le)if(he=[],Te=le+R,Te>=I&&(Te-=I),!ne[Te]){re=[];var ye=[];for(xe=Te;xe>=0;){ye[xe]=!0,ne[xe]=!0,he[he.length]=xe,re.push(N[xe]);var De=U[Math.floor(xe*4/O)];if(Me=xe*4&se,O<4+Me)throw new Error("FAT boundary crossed: "+xe+" 4 "+O);if(!N[De]||(xe=qr(N[De],Me),ye[xe]))break}F[Te]={nodes:he,data:Z1([re])}}return F}function D(N,R,U,O,I,F,ne,he){for(var re=0,se=O.length?2:0,le=R[N].data,xe=0,Te=0,Me;xe<le.length;xe+=128){var ye=le.slice(xe,xe+128);Oa(ye,64),Te=ye.read_shift(2),Me=_f(ye,0,Te-se),O.push(Me);var De={name:Me,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},Ie=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);Ie!==0&&(De.ct=b(ye,ye.l-8));var gt=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);gt!==0&&(De.mt=b(ye,ye.l-8)),De.start=ye.read_shift(4,"i"),De.size=ye.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=ue,De.name=""),De.type===5?(re=De.start,I>0&&re!==ue&&(R[re].name="!StreamData")):De.size>=4096?(De.storage="fat",R[De.start]===void 0&&(R[De.start]=w(U,De.start,R.fat_addrs,R.ssz)),R[De.start].name=De.name,De.content=R[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:re!==ue&&De.start!==ue&&R[re]&&(De.content=y(De,R[re].data,(R[he]||{}).data))),De.content&&Oa(De.content,0),F[Me]=De,ne.push(De)}}function b(N,R){return new Date((Ra(N,R+4)/1e7*Math.pow(2,32)+Ra(N,R)/1e7-11644473600)*1e3)}function K(N,R){return m(),p(g.readFileSync(N),R)}function q(N,R){var U=R&&R.type;switch(U||nt&&Buffer.isBuffer(N)&&(U="buffer"),U||"base64"){case"file":return K(N,R);case"base64":return p(un(Vn(N)),R);case"binary":return p(un(N),R)}return p(N,R)}function B(N,R){var U=R||{},O=U.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=O+"/",N.FileIndex[0]={name:O,type:5}),U.CLSID&&(N.FileIndex[0].clsid=U.CLSID),Z(N)}function Z(N){var R="Sh33tJ5";if(!ht.find(N,"/"+R)){var U=fe(4);U[0]=55,U[1]=U[3]=50,U[2]=54,N.FileIndex.push({name:R,type:2,content:U,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+R),L(N)}}function L(N,R){B(N);for(var U=!1,O=!1,I=N.FullPaths.length-1;I>=0;--I){var F=N.FileIndex[I];switch(F.type){case 0:O?U=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(F.R*F.L*F.C)&&(U=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!R)){var ne=new Date(1987,1,19),he=0,re=Object.create?Object.create(null):{},se=[];for(I=0;I<N.FullPaths.length;++I)re[N.FullPaths[I]]=!0,N.FileIndex[I].type!==0&&se.push([N.FullPaths[I],N.FileIndex[I]]);for(I=0;I<se.length;++I){var le=s(se[I][0]);O=re[le],O||(se.push([le,{name:l(le).replace("/",""),type:1,clsid:ee,ct:ne,mt:ne,content:null}]),re[le]=!0)}for(se.sort(function(Me,ye){return t(Me[0],ye[0])}),N.FullPaths=[],N.FileIndex=[],I=0;I<se.length;++I)N.FullPaths[I]=se[I][0],N.FileIndex[I]=se[I][1];for(I=0;I<se.length;++I){var xe=N.FileIndex[I],Te=N.FullPaths[I];if(xe.name=l(Te).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||ee,I===0)xe.C=se.length>1?1:-1,xe.size=0,xe.type=5;else if(Te.slice(-1)=="/"){for(he=I+1;he<se.length&&s(N.FullPaths[he])!=Te;++he);for(xe.C=he>=se.length?-1:he,he=I+1;he<se.length&&s(N.FullPaths[he])!=s(Te);++he);xe.R=he>=se.length?-1:he,xe.type=1}else s(N.FullPaths[I+1]||"")==s(Te)&&(xe.R=I+1),xe.type=2}}}function X(N,R){var U=R||{};if(U.fileType=="mad")return Bo(N,U);switch(L(N),U.fileType){case"zip":return fs(N,U)}var O=(function(Me){for(var ye=0,De=0,Ie=0;Ie<Me.FileIndex.length;++Ie){var gt=Me.FileIndex[Ie];if(gt.content){var pt=gt.content.length;pt>0&&(pt<4096?ye+=pt+63>>6:De+=pt+511>>9)}}for(var Tt=Me.FullPaths.length+3>>2,Ka=ye+7>>3,kr=ye+127>>7,qn=Ka+De+Tt+kr,mn=qn+127>>7,Si=mn<=109?0:Math.ceil((mn-109)/127);qn+mn+Si+127>>7>mn;)Si=++mn<=109?0:Math.ceil((mn-109)/127);var ma=[1,Si,mn,kr,Tt,De,ye,0];return Me.FileIndex[0].size=ye<<6,ma[7]=(Me.FileIndex[0].start=ma[0]+ma[1]+ma[2]+ma[3]+ma[4]+ma[5])+(ma[6]+7>>3),ma})(N),I=fe(O[7]<<9),F=0,ne=0;{for(F=0;F<8;++F)I.write_shift(1,Se[F]);for(F=0;F<8;++F)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),F=0;F<3;++F)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,O[2]),I.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:ue),I.write_shift(4,O[3]),I.write_shift(-4,O[1]?O[0]-1:ue),I.write_shift(4,O[1]),F=0;F<109;++F)I.write_shift(-4,F<O[2]?O[1]+F:-1)}if(O[1])for(ne=0;ne<O[1];++ne){for(;F<236+ne*127;++F)I.write_shift(-4,F<O[2]?O[1]+F:-1);I.write_shift(-4,ne===O[1]-1?ue:ne+1)}var he=function(Me){for(ne+=Me;F<ne-1;++F)I.write_shift(-4,F+1);Me&&(++F,I.write_shift(-4,ue))};for(ne=F=0,ne+=O[1];F<ne;++F)I.write_shift(-4,ge.DIFSECT);for(ne+=O[2];F<ne;++F)I.write_shift(-4,ge.FATSECT);he(O[3]),he(O[4]);for(var re=0,se=0,le=N.FileIndex[0];re<N.FileIndex.length;++re)le=N.FileIndex[re],le.content&&(se=le.content.length,!(se<4096)&&(le.start=ne,he(se+511>>9)));for(he(O[6]+7>>3);I.l&511;)I.write_shift(-4,ge.ENDOFCHAIN);for(ne=F=0,re=0;re<N.FileIndex.length;++re)le=N.FileIndex[re],le.content&&(se=le.content.length,!(!se||se>=4096)&&(le.start=ne,he(se+63>>6)));for(;I.l&511;)I.write_shift(-4,ge.ENDOFCHAIN);for(F=0;F<O[4]<<2;++F){var xe=N.FullPaths[F];if(!xe||xe.length===0){for(re=0;re<17;++re)I.write_shift(4,0);for(re=0;re<3;++re)I.write_shift(4,-1);for(re=0;re<12;++re)I.write_shift(4,0);continue}le=N.FileIndex[F],F===0&&(le.start=le.size?le.start-1:ue);var Te=F===0&&U.root||le.name;if(se=2*(Te.length+1),I.write_shift(64,Te,"utf16le"),I.write_shift(2,se),I.write_shift(1,le.type),I.write_shift(1,le.color),I.write_shift(-4,le.L),I.write_shift(-4,le.R),I.write_shift(-4,le.C),le.clsid)I.write_shift(16,le.clsid,"hex");else for(re=0;re<4;++re)I.write_shift(4,0);I.write_shift(4,le.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,le.start),I.write_shift(4,le.size),I.write_shift(4,0)}for(F=1;F<N.FileIndex.length;++F)if(le=N.FileIndex[F],le.size>=4096)if(I.l=le.start+1<<9,nt&&Buffer.isBuffer(le.content))le.content.copy(I,I.l,0,le.size),I.l+=le.size+511&-512;else{for(re=0;re<le.size;++re)I.write_shift(1,le.content[re]);for(;re&511;++re)I.write_shift(1,0)}for(F=1;F<N.FileIndex.length;++F)if(le=N.FileIndex[F],le.size>0&&le.size<4096)if(nt&&Buffer.isBuffer(le.content))le.content.copy(I,I.l,0,le.size),I.l+=le.size+63&-64;else{for(re=0;re<le.size;++re)I.write_shift(1,le.content[re]);for(;re&63;++re)I.write_shift(1,0)}if(nt)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function M(N,R){var U=N.FullPaths.map(function(re){return re.toUpperCase()}),O=U.map(function(re){var se=re.split("/");return se[se.length-(re.slice(-1)=="/"?2:1)]}),I=!1;R.charCodeAt(0)===47?(I=!0,R=U[0].slice(0,-1)+R):I=R.indexOf("/")!==-1;var F=R.toUpperCase(),ne=I===!0?U.indexOf(F):O.indexOf(F);if(ne!==-1)return N.FileIndex[ne];var he=!F.match(to);for(F=F.replace(vl,""),he&&(F=F.replace(to,"!")),ne=0;ne<U.length;++ne)if((he?U[ne].replace(to,"!"):U[ne]).replace(vl,"")==F||(he?O[ne].replace(to,"!"):O[ne]).replace(vl,"")==F)return N.FileIndex[ne];return null}var H=64,ue=-2,be="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ke(N,R,U){m();var O=X(N,U);g.writeFileSync(R,O)}function Ne(N){for(var R=new Array(N.length),U=0;U<N.length;++U)R[U]=String.fromCharCode(N[U]);return R.join("")}function Le(N,R){var U=X(N,R);switch(R&&R.type||"buffer"){case"file":return m(),g.writeFileSync(R.filename,U),U;case"binary":return typeof U=="string"?U:Ne(U);case"base64":return Tl(typeof U=="string"?U:Ne(U));case"buffer":if(nt)return Buffer.isBuffer(U)?U:Xn(U);case"array":return typeof U=="string"?un(U):U}return U}var G;function j(N){try{var R=N.InflateRaw,U=new R;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)G=N;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function V(N,R){if(!G)return Fl(N,R);var U=G.InflateRaw,O=new U,I=O._processChunk(N.slice(N.l),O._finishFlushFlag);return N.l+=O.bytesRead,I}function P(N){return G?G.deflateRawSync(N):vi(N)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function je(N){var R=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(R>>16|R>>8|R)&255}for(var we=typeof Uint8Array<"u",Ae=we?new Uint8Array(256):[],Qe=0;Qe<256;++Qe)Ae[Qe]=je(Qe);function Ve(N,R){var U=Ae[N&255];return R<=8?U>>>8-R:(U=U<<8|Ae[N>>8&255],R<=16?U>>>16-R:(U=U<<8|Ae[N>>16&255],U>>>24-R))}function Kt(N,R){var U=R&7,O=R>>>3;return(N[O]|(U<=6?0:N[O+1]<<8))>>>U&3}function We(N,R){var U=R&7,O=R>>>3;return(N[O]|(U<=5?0:N[O+1]<<8))>>>U&7}function _a(N,R){var U=R&7,O=R>>>3;return(N[O]|(U<=4?0:N[O+1]<<8))>>>U&15}function vt(N,R){var U=R&7,O=R>>>3;return(N[O]|(U<=3?0:N[O+1]<<8))>>>U&31}function Ue(N,R){var U=R&7,O=R>>>3;return(N[O]|(U<=1?0:N[O+1]<<8))>>>U&127}function ca(N,R,U){var O=R&7,I=R>>>3,F=(1<<U)-1,ne=N[I]>>>O;return U<8-O||(ne|=N[I+1]<<8-O,U<16-O)||(ne|=N[I+2]<<16-O,U<24-O)||(ne|=N[I+3]<<24-O),ne&F}function wa(N,R,U){var O=R&7,I=R>>>3;return O<=5?N[I]|=(U&7)<<O:(N[I]|=U<<O&255,N[I+1]=(U&7)>>8-O),R+3}function en(N,R,U){var O=R&7,I=R>>>3;return U=(U&1)<<O,N[I]|=U,R+1}function hn(N,R,U){var O=R&7,I=R>>>3;return U<<=O,N[I]|=U&255,U>>>=8,N[I+1]=U,R+8}function Ol(N,R,U){var O=R&7,I=R>>>3;return U<<=O,N[I]|=U&255,U>>>=8,N[I+1]=U&255,N[I+2]=U>>>8,R+16}function mi(N,R){var U=N.length,O=2*U>R?2*U:R+5,I=0;if(U>=R)return N;if(nt){var F=L1(O);if(N.copy)N.copy(F);else for(;I<N.length;++I)F[I]=N[I];return F}else if(we){var ne=new Uint8Array(O);if(ne.set)ne.set(N);else for(;I<U;++I)ne[I]=N[I];return ne}return N.length=O,N}function Ct(N){for(var R=new Array(N),U=0;U<N;++U)R[U]=0;return R}function ls(N,R,U){var O=1,I=0,F=0,ne=0,he=0,re=N.length,se=we?new Uint16Array(32):Ct(32);for(F=0;F<32;++F)se[F]=0;for(F=re;F<U;++F)N[F]=0;re=N.length;var le=we?new Uint16Array(re):Ct(re);for(F=0;F<re;++F)se[I=N[F]]++,O<I&&(O=I),le[F]=0;for(se[0]=0,F=1;F<=O;++F)se[F+16]=he=he+se[F-1]<<1;for(F=0;F<re;++F)he=N[F],he!=0&&(le[F]=se[he+16]++);var xe=0;for(F=0;F<re;++F)if(xe=N[F],xe!=0)for(he=Ve(le[F],O)>>O-xe,ne=(1<<O+4-xe)-1;ne>=0;--ne)R[he|ne<<xe]=xe&15|F<<4;return O}var cs=we?new Uint16Array(512):Ct(512),os=we?new Uint16Array(32):Ct(32);if(!we){for(var La=0;La<512;++La)cs[La]=0;for(La=0;La<32;++La)os[La]=0}(function(){for(var N=[],R=0;R<32;R++)N.push(5);ls(N,os,32);var U=[];for(R=0;R<=143;R++)U.push(8);for(;R<=255;R++)U.push(9);for(;R<=279;R++)U.push(7);for(;R<=287;R++)U.push(8);ls(U,cs,288)})();var Ro=(function(){for(var R=we?new Uint8Array(32768):[],U=0,O=0;U<Ce.length-1;++U)for(;O<Ce[U+1];++O)R[O]=U;for(;O<32768;++O)R[O]=29;var I=we?new Uint8Array(259):[];for(U=0,O=0;U<ce.length-1;++U)for(;O<ce[U+1];++O)I[O]=U;function F(he,re){for(var se=0;se<he.length;){var le=Math.min(65535,he.length-se),xe=se+le==he.length;for(re.write_shift(1,+xe),re.write_shift(2,le),re.write_shift(2,~le&65535);le-- >0;)re[re.l++]=he[se++]}return re.l}function ne(he,re){for(var se=0,le=0,xe=we?new Uint16Array(32768):[];le<he.length;){var Te=Math.min(65535,he.length-le);if(Te<10){for(se=wa(re,se,+(le+Te==he.length)),se&7&&(se+=8-(se&7)),re.l=se/8|0,re.write_shift(2,Te),re.write_shift(2,~Te&65535);Te-- >0;)re[re.l++]=he[le++];se=re.l*8;continue}se=wa(re,se,+(le+Te==he.length)+2);for(var Me=0;Te-- >0;){var ye=he[le];Me=(Me<<5^ye)&32767;var De=-1,Ie=0;if((De=xe[Me])&&(De|=le&-32768,De>le&&(De-=32768),De<le))for(;he[De+Ie]==he[le+Ie]&&Ie<250;)++Ie;if(Ie>2){ye=I[Ie],ye<=22?se=hn(re,se,Ae[ye+1]>>1)-1:(hn(re,se,3),se+=5,hn(re,se,Ae[ye-23]>>5),se+=3);var gt=ye<8?0:ye-4>>2;gt>0&&(Ol(re,se,Ie-ce[ye]),se+=gt),ye=R[le-De],se=hn(re,se,Ae[ye]>>3),se-=3;var pt=ye<4?0:ye-2>>1;pt>0&&(Ol(re,se,le-De-Ce[ye]),se+=pt);for(var Tt=0;Tt<Ie;++Tt)xe[Me]=le&32767,Me=(Me<<5^he[le])&32767,++le;Te-=Ie-1}else ye<=143?ye=ye+48:se=en(re,se,1),se=hn(re,se,Ae[ye]),xe[Me]=le&32767,++le}se=hn(re,se,0)-1}return re.l=(se+7)/8|0,re.l}return function(re,se){return re.length<8?F(re,se):ne(re,se)}})();function vi(N){var R=fe(50+Math.floor(N.length*1.1)),U=Ro(N,R);return R.slice(0,U)}var Il=we?new Uint16Array(32768):Ct(32768),Rl=we?new Uint16Array(32768):Ct(32768),Jn=we?new Uint16Array(128):Ct(128),na=1,tn=1;function oa(N,R){var U=vt(N,R)+257;R+=5;var O=vt(N,R)+1;R+=5;var I=_a(N,R)+4;R+=4;for(var F=0,ne=we?new Uint8Array(19):Ct(19),he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,se=we?new Uint8Array(8):Ct(8),le=we?new Uint8Array(8):Ct(8),xe=ne.length,Te=0;Te<I;++Te)ne[Y[Te]]=F=We(N,R),re<F&&(re=F),se[F]++,R+=3;var Me=0;for(se[0]=0,Te=1;Te<=re;++Te)le[Te]=Me=Me+se[Te-1]<<1;for(Te=0;Te<xe;++Te)(Me=ne[Te])!=0&&(he[Te]=le[Me]++);var ye=0;for(Te=0;Te<xe;++Te)if(ye=ne[Te],ye!=0){Me=Ae[he[Te]]>>8-ye;for(var De=(1<<7-ye)-1;De>=0;--De)Jn[Me|De<<ye]=ye&7|Te<<3}var Ie=[];for(re=1;Ie.length<U+O;)switch(Me=Jn[Ue(N,R)],R+=Me&7,Me>>>=3){case 16:for(F=3+Kt(N,R),R+=2,Me=Ie[Ie.length-1];F-- >0;)Ie.push(Me);break;case 17:for(F=3+We(N,R),R+=3;F-- >0;)Ie.push(0);break;case 18:for(F=11+Ue(N,R),R+=7;F-- >0;)Ie.push(0);break;default:Ie.push(Me),re<Me&&(re=Me);break}var gt=Ie.slice(0,U),pt=Ie.slice(U);for(Te=U;Te<286;++Te)gt[Te]=0;for(Te=O;Te<30;++Te)pt[Te]=0;return na=ls(gt,Il,286),tn=ls(pt,Rl,30),R}function Fo(N,R){if(N[0]==3&&!(N[1]&3))return[Zr(R),2];for(var U=0,O=0,I=L1(R||1<<18),F=0,ne=I.length>>>0,he=0,re=0;(O&1)==0;){if(O=We(N,U),U+=3,O>>>1)O>>1==1?(he=9,re=5):(U=oa(N,U),he=na,re=tn);else{U&7&&(U+=8-(U&7));var se=N[U>>>3]|N[(U>>>3)+1]<<8;if(U+=32,se>0)for(!R&&ne<F+se&&(I=mi(I,F+se),ne=I.length);se-- >0;)I[F++]=N[U>>>3],U+=8;continue}for(;;){!R&&ne<F+32767&&(I=mi(I,F+32767),ne=I.length);var le=ca(N,U,he),xe=O>>>1==1?cs[le]:Il[le];if(U+=xe&15,xe>>>=4,(xe>>>8&255)===0)I[F++]=xe;else{if(xe==256)break;xe-=257;var Te=xe<8?0:xe-4>>2;Te>5&&(Te=0);var Me=F+ce[xe];Te>0&&(Me+=ca(N,U,Te),U+=Te),le=ca(N,U,re),xe=O>>>1==1?os[le]:Rl[le],U+=xe&15,xe>>>=4;var ye=xe<4?0:xe-2>>1,De=Ce[xe];for(ye>0&&(De+=ca(N,U,ye),U+=ye),!R&&ne<Me&&(I=mi(I,Me+100),ne=I.length);F<Me;)I[F]=I[F-De],++F}}}return R?[I,U+7>>>3]:[I.slice(0,F),U+7>>>3]}function Fl(N,R){var U=N.slice(N.l||0),O=Fo(U,R);return N.l+=O[1],O[0]}function Ll(N,R){if(N)typeof console<"u"&&console.error(R);else throw new Error(R)}function Dr(N,R){var U=N;Oa(U,0);var O=[],I=[],F={FileIndex:O,FullPaths:I};B(F,{root:R.root});for(var ne=U.length-4;(U[ne]!=80||U[ne+1]!=75||U[ne+2]!=5||U[ne+3]!=6)&&ne>=0;)--ne;U.l=ne+4,U.l+=4;var he=U.read_shift(2);U.l+=6;var re=U.read_shift(4);for(U.l=re,ne=0;ne<he;++ne){U.l+=20;var se=U.read_shift(4),le=U.read_shift(4),xe=U.read_shift(2),Te=U.read_shift(2),Me=U.read_shift(2);U.l+=8;var ye=U.read_shift(4),De=h(U.slice(U.l+xe,U.l+xe+Te));U.l+=xe+Te+Me;var Ie=U.l;U.l=ye+4,us(U,se,le,F,De),U.l=Ie}return F}function us(N,R,U,O,I){N.l+=2;var F=N.read_shift(2),ne=N.read_shift(2),he=f(N);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var re=N.read_shift(4),se=N.read_shift(4),le=N.read_shift(4),xe=N.read_shift(2),Te=N.read_shift(2),Me="",ye=0;ye<xe;++ye)Me+=String.fromCharCode(N[N.l++]);if(Te){var De=h(N.slice(N.l,N.l+Te));(De[21589]||{}).mt&&(he=De[21589].mt),((I||{})[21589]||{}).mt&&(he=I[21589].mt)}N.l+=Te;var Ie=N.slice(N.l,N.l+se);switch(ne){case 8:Ie=V(N,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var gt=!1;F&8&&(re=N.read_shift(4),re==134695760&&(re=N.read_shift(4),gt=!0),se=N.read_shift(4),le=N.read_shift(4)),se!=R&&Ll(gt,"Bad compressed size: "+R+" != "+se),le!=U&&Ll(gt,"Bad uncompressed size: "+U+" != "+le),hs(O,Me,Ie,{unsafe:!0,mt:he})}function fs(N,R){var U=R||{},O=[],I=[],F=fe(1),ne=U.compression?8:0,he=0,re=0,se=0,le=0,xe=0,Te=N.FullPaths[0],Me=Te,ye=N.FileIndex[0],De=[],Ie=0;for(re=1;re<N.FullPaths.length;++re)if(Me=N.FullPaths[re].slice(Te.length),ye=N.FileIndex[re],!(!ye.size||!ye.content||Me=="Sh33tJ5")){var gt=le,pt=fe(Me.length);for(se=0;se<Me.length;++se)pt.write_shift(1,Me.charCodeAt(se)&127);pt=pt.slice(0,pt.l),De[xe]=k2.buf(ye.content,0);var Tt=ye.content;ne==8&&(Tt=P(Tt)),F=fe(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,he),F.write_shift(2,ne),ye.mt?u(F,ye.mt):F.write_shift(4,0),F.write_shift(-4,De[xe]),F.write_shift(4,Tt.length),F.write_shift(4,ye.content.length),F.write_shift(2,pt.length),F.write_shift(2,0),le+=F.length,O.push(F),le+=pt.length,O.push(pt),le+=Tt.length,O.push(Tt),F=fe(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,he),F.write_shift(2,ne),F.write_shift(4,0),F.write_shift(-4,De[xe]),F.write_shift(4,Tt.length),F.write_shift(4,ye.content.length),F.write_shift(2,pt.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,gt),Ie+=F.l,I.push(F),Ie+=pt.length,I.push(pt),++xe}return F=fe(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,xe),F.write_shift(2,xe),F.write_shift(4,Ie),F.write_shift(4,le),F.write_shift(2,0),Zt([Zt(O),Zt(I),F])}var Ba={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ds(N,R){if(N.ctype)return N.ctype;var U=N.name||"",O=U.match(/\.([^\.]+)$/);return O&&Ba[O[1]]||R&&(O=(U=R).match(/[\.\\]([^\.\\])+$/),O&&Ba[O[1]])?Ba[O[1]]:"application/octet-stream"}function Mr(N){for(var R=Tl(N),U=[],O=0;O<R.length;O+=76)U.push(R.slice(O,O+76));return U.join(`\r
`)+`\r
`}function Lo(N){var R=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var le=se.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],O=R.split(`\r
`),I=0;I<O.length;++I){var F=O[I];if(F.length==0){U.push("");continue}for(var ne=0;ne<F.length;){var he=76,re=F.slice(ne,ne+he);re.charAt(he-1)=="="?he--:re.charAt(he-2)=="="?he-=2:re.charAt(he-3)=="="&&(he-=3),re=F.slice(ne,ne+he),ne+=he,ne<F.length&&(re+="="),U.push(re)}}return U.join(`\r
`)}function Bl(N){for(var R=[],U=0;U<N.length;++U){for(var O=N[U];U<=N.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+N[++U];R.push(O)}for(var I=0;I<R.length;++I)R[I]=R[I].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return un(R.join(`\r
`))}function gi(N,R,U){for(var O="",I="",F="",ne,he=0;he<10;++he){var re=R[he];if(!re||re.match(/^\s*$/))break;var se=re.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":O=se[2].trim();break;case"content-type":F=se[2].trim();break;case"content-transfer-encoding":I=se[2].trim();break}}switch(++he,I.toLowerCase()){case"base64":ne=un(Vn(R.slice(he).join("")));break;case"quoted-printable":ne=Bl(R.slice(he));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var le=hs(N,O.slice(U.length),ne,{unsafe:!0});F&&(le.ctype=F)}function jr(N,R){if(Ne(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=R&&R.root||"",O=(nt&&Buffer.isBuffer(N)?N.toString("binary"):Ne(N)).split(`\r
`),I=0,F="";for(I=0;I<O.length;++I)if(F=O[I],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),U||(U=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),F.slice(0,U.length)!=U););var ne=(O[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var he="--"+(ne[1]||""),re=[],se=[],le={FileIndex:re,FullPaths:se};B(le);var xe,Te=0;for(I=0;I<O.length;++I){var Me=O[I];Me!==he&&Me!==he+"--"||(Te++&&gi(le,O.slice(xe,I),U),xe=I)}return le}function Bo(N,R){var U=R||{},O=U.boundary||"SheetJS";O="------="+O;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],F=N.FullPaths[0],ne=F,he=N.FileIndex[0],re=1;re<N.FullPaths.length;++re)if(ne=N.FullPaths[re].slice(F.length),he=N.FileIndex[re],!(!he.size||!he.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var se=he.content,le=nt&&Buffer.isBuffer(se)?se.toString("binary"):Ne(se),xe=0,Te=Math.min(1024,le.length),Me=0,ye=0;ye<=Te;++ye)(Me=le.charCodeAt(ye))>=32&&Me<128&&++xe;var De=xe>=Te*4/5;I.push(O),I.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+ne),I.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),I.push("Content-Type: "+ds(he,ne)),I.push(""),I.push(De?Lo(le):Mr(le))}return I.push(O+`--\r
`),I.join(`\r
`)}function Kl(N){var R={};return B(R,N),R}function hs(N,R,U,O){var I=O&&O.unsafe;I||B(N);var F=!I&&ht.find(N,R);if(!F){var ne=N.FullPaths[0];R.slice(0,ne.length)==ne?ne=R:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+R).replace("//","/")),F={name:l(R),type:2},N.FileIndex.push(F),N.FullPaths.push(ne),I||ht.utils.cfb_gc(N)}return F.content=U,F.size=U?U.length:0,O&&(O.CLSID&&(F.clsid=O.CLSID),O.mt&&(F.mt=O.mt),O.ct&&(F.ct=O.ct)),F}function Pl(N,R){B(N);var U=ht.find(N,R);if(U){for(var O=0;O<N.FileIndex.length;++O)if(N.FileIndex[O]==U)return N.FileIndex.splice(O,1),N.FullPaths.splice(O,1),!0}return!1}function pi(N,R,U){B(N);var O=ht.find(N,R);if(O){for(var I=0;I<N.FileIndex.length;++I)if(N.FileIndex[I]==O)return N.FileIndex[I].name=l(U),N.FullPaths[I]=U,!0}return!1}function xi(N){L(N,!0)}return n.find=M,n.read=q,n.parse=p,n.write=Le,n.writeFile=ke,n.utils={cfb_new:Kl,cfb_add:hs,cfb_del:Pl,cfb_mov:pi,cfb_gc:xi,ReadShift:pl,CheckField:ug,prep_blob:Oa,bconcat:Zt,use_zlib:j,_deflateRaw:vi,_inflateRaw:Fl,consts:ge},n})();function U2(a){return typeof a=="string"?Ao(a):Array.isArray(a)?s2(a):a}function Dl(a,n,t){if(typeof Deno<"u"){if(t&&typeof n=="string")switch(t){case"utf8":n=new TextEncoder(t).encode(n);break;case"binary":n=Ao(n);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(a,n)}var s=t=="utf8"?_l(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,a);if(typeof Blob<"u"){var l=new Blob([U2(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(l,a);if(typeof saveAs<"u")return saveAs(l,a);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var u=URL.createObjectURL(l);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),chrome.downloads.download({url:u,filename:a,saveAs:!0});var f=document.createElement("a");if(f.download!=null)return f.download=a,f.href=u,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),u}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(a);return h.open("w"),h.encoding="binary",Array.isArray(n)&&(n=Al(n)),h.write(n),h.close(),n}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+a)}function aa(a){for(var n=Object.keys(a),t=[],s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(a,n[s])&&t.push(n[s]);return t}function V1(a,n){for(var t=[],s=aa(a),l=0;l!==s.length;++l)t[a[s[l]][n]]==null&&(t[a[s[l]][n]]=s[l]);return t}function yf(a){for(var n=[],t=aa(a),s=0;s!==t.length;++s)n[a[t[s]]]=t[s];return n}function jo(a){for(var n=[],t=aa(a),s=0;s!==t.length;++s)n[a[t[s]]]=parseInt(t[s],10);return n}function O2(a){for(var n=[],t=aa(a),s=0;s!==t.length;++s)n[a[t[s]]]==null&&(n[a[t[s]]]=[]),n[a[t[s]]].push(t[s]);return n}var vo=new Date(1899,11,30,0,0,0);function Ta(a,n){var t=a.getTime(),s=vo.getTime()+(a.getTimezoneOffset()-vo.getTimezoneOffset())*6e4;return(t-s)/(1440*60*1e3)}var Yv=new Date,I2=vo.getTime()+(Yv.getTimezoneOffset()-vo.getTimezoneOffset())*6e4,Y1=Yv.getTimezoneOffset();function Xv(a){var n=new Date;return n.setTime(a*24*60*60*1e3+I2),n.getTimezoneOffset()!==Y1&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Y1)*6e4),n}var X1=new Date("2017-02-19T19:06:09.000Z"),Jv=isNaN(X1.getFullYear())?new Date("2/19/17"):X1,R2=Jv.getFullYear()==2017;function ha(a,n){var t=new Date(a);if(R2)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(a instanceof Date)return a;if(Jv.getFullYear()==1917&&!isNaN(t.getFullYear())){var s=t.getFullYear();return a.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var l=a.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+l[0],+l[1]-1,+l[2],+l[3]||0,+l[4]||0,+l[5]||0);return a.indexOf("Z")>-1&&(u=new Date(u.getTime()-u.getTimezoneOffset()*60*1e3)),u}function ko(a,n){if(nt&&Buffer.isBuffer(a))return a.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(u){return t[u]||u})}catch{}for(var s=[],l=0;l!=a.length;++l)s.push(String.fromCharCode(a[l]));return s.join("")}function Ea(a){if(typeof JSON<"u"&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if(typeof a!="object"||a==null)return a;if(a instanceof Date)return new Date(a.getTime());var n={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=Ea(a[t]));return n}function bt(a,n){for(var t="";t.length<n;)t+=a;return t}function Gn(a){var n=Number(a);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(a))return n;var t=1,s=a.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(s))||(s=s.replace(/[(](.*)[)]/,function(l,u){return t=-t,u}),!isNaN(n=Number(s)))?n/t:n}var F2=["january","february","march","april","may","june","july","august","september","october","november","december"];function El(a){var n=new Date(a),t=new Date(NaN),s=n.getYear(),l=n.getMonth(),u=n.getDate();if(isNaN(u))return t;var f=a.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&F2.indexOf(f)==-1)return t}else if(f.match(/[a-z]/))return t;return s<0||s>8099?t:(l>0||u>1)&&s!=101?n:a.match(/[^-0-9:,\/\\]/)?t:n}function Ge(a,n,t){if(a.FullPaths){if(typeof t=="string"){var s;return nt?s=Xn(t):s=i2(t),ht.utils.cfb_add(a,n,s)}ht.utils.cfb_add(a,n,t)}else a.file(n,t)}function Cf(){return ht.utils.cfb_new()}var Rt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,L2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Tf=yf(L2),Ef=/[&<>'"]/g,B2=/[\u0000-\u0008\u000b-\u001f]/g;function ct(a){var n=a+"";return n.replace(Ef,function(t){return Tf[t]}).replace(B2,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function J1(a){return ct(a).replace(/ /g,"_x0020_")}var qv=/[\u0000-\u001f]/g;function K2(a){var n=a+"";return n.replace(Ef,function(t){return Tf[t]}).replace(/\n/g,"<br/>").replace(qv,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function P2(a){var n=a+"";return n.replace(Ef,function(t){return Tf[t]}).replace(qv,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function z2(a){return a.replace(/(\r\n|[\r\n])/g,"&#10;")}function H2(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function af(a){for(var n="",t=0,s=0,l=0,u=0,f=0,h=0;t<a.length;){if(s=a.charCodeAt(t++),s<128){n+=String.fromCharCode(s);continue}if(l=a.charCodeAt(t++),s>191&&s<224){f=(s&31)<<6,f|=l&63,n+=String.fromCharCode(f);continue}if(u=a.charCodeAt(t++),s<240){n+=String.fromCharCode((s&15)<<12|(l&63)<<6|u&63);continue}f=a.charCodeAt(t++),h=((s&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536,n+=String.fromCharCode(55296+(h>>>10&1023)),n+=String.fromCharCode(56320+(h&1023))}return n}function q1(a){var n=Zr(2*a.length),t,s,l=1,u=0,f=0,h;for(s=0;s<a.length;s+=l)l=1,(h=a.charCodeAt(s))<128?t=h:h<224?(t=(h&31)*64+(a.charCodeAt(s+1)&63),l=2):h<240?(t=(h&15)*4096+(a.charCodeAt(s+1)&63)*64+(a.charCodeAt(s+2)&63),l=3):(l=4,t=(h&7)*262144+(a.charCodeAt(s+1)&63)*4096+(a.charCodeAt(s+2)&63)*64+(a.charCodeAt(s+3)&63),t-=65536,f=55296+(t>>>10&1023),t=56320+(t&1023)),f!==0&&(n[u++]=f&255,n[u++]=f>>>8,f=0),n[u++]=t%256,n[u++]=t>>>8;return n.slice(0,u).toString("ucs2")}function $1(a){return Xn(a,"binary").toString("utf8")}var no="foo bar baz",gl=nt&&($1(no)==af(no)&&$1||q1(no)==af(no)&&q1)||af,_l=nt?function(a){return Xn(a,"utf8").toString("binary")}:function(a){for(var n=[],t=0,s=0,l=0;t<a.length;)switch(s=a.charCodeAt(t++),!0){case s<128:n.push(String.fromCharCode(s));break;case s<2048:n.push(String.fromCharCode(192+(s>>6))),n.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,l=a.charCodeAt(t++)-56320+(s<<10),n.push(String.fromCharCode(240+(l>>18&7))),n.push(String.fromCharCode(144+(l>>12&63))),n.push(String.fromCharCode(128+(l>>6&63))),n.push(String.fromCharCode(128+(l&63)));break;default:n.push(String.fromCharCode(224+(s>>12))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)))}return n.join("")},G2=(function(){var a=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),l=0;l<a.length;++l)s=s.replace(a[l][0],a[l][1]);return s}})(),$v=/(^\s|\s$|\n)/;function ea(a,n){return"<"+a+(n.match($v)?' xml:space="preserve"':"")+">"+n+"</"+a+">"}function wl(a){return aa(a).map(function(n){return" "+n+'="'+a[n]+'"'}).join("")}function Ee(a,n,t){return"<"+a+(t!=null?wl(t):"")+(n!=null?(n.match($v)?' xml:space="preserve"':"")+">"+n+"</"+a:"/")+">"}function hf(a,n){try{return a.toISOString().replace(/\.\d*/,"")}catch(t){if(n)throw t}return""}function W2(a,n){switch(typeof a){case"string":var t=Ee("vt:lpwstr",ct(a));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ee((a|0)==a?"vt:i4":"vt:r8",ct(String(a)));case"boolean":return Ee("vt:bool",a?"true":"false")}if(a instanceof Date)return Ee("vt:filetime",hf(a));throw new Error("Unable to serialize "+a)}var zt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ci=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ia={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function V2(a,n){for(var t=1-2*(a[n+7]>>>7),s=((a[n+7]&127)<<4)+(a[n+6]>>>4&15),l=a[n+6]&15,u=5;u>=0;--u)l=l*256+a[n+u];return s==2047?l==0?t*(1/0):NaN:(s==0?s=-1022:(s-=1023,l+=Math.pow(2,52)),t*Math.pow(2,s-52)*l)}function Y2(a,n,t){var s=(n<0||1/n==-1/0?1:0)<<7,l=0,u=0,f=s?-n:n;isFinite(f)?f==0?l=u=0:(l=Math.floor(Math.log(f)/Math.LN2),u=f*Math.pow(2,52-l),l<=-1023&&(!isFinite(u)||u<Math.pow(2,52))?l=-1022:(u-=Math.pow(2,52),l+=1023)):(l=2047,u=isNaN(n)?26985:0);for(var h=0;h<=5;++h,u/=256)a[t+h]=u&255;a[t+6]=(l&15)<<4|u&15,a[t+7]=l>>4|s}var Q1=function(a){for(var n=[],t=10240,s=0;s<a[0].length;++s)if(a[0][s])for(var l=0,u=a[0][s].length;l<u;l+=t)n.push.apply(n,a[0][s].slice(l,l+t));return n},Z1=nt?function(a){return a[0].length>0&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(n){return Buffer.isBuffer(n)?n:Xn(n)})):Q1(a)}:Q1,ev=function(a,n,t){for(var s=[],l=n;l<t;l+=2)s.push(String.fromCharCode(hl(a,l)));return s.join("").replace(vl,"")},_f=nt?function(a,n,t){return Buffer.isBuffer(a)?a.toString("utf16le",n,t).replace(vl,""):ev(a,n,t)}:ev,tv=function(a,n,t){for(var s=[],l=n;l<n+t;++l)s.push(("0"+a[l].toString(16)).slice(-2));return s.join("")},Qv=nt?function(a,n,t){return Buffer.isBuffer(a)?a.toString("hex",n,n+t):tv(a,n,t)}:tv,av=function(a,n,t){for(var s=[],l=n;l<t;l++)s.push(String.fromCharCode(Qs(a,l)));return s.join("")},Ml=nt?function(n,t,s){return Buffer.isBuffer(n)?n.toString("utf8",t,s):av(n,t,s)}:av,Zv=function(a,n){var t=Ra(a,n);return t>0?Ml(a,n+4,n+4+t-1):""},eg=Zv,tg=function(a,n){var t=Ra(a,n);return t>0?Ml(a,n+4,n+4+t-1):""},ag=tg,ng=function(a,n){var t=2*Ra(a,n);return t>0?Ml(a,n+4,n+4+t-1):""},rg=ng,sg=function(n,t){var s=Ra(n,t);return s>0?_f(n,t+4,t+4+s):""},ig=sg,lg=function(a,n){var t=Ra(a,n);return t>0?Ml(a,n+4,n+4+t):""},cg=lg,og=function(a,n){return V2(a,n)},go=og,wf=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};nt&&(eg=function(n,t){if(!Buffer.isBuffer(n))return Zv(n,t);var s=n.readUInt32LE(t);return s>0?n.toString("utf8",t+4,t+4+s-1):""},ag=function(n,t){if(!Buffer.isBuffer(n))return tg(n,t);var s=n.readUInt32LE(t);return s>0?n.toString("utf8",t+4,t+4+s-1):""},rg=function(n,t){if(!Buffer.isBuffer(n))return ng(n,t);var s=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+s-1)},ig=function(n,t){if(!Buffer.isBuffer(n))return sg(n,t);var s=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+s)},cg=function(n,t){if(!Buffer.isBuffer(n))return lg(n,t);var s=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+s)},go=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):og(n,t)},wf=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Qs=function(a,n){return a[n]},hl=function(a,n){return a[n+1]*256+a[n]},X2=function(a,n){var t=a[n+1]*256+a[n];return t<32768?t:(65535-t+1)*-1},Ra=function(a,n){return a[n+3]*(1<<24)+(a[n+2]<<16)+(a[n+1]<<8)+a[n]},qr=function(a,n){return a[n+3]<<24|a[n+2]<<16|a[n+1]<<8|a[n]},J2=function(a,n){return a[n]<<24|a[n+1]<<16|a[n+2]<<8|a[n+3]};function pl(a,n){var t="",s,l,u=[],f,h,g,m;switch(n){case"dbcs":if(m=this.l,nt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*a).toString("utf16le");else for(g=0;g<a;++g)t+=String.fromCharCode(hl(this,m)),m+=2;a*=2;break;case"utf8":t=Ml(this,this.l,this.l+a);break;case"utf16le":a*=2,t=_f(this,this.l,this.l+a);break;case"wstr":return pl.call(this,a,"dbcs");case"lpstr-ansi":t=eg(this,this.l),a=4+Ra(this,this.l);break;case"lpstr-cp":t=ag(this,this.l),a=4+Ra(this,this.l);break;case"lpwstr":t=rg(this,this.l),a=4+2*Ra(this,this.l);break;case"lpp4":a=4+Ra(this,this.l),t=ig(this,this.l),a&2&&(a+=2);break;case"8lpp4":a=4+Ra(this,this.l),t=cg(this,this.l),a&3&&(a+=4-(a&3));break;case"cstr":for(a=0,t="";(f=Qs(this,this.l+a++))!==0;)u.push(eo(f));t=u.join("");break;case"_wstr":for(a=0,t="";(f=hl(this,this.l+a))!==0;)u.push(eo(f)),a+=2;a+=2,t=u.join("");break;case"dbcs-cont":for(t="",m=this.l,g=0;g<a;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return f=Qs(this,m),this.l=m+1,h=pl.call(this,a-g,f?"dbcs-cont":"sbcs-cont"),u.join("")+h;u.push(eo(hl(this,m))),m+=2}t=u.join(""),a*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,g=0;g!=a;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return f=Qs(this,m),this.l=m+1,h=pl.call(this,a-g,f?"dbcs-cont":"sbcs-cont"),u.join("")+h;u.push(eo(Qs(this,m))),m+=1}t=u.join("");break;default:switch(a){case 1:return s=Qs(this,this.l),this.l++,s;case 2:return s=(n==="i"?X2:hl)(this,this.l),this.l+=2,s;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(s=(a>0?qr:J2)(this,this.l),this.l+=4,s):(l=Ra(this,this.l),this.l+=4,l);case 8:case-8:if(n==="f")return a==8?l=go(this,this.l):l=go([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,l;a=8;case 16:t=Qv(this,this.l,a);break}}return this.l+=a,t}var q2=function(a,n,t){a[t]=n&255,a[t+1]=n>>>8&255,a[t+2]=n>>>16&255,a[t+3]=n>>>24&255},$2=function(a,n,t){a[t]=n&255,a[t+1]=n>>8&255,a[t+2]=n>>16&255,a[t+3]=n>>24&255},Q2=function(a,n,t){a[t]=n&255,a[t+1]=n>>>8&255};function Z2(a,n,t){var s=0,l=0;if(t==="dbcs"){for(l=0;l!=n.length;++l)Q2(this,n.charCodeAt(l),this.l+2*l);s=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),l=0;l!=n.length;++l)this[this.l+l]=n.charCodeAt(l)&255;s=n.length}else if(t==="hex"){for(;l<a;++l)this[this.l++]=parseInt(n.slice(2*l,2*l+2),16)||0;return this}else if(t==="utf16le"){var u=Math.min(this.l+a,this.length);for(l=0;l<Math.min(n.length,a);++l){var f=n.charCodeAt(l);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<u;)this[this.l++]=0;return this}else switch(a){case 1:s=1,this[this.l]=n&255;break;case 2:s=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:s=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:s=4,q2(this,n,this.l);break;case 8:if(s=8,t==="f"){Y2(this,n,this.l);break}case 16:break;case-4:s=4,$2(this,n,this.l);break}return this.l+=s,this}function ug(a,n){var t=Qv(this,this.l,a.length>>1);if(t!==a)throw new Error(n+"Expected "+a+" saw "+t);this.l+=a.length>>1}function Oa(a,n){a.l=n,a.read_shift=pl,a.chk=ug,a.write_shift=Z2}function Tn(a,n){a.l+=n}function fe(a){var n=Zr(a);return Oa(n,0),n}function Ca(){var a=[],n=nt?256:2048,t=function(m){var p=fe(m);return Oa(p,0),p},s=t(n),l=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&a.push(s),s=null)},u=function(m){return s&&m<s.length-s.l?s:(l(),s=t(Math.max(m+1,n)))},f=function(){return l(),Zt(a)},h=function(m){l(),s=m,s.l==null&&(s.l=s.length),u(n)};return{next:u,push:h,end:f,_bufs:a}}function pe(a,n,t,s){var l=+n,u;if(!isNaN(l)){s||(s=Vw[l].p||(t||[]).length||0),u=1+(l>=128?1:0)+1,s>=128&&++u,s>=16384&&++u,s>=2097152&&++u;var f=a.next(u);l<=127?f.write_shift(1,l):(f.write_shift(1,(l&127)+128),f.write_shift(1,l>>7));for(var h=0;h!=4;++h)if(s>=128)f.write_shift(1,(s&127)+128),s>>=7;else{f.write_shift(1,s);break}s>0&&wf(t)&&a.push(t)}}function xl(a,n,t){var s=Ea(a);if(n.s?(s.cRel&&(s.c+=n.s.c),s.rRel&&(s.r+=n.s.r)):(s.cRel&&(s.c+=n.c),s.rRel&&(s.r+=n.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function nv(a,n,t){var s=Ea(a);return s.s=xl(s.s,n.s,t),s.e=xl(s.e,n.s,t),s}function Sl(a,n){if(a.cRel&&a.c<0)for(a=Ea(a);a.c<0;)a.c+=n>8?16384:256;if(a.rRel&&a.r<0)for(a=Ea(a);a.r<0;)a.r+=n>8?1048576:n>5?65536:16384;var t=ot(a);return!a.cRel&&a.cRel!=null&&(t=ay(t)),!a.rRel&&a.rRel!=null&&(t=ey(t)),t}function nf(a,n){return a.s.r==0&&!a.s.rRel&&a.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!a.e.rRel?(a.s.cRel?"":"$")+ia(a.s.c)+":"+(a.e.cRel?"":"$")+ia(a.e.c):a.s.c==0&&!a.s.cRel&&a.e.c==(n.biff>=12?16383:255)&&!a.e.cRel?(a.s.rRel?"":"$")+ta(a.s.r)+":"+(a.e.rRel?"":"$")+ta(a.e.r):Sl(a.s,n.biff)+":"+Sl(a.e,n.biff)}function bf(a){return parseInt(ty(a),10)-1}function ta(a){return""+(a+1)}function ey(a){return a.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ty(a){return a.replace(/\$(\d+)$/,"$1")}function Nf(a){for(var n=ny(a),t=0,s=0;s!==n.length;++s)t=26*t+n.charCodeAt(s)-64;return t-1}function ia(a){if(a<0)throw new Error("invalid column "+a);var n="";for(++a;a;a=Math.floor((a-1)/26))n=String.fromCharCode((a-1)%26+65)+n;return n}function ay(a){return a.replace(/^([A-Z])/,"$$$1")}function ny(a){return a.replace(/^\$([A-Z])/,"$1")}function ry(a){return a.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ht(a){for(var n=0,t=0,s=0;s<a.length;++s){var l=a.charCodeAt(s);l>=48&&l<=57?n=10*n+(l-48):l>=65&&l<=90&&(t=26*t+(l-64))}return{c:t-1,r:n-1}}function ot(a){for(var n=a.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(a.r+1)}function Fa(a){var n=a.indexOf(":");return n==-1?{s:Ht(a),e:Ht(a)}:{s:Ht(a.slice(0,n)),e:Ht(a.slice(n+1))}}function It(a,n){return typeof n>"u"||typeof n=="number"?It(a.s,a.e):(typeof a!="string"&&(a=ot(a)),typeof n!="string"&&(n=ot(n)),a==n?a:a+":"+n)}function yt(a){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,l=0,u=a.length;for(t=0;s<u&&!((l=a.charCodeAt(s)-64)<1||l>26);++s)t=26*t+l;for(n.s.c=--t,t=0;s<u&&!((l=a.charCodeAt(s)-48)<0||l>9);++s)t=10*t+l;if(n.s.r=--t,s===u||l!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++s,t=0;s!=u&&!((l=a.charCodeAt(s)-64)<1||l>26);++s)t=26*t+l;for(n.e.c=--t,t=0;s!=u&&!((l=a.charCodeAt(s)-48)<0||l>9);++s)t=10*t+l;return n.e.r=--t,n}function rv(a,n){var t=a.t=="d"&&n instanceof Date;if(a.z!=null)try{return a.w=wr(a.z,t?Ta(n):n)}catch{}try{return a.w=wr((a.XF||{}).numFmtId||(t?14:0),t?Ta(n):n)}catch{return""+n}}function Yn(a,n,t){return a==null||a.t==null||a.t=="z"?"":a.w!==void 0?a.w:(a.t=="d"&&!a.z&&t&&t.dateNF&&(a.z=t.dateNF),a.t=="e"?jl[a.v]||a.v:n==null?rv(a,a.v):rv(a,n))}function as(a,n){var t=n&&n.sheet?n.sheet:"Sheet1",s={};return s[t]=a,{SheetNames:[t],Sheets:s}}function fg(a,n,t){var s=t||{},l=a?Array.isArray(a):s.dense,u=a||(l?[]:{}),f=0,h=0;if(u&&s.origin!=null){if(typeof s.origin=="number")f=s.origin;else{var g=typeof s.origin=="string"?Ht(s.origin):s.origin;f=g.r,h=g.c}u["!ref"]||(u["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(u["!ref"]){var p=yt(u["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),f==-1&&(m.e.r=f=p.e.r+1)}for(var S=0;S!=n.length;++S)if(n[S]){if(!Array.isArray(n[S]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=n[S].length;++x)if(!(typeof n[S][x]>"u")){var C={v:n[S][x]},T=f+S,y=h+x;if(m.s.r>T&&(m.s.r=T),m.s.c>y&&(m.s.c=y),m.e.r<T&&(m.e.r=T),m.e.c<y&&(m.e.c=y),n[S][x]&&typeof n[S][x]=="object"&&!Array.isArray(n[S][x])&&!(n[S][x]instanceof Date))C=n[S][x];else if(Array.isArray(C.v)&&(C.f=n[S][x][1],C.v=C.v[0]),C.v===null)if(C.f)C.t="n";else if(s.nullError)C.t="e",C.v=0;else if(s.sheetStubs)C.t="z";else continue;else typeof C.v=="number"?C.t="n":typeof C.v=="boolean"?C.t="b":C.v instanceof Date?(C.z=s.dateNF||Nt[14],s.cellDates?(C.t="d",C.w=wr(C.z,Ta(C.v))):(C.t="n",C.v=Ta(C.v),C.w=wr(C.z,C.v))):C.t="s";if(l)u[T]||(u[T]=[]),u[T][y]&&u[T][y].z&&(C.z=u[T][y].z),u[T][y]=C;else{var _=ot({c:y,r:T});u[_]&&u[_].z&&(C.z=u[_].z),u[_]=C}}}return m.s.c<1e7&&(u["!ref"]=It(m)),u}function oi(a,n){return fg(null,a,n)}function sy(a){return a.read_shift(4,"i")}function dn(a,n){return n||(n=fe(4)),n.write_shift(4,a),n}function la(a){var n=a.read_shift(4);return n===0?"":a.read_shift(n,"dbcs")}function Gt(a,n){var t=!1;return n==null&&(t=!0,n=fe(4+2*a.length)),n.write_shift(4,a.length),a.length>0&&n.write_shift(0,a,"dbcs"),t?n.slice(0,n.l):n}function iy(a){return{ich:a.read_shift(2),ifnt:a.read_shift(2)}}function ly(a,n){return n||(n=fe(4)),n.write_shift(2,0),n.write_shift(2,0),n}function Af(a,n){var t=a.l,s=a.read_shift(1),l=la(a),u=[],f={t:l,h:l};if((s&1)!==0){for(var h=a.read_shift(4),g=0;g!=h;++g)u.push(iy(a));f.r=u}else f.r=[{ich:0,ifnt:0}];return a.l=t+n,f}function cy(a,n){var t=!1;return n==null&&(t=!0,n=fe(15+4*a.t.length)),n.write_shift(1,0),Gt(a.t,n),t?n.slice(0,n.l):n}var oy=Af;function uy(a,n){var t=!1;return n==null&&(t=!0,n=fe(23+4*a.t.length)),n.write_shift(1,1),Gt(a.t,n),n.write_shift(4,1),ly({},n),t?n.slice(0,n.l):n}function Za(a){var n=a.read_shift(4),t=a.read_shift(2);return t+=a.read_shift(1)<<16,a.l++,{c:n,iStyleRef:t}}function ns(a,n){return n==null&&(n=fe(8)),n.write_shift(-4,a.c),n.write_shift(3,a.iStyleRef||a.s),n.write_shift(1,0),n}function rs(a){var n=a.read_shift(2);return n+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:n}}function ss(a,n){return n==null&&(n=fe(4)),n.write_shift(3,a.iStyleRef||a.s),n.write_shift(1,0),n}var fy=la,dg=Gt;function Df(a){var n=a.read_shift(4);return n===0||n===4294967295?"":a.read_shift(n,"dbcs")}function po(a,n){var t=!1;return n==null&&(t=!0,n=fe(127)),n.write_shift(4,a.length>0?a.length:4294967295),a.length>0&&n.write_shift(0,a,"dbcs"),t?n.slice(0,n.l):n}var dy=la,mf=Df,Mf=po;function hg(a){var n=a.slice(a.l,a.l+4),t=n[0]&1,s=n[0]&2;a.l+=4;var l=s===0?go([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):qr(n,0)>>2;return t?l/100:l}function mg(a,n){n==null&&(n=fe(4));var t=0,s=0,l=a*100;if(a==(a|0)&&a>=-536870912&&a<1<<29?s=1:l==(l|0)&&l>=-536870912&&l<1<<29&&(s=1,t=1),s)n.write_shift(-4,((t?l:a)<<2)+(t+2));else throw new Error("unsupported RkNumber "+a)}function vg(a){var n={s:{},e:{}};return n.s.r=a.read_shift(4),n.e.r=a.read_shift(4),n.s.c=a.read_shift(4),n.e.c=a.read_shift(4),n}function hy(a,n){return n||(n=fe(16)),n.write_shift(4,a.s.r),n.write_shift(4,a.e.r),n.write_shift(4,a.s.c),n.write_shift(4,a.e.c),n}var is=vg,ui=hy;function fi(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function es(a,n){return(n||fe(8)).write_shift(8,a,"f")}function my(a){var n={},t=a.read_shift(1),s=t>>>1,l=a.read_shift(1),u=a.read_shift(2,"i"),f=a.read_shift(1),h=a.read_shift(1),g=a.read_shift(1);switch(a.l++,s){case 0:n.auto=1;break;case 1:n.index=l;var m=Ey[l];m&&(n.rgb=vv(m));break;case 2:n.rgb=vv([f,h,g]);break;case 3:n.theme=l;break}return u!=0&&(n.tint=u>0?u/32767:u/32768),n}function xo(a,n){if(n||(n=fe(8)),!a||a.auto)return n.write_shift(4,0),n.write_shift(4,0),n;a.index!=null?(n.write_shift(1,2),n.write_shift(1,a.index)):a.theme!=null?(n.write_shift(1,6),n.write_shift(1,a.theme)):(n.write_shift(1,5),n.write_shift(1,0));var t=a.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),n.write_shift(2,t),!a.rgb||a.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var s=a.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),n.write_shift(1,parseInt(s.slice(0,2),16)),n.write_shift(1,parseInt(s.slice(2,4),16)),n.write_shift(1,parseInt(s.slice(4,6),16)),n.write_shift(1,255)}return n}function vy(a){var n=a.read_shift(1);a.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function gy(a,n){n||(n=fe(2));var t=(a.italic?2:0)|(a.strike?8:0)|(a.outline?16:0)|(a.shadow?32:0)|(a.condense?64:0)|(a.extend?128:0);return n.write_shift(1,t),n.write_shift(1,0),n}var gg=2,Ua=3,ro=11,So=19,so=64,py=65,xy=71,Sy=4108,yy=4126,Qt=80,sv={1:{n:"CodePage",t:gg},2:{n:"Category",t:Qt},3:{n:"PresentationFormat",t:Qt},4:{n:"ByteCount",t:Ua},5:{n:"LineCount",t:Ua},6:{n:"ParagraphCount",t:Ua},7:{n:"SlideCount",t:Ua},8:{n:"NoteCount",t:Ua},9:{n:"HiddenCount",t:Ua},10:{n:"MultimediaClipCount",t:Ua},11:{n:"ScaleCrop",t:ro},12:{n:"HeadingPairs",t:Sy},13:{n:"TitlesOfParts",t:yy},14:{n:"Manager",t:Qt},15:{n:"Company",t:Qt},16:{n:"LinksUpToDate",t:ro},17:{n:"CharacterCount",t:Ua},19:{n:"SharedDoc",t:ro},22:{n:"HyperlinksChanged",t:ro},23:{n:"AppVersion",t:Ua,p:"version"},24:{n:"DigSig",t:py},26:{n:"ContentType",t:Qt},27:{n:"ContentStatus",t:Qt},28:{n:"Language",t:Qt},29:{n:"Version",t:Qt},255:{},2147483648:{n:"Locale",t:So},2147483651:{n:"Behavior",t:So},1919054434:{}},iv={1:{n:"CodePage",t:gg},2:{n:"Title",t:Qt},3:{n:"Subject",t:Qt},4:{n:"Author",t:Qt},5:{n:"Keywords",t:Qt},6:{n:"Comments",t:Qt},7:{n:"Template",t:Qt},8:{n:"LastAuthor",t:Qt},9:{n:"RevNumber",t:Qt},10:{n:"EditTime",t:so},11:{n:"LastPrinted",t:so},12:{n:"CreatedDate",t:so},13:{n:"ModifiedDate",t:so},14:{n:"PageCount",t:Ua},15:{n:"WordCount",t:Ua},16:{n:"CharCount",t:Ua},17:{n:"Thumbnail",t:xy},18:{n:"Application",t:Qt},19:{n:"DocSecurity",t:Ua},255:{},2147483648:{n:"Locale",t:So},2147483651:{n:"Behavior",t:So},1919054434:{}};function Cy(a){return a.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var Ty=Cy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ey=Ea(Ty),jl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_y={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},io={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function pg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xg(a,n){var t=O2(_y),s=[],l;s[s.length]=Rt,s[s.length]=Ee("Types",null,{xmlns:zt.CT,"xmlns:xsd":zt.xsd,"xmlns:xsi":zt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return Ee("Default",null,{Extension:g[0],ContentType:g[1]})}));var u=function(g){a[g]&&a[g].length>0&&(l=a[g][0],s[s.length]=Ee("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:io[g][n.bookType]||io[g].xlsx}))},f=function(g){(a[g]||[]).forEach(function(m){s[s.length]=Ee("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:io[g][n.bookType]||io[g].xlsx})})},h=function(g){(a[g]||[]).forEach(function(m){s[s.length]=Ee("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[g][0]})})};return u("workbooks"),f("sheets"),f("charts"),h("themes"),["strs","styles"].forEach(u),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),f("metadata"),h("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sg(a){var n=a.lastIndexOf("/");return a.slice(0,n+1)+"_rels/"+a.slice(n+1)+".rels"}function ni(a){var n=[Rt,Ee("Relationships",null,{xmlns:zt.RELS})];return aa(a["!id"]).forEach(function(t){n[n.length]=Ee("Relationship",null,a["!id"][t])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function lt(a,n,t,s,l,u){if(l||(l={}),a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),n<0)for(n=a["!idx"];a["!id"]["rId"+n];++n);if(a["!idx"]=n+1,l.Id="rId"+n,l.Type=s,l.Target=t,[tt.HLINK,tt.XPATH,tt.XMISS].indexOf(l.Type)>-1&&(l.TargetMode="External"),a["!id"][l.Id])throw new Error("Cannot rewrite rId "+n);return a["!id"][l.Id]=l,a[("/"+l.Target).replace("//","/")]=l,n}function wy(a){var n=[Rt];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<a.length;++t)n.push('  <manifest:file-entry manifest:full-path="'+a[t][0]+'" manifest:media-type="'+a[t][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function lv(a,n,t){return['  <rdf:Description rdf:about="'+a+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function by(a,n){return['  <rdf:Description rdf:about="'+a+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function Ny(a){var n=[Rt];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=a.length;++t)n.push(lv(a[t][0],a[t][1])),n.push(by("",a[t][0]));return n.push(lv("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function yg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+oo.version+"</meta:generator></office:meta></office:document-meta>"}var Qr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function rf(a,n,t,s,l){l[a]!=null||n==null||n===""||(l[a]=n,n=ct(n),s[s.length]=t?Ee(a,n,t):ea(a,n))}function Cg(a,n){var t=n||{},s=[Rt,Ee("cp:coreProperties",null,{"xmlns:cp":zt.CORE_PROPS,"xmlns:dc":zt.dc,"xmlns:dcterms":zt.dcterms,"xmlns:dcmitype":zt.dcmitype,"xmlns:xsi":zt.xsi})],l={};if(!a&&!t.Props)return s.join("");a&&(a.CreatedDate!=null&&rf("dcterms:created",typeof a.CreatedDate=="string"?a.CreatedDate:hf(a.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,l),a.ModifiedDate!=null&&rf("dcterms:modified",typeof a.ModifiedDate=="string"?a.ModifiedDate:hf(a.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,l));for(var u=0;u!=Qr.length;++u){var f=Qr[u],h=t.Props&&t.Props[f[1]]!=null?t.Props[f[1]]:a?a[f[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&rf(f[0],h,null,s,l)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var ri=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Tg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Eg(a){var n=[],t=Ee;return a||(a={}),a.Application="SheetJS",n[n.length]=Rt,n[n.length]=Ee("Properties",null,{xmlns:zt.EXT_PROPS,"xmlns:vt":zt.vt}),ri.forEach(function(s){if(a[s[1]]!==void 0){var l;switch(s[2]){case"string":l=ct(String(a[s[1]]));break;case"bool":l=a[s[1]]?"true":"false";break}l!==void 0&&(n[n.length]=t(s[0],l))}}),n[n.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=t("TitlesOfParts",t("vt:vector",a.SheetNames.map(function(s){return"<vt:lpstr>"+ct(s)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}function _g(a){var n=[Rt,Ee("Properties",null,{xmlns:zt.CUST_PROPS,"xmlns:vt":zt.vt})];if(!a)return n.join("");var t=1;return aa(a).forEach(function(l){++t,n[n.length]=Ee("property",W2(a[l]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:ct(l)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var cv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ay(a,n){var t=[];return aa(cv).map(function(s){for(var l=0;l<Qr.length;++l)if(Qr[l][1]==s)return Qr[l];for(l=0;l<ri.length;++l)if(ri[l][1]==s)return ri[l];throw s}).forEach(function(s){if(a[s[1]]!=null){var l=n&&n.Props&&n.Props[s[1]]!=null?n.Props[s[1]]:a[s[1]];switch(s[2]){case"date":l=new Date(l).toISOString().replace(/\.\d*Z/,"Z");break}typeof l=="number"?l=String(l):l===!0||l===!1?l=l?"1":"0":l instanceof Date&&(l=new Date(l).toISOString().replace(/\.\d*Z/,"")),t.push(ea(cv[s[1]]||s[1],l))}}),Ee("DocumentProperties",t.join(""),{xmlns:Ia.o})}function Dy(a,n){var t=["Worksheets","SheetNames"],s="CustomDocumentProperties",l=[];return a&&aa(a).forEach(function(u){if(Object.prototype.hasOwnProperty.call(a,u)){for(var f=0;f<Qr.length;++f)if(u==Qr[f][1])return;for(f=0;f<ri.length;++f)if(u==ri[f][1])return;for(f=0;f<t.length;++f)if(u==t[f])return;var h=a[u],g="string";typeof h=="number"?(g="float",h=String(h)):h===!0||h===!1?(g="boolean",h=h?"1":"0"):h=String(h),l.push(Ee(J1(u),h,{"dt:dt":g}))}}),n&&aa(n).forEach(function(u){if(Object.prototype.hasOwnProperty.call(n,u)&&!(a&&Object.prototype.hasOwnProperty.call(a,u))){var f=n[u],h="string";typeof f=="number"?(h="float",f=String(f)):f===!0||f===!1?(h="boolean",f=f?"1":"0"):f instanceof Date?(h="dateTime.tz",f=f.toISOString()):f=String(f),l.push(Ee(J1(u),f,{"dt:dt":h}))}}),"<"+s+' xmlns="'+Ia.o+'">'+l.join("")+"</"+s+">"}function My(a){var n=typeof a=="string"?new Date(Date.parse(a)):a,t=n.getTime()/1e3+11644473600,s=t%Math.pow(2,32),l=(t-s)/Math.pow(2,32);s*=1e7,l*=1e7;var u=s/Math.pow(2,32)|0;u>0&&(s=s%Math.pow(2,32),l+=u);var f=fe(8);return f.write_shift(4,s),f.write_shift(4,l),f}function ov(a,n){var t=fe(4),s=fe(4);switch(t.write_shift(4,a==80?31:a),a){case 3:s.write_shift(-4,n);break;case 5:s=fe(8),s.write_shift(8,n,"f");break;case 11:s.write_shift(4,n?1:0);break;case 64:s=My(n);break;case 31:case 80:for(s=fe(4+2*(n.length+1)+(n.length%2?0:2)),s.write_shift(4,n.length+1),s.write_shift(0,n,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+n)}return Zt([t,s])}var wg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function jy(a){switch(typeof a){case"boolean":return 11;case"number":return(a|0)==a?3:5;case"string":return 31;case"object":if(a instanceof Date)return 64;break}return-1}function uv(a,n,t){var s=fe(8),l=[],u=[],f=8,h=0,g=fe(8),m=fe(8);if(g.write_shift(4,2),g.write_shift(4,1200),m.write_shift(4,1),u.push(g),l.push(m),f+=8+g.length,!n){m=fe(8),m.write_shift(4,0),l.unshift(m);var p=[fe(4)];for(p[0].write_shift(4,a.length),h=0;h<a.length;++h){var S=a[h][0];for(g=fe(8+2*(S.length+1)+(S.length%2?0:2)),g.write_shift(4,h+2),g.write_shift(4,S.length+1),g.write_shift(0,S,"dbcs");g.l!=g.length;)g.write_shift(1,0);p.push(g)}g=Zt(p),u.unshift(g),f+=8+g.length}for(h=0;h<a.length;++h)if(!(n&&!n[a[h][0]])&&!(wg.indexOf(a[h][0])>-1||Tg.indexOf(a[h][0])>-1)&&a[h][1]!=null){var x=a[h][1],C=0;if(n){C=+n[a[h][0]];var T=t[C];if(T.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}g=ov(T.t,x)}else{var _=jy(x);_==-1&&(_=31,x=String(x)),g=ov(_,x)}u.push(g),m=fe(8),m.write_shift(4,n?C:2+h),l.push(m),f+=8+g.length}var w=8*(u.length+1);for(h=0;h<u.length;++h)l[h].write_shift(4,w),w+=u[h].length;return s.write_shift(4,f),s.write_shift(4,u.length),Zt([s].concat(l).concat(u))}function fv(a,n,t,s,l,u){var f=fe(l?68:48),h=[f];f.write_shift(2,65534),f.write_shift(2,0),f.write_shift(4,842412599),f.write_shift(16,ht.utils.consts.HEADER_CLSID,"hex"),f.write_shift(4,l?2:1),f.write_shift(16,n,"hex"),f.write_shift(4,l?68:48);var g=uv(a,t,s);if(h.push(g),l){var m=uv(l,null,null);f.write_shift(16,u,"hex"),f.write_shift(4,68+g.length),h.push(m)}return Zt(h)}function ky(a,n){n||(n=fe(a));for(var t=0;t<a;++t)n.write_shift(1,0);return n}function Uy(a,n){return a.read_shift(n)===1}function da(a,n){return n||(n=fe(2)),n.write_shift(2,+!!a),n}function bg(a){return a.read_shift(2,"u")}function Qa(a,n){return n||(n=fe(2)),n.write_shift(2,a),n}function Ng(a,n,t){return t||(t=fe(2)),t.write_shift(1,n=="e"?+a:+!!a),t.write_shift(1,n=="e"?1:0),t}function Ag(a,n,t){var s=a.read_shift(t&&t.biff>=12?2:1),l="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var u=a.read_shift(1);u&&(l="dbcs-cont")}else t.biff==12&&(l="wstr");t.biff>=2&&t.biff<=5&&(l="cpstr");var f=s?a.read_shift(s,l):"";return f}function Oy(a){var n=a.t||"",t=fe(3);t.write_shift(2,n.length),t.write_shift(1,1);var s=fe(2*n.length);s.write_shift(2*n.length,n,"utf16le");var l=[t,s];return Zt(l)}function Iy(a,n,t){var s;if(t){if(t.biff>=2&&t.biff<=5)return a.read_shift(n,"cpstr");if(t.biff>=12)return a.read_shift(n,"dbcs-cont")}var l=a.read_shift(1);return l===0?s=a.read_shift(n,"sbcs-cont"):s=a.read_shift(n,"dbcs-cont"),s}function Ry(a,n,t){var s=a.read_shift(t&&t.biff==2?1:2);return s===0?(a.l++,""):Iy(a,s,t)}function Fy(a,n,t){if(t.biff>5)return Ry(a,n,t);var s=a.read_shift(1);return s===0?(a.l++,""):a.read_shift(s,t.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function Dg(a,n,t){return t||(t=fe(3+2*a.length)),t.write_shift(2,a.length),t.write_shift(1,1),t.write_shift(31,a,"utf16le"),t}function dv(a,n){n||(n=fe(6+a.length*2)),n.write_shift(4,1+a.length);for(var t=0;t<a.length;++t)n.write_shift(2,a.charCodeAt(t));return n.write_shift(2,0),n}function Ly(a){var n=fe(512),t=0,s=a.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var l=s.indexOf("#"),u=l>-1?31:23;switch(s.charAt(0)){case"#":u=28;break;case".":u&=-3;break}n.write_shift(4,2),n.write_shift(4,u);var f=[8,6815827,6619237,4849780,83];for(t=0;t<f.length;++t)n.write_shift(4,f[t]);if(u==28)s=s.slice(1),dv(s,n);else if(u&2){for(f="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<f.length;++t)n.write_shift(1,parseInt(f[t],16));var h=l>-1?s.slice(0,l):s;for(n.write_shift(4,2*(h.length+1)),t=0;t<h.length;++t)n.write_shift(2,h.charCodeAt(t));n.write_shift(2,0),u&8&&dv(l>-1?s.slice(l+1):"",n)}else{for(f="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<f.length;++t)n.write_shift(1,parseInt(f[t],16));for(var g=0;s.slice(g*3,g*3+3)=="../"||s.slice(g*3,g*3+3)=="..\\";)++g;for(n.write_shift(2,g),n.write_shift(4,s.length-3*g+1),t=0;t<s.length-3*g;++t)n.write_shift(1,s.charCodeAt(t+3*g)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),t=0;t<6;++t)n.write_shift(4,0)}return n.slice(0,n.l)}function ts(a,n,t,s){return s||(s=fe(6)),s.write_shift(2,a),s.write_shift(2,n),s.write_shift(2,t||0),s}function By(a,n,t){var s=t.biff>8?4:2,l=a.read_shift(s),u=a.read_shift(s,"i"),f=a.read_shift(s,"i");return[l,u,f]}function Ky(a){var n=a.read_shift(2),t=a.read_shift(2),s=a.read_shift(2),l=a.read_shift(2);return{s:{c:s,r:n},e:{c:l,r:t}}}function Mg(a,n){return n||(n=fe(8)),n.write_shift(2,a.s.r),n.write_shift(2,a.e.r),n.write_shift(2,a.s.c),n.write_shift(2,a.e.c),n}function jf(a,n,t){var s=1536,l=16;switch(t.bookType){case"biff8":break;case"biff5":s=1280,l=8;break;case"biff4":s=4,l=6;break;case"biff3":s=3,l=6;break;case"biff2":s=2,l=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var u=fe(l);return u.write_shift(2,s),u.write_shift(2,n),l>4&&u.write_shift(2,29282),l>6&&u.write_shift(2,1997),l>8&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function Py(a,n){var t=!n||n.biff==8,s=fe(t?112:54);for(s.write_shift(n.biff==8?2:1,7),t&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(t?0:536870912));s.l<s.length;)s.write_shift(1,t?0:32);return s}function zy(a,n){var t=!n||n.biff>=8?2:1,s=fe(8+t*a.name.length);s.write_shift(4,a.pos),s.write_shift(1,a.hs||0),s.write_shift(1,a.dt),s.write_shift(1,a.name.length),n.biff>=8&&s.write_shift(1,1),s.write_shift(t*a.name.length,a.name,n.biff<8?"sbcs":"utf16le");var l=s.slice(0,s.l);return l.l=s.l,l}function Hy(a,n){var t=fe(8);t.write_shift(4,a.Count),t.write_shift(4,a.Unique);for(var s=[],l=0;l<a.length;++l)s[l]=Oy(a[l]);var u=Zt([t].concat(s));return u.parts=[t.length].concat(s.map(function(f){return f.length})),u}function Gy(){var a=fe(18);return a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,29280),a.write_shift(2,17600),a.write_shift(2,56),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,1),a.write_shift(2,500),a}function Wy(a){var n=fe(18),t=1718;return a&&a.RTL&&(t|=64),n.write_shift(2,t),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function Vy(a,n){var t=a.name||"Arial",s=n&&n.biff==5,l=s?15+t.length:16+2*t.length,u=fe(l);return u.write_shift(2,a.sz*20),u.write_shift(4,0),u.write_shift(2,400),u.write_shift(4,0),u.write_shift(2,0),u.write_shift(1,t.length),s||u.write_shift(1,1),u.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le"),u}function Yy(a,n,t,s){var l=fe(10);return ts(a,n,s,l),l.write_shift(4,t),l}function Xy(a,n,t,s,l){var u=!l||l.biff==8,f=fe(8+ +u+(1+u)*t.length);return ts(a,n,s,f),f.write_shift(2,t.length),u&&f.write_shift(1,1),f.write_shift((1+u)*t.length,t,u?"utf16le":"sbcs"),f}function Jy(a,n,t,s){var l=t&&t.biff==5;s||(s=fe(l?3+n.length:5+2*n.length)),s.write_shift(2,a),s.write_shift(l?1:2,n.length),l||s.write_shift(1,1),s.write_shift((l?1:2)*n.length,n,l?"sbcs":"utf16le");var u=s.length>s.l?s.slice(0,s.l):s;return u.l==null&&(u.l=u.length),u}function qy(a,n){var t=n.biff==8||!n.biff?4:2,s=fe(2*t+6);return s.write_shift(t,a.s.r),s.write_shift(t,a.e.r+1),s.write_shift(2,a.s.c),s.write_shift(2,a.e.c+1),s.write_shift(2,0),s}function hv(a,n,t,s){var l=t&&t.biff==5;s||(s=fe(l?16:20)),s.write_shift(2,0),a.style?(s.write_shift(2,a.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,a.numFmtId||0),s.write_shift(2,n<<4));var u=0;return a.numFmtId>0&&l&&(u|=1024),s.write_shift(4,u),s.write_shift(4,0),l||s.write_shift(4,0),s.write_shift(2,0),s}function $y(a){var n=fe(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function Qy(a,n,t,s,l,u){var f=fe(8);return ts(a,n,s,f),Ng(t,u,f),f}function Zy(a,n,t,s){var l=fe(14);return ts(a,n,s,l),es(t,l),l}function eC(a,n,t){if(t.biff<8)return tC(a,n,t);for(var s=[],l=a.l+n,u=a.read_shift(t.biff>8?4:2);u--!==0;)s.push(By(a,t.biff>8?12:6,t));if(a.l!=l)throw new Error("Bad ExternSheet: "+a.l+" != "+l);return s}function tC(a,n,t){a[a.l+1]==3&&a[a.l]++;var s=Ag(a,n,t);return s.charCodeAt(0)==3?s.slice(1):s}function aC(a){var n=fe(2+a.length*8);n.write_shift(2,a.length);for(var t=0;t<a.length;++t)Mg(a[t],n);return n}function nC(a){var n=fe(24),t=Ht(a[0]);n.write_shift(2,t.r),n.write_shift(2,t.r),n.write_shift(2,t.c),n.write_shift(2,t.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),l=0;l<16;++l)n.write_shift(1,parseInt(s[l],16));return Zt([n,Ly(a[1])])}function rC(a){var n=a[1].Tooltip,t=fe(10+2*(n.length+1));t.write_shift(2,2048);var s=Ht(a[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var l=0;l<n.length;++l)t.write_shift(2,n.charCodeAt(l));return t.write_shift(2,0),t}function sC(a){return a||(a=fe(4)),a.write_shift(2,1),a.write_shift(2,1),a}function iC(a,n,t){if(!t.cellStyles)return Tn(a,n);var s=t&&t.biff>=12?4:2,l=a.read_shift(s),u=a.read_shift(s),f=a.read_shift(s),h=a.read_shift(s),g=a.read_shift(2);s==2&&(a.l+=2);var m={s:l,e:u,w:f,ixfe:h,flags:g};return(t.biff>=5||!t.biff)&&(m.level=g>>8&7),m}function lC(a,n){var t=fe(12);t.write_shift(2,n),t.write_shift(2,n),t.write_shift(2,a.width*256),t.write_shift(2,0);var s=0;return a.hidden&&(s|=1),t.write_shift(1,s),s=a.level||0,t.write_shift(1,s),t.write_shift(2,0),t}function cC(a){for(var n=fe(2*a),t=0;t<a;++t)n.write_shift(2,t+1);return n}function oC(a,n,t){var s=fe(15);return Ul(s,a,n),s.write_shift(8,t,"f"),s}function uC(a,n,t){var s=fe(9);return Ul(s,a,n),s.write_shift(2,t),s}var fC=(function(){var a={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=yf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(h,g){var m=[],p=Zr(1);switch(g.type){case"base64":p=un(Vn(h));break;case"binary":p=un(h);break;case"buffer":case"array":p=h;break}Oa(p,0);var S=p.read_shift(1),x=!!(S&136),C=!1,T=!1;switch(S){case 2:break;case 3:break;case 48:C=!0,x=!0;break;case 49:C=!0,x=!0;break;case 131:break;case 139:break;case 140:T=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+S.toString(16))}var y=0,_=521;S==2&&(y=p.read_shift(2)),p.l+=3,S!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),S!=2&&(_=p.read_shift(2));var w=p.read_shift(2),k=g.codepage||1252;S!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(k=a[p[p.l]]),p.l+=1,p.l+=2),T&&(p.l+=36);for(var D=[],b={},K=Math.min(p.length,S==2?521:_-10-(C?264:0)),q=T?32:11;p.l<K&&p[p.l]!=13;)switch(b={},b.name=uo.utils.decode(k,p.slice(p.l,p.l+q)).replace(/[\u0000\r\n].*$/g,""),p.l+=q,b.type=String.fromCharCode(p.read_shift(1)),S!=2&&!T&&(b.offset=p.read_shift(4)),b.len=p.read_shift(1),S==2&&(b.offset=p.read_shift(2)),b.dec=p.read_shift(1),b.name.length&&D.push(b),S!=2&&(p.l+=T?13:14),b.type){case"B":(!C||b.len!=8)&&g.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(p[p.l]!==13&&(p.l=_-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=_;var B=0,Z=0;for(m[0]=[],Z=0;Z!=D.length;++Z)m[0][Z]=D[Z].name;for(;y-- >0;){if(p[p.l]===42){p.l+=w;continue}for(++p.l,m[++B]=[],Z=0,Z=0;Z!=D.length;++Z){var L=p.slice(p.l,p.l+D[Z].len);p.l+=D[Z].len,Oa(L,0);var X=uo.utils.decode(k,L);switch(D[Z].type){case"C":X.trim().length&&(m[B][Z]=X.replace(/\s+$/,""));break;case"D":X.length===8?m[B][Z]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):m[B][Z]=X;break;case"F":m[B][Z]=parseFloat(X.trim());break;case"+":case"I":m[B][Z]=T?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":m[B][Z]=!0;break;case"N":case"F":m[B][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+S.toString(16));m[B][Z]="##MEMO##"+(T?parseInt(X.trim(),10):L.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(m[B][Z]=+X||0);break;case"@":m[B][Z]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":m[B][Z]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":m[B][Z]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[B][Z]=-L.read_shift(-8,"f");break;case"B":if(C&&D[Z].len==8){m[B][Z]=L.read_shift(8,"f");break}case"G":case"P":L.l+=D[Z].len;break;case"0":if(D[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+D[Z].type)}}}if(S!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return g&&g.sheetRows&&(m=m.slice(0,g.sheetRows)),g.DBF=D,m}function s(h,g){var m=g||{};m.dateNF||(m.dateNF="yyyymmdd");var p=oi(t(h,m),m);return p["!cols"]=m.DBF.map(function(S){return{wch:S.len,DBF:S}}),delete m.DBF,p}function l(h,g){try{return as(s(h,g),g)}catch(m){if(g&&g.WTF)throw m}return{SheetNames:[],Sheets:{}}}var u={B:8,C:250,L:1,D:8,"?":0,"":0};function f(h,g){var m=g||{};if(+m.codepage>=0&&Cl(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ca(),S=wo(h,{header:1,raw:!0,cellDates:!0}),x=S[0],C=S.slice(1),T=h["!cols"]||[],y=0,_=0,w=0,k=1;for(y=0;y<x.length;++y){if(((T[y]||{}).DBF||{}).name){x[y]=T[y].DBF.name,++w;continue}if(x[y]!=null){if(++w,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(_=0;_<1024;++_)if(x.indexOf(x[y]+"_"+_)==-1){x[y]+="_"+_;break}}}}var D=yt(h["!ref"]),b=[],K=[],q=[];for(y=0;y<=D.e.c-D.s.c;++y){var B="",Z="",L=0,X=[];for(_=0;_<C.length;++_)C[_][y]!=null&&X.push(C[_][y]);if(X.length==0||x[y]==null){b[y]="?";continue}for(_=0;_<X.length;++_){switch(typeof X[_]){case"number":Z="B";break;case"string":Z="C";break;case"boolean":Z="L";break;case"object":Z=X[_]instanceof Date?"D":"C";break;default:Z="C"}L=Math.max(L,String(X[_]).length),B=B&&B!=Z?"C":Z}L>250&&(L=250),Z=((T[y]||{}).DBF||{}).type,Z=="C"&&T[y].DBF.len>L&&(L=T[y].DBF.len),B=="B"&&Z=="N"&&(B="N",q[y]=T[y].DBF.dec,L=T[y].DBF.len),K[y]=B=="C"||Z=="N"?L:u[B]||0,k+=K[y],b[y]=B}var M=p.next(32);for(M.write_shift(4,318902576),M.write_shift(4,C.length),M.write_shift(2,296+32*w),M.write_shift(2,k),y=0;y<4;++y)M.write_shift(4,0);for(M.write_shift(4,0|(+n[kv]||3)<<8),y=0,_=0;y<x.length;++y)if(x[y]!=null){var H=p.next(32),ue=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,ue,"sbcs"),H.write_shift(1,b[y]=="?"?"C":b[y],"sbcs"),H.write_shift(4,_),H.write_shift(1,K[y]||u[b[y]]||0),H.write_shift(1,q[y]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),_+=K[y]||u[b[y]]||0}var be=p.next(264);for(be.write_shift(4,13),y=0;y<65;++y)be.write_shift(4,0);for(y=0;y<C.length;++y){var Se=p.next(k);for(Se.write_shift(1,0),_=0;_<x.length;++_)if(x[_]!=null)switch(b[_]){case"L":Se.write_shift(1,C[y][_]==null?63:C[y][_]?84:70);break;case"B":Se.write_shift(8,C[y][_]||0,"f");break;case"N":var ee="0";for(typeof C[y][_]=="number"&&(ee=C[y][_].toFixed(q[_]||0)),w=0;w<K[_]-ee.length;++w)Se.write_shift(1,32);Se.write_shift(1,ee,"sbcs");break;case"D":C[y][_]?(Se.write_shift(4,("0000"+C[y][_].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(C[y][_].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+C[y][_].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(C[y][_]!=null?C[y][_]:"").slice(0,K[_]);for(Se.write_shift(1,ge,"sbcs"),w=0;w<K[_]-ge.length;++w)Se.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:l,to_sheet:s,from_sheet:f}})(),dC=(function(){var a={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+aa(a).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,C){var T=a[C];return typeof T=="number"?F1(T):T},s=function(x,C,T){var y=C.charCodeAt(0)-32<<4|T.charCodeAt(0)-48;return y==59?x:F1(y)};a["|"]=254;function l(x,C){switch(C.type){case"base64":return u(Vn(x),C);case"binary":return u(x,C);case"buffer":return u(nt&&Buffer.isBuffer(x)?x.toString("binary"):Al(x),C);case"array":return u(ko(x),C)}throw new Error("Unrecognized type "+C.type)}function u(x,C){var T=x.split(/[\n\r]+/),y=-1,_=-1,w=0,k=0,D=[],b=[],K=null,q={},B=[],Z=[],L=[],X=0,M;for(+C.codepage>=0&&Cl(+C.codepage);w!==T.length;++w){X=0;var H=T[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(n,t),ue=H.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),be=ue[0],Se;if(H.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&b.push(H.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,ge=!1,ke=!1,Ne=!1,Le=-1,G=-1;for(k=1;k<ue.length;++k)switch(ue[k].charAt(0)){case"A":break;case"X":_=parseInt(ue[k].slice(1))-1,ge=!0;break;case"Y":for(y=parseInt(ue[k].slice(1))-1,ge||(_=0),M=D.length;M<=y;++M)D[M]=[];break;case"K":Se=ue[k].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(Gn(Se))?isNaN(El(Se).getDate())||(Se=ha(Se)):(Se=Gn(Se),K!==null&&Gv(K)&&(Se=Xv(Se))),ee=!0;break;case"E":Ne=!0;var j=uT(ue[k].slice(1),{r:y,c:_});D[y][_]=[D[y][_],j];break;case"S":ke=!0,D[y][_]=[D[y][_],"S5S"];break;case"G":break;case"R":Le=parseInt(ue[k].slice(1))-1;break;case"C":G=parseInt(ue[k].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+H)}if(ee&&(D[y][_]&&D[y][_].length==2?D[y][_][0]=Se:D[y][_]=Se,K=null),ke){if(Ne)throw new Error("SYLK shared formula cannot have own formula");var V=Le>-1&&D[Le][G];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");D[y][_][1]=fT(V[1],{r:y-Le,c:_-G})}break;case"F":var P=0;for(k=1;k<ue.length;++k)switch(ue[k].charAt(0)){case"X":_=parseInt(ue[k].slice(1))-1,++P;break;case"Y":for(y=parseInt(ue[k].slice(1))-1,M=D.length;M<=y;++M)D[M]=[];break;case"M":X=parseInt(ue[k].slice(1))/20;break;case"F":break;case"G":break;case"P":K=b[parseInt(ue[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=ue[k].slice(1).split(" "),M=parseInt(L[0],10);M<=parseInt(L[1],10);++M)X=parseInt(L[2],10),Z[M-1]=X===0?{hidden:!0}:{wch:X},kf(Z[M-1]);break;case"C":_=parseInt(ue[k].slice(1))-1,Z[_]||(Z[_]={});break;case"R":y=parseInt(ue[k].slice(1))-1,B[y]||(B[y]={}),X>0?(B[y].hpt=X,B[y].hpx=Ig(X)):X===0&&(B[y].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+H)}P<1&&(K=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+H)}}return B.length>0&&(q["!rows"]=B),Z.length>0&&(q["!cols"]=Z),C&&C.sheetRows&&(D=D.slice(0,C.sheetRows)),[D,q]}function f(x,C){var T=l(x,C),y=T[0],_=T[1],w=oi(y,C);return aa(_).forEach(function(k){w[k]=_[k]}),w}function h(x,C){return as(f(x,C),C)}function g(x,C,T,y){var _="C;Y"+(T+1)+";X"+(y+1)+";K";switch(x.t){case"n":_+=x.v||0,x.f&&!x.F&&(_+=";E"+Of(x.f,{r:T,c:y}));break;case"b":_+=x.v?"TRUE":"FALSE";break;case"e":_+=x.w||x.v;break;case"d":_+='"'+(x.w||x.v)+'"';break;case"s":_+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function m(x,C){C.forEach(function(T,y){var _="F;W"+(y+1)+" "+(y+1)+" ";T.hidden?_+="0":(typeof T.width=="number"&&!T.wpx&&(T.wpx=yo(T.width)),typeof T.wpx=="number"&&!T.wch&&(T.wch=Co(T.wpx)),typeof T.wch=="number"&&(_+=Math.round(T.wch))),_.charAt(_.length-1)!=" "&&x.push(_)})}function p(x,C){C.forEach(function(T,y){var _="F;";T.hidden?_+="M0;":T.hpt?_+="M"+20*T.hpt+";":T.hpx&&(_+="M"+20*To(T.hpx)+";"),_.length>2&&x.push(_+"R"+(y+1))})}function S(x,C){var T=["ID;PWXL;N;E"],y=[],_=yt(x["!ref"]),w,k=Array.isArray(x),D=`\r
`;T.push("P;PGeneral"),T.push("F;P0;DG0G8;M255"),x["!cols"]&&m(T,x["!cols"]),x["!rows"]&&p(T,x["!rows"]),T.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var b=_.s.r;b<=_.e.r;++b)for(var K=_.s.c;K<=_.e.c;++K){var q=ot({r:b,c:K});w=k?(x[b]||[])[K]:x[q],!(!w||w.v==null&&(!w.f||w.F))&&y.push(g(w,x,b,K))}return T.join(D)+D+y.join(D)+D+"E"+D}return{to_workbook:h,to_sheet:f,from_sheet:S}})(),hC=(function(){function a(u,f){switch(f.type){case"base64":return n(Vn(u),f);case"binary":return n(u,f);case"buffer":return n(nt&&Buffer.isBuffer(u)?u.toString("binary"):Al(u),f);case"array":return n(ko(u),f)}throw new Error("Unrecognized type "+f.type)}function n(u,f){for(var h=u.split(`
`),g=-1,m=-1,p=0,S=[];p!==h.length;++p){if(h[p].trim()==="BOT"){S[++g]=[],m=0;continue}if(!(g<0)){var x=h[p].trim().split(","),C=x[0],T=x[1];++p;for(var y=h[p]||"";(y.match(/["]/g)||[]).length&1&&p<h.length-1;)y+=`
`+h[++p];switch(y=y.trim(),+C){case-1:if(y==="BOT"){S[++g]=[],m=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?S[g][m]=!0:y==="FALSE"?S[g][m]=!1:isNaN(Gn(T))?isNaN(El(T).getDate())?S[g][m]=T:S[g][m]=ha(T):S[g][m]=Gn(T),++m;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),S[g][m++]=y!==""?y:null;break}if(y==="EOD")break}}return f&&f.sheetRows&&(S=S.slice(0,f.sheetRows)),S}function t(u,f){return oi(a(u,f),f)}function s(u,f){return as(t(u,f),f)}var l=(function(){var u=function(g,m,p,S,x){g.push(m),g.push(p+","+S),g.push('"'+x.replace(/"/g,'""')+'"')},f=function(g,m,p,S){g.push(m+","+p),g.push(m==1?'"'+S.replace(/"/g,'""')+'"':S)};return function(g){var m=[],p=yt(g["!ref"]),S,x=Array.isArray(g);u(m,"TABLE",0,1,"sheetjs"),u(m,"VECTORS",0,p.e.r-p.s.r+1,""),u(m,"TUPLES",0,p.e.c-p.s.c+1,""),u(m,"DATA",0,0,"");for(var C=p.s.r;C<=p.e.r;++C){f(m,-1,0,"BOT");for(var T=p.s.c;T<=p.e.c;++T){var y=ot({r:C,c:T});if(S=x?(g[C]||[])[T]:g[y],!S){f(m,1,0,"");continue}switch(S.t){case"n":var _=S.w;!_&&S.v!=null&&(_=S.v),_==null?S.f&&!S.F?f(m,1,0,"="+S.f):f(m,1,0,""):f(m,0,_,"V");break;case"b":f(m,0,S.v?1:0,S.v?"TRUE":"FALSE");break;case"s":f(m,1,0,isNaN(S.v)?S.v:'="'+S.v+'"');break;case"d":S.w||(S.w=wr(S.z||Nt[14],Ta(ha(S.v)))),f(m,0,S.w,"V");break;default:f(m,1,0,"")}}}f(m,-1,0,"EOD");var w=`\r
`,k=m.join(w);return k}})();return{to_workbook:s,to_sheet:t,from_sheet:l}})(),jg=(function(){function a(S){return S.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(S){return S.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(S,x){for(var C=S.split(`
`),T=-1,y=-1,_=0,w=[];_!==C.length;++_){var k=C[_].trim().split(":");if(k[0]==="cell"){var D=Ht(k[1]);if(w.length<=D.r)for(T=w.length;T<=D.r;++T)w[T]||(w[T]=[]);switch(T=D.r,y=D.c,k[2]){case"t":w[T][y]=a(k[3]);break;case"v":w[T][y]=+k[3];break;case"vtf":var b=k[k.length-1];case"vtc":switch(k[3]){case"nl":w[T][y]=!!+k[4];break;default:w[T][y]=+k[4];break}k[2]=="vtf"&&(w[T][y]=[w[T][y],b])}}}return x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),w}function s(S,x){return oi(t(S,x),x)}function l(S,x){return as(s(S,x),x)}var u=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function m(S){if(!S||!S["!ref"])return"";for(var x=[],C=[],T,y="",_=Fa(S["!ref"]),w=Array.isArray(S),k=_.s.r;k<=_.e.r;++k)for(var D=_.s.c;D<=_.e.c;++D)if(y=ot({r:k,c:D}),T=w?(S[k]||[])[D]:S[y],!(!T||T.v==null||T.t==="z")){switch(C=["cell",y,"t"],T.t){case"s":case"str":C.push(n(T.v));break;case"n":T.f?(C[2]="vtf",C[3]="n",C[4]=T.v,C[5]=n(T.f)):(C[2]="v",C[3]=T.v);break;case"b":C[2]="vt"+(T.f?"f":"c"),C[3]="nl",C[4]=T.v?"1":"0",C[5]=n(T.f||(T.v?"TRUE":"FALSE"));break;case"d":var b=Ta(ha(T.v));C[2]="vtc",C[3]="nd",C[4]=""+b,C[5]=T.w||wr(T.z||Nt[14],b);break;case"e":continue}x.push(C.join(":"))}return x.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function p(S){return[u,f,h,f,m(S),g].join(`
`)}return{to_workbook:l,to_sheet:s,from_sheet:p}})(),mC=(function(){function a(p,S,x,C,T){T.raw?S[x][C]=p:p===""||(p==="TRUE"?S[x][C]=!0:p==="FALSE"?S[x][C]=!1:isNaN(Gn(p))?isNaN(El(p).getDate())?S[x][C]=p:S[x][C]=ha(p):S[x][C]=Gn(p))}function n(p,S){var x=S||{},C=[];if(!p||p.length===0)return C;for(var T=p.split(/[\r\n]/),y=T.length-1;y>=0&&T[y].length===0;)--y;for(var _=10,w=0,k=0;k<=y;++k)w=T[k].indexOf(" "),w==-1?w=T[k].length:w++,_=Math.max(_,w);for(k=0;k<=y;++k){C[k]=[];var D=0;for(a(T[k].slice(0,_).trim(),C,k,D,x),D=1;D<=(T[k].length-_)/10+1;++D)a(T[k].slice(_+(D-1)*10,_+D*10).trim(),C,k,D,x)}return x.sheetRows&&(C=C.slice(0,x.sheetRows)),C}var t={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function l(p){for(var S={},x=!1,C=0,T=0;C<p.length;++C)(T=p.charCodeAt(C))==34?x=!x:!x&&T in t&&(S[T]=(S[T]||0)+1);T=[];for(C in S)Object.prototype.hasOwnProperty.call(S,C)&&T.push([S[C],C]);if(!T.length){S=s;for(C in S)Object.prototype.hasOwnProperty.call(S,C)&&T.push([S[C],C])}return T.sort(function(y,_){return y[0]-_[0]||s[y[1]]-s[_[1]]}),t[T.pop()[1]]||44}function u(p,S){var x=S||{},C="",T=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(C=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(C=p.charAt(4),p=p.slice(6)):C=l(p.slice(0,1024)):x&&x.FS?C=x.FS:C=l(p.slice(0,1024));var _=0,w=0,k=0,D=0,b=0,K=C.charCodeAt(0),q=!1,B=0,Z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var L=x.dateNF!=null?M2(x.dateNF):null;function X(){var M=p.slice(D,b),H={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)H.t="z";else if(x.raw)H.t="s",H.v=M;else if(M.trim().length===0)H.t="s",H.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(H.t="s",H.v=M.slice(2,-1).replace(/""/g,'"')):dT(M)?(H.t="n",H.f=M.slice(1)):(H.t="s",H.v=M);else if(M=="TRUE")H.t="b",H.v=!0;else if(M=="FALSE")H.t="b",H.v=!1;else if(!isNaN(k=Gn(M)))H.t="n",x.cellText!==!1&&(H.w=M),H.v=k;else if(!isNaN(El(M).getDate())||L&&M.match(L)){H.z=x.dateNF||Nt[14];var ue=0;L&&M.match(L)&&(M=j2(M,x.dateNF,M.match(L)||[]),ue=1),x.cellDates?(H.t="d",H.v=ha(M,ue)):(H.t="n",H.v=Ta(ha(M,ue))),x.cellText!==!1&&(H.w=wr(H.z,H.v instanceof Date?Ta(H.v):H.v)),x.cellNF||delete H.z}else H.t="s",H.v=M;if(H.t=="z"||(x.dense?(T[_]||(T[_]=[]),T[_][w]=H):T[ot({c:w,r:_})]=H),D=b+1,Z=p.charCodeAt(D),y.e.c<w&&(y.e.c=w),y.e.r<_&&(y.e.r=_),B==K)++w;else if(w=0,++_,x.sheetRows&&x.sheetRows<=_)return!0}e:for(;b<p.length;++b)switch(B=p.charCodeAt(b)){case 34:Z===34&&(q=!q);break;case K:case 10:case 13:if(!q&&X())break e;break}return b-D>0&&X(),T["!ref"]=It(y),T}function f(p,S){return!(S&&S.PRN)||S.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?u(p,S):oi(n(p,S),S)}function h(p,S){var x="",C=S.type=="string"?[0,0,0,0]:bb(p,S);switch(S.type){case"base64":x=Vn(p);break;case"binary":x=p;break;case"buffer":S.codepage==65001?x=p.toString("utf8"):S.codepage&&typeof uo<"u"||(x=nt&&Buffer.isBuffer(p)?p.toString("binary"):Al(p));break;case"array":x=ko(p);break;case"string":x=p;break;default:throw new Error("Unrecognized type "+S.type)}return C[0]==239&&C[1]==187&&C[2]==191?x=gl(x.slice(3)):S.type!="string"&&S.type!="buffer"&&S.codepage==65001?x=gl(x):S.type=="binary"&&typeof uo<"u",x.slice(0,19)=="socialcalc:version:"?jg.to_sheet(S.type=="string"?x:gl(x),S):f(x,S)}function g(p,S){return as(h(p,S),S)}function m(p){for(var S=[],x=yt(p["!ref"]),C,T=Array.isArray(p),y=x.s.r;y<=x.e.r;++y){for(var _=[],w=x.s.c;w<=x.e.c;++w){var k=ot({r:y,c:w});if(C=T?(p[y]||[])[w]:p[k],!C||C.v==null){_.push("          ");continue}for(var D=(C.w||(Yn(C),C.w)||"").slice(0,10);D.length<10;)D+=" ";_.push(D+(w===0?" ":""))}S.push(_.join(""))}return S.join(`
`)}return{to_workbook:g,to_sheet:h,from_sheet:m}})(),mv=(function(){function a(j,V,P){if(j){Oa(j,j.l||0);for(var Y=P.Enum||Le;j.l<j.length;){var ce=j.read_shift(2),Ce=Y[ce]||Y[65535],je=j.read_shift(2),we=j.l+je,Ae=Ce.f&&Ce.f(j,je,P);if(j.l=we,V(Ae,Ce,ce))return}}}function n(j,V){switch(V.type){case"base64":return t(un(Vn(j)),V);case"binary":return t(un(j),V);case"buffer":case"array":return t(j,V)}throw"Unsupported type "+V.type}function t(j,V){if(!j)return j;var P=V||{},Y=P.dense?[]:{},ce="Sheet1",Ce="",je=0,we={},Ae=[],Qe=[],Ve={s:{r:0,c:0},e:{r:0,c:0}},Kt=P.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)P.Enum=Le,a(j,function(Ue,ca,wa){switch(wa){case 0:P.vers=Ue,Ue>=4096&&(P.qpro=!0);break;case 6:Ve=Ue;break;case 204:Ue&&(Ce=Ue);break;case 222:Ce=Ue;break;case 15:case 51:P.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:wa==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=P.dateNF||Nt[14],P.cellDates&&(Ue[1].t="d",Ue[1].v=Xv(Ue[1].v))),P.qpro&&Ue[3]>je&&(Y["!ref"]=It(Ve),we[ce]=Y,Ae.push(ce),Y=P.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},je=Ue[3],ce=Ce||"Sheet"+(je+1),Ce="");var en=P.dense?(Y[Ue[0].r]||[])[Ue[0].c]:Y[ot(Ue[0])];if(en){en.t=Ue[1].t,en.v=Ue[1].v,Ue[1].z!=null&&(en.z=Ue[1].z),Ue[1].f!=null&&(en.f=Ue[1].f);break}P.dense?(Y[Ue[0].r]||(Y[Ue[0].r]=[]),Y[Ue[0].r][Ue[0].c]=Ue[1]):Y[ot(Ue[0])]=Ue[1];break}},P);else if(j[2]==26||j[2]==14)P.Enum=G,j[2]==14&&(P.qpro=!0,j.l=0),a(j,function(Ue,ca,wa){switch(wa){case 204:ce=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>je&&(Y["!ref"]=It(Ve),we[ce]=Y,Ae.push(ce),Y=P.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},je=Ue[3],ce="Sheet"+(je+1)),Kt>0&&Ue[0].r>=Kt)break;P.dense?(Y[Ue[0].r]||(Y[Ue[0].r]=[]),Y[Ue[0].r][Ue[0].c]=Ue[1]):Y[ot(Ue[0])]=Ue[1],Ve.e.c<Ue[0].c&&(Ve.e.c=Ue[0].c),Ve.e.r<Ue[0].r&&(Ve.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(Qe[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:Qe[Ue[0]]=Ue[1],Ue[0]==je&&(ce=Ue[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(Y["!ref"]=It(Ve),we[Ce||ce]=Y,Ae.push(Ce||ce),!Qe.length)return{SheetNames:Ae,Sheets:we};for(var We={},_a=[],vt=0;vt<Qe.length;++vt)we[Ae[vt]]?(_a.push(Qe[vt]||Ae[vt]),We[Qe[vt]]=we[Qe[vt]]||we[Ae[vt]]):(_a.push(Qe[vt]),We[Qe[vt]]={"!ref":"A1"});return{SheetNames:_a,Sheets:We}}function s(j,V){var P=V||{};if(+P.codepage>=0&&Cl(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Ca(),ce=yt(j["!ref"]),Ce=Array.isArray(j),je=[];_e(Y,0,u(1030)),_e(Y,6,g(ce));for(var we=Math.min(ce.e.r,8191),Ae=ce.s.r;Ae<=we;++Ae)for(var Qe=ta(Ae),Ve=ce.s.c;Ve<=ce.e.c;++Ve){Ae===ce.s.r&&(je[Ve]=ia(Ve));var Kt=je[Ve]+Qe,We=Ce?(j[Ae]||[])[Ve]:j[Kt];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?_e(Y,13,C(Ae,Ve,We.v)):_e(Y,14,y(Ae,Ve,We.v));else{var _a=Yn(We);_e(Y,15,S(Ae,Ve,_a.slice(0,239)))}}return _e(Y,1),Y.end()}function l(j,V){var P=V||{};if(+P.codepage>=0&&Cl(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Ca();_e(Y,0,f(j));for(var ce=0,Ce=0;ce<j.SheetNames.length;++ce)(j.Sheets[j.SheetNames[ce]]||{})["!ref"]&&_e(Y,27,Ne(j.SheetNames[ce],Ce++));var je=0;for(ce=0;ce<j.SheetNames.length;++ce){var we=j.Sheets[j.SheetNames[ce]];if(!(!we||!we["!ref"])){for(var Ae=yt(we["!ref"]),Qe=Array.isArray(we),Ve=[],Kt=Math.min(Ae.e.r,8191),We=Ae.s.r;We<=Kt;++We)for(var _a=ta(We),vt=Ae.s.c;vt<=Ae.e.c;++vt){We===Ae.s.r&&(Ve[vt]=ia(vt));var Ue=Ve[vt]+_a,ca=Qe?(we[We]||[])[vt]:we[Ue];if(!(!ca||ca.t=="z"))if(ca.t=="n")_e(Y,23,X(We,vt,je,ca.v));else{var wa=Yn(ca);_e(Y,22,B(We,vt,je,wa.slice(0,239)))}}++je}}return _e(Y,1),Y.end()}function u(j){var V=fe(2);return V.write_shift(2,j),V}function f(j){var V=fe(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var P=0,Y=0,ce=0,Ce=0;Ce<j.SheetNames.length;++Ce){var je=j.SheetNames[Ce],we=j.Sheets[je];if(!(!we||!we["!ref"])){++ce;var Ae=Fa(we["!ref"]);P<Ae.e.r&&(P=Ae.e.r),Y<Ae.e.c&&(Y=Ae.e.c)}}return P>8191&&(P=8191),V.write_shift(2,P),V.write_shift(1,ce),V.write_shift(1,Y),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function h(j,V,P){var Y={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&P.qpro?(Y.s.c=j.read_shift(1),j.l++,Y.s.r=j.read_shift(2),Y.e.c=j.read_shift(1),j.l++,Y.e.r=j.read_shift(2),Y):(Y.s.c=j.read_shift(2),Y.s.r=j.read_shift(2),V==12&&P.qpro&&(j.l+=2),Y.e.c=j.read_shift(2),Y.e.r=j.read_shift(2),V==12&&P.qpro&&(j.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function g(j){var V=fe(8);return V.write_shift(2,j.s.c),V.write_shift(2,j.s.r),V.write_shift(2,j.e.c),V.write_shift(2,j.e.r),V}function m(j,V,P){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(Y[0].c=j.read_shift(1),Y[3]=j.read_shift(1),Y[0].r=j.read_shift(2),j.l+=2):(Y[2]=j.read_shift(1),Y[0].c=j.read_shift(2),Y[0].r=j.read_shift(2)),Y}function p(j,V,P){var Y=j.l+V,ce=m(j,V,P);if(ce[1].t="s",P.vers==20768){j.l++;var Ce=j.read_shift(1);return ce[1].v=j.read_shift(Ce,"utf8"),ce}return P.qpro&&j.l++,ce[1].v=j.read_shift(Y-j.l,"cstr"),ce}function S(j,V,P){var Y=fe(7+P.length);Y.write_shift(1,255),Y.write_shift(2,V),Y.write_shift(2,j),Y.write_shift(1,39);for(var ce=0;ce<Y.length;++ce){var Ce=P.charCodeAt(ce);Y.write_shift(1,Ce>=128?95:Ce)}return Y.write_shift(1,0),Y}function x(j,V,P){var Y=m(j,V,P);return Y[1].v=j.read_shift(2,"i"),Y}function C(j,V,P){var Y=fe(7);return Y.write_shift(1,255),Y.write_shift(2,V),Y.write_shift(2,j),Y.write_shift(2,P,"i"),Y}function T(j,V,P){var Y=m(j,V,P);return Y[1].v=j.read_shift(8,"f"),Y}function y(j,V,P){var Y=fe(13);return Y.write_shift(1,255),Y.write_shift(2,V),Y.write_shift(2,j),Y.write_shift(8,P,"f"),Y}function _(j,V,P){var Y=j.l+V,ce=m(j,V,P);if(ce[1].v=j.read_shift(8,"f"),P.qpro)j.l=Y;else{var Ce=j.read_shift(2);b(j.slice(j.l,j.l+Ce),ce),j.l+=Ce}return ce}function w(j,V,P){var Y=V&32768;return V&=-32769,V=(Y?j:0)+(V>=8192?V-16384:V),(Y?"":"$")+(P?ia(V):ta(V))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},D=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(j,V){Oa(j,0);for(var P=[],Y=0,ce="",Ce="",je="",we="";j.l<j.length;){var Ae=j[j.l++];switch(Ae){case 0:P.push(j.read_shift(8,"f"));break;case 1:Ce=w(V[0].c,j.read_shift(2),!0),ce=w(V[0].r,j.read_shift(2),!1),P.push(Ce+ce);break;case 2:{var Qe=w(V[0].c,j.read_shift(2),!0),Ve=w(V[0].r,j.read_shift(2),!1);Ce=w(V[0].c,j.read_shift(2),!0),ce=w(V[0].r,j.read_shift(2),!1),P.push(Qe+Ve+":"+Ce+ce)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(j.read_shift(2));break;case 6:{for(var Kt="";Ae=j[j.l++];)Kt+=String.fromCharCode(Ae);P.push('"'+Kt.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:we=P.pop(),je=P.pop(),P.push(["AND","OR"][Ae-20]+"("+je+","+we+")");break;default:if(Ae<32&&D[Ae])we=P.pop(),je=P.pop(),P.push(je+D[Ae]+we);else if(k[Ae]){if(Y=k[Ae][1],Y==69&&(Y=j[j.l++]),Y>P.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+P.join("|")+"|");return}var We=P.slice(-Y);P.length-=Y,P.push(k[Ae][0]+"("+We.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}P.length==1?V[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function K(j){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=j.read_shift(2),V[3]=j[j.l++],V[0].c=j[j.l++],V}function q(j,V){var P=K(j);return P[1].t="s",P[1].v=j.read_shift(V-4,"cstr"),P}function B(j,V,P,Y){var ce=fe(6+Y.length);ce.write_shift(2,j),ce.write_shift(1,P),ce.write_shift(1,V),ce.write_shift(1,39);for(var Ce=0;Ce<Y.length;++Ce){var je=Y.charCodeAt(Ce);ce.write_shift(1,je>=128?95:je)}return ce.write_shift(1,0),ce}function Z(j,V){var P=K(j);P[1].v=j.read_shift(2);var Y=P[1].v>>1;if(P[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return P[1].v=Y,P}function L(j,V){var P=K(j),Y=j.read_shift(4),ce=j.read_shift(4),Ce=j.read_shift(2);if(Ce==65535)return Y===0&&ce===3221225472?(P[1].t="e",P[1].v=15):Y===0&&ce===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var je=Ce&32768;return Ce=(Ce&32767)-16446,P[1].v=(1-je*2)*(ce*Math.pow(2,Ce+32)+Y*Math.pow(2,Ce)),P}function X(j,V,P,Y){var ce=fe(14);if(ce.write_shift(2,j),ce.write_shift(1,P),ce.write_shift(1,V),Y==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Ce=0,je=0,we=0,Ae=0;return Y<0&&(Ce=1,Y=-Y),je=Math.log2(Y)|0,Y/=Math.pow(2,je-31),Ae=Y>>>0,(Ae&2147483648)==0&&(Y/=2,++je,Ae=Y>>>0),Y-=Ae,Ae|=2147483648,Ae>>>=0,Y*=Math.pow(2,32),we=Y>>>0,ce.write_shift(4,we),ce.write_shift(4,Ae),je+=16383+(Ce?32768:0),ce.write_shift(2,je),ce}function M(j,V){var P=L(j);return j.l+=V-14,P}function H(j,V){var P=K(j),Y=j.read_shift(4);return P[1].v=Y>>6,P}function ue(j,V){var P=K(j),Y=j.read_shift(8,"f");return P[1].v=Y,P}function be(j,V){var P=ue(j);return j.l+=V-10,P}function Se(j,V){return j[j.l+V-1]==0?j.read_shift(V,"cstr"):""}function ee(j,V){var P=j[j.l++];P>V-1&&(P=V-1);for(var Y="";Y.length<P;)Y+=String.fromCharCode(j[j.l++]);return Y}function ge(j,V,P){if(!(!P.qpro||V<21)){var Y=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var ce=j.read_shift(V-21,"cstr");return[Y,ce]}}function ke(j,V){for(var P={},Y=j.l+V;j.l<Y;){var ce=j.read_shift(2);if(ce==14e3){for(P[ce]=[0,""],P[ce][0]=j.read_shift(2);j[j.l];)P[ce][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return P}function Ne(j,V){var P=fe(5+j.length);P.write_shift(2,14e3),P.write_shift(2,V);for(var Y=0;Y<j.length;++Y){var ce=j.charCodeAt(Y);P[P.l++]=ce>127?95:ce}return P[P.l++]=0,P}var Le={0:{n:"BOF",f:bg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:T},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:q},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:Z},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ke},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:l,to_workbook:n}})(),vC=/^\s|\s$|[\t\n\r]/;function kg(a,n){if(!n.bookSST)return"";var t=[Rt];t[t.length]=Ee("sst",null,{xmlns:ci[0],count:a.Count,uniqueCount:a.Unique});for(var s=0;s!=a.length;++s)if(a[s]!=null){var l=a[s],u="<si>";l.r?u+=l.r:(u+="<t",l.t||(l.t=""),l.t.match(vC)&&(u+=' xml:space="preserve"'),u+=">"+ct(l.t)+"</t>"),u+="</si>",t[t.length]=u}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function gC(a){return[a.read_shift(4),a.read_shift(4)]}function pC(a,n){return n||(n=fe(8)),n.write_shift(4,a.Count),n.write_shift(4,a.Unique),n}var xC=cy;function SC(a){var n=Ca();pe(n,159,pC(a));for(var t=0;t<a.length;++t)pe(n,19,xC(a[t]));return pe(n,160),n.end()}function yC(a){for(var n=[],t=a.split(""),s=0;s<t.length;++s)n[s]=t[s].charCodeAt(0);return n}function Ug(a){var n=0,t,s=yC(a),l=s.length+1,u,f,h,g,m;for(t=Zr(l),t[0]=s.length,u=1;u!=l;++u)t[u]=s[u-1];for(u=l-1;u>=0;--u)f=t[u],h=(n&16384)===0?0:1,g=n<<1&32767,m=h|g,n=m^f;return n^52811}var CC=(function(){function a(l,u){switch(u.type){case"base64":return n(Vn(l),u);case"binary":return n(l,u);case"buffer":return n(nt&&Buffer.isBuffer(l)?l.toString("binary"):Al(l),u);case"array":return n(ko(l),u)}throw new Error("Unrecognized type "+u.type)}function n(l,u){var f=u||{},h=f.dense?[]:{},g=l.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(p,S){Array.isArray(h)&&(h[S]=[]);for(var x=/\\\w+\b/g,C=0,T,y=-1;T=x.exec(p);){switch(T[0]){case"\\cell":var _=p.slice(C,x.lastIndex-T[0].length);if(_[0]==" "&&(_=_.slice(1)),++y,_.length){var w={v:_,t:"s"};Array.isArray(h)?h[S][y]=w:h[ot({r:S,c:y})]=w}break}C=x.lastIndex}y>m.e.c&&(m.e.c=y)}),h["!ref"]=It(m),h}function t(l,u){return as(a(l,u),u)}function s(l){for(var u=["{\\rtf1\\ansi"],f=yt(l["!ref"]),h,g=Array.isArray(l),m=f.s.r;m<=f.e.r;++m){u.push("\\trowd\\trautofit1");for(var p=f.s.c;p<=f.e.c;++p)u.push("\\cellx"+(p+1));for(u.push("\\pard\\intbl"),p=f.s.c;p<=f.e.c;++p){var S=ot({r:m,c:p});h=g?(l[m]||[])[p]:l[S],!(!h||h.v==null&&(!h.f||h.F))&&(u.push(" "+(h.w||(Yn(h),h.w))),u.push("\\cell"))}u.push("\\pard\\intbl\\row")}return u.join("")+"}"}return{to_workbook:t,to_sheet:a,from_sheet:s}})();function vv(a){for(var n=0,t=1;n!=3;++n)t=t*256+(a[n]>255?255:a[n]<0?0:a[n]);return t.toString(16).toUpperCase().slice(1)}var TC=6,Wn=TC;function yo(a){return Math.floor((a+Math.round(128/Wn)/256)*Wn)}function Co(a){return Math.floor((a-5)/Wn*100+.5)/100}function vf(a){return Math.round((a*Wn+5)/Wn*256)/256}function kf(a){a.width?(a.wpx=yo(a.width),a.wch=Co(a.wpx),a.MDW=Wn):a.wpx?(a.wch=Co(a.wpx),a.width=vf(a.wch),a.MDW=Wn):typeof a.wch=="number"&&(a.width=vf(a.wch),a.wpx=yo(a.width),a.MDW=Wn),a.customWidth&&delete a.customWidth}var EC=96,Og=EC;function To(a){return a*96/Og}function Ig(a){return a*Og/96}function _C(a){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)a[s]!=null&&(n[n.length]=Ee("numFmt",null,{numFmtId:s,formatCode:ct(a[s])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Ee("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function wC(a){var n=[];return n[n.length]=Ee("cellXfs",null),a.forEach(function(t){n[n.length]=Ee("xf",null,t)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Ee("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function Rg(a,n){var t=[Rt,Ee("styleSheet",null,{xmlns:ci[0],"xmlns:vt":zt.vt})],s;return a.SSF&&(s=_C(a.SSF))!=null&&(t[t.length]=s),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=wC(n.cellXfs))&&(t[t.length]=s),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function bC(a,n){var t=a.read_shift(2),s=la(a);return[t,s]}function NC(a,n,t){t||(t=fe(6+4*n.length)),t.write_shift(2,a),Gt(n,t);var s=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),s}function AC(a,n,t){var s={};s.sz=a.read_shift(2)/20;var l=vy(a);l.fItalic&&(s.italic=1),l.fCondense&&(s.condense=1),l.fExtend&&(s.extend=1),l.fShadow&&(s.shadow=1),l.fOutline&&(s.outline=1),l.fStrikeout&&(s.strike=1);var u=a.read_shift(2);switch(u===700&&(s.bold=1),a.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var f=a.read_shift(1);f!=0&&(s.underline=f);var h=a.read_shift(1);h>0&&(s.family=h);var g=a.read_shift(1);switch(g>0&&(s.charset=g),a.l++,s.color=my(a),a.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=la(a),s}function DC(a,n){n||(n=fe(153)),n.write_shift(2,a.sz*20),gy(a,n),n.write_shift(2,a.bold?700:400);var t=0;a.vertAlign=="superscript"?t=1:a.vertAlign=="subscript"&&(t=2),n.write_shift(2,t),n.write_shift(1,a.underline||0),n.write_shift(1,a.family||0),n.write_shift(1,a.charset||0),n.write_shift(1,0),xo(a.color,n);var s=0;return s=2,n.write_shift(1,s),Gt(a.name,n),n.length>n.l?n.slice(0,n.l):n}var MC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],sf,jC=Tn;function gv(a,n){n||(n=fe(84)),sf||(sf=yf(MC));var t=sf[a.patternType];t==null&&(t=40),n.write_shift(4,t);var s=0;if(t!=40)for(xo({auto:1},n),xo({auto:1},n);s<12;++s)n.write_shift(4,0);else{for(;s<4;++s)n.write_shift(4,0);for(;s<12;++s)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function kC(a,n){var t=a.l+n,s=a.read_shift(2),l=a.read_shift(2);return a.l=t,{ixfe:s,numFmtId:l}}function Fg(a,n,t){t||(t=fe(16)),t.write_shift(2,n||0),t.write_shift(2,a.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var s=0;return t.write_shift(1,s),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function ul(a,n){return n||(n=fe(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var UC=Tn;function OC(a,n){return n||(n=fe(51)),n.write_shift(1,0),ul(null,n),ul(null,n),ul(null,n),ul(null,n),ul(null,n),n.length>n.l?n.slice(0,n.l):n}function IC(a,n){return n||(n=fe(52)),n.write_shift(4,a.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),po(a.name||"",n),n.length>n.l?n.slice(0,n.l):n}function RC(a,n,t){var s=fe(2052);return s.write_shift(4,a),po(n,s),po(t,s),s.length>s.l?s.slice(0,s.l):s}function FC(a,n){if(n){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var l=s[0];l<=s[1];++l)n[l]!=null&&++t}),t!=0&&(pe(a,615,dn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var l=s[0];l<=s[1];++l)n[l]!=null&&pe(a,44,NC(l,n[l]))}),pe(a,616))}}function LC(a){var n=1;pe(a,611,dn(n)),pe(a,43,DC({sz:12,color:{theme:1},name:"Calibri",family:2})),pe(a,612)}function BC(a){var n=2;pe(a,603,dn(n)),pe(a,45,gv({patternType:"none"})),pe(a,45,gv({patternType:"gray125"})),pe(a,604)}function KC(a){var n=1;pe(a,613,dn(n)),pe(a,46,OC()),pe(a,614)}function PC(a){var n=1;pe(a,626,dn(n)),pe(a,47,Fg({numFmtId:0},65535)),pe(a,627)}function zC(a,n){pe(a,617,dn(n.length)),n.forEach(function(t){pe(a,47,Fg(t,0))}),pe(a,618)}function HC(a){var n=1;pe(a,619,dn(n)),pe(a,48,IC({xfId:0,name:"Normal"})),pe(a,620)}function GC(a){var n=0;pe(a,505,dn(n)),pe(a,506)}function WC(a){var n=0;pe(a,508,RC(n,"TableStyleMedium9","PivotStyleMedium4")),pe(a,509)}function VC(a,n){var t=Ca();return pe(t,278),FC(t,a.SSF),LC(t),BC(t),KC(t),PC(t),zC(t,n.cellXfs),HC(t),GC(t),WC(t),pe(t,279),t.end()}function Lg(a,n){if(n&&n.themeXLSX)return n.themeXLSX;if(a&&typeof a.raw=="string")return a.raw;var t=[Rt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function YC(a,n){return{flags:a.read_shift(4),version:a.read_shift(4),name:la(a)}}function XC(a){var n=fe(12+2*a.name.length);return n.write_shift(4,a.flags),n.write_shift(4,a.version),Gt(a.name,n),n.slice(0,n.l)}function JC(a){for(var n=[],t=a.read_shift(4);t-- >0;)n.push([a.read_shift(4),a.read_shift(4)]);return n}function qC(a){var n=fe(4+8*a.length);n.write_shift(4,a.length);for(var t=0;t<a.length;++t)n.write_shift(4,a[t][0]),n.write_shift(4,a[t][1]);return n}function $C(a,n){var t=fe(8+2*n.length);return t.write_shift(4,a),Gt(n,t),t.slice(0,t.l)}function QC(a){return a.l+=4,a.read_shift(4)!=0}function ZC(a,n){var t=fe(8);return t.write_shift(4,a),t.write_shift(4,1),t}function eT(){var a=Ca();return pe(a,332),pe(a,334,dn(1)),pe(a,335,XC({name:"XLDAPR",version:12e4,flags:3496657072})),pe(a,336),pe(a,339,$C(1,"XLDAPR")),pe(a,52),pe(a,35,dn(514)),pe(a,4096,dn(0)),pe(a,4097,Qa(1)),pe(a,36),pe(a,53),pe(a,340),pe(a,337,ZC(1)),pe(a,51,qC([[1,0]])),pe(a,338),pe(a,333),a.end()}function Bg(){var a=[Rt];return a.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),a.join("")}function tT(a){var n={};n.i=a.read_shift(4);var t={};t.r=a.read_shift(4),t.c=a.read_shift(4),n.r=ot(t);var s=a.read_shift(1);return s&2&&(n.l="1"),s&8&&(n.a="1"),n}var ei=1024;function Kg(a,n){for(var t=[21600,21600],s=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),l=[Ee("xml",null,{"xmlns:v":Ia.v,"xmlns:o":Ia.o,"xmlns:x":Ia.x,"xmlns:mv":Ia.mv}).replace(/\/>/,">"),Ee("o:shapelayout",Ee("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),Ee("v:shapetype",[Ee("v:stroke",null,{joinstyle:"miter"}),Ee("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:s})];ei<a*1e3;)ei+=1e3;return n.forEach(function(u){var f=Ht(u[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var g=h.type=="gradient"?Ee("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=Ee("v:fill",g,h),p={on:"t",obscured:"t"};++ei,l=l.concat(["<v:shape"+wl({id:"_x0000_s"+ei,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(u[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,Ee("v:shadow",null,p),Ee("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ea("x:Anchor",[f.c+1,0,f.r+1,0,f.c+3,20,f.r+5,20].join(",")),ea("x:AutoFill","False"),ea("x:Row",String(f.r)),ea("x:Column",String(f.c)),u[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),l.push("</xml>"),l.join("")}function Pg(a){var n=[Rt,Ee("comments",null,{xmlns:ci[0]})],t=[];return n.push("<authors>"),a.forEach(function(s){s[1].forEach(function(l){var u=ct(l.a);t.indexOf(u)==-1&&(t.push(u),n.push("<author>"+u+"</author>")),l.T&&l.ID&&t.indexOf("tc="+l.ID)==-1&&(t.push("tc="+l.ID),n.push("<author>tc="+l.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),a.forEach(function(s){var l=0,u=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?l=t.indexOf("tc="+s[1][0].ID):s[1].forEach(function(g){g.a&&(l=t.indexOf(ct(g.a))),u.push(g.t||"")}),n.push('<comment ref="'+s[0]+'" authorId="'+l+'"><text>'),u.length<=1)n.push(ea("t",ct(u[0]||"")));else{for(var f=`Comment:
    `+u[0]+`
`,h=1;h<u.length;++h)f+=`Reply:
    `+u[h]+`
`;n.push(ea("t",ct(f)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function aT(a,n,t){var s=[Rt,Ee("ThreadedComments",null,{xmlns:zt.TCMNT}).replace(/[\/]>/,">")];return a.forEach(function(l){var u="";(l[1]||[]).forEach(function(f,h){if(!f.T){delete f.ID;return}f.a&&n.indexOf(f.a)==-1&&n.push(f.a);var g={ref:l[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};h==0?u=g.id:g.parentId=u,f.ID=g.id,f.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(f.a)).slice(-12)+"}"),s.push(Ee("threadedComment",ea("text",f.t||""),g))})}),s.push("</ThreadedComments>"),s.join("")}function nT(a){var n=[Rt,Ee("personList",null,{xmlns:zt.TCMNT,"xmlns:x":ci[0]}).replace(/[\/]>/,">")];return a.forEach(function(t,s){n.push(Ee("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:t,providerId:"None"}))}),n.push("</personList>"),n.join("")}function rT(a){var n={};n.iauthor=a.read_shift(4);var t=is(a);return n.rfx=t.s,n.ref=ot(t.s),a.l+=16,n}function sT(a,n){return n==null&&(n=fe(36)),n.write_shift(4,a[1].iauthor),ui(a[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var iT=la;function lT(a){return Gt(a.slice(0,54))}function cT(a){var n=Ca(),t=[];return pe(n,628),pe(n,630),a.forEach(function(s){s[1].forEach(function(l){t.indexOf(l.a)>-1||(t.push(l.a.slice(0,54)),pe(n,632,lT(l.a)))})}),pe(n,631),pe(n,633),a.forEach(function(s){s[1].forEach(function(l){l.iauthor=t.indexOf(l.a);var u={s:Ht(s[0]),e:Ht(s[0])};pe(n,635,sT([u,l])),l.t&&l.t.length>0&&pe(n,637,uy(l)),pe(n,636),delete l.iauthor})}),pe(n,634),pe(n,629),n.end()}function oT(a,n){n.FullPaths.forEach(function(t,s){if(s!=0){var l=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");l.slice(-1)!=="/"&&ht.utils.cfb_add(a,l,n.FileIndex[s].content)}})}var zg=["xlsb","xlsm","xlam","biff8","xla"],uT=(function(){var a=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(s,l,u,f){var h=!1,g=!1;u.length==0?g=!0:u.charAt(0)=="["&&(g=!0,u=u.slice(1,-1)),f.length==0?h=!0:f.charAt(0)=="["&&(h=!0,f=f.slice(1,-1));var m=u.length>0?parseInt(u,10)|0:0,p=f.length>0?parseInt(f,10)|0:0;return h?p+=n.c:--p,g?m+=n.r:--m,l+(h?"":"$")+ia(p)+(g?"":"$")+ta(m)}return function(l,u){return n=u,l.replace(a,t)}})(),Uf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Of=(function(){return function(n,t){return n.replace(Uf,function(s,l,u,f,h,g){var m=Nf(f)-(u?0:t.c),p=bf(g)-(h?0:t.r),S=p==0?"":h?p+1:"["+p+"]",x=m==0?"":u?m+1:"["+m+"]";return l+"R"+S+"C"+x})}})();function fT(a,n){return a.replace(Uf,function(t,s,l,u,f,h){return s+(l=="$"?l+u:ia(Nf(u)+n.c))+(f=="$"?f+h:ta(bf(h)+n.r))})}function dT(a){return a.length!=1}function Ot(a){a.l+=1}function br(a,n){var t=a.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Hg(a,n,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return Gg(a);t.biff==12&&(s=4)}var l=a.read_shift(s),u=a.read_shift(s),f=br(a),h=br(a);return{s:{r:l,c:f[0],cRel:f[1],rRel:f[2]},e:{r:u,c:h[0],cRel:h[1],rRel:h[2]}}}function Gg(a){var n=br(a),t=br(a),s=a.read_shift(1),l=a.read_shift(1);return{s:{r:n[0],c:s,cRel:n[1],rRel:n[2]},e:{r:t[0],c:l,cRel:t[1],rRel:t[2]}}}function hT(a,n,t){if(t.biff<8)return Gg(a);var s=a.read_shift(t.biff==12?4:2),l=a.read_shift(t.biff==12?4:2),u=br(a),f=br(a);return{s:{r:s,c:u[0],cRel:u[1],rRel:u[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function Wg(a,n,t){if(t&&t.biff>=2&&t.biff<=5)return mT(a);var s=a.read_shift(t&&t.biff==12?4:2),l=br(a);return{r:s,c:l[0],cRel:l[1],rRel:l[2]}}function mT(a){var n=br(a),t=a.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function vT(a){var n=a.read_shift(2),t=a.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function gT(a,n,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return pT(a);var l=a.read_shift(s>=12?4:2),u=a.read_shift(2),f=(u&16384)>>14,h=(u&32768)>>15;if(u&=16383,h==1)for(;l>524287;)l-=1048576;if(f==1)for(;u>8191;)u=u-16384;return{r:l,c:u,cRel:f,rRel:h}}function pT(a){var n=a.read_shift(2),t=a.read_shift(1),s=(n&32768)>>15,l=(n&16384)>>14;return n&=16383,s==1&&n>=8192&&(n=n-16384),l==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:l,rRel:s}}function xT(a,n,t){var s=(a[a.l++]&96)>>5,l=Hg(a,t.biff>=2&&t.biff<=5?6:8,t);return[s,l]}function ST(a,n,t){var s=(a[a.l++]&96)>>5,l=a.read_shift(2,"i"),u=8;if(t)switch(t.biff){case 5:a.l+=12,u=6;break;case 12:u=12;break}var f=Hg(a,u,t);return[s,l,f]}function yT(a,n,t){var s=(a[a.l++]&96)>>5;return a.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}function CT(a,n,t){var s=(a[a.l++]&96)>>5,l=a.read_shift(2),u=8;if(t)switch(t.biff){case 5:a.l+=12,u=6;break;case 12:u=12;break}return a.l+=u,[s,l]}function TT(a,n,t){var s=(a[a.l++]&96)>>5,l=hT(a,n-1,t);return[s,l]}function ET(a,n,t){var s=(a[a.l++]&96)>>5;return a.l+=t.biff==2?6:t.biff==12?14:7,[s]}function pv(a){var n=a[a.l+1]&1,t=1;return a.l+=4,[n,t]}function _T(a,n,t){a.l+=2;for(var s=a.read_shift(t&&t.biff==2?1:2),l=[],u=0;u<=s;++u)l.push(a.read_shift(t&&t.biff==2?1:2));return l}function wT(a,n,t){var s=a[a.l+1]&255?1:0;return a.l+=2,[s,a.read_shift(t&&t.biff==2?1:2)]}function bT(a,n,t){var s=a[a.l+1]&255?1:0;return a.l+=2,[s,a.read_shift(t&&t.biff==2?1:2)]}function NT(a){var n=a[a.l+1]&255?1:0;return a.l+=2,[n,a.read_shift(2)]}function AT(a,n,t){var s=a[a.l+1]&255?1:0;return a.l+=t&&t.biff==2?3:4,[s]}function Vg(a){var n=a.read_shift(1),t=a.read_shift(1);return[n,t]}function DT(a){return a.read_shift(2),Vg(a)}function MT(a){return a.read_shift(2),Vg(a)}function jT(a,n,t){var s=(a[a.l]&96)>>5;a.l+=1;var l=Wg(a,0,t);return[s,l]}function kT(a,n,t){var s=(a[a.l]&96)>>5;a.l+=1;var l=gT(a,0,t);return[s,l]}function UT(a,n,t){var s=(a[a.l]&96)>>5;a.l+=1;var l=a.read_shift(2);t&&t.biff==5&&(a.l+=12);var u=Wg(a,0,t);return[s,l,u]}function OT(a,n,t){var s=(a[a.l]&96)>>5;a.l+=1;var l=a.read_shift(t&&t.biff<=3?1:2);return[OE[l],Jg[l],s]}function IT(a,n,t){var s=a[a.l++],l=a.read_shift(1),u=t&&t.biff<=3?[s==88?-1:0,a.read_shift(1)]:RT(a);return[l,(u[0]===0?Jg:UE)[u[1]]]}function RT(a){return[a[a.l+1]>>7,a.read_shift(2)&32767]}function FT(a,n,t){a.l+=t&&t.biff==2?3:4}function LT(a,n,t){if(a.l++,t&&t.biff==12)return[a.read_shift(4,"i"),0];var s=a.read_shift(2),l=a.read_shift(t&&t.biff==2?1:2);return[s,l]}function BT(a){return a.l++,jl[a.read_shift(1)]}function KT(a){return a.l++,a.read_shift(2)}function PT(a){return a.l++,a.read_shift(1)!==0}function zT(a){return a.l++,fi(a)}function HT(a,n,t){return a.l++,Ag(a,n-1,t)}function GT(a,n){var t=[a.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Uy(a,1)?"TRUE":"FALSE",n!=12&&(a.l+=7);break;case 37:case 16:t[1]=jl[a[a.l]],a.l+=n==12?4:8;break;case 0:a.l+=8;break;case 1:t[1]=fi(a);break;case 2:t[1]=Fy(a,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function WT(a,n,t){for(var s=a.read_shift(t.biff==12?4:2),l=[],u=0;u!=s;++u)l.push((t.biff==12?is:Ky)(a));return l}function VT(a,n,t){var s=0,l=0;t.biff==12?(s=a.read_shift(4),l=a.read_shift(4)):(l=1+a.read_shift(1),s=1+a.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,--l==0&&(l=256));for(var u=0,f=[];u!=s&&(f[u]=[]);++u)for(var h=0;h!=l;++h)f[u][h]=GT(a,t.biff);return f}function YT(a,n,t){var s=a.read_shift(1)>>>5&3,l=!t||t.biff>=8?4:2,u=a.read_shift(l);switch(t.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12;break}return[s,0,u]}function XT(a,n,t){if(t.biff==5)return JT(a);var s=a.read_shift(1)>>>5&3,l=a.read_shift(2),u=a.read_shift(4);return[s,l,u]}function JT(a){var n=a.read_shift(1)>>>5&3,t=a.read_shift(2,"i");a.l+=8;var s=a.read_shift(2);return a.l+=12,[n,t,s]}function qT(a,n,t){var s=a.read_shift(1)>>>5&3;a.l+=t&&t.biff==2?3:4;var l=a.read_shift(t&&t.biff==2?1:2);return[s,l]}function $T(a,n,t){var s=a.read_shift(1)>>>5&3,l=a.read_shift(t&&t.biff==2?1:2);return[s,l]}function QT(a,n,t){var s=a.read_shift(1)>>>5&3;return a.l+=4,t.biff<8&&a.l--,t.biff==12&&(a.l+=2),[s]}function ZT(a,n,t){var s=(a[a.l++]&96)>>5,l=a.read_shift(2),u=4;if(t)switch(t.biff){case 5:u=15;break;case 12:u=6;break}return a.l+=u,[s,l]}var eE=Tn,tE=Tn,aE=Tn;function kl(a,n,t){return a.l+=2,[vT(a)]}function If(a){return a.l+=6,[]}var nE=kl,rE=If,sE=If,iE=kl;function Yg(a){return a.l+=2,[bg(a),a.read_shift(2)&1]}var lE=kl,cE=Yg,oE=If,uE=kl,fE=kl,dE=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hE(a){a.l+=2;var n=a.read_shift(2),t=a.read_shift(2),s=a.read_shift(4),l=a.read_shift(2),u=a.read_shift(2),f=dE[t>>2&31];return{ixti:n,coltype:t&3,rt:f,idx:s,c:l,C:u}}function mE(a){return a.l+=2,[a.read_shift(4)]}function vE(a,n,t){return a.l+=5,a.l+=2,a.l+=t.biff==2?1:4,["PTGSHEET"]}function gE(a,n,t){return a.l+=t.biff==2?4:5,["PTGENDSHEET"]}function pE(a){var n=a.read_shift(1)>>>5&3,t=a.read_shift(2);return[n,t]}function xE(a){var n=a.read_shift(1)>>>5&3,t=a.read_shift(2);return[n,t]}function SE(a){return a.l+=4,[0,0]}var xv={1:{n:"PtgExp",f:LT},2:{n:"PtgTbl",f:aE},3:{n:"PtgAdd",f:Ot},4:{n:"PtgSub",f:Ot},5:{n:"PtgMul",f:Ot},6:{n:"PtgDiv",f:Ot},7:{n:"PtgPower",f:Ot},8:{n:"PtgConcat",f:Ot},9:{n:"PtgLt",f:Ot},10:{n:"PtgLe",f:Ot},11:{n:"PtgEq",f:Ot},12:{n:"PtgGe",f:Ot},13:{n:"PtgGt",f:Ot},14:{n:"PtgNe",f:Ot},15:{n:"PtgIsect",f:Ot},16:{n:"PtgUnion",f:Ot},17:{n:"PtgRange",f:Ot},18:{n:"PtgUplus",f:Ot},19:{n:"PtgUminus",f:Ot},20:{n:"PtgPercent",f:Ot},21:{n:"PtgParen",f:Ot},22:{n:"PtgMissArg",f:Ot},23:{n:"PtgStr",f:HT},26:{n:"PtgSheet",f:vE},27:{n:"PtgEndSheet",f:gE},28:{n:"PtgErr",f:BT},29:{n:"PtgBool",f:PT},30:{n:"PtgInt",f:KT},31:{n:"PtgNum",f:zT},32:{n:"PtgArray",f:ET},33:{n:"PtgFunc",f:OT},34:{n:"PtgFuncVar",f:IT},35:{n:"PtgName",f:YT},36:{n:"PtgRef",f:jT},37:{n:"PtgArea",f:xT},38:{n:"PtgMemArea",f:qT},39:{n:"PtgMemErr",f:eE},40:{n:"PtgMemNoMem",f:tE},41:{n:"PtgMemFunc",f:$T},42:{n:"PtgRefErr",f:QT},43:{n:"PtgAreaErr",f:yT},44:{n:"PtgRefN",f:kT},45:{n:"PtgAreaN",f:TT},46:{n:"PtgMemAreaN",f:pE},47:{n:"PtgMemNoMemN",f:xE},57:{n:"PtgNameX",f:XT},58:{n:"PtgRef3d",f:UT},59:{n:"PtgArea3d",f:ST},60:{n:"PtgRefErr3d",f:ZT},61:{n:"PtgAreaErr3d",f:CT},255:{}},yE={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},CE={1:{n:"PtgElfLel",f:Yg},2:{n:"PtgElfRw",f:uE},3:{n:"PtgElfCol",f:nE},6:{n:"PtgElfRwV",f:fE},7:{n:"PtgElfColV",f:iE},10:{n:"PtgElfRadical",f:lE},11:{n:"PtgElfRadicalS",f:oE},13:{n:"PtgElfColS",f:rE},15:{n:"PtgElfColSV",f:sE},16:{n:"PtgElfRadicalLel",f:cE},25:{n:"PtgList",f:hE},29:{n:"PtgSxName",f:mE},255:{}},TE={0:{n:"PtgAttrNoop",f:SE},1:{n:"PtgAttrSemi",f:AT},2:{n:"PtgAttrIf",f:bT},4:{n:"PtgAttrChoose",f:_T},8:{n:"PtgAttrGoto",f:wT},16:{n:"PtgAttrSum",f:FT},32:{n:"PtgAttrBaxcel",f:pv},33:{n:"PtgAttrBaxcel",f:pv},64:{n:"PtgAttrSpace",f:DT},65:{n:"PtgAttrSpaceSemi",f:MT},128:{n:"PtgAttrIfError",f:NT},255:{}};function EE(a,n,t,s){if(s.biff<8)return Tn(a,n);for(var l=a.l+n,u=[],f=0;f!==t.length;++f)switch(t[f][0]){case"PtgArray":t[f][1]=VT(a,0,s),u.push(t[f][1]);break;case"PtgMemArea":t[f][2]=WT(a,t[f][1],s),u.push(t[f][2]);break;case"PtgExp":s&&s.biff==12&&(t[f][1][1]=a.read_shift(4),u.push(t[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[f][0]}return n=l-a.l,n!==0&&u.push(Tn(a,n)),u}function _E(a,n,t){for(var s=a.l+n,l,u,f=[];s!=a.l;)n=s-a.l,u=a[a.l],l=xv[u]||xv[yE[u]],(u===24||u===25)&&(l=(u===24?CE:TE)[a[a.l+1]]),!l||!l.f?Tn(a,n):f.push([l.n,l.f(a,n,t)]);return f}function wE(a){for(var n=[],t=0;t<a.length;++t){for(var s=a[t],l=[],u=0;u<s.length;++u){var f=s[u];if(f)switch(f[0]){case 2:l.push('"'+f[1].replace(/"/g,'""')+'"');break;default:l.push(f[1])}else l.push("")}n.push(l.join(","))}return n.join(";")}var bE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function NE(a,n){if(!a&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(a)?"'"+a+"'":a}function Xg(a,n,t){if(!a)return"SH33TJSERR0";if(t.biff>8&&(!a.XTI||!a.XTI[n]))return a.SheetNames[n];if(!a.XTI)return"SH33TJSERR6";var s=a.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":a.XTI[n-1];if(!s)return"SH33TJSERR1";var l="";if(t.biff>8)switch(a[s[0]][0]){case 357:return l=s[1]==-1?"#REF":a.SheetNames[s[1]],s[1]==s[2]?l:l+":"+a.SheetNames[s[2]];case 358:return t.SID!=null?a.SheetNames[t.SID]:"SH33TJSSAME"+a[s[0]][0];case 355:default:return"SH33TJSSRC"+a[s[0]][0]}switch(a[s[0]][0][0]){case 1025:return l=s[1]==-1?"#REF":a.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?l:l+":"+a.SheetNames[s[2]];case 14849:return a[s[0]].slice(1).map(function(u){return u.Name}).join(";;");default:return a[s[0]][0][3]?(l=s[1]==-1?"#REF":a[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?l:l+":"+a[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Sv(a,n,t){var s=Xg(a,n,t);return s=="#REF"?s:NE(s,t)}function li(a,n,t,s,l){var u=l&&l.biff||8,f={s:{c:0,r:0}},h=[],g,m,p,S=0,x=0,C,T="";if(!a[0]||!a[0][0])return"";for(var y=-1,_="",w=0,k=a[0].length;w<k;++w){var D=a[0][w];switch(D[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=h.pop(),m=h.pop(),y>=0){switch(a[0][y][1][0]){case 0:_=bt(" ",a[0][y][1][1]);break;case 1:_=bt("\r",a[0][y][1][1]);break;default:if(_="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][y][1][0])}m=m+_,y=-1}h.push(m+bE[D[0]]+g);break;case"PtgIsect":g=h.pop(),m=h.pop(),h.push(m+" "+g);break;case"PtgUnion":g=h.pop(),m=h.pop(),h.push(m+","+g);break;case"PtgRange":g=h.pop(),m=h.pop(),h.push(m+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=xl(D[1][1],f,l),h.push(Sl(p,u));break;case"PtgRefN":p=t?xl(D[1][1],t,l):D[1][1],h.push(Sl(p,u));break;case"PtgRef3d":S=D[1][1],p=xl(D[1][2],f,l),T=Sv(s,S,l),h.push(T+"!"+Sl(p,u));break;case"PtgFunc":case"PtgFuncVar":var b=D[1][0],K=D[1][1];b||(b=0),b&=127;var q=b==0?[]:h.slice(-b);h.length-=b,K==="User"&&(K=q.shift()),h.push(K+"("+q.join(",")+")");break;case"PtgBool":h.push(D[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(D[1]);break;case"PtgNum":h.push(String(D[1]));break;case"PtgStr":h.push('"'+D[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(D[1]);break;case"PtgAreaN":C=nv(D[1][1],t?{s:t}:f,l),h.push(nf(C,l));break;case"PtgArea":C=nv(D[1][1],f,l),h.push(nf(C,l));break;case"PtgArea3d":S=D[1][1],C=D[1][2],T=Sv(s,S,l),h.push(T+"!"+nf(C,l));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=D[1][2];var B=(s.names||[])[x-1]||(s[0]||[])[x],Z=B?B.Name:"SH33TJSNAME"+String(x);Z&&Z.slice(0,6)=="_xlfn."&&!l.xlfn&&(Z=Z.slice(6)),h.push(Z);break;case"PtgNameX":var L=D[1][1];x=D[1][2];var X;if(l.biff<=5)L<0&&(L=-L),s[L]&&(X=s[L][x]);else{var M="";if(((s[L]||[])[0]||[])[0]==14849||(((s[L]||[])[0]||[])[0]==1025?s[L][x]&&s[L][x].itab>0&&(M=s.SheetNames[s[L][x].itab-1]+"!"):M=s.SheetNames[x-1]+"!"),s[L]&&s[L][x])M+=s[L][x].Name;else if(s[0]&&s[0][x])M+=s[0][x].Name;else{var H=(Xg(s,L,l)||"").split(";;");H[x-1]?M=H[x-1]:M+="SH33TJSERRX"}h.push(M);break}X||(X={Name:"SH33TJSERRY"}),h.push(X.Name);break;case"PtgParen":var ue="(",be=")";if(y>=0){switch(_="",a[0][y][1][0]){case 2:ue=bt(" ",a[0][y][1][1])+ue;break;case 3:ue=bt("\r",a[0][y][1][1])+ue;break;case 4:be=bt(" ",a[0][y][1][1])+be;break;case 5:be=bt("\r",a[0][y][1][1])+be;break;default:if(l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][y][1][0])}y=-1}h.push(ue+h.pop()+be);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":p={c:D[1][1],r:D[1][0]};var Se={c:t.c,r:t.r};if(s.sharedf[ot(p)]){var ee=s.sharedf[ot(p)];h.push(li(ee,f,Se,s,l))}else{var ge=!1;for(g=0;g!=s.arrayf.length;++g)if(m=s.arrayf[g],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){h.push(li(m[1],f,Se,s,l)),ge=!0;break}ge||h.push(D[1])}break;case"PtgArray":h.push("{"+wE(D[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+D[1].idx+"[#"+D[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(D));default:throw new Error("Unrecognized Formula Token: "+String(D))}var ke=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(l.biff!=3&&y>=0&&ke.indexOf(a[0][w][0])==-1){D=a[0][y];var Ne=!0;switch(D[1][0]){case 4:Ne=!1;case 0:_=bt(" ",D[1][1]);break;case 5:Ne=!1;case 1:_=bt("\r",D[1][1]);break;default:if(_="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+D[1][0])}h.push((Ne?_:"")+h.pop()+(Ne?"":_)),y=-1}}if(h.length>1&&l.WTF)throw new Error("bad formula stack");return h[0]}function AE(a){if(a==null){var n=fe(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof a=="number")return es(a);return es(0)}function DE(a,n,t,s,l){var u=ts(n,t,l),f=AE(a.v),h=fe(6),g=33;h.write_shift(2,g),h.write_shift(4,0);for(var m=fe(a.bf.length),p=0;p<a.bf.length;++p)m[p]=a.bf[p];var S=Zt([u,f,h,m]);return S}function Uo(a,n,t){var s=a.read_shift(4),l=_E(a,s,t),u=a.read_shift(4),f=u>0?EE(a,u,l,t):null;return[l,f]}var ME=Uo,Oo=Uo,jE=Uo,kE=Uo,UE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Jg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},OE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function IE(a){var n="of:="+a.replace(Uf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function RE(a){return a.replace(/\./,"!")}var yl=typeof Map<"u";function Rf(a,n,t){var s=0,l=a.length;if(t){if(yl?t.has(n):Object.prototype.hasOwnProperty.call(t,n)){for(var u=yl?t.get(n):t[n];s<u.length;++s)if(a[u[s]].t===n)return a.Count++,u[s]}}else for(;s<l;++s)if(a[s].t===n)return a.Count++,s;return a[l]={t:n},a.Count++,a.Unique++,t&&(yl?(t.has(n)||t.set(n,[]),t.get(n).push(l)):(Object.prototype.hasOwnProperty.call(t,n)||(t[n]=[]),t[n].push(l))),l}function Io(a,n){var t={min:a+1,max:a+1},s=-1;return n.MDW&&(Wn=n.MDW),n.width!=null?t.customWidth=1:n.wpx!=null?s=Co(n.wpx):n.wch!=null&&(s=n.wch),s>-1?(t.width=vf(s),t.customWidth=1):n.width!=null&&(t.width=n.width),n.hidden&&(t.hidden=!0),n.level!=null&&(t.outlineLevel=t.level=n.level),t}function qg(a,n){if(a){var t=[.7,.7,.75,.75,.3,.3];a.left==null&&(a.left=t[0]),a.right==null&&(a.right=t[1]),a.top==null&&(a.top=t[2]),a.bottom==null&&(a.bottom=t[3]),a.header==null&&(a.header=t[4]),a.footer==null&&(a.footer=t[5])}}function Ar(a,n,t){var s=t.revssf[n.z!=null?n.z:"General"],l=60,u=a.length;if(s==null&&t.ssf){for(;l<392;++l)if(t.ssf[l]==null){Wv(n.z,l),t.ssf[l]=n.z,t.revssf[n.z]=s=l;break}}for(l=0;l!=u;++l)if(a[l].numFmtId===s)return l;return a[u]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},u}function FE(a,n,t){if(a&&a["!ref"]){var s=yt(a["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+t+"): "+a["!ref"])}}function LE(a){if(a.length===0)return"";for(var n='<mergeCells count="'+a.length+'">',t=0;t!=a.length;++t)n+='<mergeCell ref="'+It(a[t])+'"/>';return n+"</mergeCells>"}function BE(a,n,t,s,l){var u=!1,f={},h=null;if(s.bookType!=="xlsx"&&n.vbaraw){var g=n.SheetNames[t];try{n.Workbook&&(g=n.Workbook.Sheets[t].CodeName||g)}catch{}u=!0,f.codeName=_l(ct(g))}if(a&&a["!outline"]){var m={summaryBelow:1,summaryRight:1};a["!outline"].above&&(m.summaryBelow=0),a["!outline"].left&&(m.summaryRight=0),h=(h||"")+Ee("outlinePr",null,m)}!u&&!h||(l[l.length]=Ee("sheetPr",h,f))}var KE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],PE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function zE(a){var n={sheet:1};return KE.forEach(function(t){a[t]!=null&&a[t]&&(n[t]="1")}),PE.forEach(function(t){a[t]!=null&&!a[t]&&(n[t]="0")}),a.password&&(n.password=Ug(a.password).toString(16).toUpperCase()),Ee("sheetProtection",null,n)}function HE(a){return qg(a),Ee("pageMargins",null,a)}function GE(a,n){for(var t=["<cols>"],s,l=0;l!=n.length;++l)(s=n[l])&&(t[t.length]=Ee("col",null,Io(l,s)));return t[t.length]="</cols>",t.join("")}function WE(a,n,t,s){var l=typeof a.ref=="string"?a.ref:It(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,f=Fa(l);f.s.r==f.e.r&&(f.e.r=Fa(n["!ref"]).e.r,l=It(f));for(var h=0;h<u.length;++h){var g=u[h];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==s){g.Ref="'"+t.SheetNames[s]+"'!"+l;break}}return h==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+l}),Ee("autoFilter",null,{ref:l})}function VE(a,n,t,s){var l={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(l.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Ee("sheetViews",Ee("sheetView",null,l),{})}function YE(a,n,t,s){if(a.c&&t["!comments"].push([n,a.c]),a.v===void 0&&typeof a.f!="string"||a.t==="z"&&!a.f)return"";var l="",u=a.t,f=a.v;if(a.t!=="z")switch(a.t){case"b":l=a.v?"1":"0";break;case"n":l=""+a.v;break;case"e":l=jl[a.v];break;case"d":s&&s.cellDates?l=ha(a.v,-1).toISOString():(a=Ea(a),a.t="n",l=""+(a.v=Ta(ha(a.v)))),typeof a.z>"u"&&(a.z=Nt[14]);break;default:l=a.v;break}var h=ea("v",ct(l)),g={r:n},m=Ar(s.cellXfs,a,s);switch(m!==0&&(g.s=m),a.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(a.v==null){delete a.t;break}if(a.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){h=ea("v",""+Rf(s.Strings,a.v,s.revStrings)),g.t="s";break}g.t="str";break}if(a.t!=u&&(a.t=u,a.v=f),typeof a.f=="string"&&a.f){var p=a.F&&a.F.slice(0,n.length)==n?{t:"array",ref:a.F}:null;h=Ee("f",ct(a.f),p)+(a.v!=null?h:"")}return a.l&&t["!links"].push([n,a.l]),a.D&&(g.cm=1),Ee("c",h,g)}function XE(a,n,t,s){var l=[],u=[],f=yt(a["!ref"]),h="",g,m="",p=[],S=0,x=0,C=a["!rows"],T=Array.isArray(a),y={r:m},_,w=-1;for(x=f.s.c;x<=f.e.c;++x)p[x]=ia(x);for(S=f.s.r;S<=f.e.r;++S){for(u=[],m=ta(S),x=f.s.c;x<=f.e.c;++x){g=p[x]+m;var k=T?(a[S]||[])[x]:a[g];k!==void 0&&(h=YE(k,g,a,n))!=null&&u.push(h)}(u.length>0||C&&C[S])&&(y={r:m},C&&C[S]&&(_=C[S],_.hidden&&(y.hidden=1),w=-1,_.hpx?w=To(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(y.ht=w,y.customHeight=1),_.level&&(y.outlineLevel=_.level)),l[l.length]=Ee("row",u.join(""),y))}if(C)for(;S<C.length;++S)C&&C[S]&&(y={r:S+1},_=C[S],_.hidden&&(y.hidden=1),w=-1,_.hpx?w=To(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(y.ht=w,y.customHeight=1),_.level&&(y.outlineLevel=_.level),l[l.length]=Ee("row","",y));return l.join("")}function $g(a,n,t,s){var l=[Rt,Ee("worksheet",null,{xmlns:ci[0],"xmlns:r":zt.r})],u=t.SheetNames[a],f=0,h="",g=t.Sheets[u];g==null&&(g={});var m=g["!ref"]||"A1",p=yt(m);if(p.e.c>16383||p.e.r>1048575){if(n.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),m=It(p)}s||(s={}),g["!comments"]=[];var S=[];BE(g,t,a,n,l),l[l.length]=Ee("dimension",null,{ref:m}),l[l.length]=VE(g,n,a,t),n.sheetFormat&&(l[l.length]=Ee("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(l[l.length]=GE(g,g["!cols"])),l[f=l.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(h=XE(g,n),h.length>0&&(l[l.length]=h)),l.length>f+1&&(l[l.length]="</sheetData>",l[f]=l[f].replace("/>",">")),g["!protect"]&&(l[l.length]=zE(g["!protect"])),g["!autofilter"]!=null&&(l[l.length]=WE(g["!autofilter"],g,t,a)),g["!merges"]!=null&&g["!merges"].length>0&&(l[l.length]=LE(g["!merges"]));var x=-1,C,T=-1;return g["!links"].length>0&&(l[l.length]="<hyperlinks>",g["!links"].forEach(function(y){y[1].Target&&(C={ref:y[0]},y[1].Target.charAt(0)!="#"&&(T=lt(s,-1,ct(y[1].Target).replace(/#.*$/,""),tt.HLINK),C["r:id"]="rId"+T),(x=y[1].Target.indexOf("#"))>-1&&(C.location=ct(y[1].Target.slice(x+1))),y[1].Tooltip&&(C.tooltip=ct(y[1].Tooltip)),l[l.length]=Ee("hyperlink",null,C))}),l[l.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(l[l.length]=HE(g["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(l[l.length]=ea("ignoredErrors",Ee("ignoredError",null,{numberStoredAsText:1,sqref:m}))),S.length>0&&(T=lt(s,-1,"../drawings/drawing"+(a+1)+".xml",tt.DRAW),l[l.length]=Ee("drawing",null,{"r:id":"rId"+T}),g["!drawing"]=S),g["!comments"].length>0&&(T=lt(s,-1,"../drawings/vmlDrawing"+(a+1)+".vml",tt.VML),l[l.length]=Ee("legacyDrawing",null,{"r:id":"rId"+T}),g["!legacy"]=T),l.length>1&&(l[l.length]="</worksheet>",l[1]=l[1].replace("/>",">")),l.join("")}function JE(a,n){var t={},s=a.l+n;t.r=a.read_shift(4),a.l+=4;var l=a.read_shift(2);a.l+=1;var u=a.read_shift(1);return a.l=s,u&7&&(t.level=u&7),u&16&&(t.hidden=!0),u&32&&(t.hpt=l/20),t}function qE(a,n,t){var s=fe(145),l=(t["!rows"]||[])[a]||{};s.write_shift(4,a),s.write_shift(4,0);var u=320;l.hpx?u=To(l.hpx)*20:l.hpt&&(u=l.hpt*20),s.write_shift(2,u),s.write_shift(1,0);var f=0;l.level&&(f|=l.level),l.hidden&&(f|=16),(l.hpx||l.hpt)&&(f|=32),s.write_shift(1,f),s.write_shift(1,0);var h=0,g=s.l;s.l+=4;for(var m={r:a,c:0},p=0;p<16;++p)if(!(n.s.c>p+1<<10||n.e.c<p<<10)){for(var S=-1,x=-1,C=p<<10;C<p+1<<10;++C){m.c=C;var T=Array.isArray(t)?(t[m.r]||[])[m.c]:t[ot(m)];T&&(S<0&&(S=C),x=C)}S<0||(++h,s.write_shift(4,S),s.write_shift(4,x))}var y=s.l;return s.l=g,s.write_shift(4,h),s.l=y,s.length>s.l?s.slice(0,s.l):s}function $E(a,n,t,s){var l=qE(s,t,n);(l.length>17||(n["!rows"]||[])[s])&&pe(a,0,l)}var QE=is,ZE=ui;function e_(){}function t_(a,n){var t={},s=a[a.l];return++a.l,t.above=!(s&64),t.left=!(s&128),a.l+=18,t.name=fy(a),t}function a_(a,n,t){t==null&&(t=fe(84+4*a.length));var s=192;n&&(n.above&&(s&=-65),n.left&&(s&=-129)),t.write_shift(1,s);for(var l=1;l<3;++l)t.write_shift(1,0);return xo({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),dg(a,t),t.slice(0,t.l)}function n_(a){var n=Za(a);return[n]}function r_(a,n,t){return t==null&&(t=fe(8)),ns(n,t)}function s_(a){var n=rs(a);return[n]}function i_(a,n,t){return t==null&&(t=fe(4)),ss(n,t)}function l_(a){var n=Za(a),t=a.read_shift(1);return[n,t,"b"]}function c_(a,n,t){return t==null&&(t=fe(9)),ns(n,t),t.write_shift(1,a.v?1:0),t}function o_(a){var n=rs(a),t=a.read_shift(1);return[n,t,"b"]}function u_(a,n,t){return t==null&&(t=fe(5)),ss(n,t),t.write_shift(1,a.v?1:0),t}function f_(a){var n=Za(a),t=a.read_shift(1);return[n,t,"e"]}function d_(a,n,t){return t==null&&(t=fe(9)),ns(n,t),t.write_shift(1,a.v),t}function h_(a){var n=rs(a),t=a.read_shift(1);return[n,t,"e"]}function m_(a,n,t){return t==null&&(t=fe(8)),ss(n,t),t.write_shift(1,a.v),t.write_shift(2,0),t.write_shift(1,0),t}function v_(a){var n=Za(a),t=a.read_shift(4);return[n,t,"s"]}function g_(a,n,t){return t==null&&(t=fe(12)),ns(n,t),t.write_shift(4,n.v),t}function p_(a){var n=rs(a),t=a.read_shift(4);return[n,t,"s"]}function x_(a,n,t){return t==null&&(t=fe(8)),ss(n,t),t.write_shift(4,n.v),t}function S_(a){var n=Za(a),t=fi(a);return[n,t,"n"]}function y_(a,n,t){return t==null&&(t=fe(16)),ns(n,t),es(a.v,t),t}function C_(a){var n=rs(a),t=fi(a);return[n,t,"n"]}function T_(a,n,t){return t==null&&(t=fe(12)),ss(n,t),es(a.v,t),t}function E_(a){var n=Za(a),t=hg(a);return[n,t,"n"]}function __(a,n,t){return t==null&&(t=fe(12)),ns(n,t),mg(a.v,t),t}function w_(a){var n=rs(a),t=hg(a);return[n,t,"n"]}function b_(a,n,t){return t==null&&(t=fe(8)),ss(n,t),mg(a.v,t),t}function N_(a){var n=Za(a),t=Af(a);return[n,t,"is"]}function A_(a){var n=Za(a),t=la(a);return[n,t,"str"]}function D_(a,n,t){return t==null&&(t=fe(12+4*a.v.length)),ns(n,t),Gt(a.v,t),t.length>t.l?t.slice(0,t.l):t}function M_(a){var n=rs(a),t=la(a);return[n,t,"str"]}function j_(a,n,t){return t==null&&(t=fe(8+4*a.v.length)),ss(n,t),Gt(a.v,t),t.length>t.l?t.slice(0,t.l):t}function k_(a,n,t){var s=a.l+n,l=Za(a);l.r=t["!row"];var u=a.read_shift(1),f=[l,u,"b"];if(t.cellFormula){a.l+=2;var h=Oo(a,s-a.l,t);f[3]=li(h,null,l,t.supbooks,t)}else a.l=s;return f}function U_(a,n,t){var s=a.l+n,l=Za(a);l.r=t["!row"];var u=a.read_shift(1),f=[l,u,"e"];if(t.cellFormula){a.l+=2;var h=Oo(a,s-a.l,t);f[3]=li(h,null,l,t.supbooks,t)}else a.l=s;return f}function O_(a,n,t){var s=a.l+n,l=Za(a);l.r=t["!row"];var u=fi(a),f=[l,u,"n"];if(t.cellFormula){a.l+=2;var h=Oo(a,s-a.l,t);f[3]=li(h,null,l,t.supbooks,t)}else a.l=s;return f}function I_(a,n,t){var s=a.l+n,l=Za(a);l.r=t["!row"];var u=la(a),f=[l,u,"str"];if(t.cellFormula){a.l+=2;var h=Oo(a,s-a.l,t);f[3]=li(h,null,l,t.supbooks,t)}else a.l=s;return f}var R_=is,F_=ui;function L_(a,n){return n==null&&(n=fe(4)),n.write_shift(4,a),n}function B_(a,n){var t=a.l+n,s=is(a),l=Df(a),u=la(a),f=la(a),h=la(a);a.l=t;var g={rfx:s,relId:l,loc:u,display:h};return f&&(g.Tooltip=f),g}function K_(a,n){var t=fe(50+4*(a[1].Target.length+(a[1].Tooltip||"").length));ui({s:Ht(a[0]),e:Ht(a[0])},t),Mf("rId"+n,t);var s=a[1].Target.indexOf("#"),l=s==-1?"":a[1].Target.slice(s+1);return Gt(l||"",t),Gt(a[1].Tooltip||"",t),Gt("",t),t.slice(0,t.l)}function P_(){}function z_(a,n,t){var s=a.l+n,l=vg(a),u=a.read_shift(1),f=[l];if(f[2]=u,t.cellFormula){var h=ME(a,s-a.l,t);f[1]=h}else a.l=s;return f}function H_(a,n,t){var s=a.l+n,l=is(a),u=[l];if(t.cellFormula){var f=kE(a,s-a.l,t);u[1]=f,a.l=s}else a.l=s;return u}function G_(a,n,t){t==null&&(t=fe(18));var s=Io(a,n);t.write_shift(-4,a),t.write_shift(-4,a),t.write_shift(4,(s.width||10)*256),t.write_shift(4,0);var l=0;return n.hidden&&(l|=1),typeof s.width=="number"&&(l|=2),n.level&&(l|=n.level<<8),t.write_shift(2,l),t}var Qg=["left","right","top","bottom","header","footer"];function W_(a){var n={};return Qg.forEach(function(t){n[t]=fi(a)}),n}function V_(a,n){return n==null&&(n=fe(48)),qg(a),Qg.forEach(function(t){es(a[t],n)}),n}function Y_(a){var n=a.read_shift(2);return a.l+=28,{RTL:n&32}}function X_(a,n,t){t==null&&(t=fe(30));var s=924;return(((n||{}).Views||[])[0]||{}).RTL&&(s|=32),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function J_(a){var n=fe(24);return n.write_shift(4,4),n.write_shift(4,1),ui(a,n),n}function q_(a,n){return n==null&&(n=fe(66)),n.write_shift(2,a.password?Ug(a.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?n.write_shift(4,a[t[0]]!=null&&!a[t[0]]?1:0):n.write_shift(4,a[t[0]]!=null&&a[t[0]]?0:1)}),n}function $_(){}function Q_(){}function Z_(a,n,t,s,l,u,f){if(n.v===void 0)return!1;var h="";switch(n.t){case"b":h=n.v?"1":"0";break;case"d":n=Ea(n),n.z=n.z||Nt[14],n.v=Ta(ha(n.v)),n.t="n";break;case"n":case"e":h=""+n.v;break;default:h=n.v;break}var g={r:t,c:s};switch(g.s=Ar(l.cellXfs,n,l),n.l&&u["!links"].push([ot(g),n.l]),n.c&&u["!comments"].push([ot(g),n.c]),n.t){case"s":case"str":return l.bookSST?(h=Rf(l.Strings,n.v,l.revStrings),g.t="s",g.v=h,f?pe(a,18,x_(n,g)):pe(a,7,g_(n,g))):(g.t="str",f?pe(a,17,j_(n,g)):pe(a,6,D_(n,g))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?f?pe(a,13,b_(n,g)):pe(a,2,__(n,g)):f?pe(a,16,T_(n,g)):pe(a,5,y_(n,g)),!0;case"b":return g.t="b",f?pe(a,15,u_(n,g)):pe(a,4,c_(n,g)),!0;case"e":return g.t="e",f?pe(a,14,m_(n,g)):pe(a,3,d_(n,g)),!0}return f?pe(a,12,i_(n,g)):pe(a,1,r_(n,g)),!0}function ew(a,n,t,s){var l=yt(n["!ref"]||"A1"),u,f="",h=[];pe(a,145);var g=Array.isArray(n),m=l.e.r;n["!rows"]&&(m=Math.max(l.e.r,n["!rows"].length-1));for(var p=l.s.r;p<=m;++p){f=ta(p),$E(a,n,l,p);var S=!1;if(p<=l.e.r)for(var x=l.s.c;x<=l.e.c;++x){p===l.s.r&&(h[x]=ia(x)),u=h[x]+f;var C=g?(n[p]||[])[x]:n[u];if(!C){S=!1;continue}S=Z_(a,C,p,x,s,n,S)}}pe(a,146)}function tw(a,n){!n||!n["!merges"]||(pe(a,177,L_(n["!merges"].length)),n["!merges"].forEach(function(t){pe(a,176,F_(t))}),pe(a,178))}function aw(a,n){!n||!n["!cols"]||(pe(a,390),n["!cols"].forEach(function(t,s){t&&pe(a,60,G_(s,t))}),pe(a,391))}function nw(a,n){!n||!n["!ref"]||(pe(a,648),pe(a,649,J_(yt(n["!ref"]))),pe(a,650))}function rw(a,n,t){n["!links"].forEach(function(s){if(s[1].Target){var l=lt(t,-1,s[1].Target.replace(/#.*$/,""),tt.HLINK);pe(a,494,K_(s,l))}}),delete n["!links"]}function sw(a,n,t,s){if(n["!comments"].length>0){var l=lt(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",tt.VML);pe(a,551,Mf("rId"+l)),n["!legacy"]=l}}function iw(a,n,t,s){if(n["!autofilter"]){var l=n["!autofilter"],u=typeof l.ref=="string"?l.ref:It(l.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,h=Fa(u);h.s.r==h.e.r&&(h.e.r=Fa(n["!ref"]).e.r,u=It(h));for(var g=0;g<f.length;++g){var m=f[g];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==s){m.Ref="'"+t.SheetNames[s]+"'!"+u;break}}g==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+u}),pe(a,161,ui(yt(u))),pe(a,162)}}function lw(a,n,t){pe(a,133),pe(a,137,X_(n,t)),pe(a,138),pe(a,134)}function cw(a,n){n["!protect"]&&pe(a,535,q_(n["!protect"]))}function ow(a,n,t,s){var l=Ca(),u=t.SheetNames[a],f=t.Sheets[u]||{},h=u;try{t&&t.Workbook&&(h=t.Workbook.Sheets[a].CodeName||h)}catch{}var g=yt(f["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(n.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return f["!links"]=[],f["!comments"]=[],pe(l,129),(t.vbaraw||f["!outline"])&&pe(l,147,a_(h,f["!outline"])),pe(l,148,ZE(g)),lw(l,f,t.Workbook),aw(l,f),ew(l,f,a,n),cw(l,f),iw(l,f,t,a),tw(l,f),rw(l,f,s),f["!margins"]&&pe(l,476,V_(f["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&nw(l,f),sw(l,f,a,s),pe(l,130),l.end()}function uw(a,n){a.l+=10;var t=la(a);return{name:t}}var fw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function dw(a){return!a.Workbook||!a.Workbook.WBProps?"false":H2(a.Workbook.WBProps.date1904)?"true":"false"}var hw="][*?/\\".split("");function Zg(a,n){if(a.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return hw.forEach(function(s){if(a.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function mw(a,n,t){a.forEach(function(s,l){Zg(s);for(var u=0;u<l;++u)if(s==a[u])throw new Error("Duplicate Sheet Name: "+s);if(t){var f=n&&n[l]&&n[l].CodeName||s;if(f.charCodeAt(0)==95&&f.length>22)throw new Error("Bad Code Name: Worksheet"+f)}})}function vw(a){if(!a||!a.SheetNames||!a.Sheets)throw new Error("Invalid Workbook");if(!a.SheetNames.length)throw new Error("Workbook is empty");var n=a.Workbook&&a.Workbook.Sheets||[];mw(a.SheetNames,n,!!a.vbaraw);for(var t=0;t<a.SheetNames.length;++t)FE(a.Sheets[a.SheetNames[t]],a.SheetNames[t],t)}function ep(a){var n=[Rt];n[n.length]=Ee("workbook",null,{xmlns:ci[0],"xmlns:r":zt.r});var t=a.Workbook&&(a.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(fw.forEach(function(h){a.Workbook.WBProps[h[0]]!=null&&a.Workbook.WBProps[h[0]]!=h[1]&&(s[h[0]]=a.Workbook.WBProps[h[0]])}),a.Workbook.WBProps.CodeName&&(s.codeName=a.Workbook.WBProps.CodeName,delete s.CodeName)),n[n.length]=Ee("workbookPr",null,s);var l=a.Workbook&&a.Workbook.Sheets||[],u=0;if(l&&l[0]&&l[0].Hidden){for(n[n.length]="<bookViews>",u=0;u!=a.SheetNames.length&&!(!l[u]||!l[u].Hidden);++u);u==a.SheetNames.length&&(u=0),n[n.length]='<workbookView firstSheet="'+u+'" activeTab="'+u+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",u=0;u!=a.SheetNames.length;++u){var f={name:ct(a.SheetNames[u].slice(0,31))};if(f.sheetId=""+(u+1),f["r:id"]="rId"+(u+1),l[u])switch(l[u].Hidden){case 1:f.state="hidden";break;case 2:f.state="veryHidden";break}n[n.length]=Ee("sheet",null,f)}return n[n.length]="</sheets>",t&&(n[n.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(h){var g={name:h.Name};h.Comment&&(g.comment=h.Comment),h.Sheet!=null&&(g.localSheetId=""+h.Sheet),h.Hidden&&(g.hidden="1"),h.Ref&&(n[n.length]=Ee("definedName",ct(h.Ref),g))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function gw(a,n){var t={};return t.Hidden=a.read_shift(4),t.iTabID=a.read_shift(4),t.strRelID=mf(a),t.name=la(a),t}function pw(a,n){return n||(n=fe(127)),n.write_shift(4,a.Hidden),n.write_shift(4,a.iTabID),Mf(a.strRelID,n),Gt(a.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function xw(a,n){var t={},s=a.read_shift(4);t.defaultThemeVersion=a.read_shift(4);var l=n>8?la(a):"";return l.length>0&&(t.CodeName=l),t.autoCompressPictures=!!(s&65536),t.backupFile=!!(s&64),t.checkCompatibility=!!(s&4096),t.date1904=!!(s&1),t.filterPrivacy=!!(s&8),t.hidePivotFieldList=!!(s&1024),t.promptedSolutions=!!(s&16),t.publishItems=!!(s&2048),t.refreshAllConnections=!!(s&262144),t.saveExternalLinkValues=!!(s&128),t.showBorderUnselectedTables=!!(s&4),t.showInkAnnotation=!!(s&32),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(s&32768),t.updateLinks=["userSet","never","always"][s>>8&3],t}function Sw(a,n){n||(n=fe(72));var t=0;return a&&a.filterPrivacy&&(t|=8),n.write_shift(4,t),n.write_shift(4,0),dg(a&&a.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function yw(a,n,t){var s=a.l+n;a.l+=4,a.l+=1;var l=a.read_shift(4),u=dy(a),f=jE(a,0,t),h=Df(a);a.l=s;var g={Name:u,Ptg:f};return l<268435455&&(g.Sheet=l),h&&(g.Comment=h),g}function Cw(a,n){pe(a,143);for(var t=0;t!=n.SheetNames.length;++t){var s=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t]&&n.Workbook.Sheets[t].Hidden||0,l={Hidden:s,iTabID:t+1,strRelID:"rId"+(t+1),name:n.SheetNames[t]};pe(a,156,pw(l))}pe(a,144)}function Tw(a,n){n||(n=fe(127));for(var t=0;t!=4;++t)n.write_shift(4,0);return Gt("SheetJS",n),Gt(oo.version,n),Gt(oo.version,n),Gt("7262",n),n.length>n.l?n.slice(0,n.l):n}function Ew(a,n){n||(n=fe(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,a),n.write_shift(4,a);var t=120;return n.write_shift(1,t),n.length>n.l?n.slice(0,n.l):n}function _w(a,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var t=n.Workbook.Sheets,s=0,l=-1,u=-1;s<t.length;++s)!t[s]||!t[s].Hidden&&l==-1?l=s:t[s].Hidden==1&&u==-1&&(u=s);u>l||(pe(a,135),pe(a,158,Ew(l)),pe(a,136))}}function ww(a,n){var t=Ca();return pe(t,131),pe(t,128,Tw()),pe(t,153,Sw(a.Workbook&&a.Workbook.WBProps||null)),_w(t,a),Cw(t,a),pe(t,132),t.end()}function bw(a,n,t){return(n.slice(-4)===".bin"?ww:ep)(a)}function Nw(a,n,t,s,l){return(n.slice(-4)===".bin"?ow:$g)(a,t,s,l)}function Aw(a,n,t){return(n.slice(-4)===".bin"?VC:Rg)(a,t)}function Dw(a,n,t){return(n.slice(-4)===".bin"?SC:kg)(a,t)}function Mw(a,n,t){return(n.slice(-4)===".bin"?cT:Pg)(a)}function jw(a){return(a.slice(-4)===".bin"?eT:Bg)()}function kw(a,n){var t=[];return a.Props&&t.push(Ay(a.Props,n)),a.Custprops&&t.push(Dy(a.Props,a.Custprops)),t.join("")}function Uw(){return""}function Ow(a,n){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(s,l){var u=[];u.push(Ee("NumberFormat",null,{"ss:Format":ct(Nt[s.numFmtId])}));var f={"ss:ID":"s"+(21+l)};t.push(Ee("Style",u.join(""),f))}),Ee("Styles",t.join(""))}function tp(a){return Ee("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+Of(a.Ref,{r:0,c:0})})}function Iw(a){if(!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,t=[],s=0;s<n.length;++s){var l=n[s];l.Sheet==null&&(l.Name.match(/^_xlfn\./)||t.push(tp(l)))}return Ee("Names",t.join(""))}function Rw(a,n,t,s){if(!a||!((s||{}).Workbook||{}).Names)return"";for(var l=s.Workbook.Names,u=[],f=0;f<l.length;++f){var h=l[f];h.Sheet==t&&(h.Name.match(/^_xlfn\./)||u.push(tp(h)))}return u.join("")}function Fw(a,n,t,s){if(!a)return"";var l=[];if(a["!margins"]&&(l.push("<PageSetup>"),a["!margins"].header&&l.push(Ee("Header",null,{"x:Margin":a["!margins"].header})),a["!margins"].footer&&l.push(Ee("Footer",null,{"x:Margin":a["!margins"].footer})),l.push(Ee("PageMargins",null,{"x:Bottom":a["!margins"].bottom||"0.75","x:Left":a["!margins"].left||"0.7","x:Right":a["!margins"].right||"0.7","x:Top":a["!margins"].top||"0.75"})),l.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[t])if(s.Workbook.Sheets[t].Hidden)l.push(Ee("Visible",s.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var u=0;u<t&&!(s.Workbook.Sheets[u]&&!s.Workbook.Sheets[u].Hidden);++u);u==t&&l.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&l.push("<DisplayRightToLeft/>"),a["!protect"]&&(l.push(ea("ProtectContents","True")),a["!protect"].objects&&l.push(ea("ProtectObjects","True")),a["!protect"].scenarios&&l.push(ea("ProtectScenarios","True")),a["!protect"].selectLockedCells!=null&&!a["!protect"].selectLockedCells?l.push(ea("EnableSelection","NoSelection")):a["!protect"].selectUnlockedCells!=null&&!a["!protect"].selectUnlockedCells&&l.push(ea("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(f){a["!protect"][f[0]]&&l.push("<"+f[1]+"/>")})),l.length==0?"":Ee("WorksheetOptions",l.join(""),{xmlns:Ia.x})}function Lw(a){return a.map(function(n){var t=z2(n.t||""),s=Ee("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ee("Comment",s,{"ss:Author":n.a})}).join("")}function Bw(a,n,t,s,l,u,f){if(!a||a.v==null&&a.f==null)return"";var h={};if(a.f&&(h["ss:Formula"]="="+ct(Of(a.f,f))),a.F&&a.F.slice(0,n.length)==n){var g=Ht(a.F.slice(n.length+1));h["ss:ArrayRange"]="RC:R"+(g.r==f.r?"":"["+(g.r-f.r)+"]")+"C"+(g.c==f.c?"":"["+(g.c-f.c)+"]")}if(a.l&&a.l.Target&&(h["ss:HRef"]=ct(a.l.Target),a.l.Tooltip&&(h["x:HRefScreenTip"]=ct(a.l.Tooltip))),t["!merges"])for(var m=t["!merges"],p=0;p!=m.length;++p)m[p].s.c!=f.c||m[p].s.r!=f.r||(m[p].e.c>m[p].s.c&&(h["ss:MergeAcross"]=m[p].e.c-m[p].s.c),m[p].e.r>m[p].s.r&&(h["ss:MergeDown"]=m[p].e.r-m[p].s.r));var S="",x="";switch(a.t){case"z":if(!s.sheetStubs)return"";break;case"n":S="Number",x=String(a.v);break;case"b":S="Boolean",x=a.v?"1":"0";break;case"e":S="Error",x=jl[a.v];break;case"d":S="DateTime",x=new Date(a.v).toISOString(),a.z==null&&(a.z=a.z||Nt[14]);break;case"s":S="String",x=P2(a.v||"");break}var C=Ar(s.cellXfs,a,s);h["ss:StyleID"]="s"+(21+C),h["ss:Index"]=f.c+1;var T=a.v!=null?x:"",y=a.t=="z"?"":'<Data ss:Type="'+S+'">'+T+"</Data>";return(a.c||[]).length>0&&(y+=Lw(a.c)),Ee("Cell",y,h)}function Kw(a,n){var t='<Row ss:Index="'+(a+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=Ig(n.hpt)),n.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Pw(a,n,t,s){if(!a["!ref"])return"";var l=yt(a["!ref"]),u=a["!merges"]||[],f=0,h=[];a["!cols"]&&a["!cols"].forEach(function(_,w){kf(_);var k=!!_.width,D=Io(w,_),b={"ss:Index":w+1};k&&(b["ss:Width"]=yo(D.width)),_.hidden&&(b["ss:Hidden"]="1"),h.push(Ee("Column",null,b))});for(var g=Array.isArray(a),m=l.s.r;m<=l.e.r;++m){for(var p=[Kw(m,(a["!rows"]||[])[m])],S=l.s.c;S<=l.e.c;++S){var x=!1;for(f=0;f!=u.length;++f)if(!(u[f].s.c>S)&&!(u[f].s.r>m)&&!(u[f].e.c<S)&&!(u[f].e.r<m)){(u[f].s.c!=S||u[f].s.r!=m)&&(x=!0);break}if(!x){var C={r:m,c:S},T=ot(C),y=g?(a[m]||[])[S]:a[T];p.push(Bw(y,T,a,n,t,s,C))}}p.push("</Row>"),p.length>2&&h.push(p.join(""))}return h.join("")}function zw(a,n,t){var s=[],l=t.SheetNames[a],u=t.Sheets[l],f=u?Rw(u,n,a,t):"";return f.length>0&&s.push("<Names>"+f+"</Names>"),f=u?Pw(u,n,a,t):"",f.length>0&&s.push("<Table>"+f+"</Table>"),s.push(Fw(u,n,a,t)),s.join("")}function Hw(a,n){n||(n={}),a.SSF||(a.SSF=Ea(Nt)),a.SSF&&(Mo(),Do(a.SSF),n.revssf=jo(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF,n.cellXfs=[],Ar(n.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(kw(a,n)),t.push(Uw()),t.push(""),t.push("");for(var s=0;s<a.SheetNames.length;++s)t.push(Ee("Worksheet",zw(s,n,a),{"ss:Name":ct(a.SheetNames[s])}));return t[2]=Ow(a,n),t[3]=Iw(a),Rt+Ee("Workbook",t.join(""),{xmlns:Ia.ss,"xmlns:o":Ia.o,"xmlns:x":Ia.x,"xmlns:ss":Ia.ss,"xmlns:dt":Ia.dt,"xmlns:html":Ia.html})}var lf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Gw(a,n){var t=[],s=[],l=[],u=0,f,h=V1(sv,"n"),g=V1(iv,"n");if(a.Props)for(f=aa(a.Props),u=0;u<f.length;++u)(Object.prototype.hasOwnProperty.call(h,f[u])?t:Object.prototype.hasOwnProperty.call(g,f[u])?s:l).push([f[u],a.Props[f[u]]]);if(a.Custprops)for(f=aa(a.Custprops),u=0;u<f.length;++u)Object.prototype.hasOwnProperty.call(a.Props||{},f[u])||(Object.prototype.hasOwnProperty.call(h,f[u])?t:Object.prototype.hasOwnProperty.call(g,f[u])?s:l).push([f[u],a.Custprops[f[u]]]);var m=[];for(u=0;u<l.length;++u)wg.indexOf(l[u][0])>-1||Tg.indexOf(l[u][0])>-1||l[u][1]!=null&&m.push(l[u]);s.length&&ht.utils.cfb_add(n,"/SummaryInformation",fv(s,lf.SI,g,iv)),(t.length||m.length)&&ht.utils.cfb_add(n,"/DocumentSummaryInformation",fv(t,lf.DSI,h,sv,m.length?m:null,lf.UDI))}function Ww(a,n){var t=n||{},s=ht.utils.cfb_new({root:"R"}),l="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":l="/Workbook",t.biff=8;break;case"biff5":l="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return ht.utils.cfb_add(s,l,ap(a,t)),t.biff==8&&(a.Props||a.Custprops)&&Gw(a,s),t.biff==8&&a.vbaraw&&oT(s,ht.read(a.vbaraw,{type:typeof a.vbaraw=="string"?"binary":"buffer"})),s}var Vw={0:{f:JE},1:{f:n_},2:{f:E_},3:{f:f_},4:{f:l_},5:{f:S_},6:{f:A_},7:{f:v_},8:{f:I_},9:{f:O_},10:{f:k_},11:{f:U_},12:{f:s_},13:{f:w_},14:{f:h_},15:{f:o_},16:{f:C_},17:{f:M_},18:{f:p_},19:{f:Af},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yw},40:{},42:{},43:{f:AC},44:{f:bC},45:{f:jC},46:{f:UC},47:{f:kC},48:{},49:{f:sy},50:{},51:{f:JC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:iC},62:{f:N_},63:{f:tT},64:{f:$_},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Y_},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:t_},148:{f:QE,p:16},151:{f:P_},152:{},153:{f:xw},154:{},155:{},156:{f:gw},157:{},158:{},159:{T:1,f:gC},160:{T:-1},161:{T:1,f:is},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:R_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:YC},336:{T:-1},337:{f:QC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:mf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:z_},427:{f:H_},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:W_},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:e_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:B_},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:mf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:iT},633:{T:1},634:{T:-1},635:{T:1,f:rT},636:{T:-1},637:{f:oy},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uw},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Q_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(a,n,t,s){var l=n;if(!isNaN(l)){var u=s||(t||[]).length||0,f=a.next(4);f.write_shift(2,l),f.write_shift(2,u),u>0&&wf(t)&&a.push(t)}}function Yw(a,n,t,s){var l=(t||[]).length||0;if(l<=8224)return _e(a,n,t,l);var u=n;if(!isNaN(u)){for(var f=t.parts||[],h=0,g=0,m=0;m+(f[h]||8224)<=8224;)m+=f[h]||8224,h++;var p=a.next(4);for(p.write_shift(2,u),p.write_shift(2,m),a.push(t.slice(g,g+m)),g+=m;g<l;){for(p=a.next(4),p.write_shift(2,60),m=0;m+(f[h]||8224)<=8224;)m+=f[h]||8224,h++;p.write_shift(2,m),a.push(t.slice(g,g+m)),g+=m}}}function Ul(a,n,t){return a||(a=fe(7)),a.write_shift(2,n),a.write_shift(2,t),a.write_shift(2,0),a.write_shift(1,0),a}function Xw(a,n,t,s){var l=fe(9);return Ul(l,a,n),Ng(t,s||"b",l),l}function Jw(a,n,t){var s=fe(8+2*t.length);return Ul(s,a,n),s.write_shift(1,t.length),s.write_shift(t.length,t,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function qw(a,n,t,s){if(n.v!=null)switch(n.t){case"d":case"n":var l=n.t=="d"?Ta(ha(n.v)):n.v;l==(l|0)&&l>=0&&l<65536?_e(a,2,uC(t,s,l)):_e(a,3,oC(t,s,l));return;case"b":case"e":_e(a,5,Xw(t,s,n.v,n.t));return;case"s":case"str":_e(a,4,Jw(t,s,(n.v||"").slice(0,255)));return}_e(a,1,Ul(null,t,s))}function $w(a,n,t,s){var l=Array.isArray(n),u=yt(n["!ref"]||"A1"),f,h="",g=[];if(u.e.c>255||u.e.r>16383){if(s.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,16383),f=It(u)}for(var m=u.s.r;m<=u.e.r;++m){h=ta(m);for(var p=u.s.c;p<=u.e.c;++p){m===u.s.r&&(g[p]=ia(p)),f=g[p]+h;var S=l?(n[m]||[])[p]:n[f];S&&qw(a,S,m,p)}}}function Qw(a,n){for(var t=n||{},s=Ca(),l=0,u=0;u<a.SheetNames.length;++u)a.SheetNames[u]==t.sheet&&(l=u);if(l==0&&t.sheet&&a.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return _e(s,t.biff==4?1033:t.biff==3?521:9,jf(a,16,t)),$w(s,a.Sheets[a.SheetNames[l]],l,t),_e(s,10),s.end()}function Zw(a,n,t){_e(a,49,Vy({sz:12,name:"Arial"},t))}function eb(a,n,t){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var l=s[0];l<=s[1];++l)n[l]!=null&&_e(a,1054,Jy(l,n[l],t))})}function tb(a,n){var t=fe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),_e(a,2151,t),t=fe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Mg(yt(n["!ref"]||"A1"),t),t.write_shift(4,4),_e(a,2152,t)}function ab(a,n){for(var t=0;t<16;++t)_e(a,224,hv({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(s){_e(a,224,hv(s,0,n))})}function nb(a,n){for(var t=0;t<n["!links"].length;++t){var s=n["!links"][t];_e(a,440,nC(s)),s[1].Tooltip&&_e(a,2048,rC(s))}delete n["!links"]}function rb(a,n){if(n){var t=0;n.forEach(function(s,l){++t<=256&&s&&_e(a,125,lC(Io(l,s),l))})}}function sb(a,n,t,s,l){var u=16+Ar(l.cellXfs,n,l);if(n.v==null&&!n.bf){_e(a,513,ts(t,s,u));return}if(n.bf)_e(a,6,DE(n,t,s,l,u));else switch(n.t){case"d":case"n":var f=n.t=="d"?Ta(ha(n.v)):n.v;_e(a,515,Zy(t,s,f,u));break;case"b":case"e":_e(a,517,Qy(t,s,n.v,u,l,n.t));break;case"s":case"str":if(l.bookSST){var h=Rf(l.Strings,n.v,l.revStrings);_e(a,253,Yy(t,s,h,u))}else _e(a,516,Xy(t,s,(n.v||"").slice(0,255),u,l));break;default:_e(a,513,ts(t,s,u))}}function ib(a,n,t){var s=Ca(),l=t.SheetNames[a],u=t.Sheets[l]||{},f=(t||{}).Workbook||{},h=(f.Sheets||[])[a]||{},g=Array.isArray(u),m=n.biff==8,p,S="",x=[],C=yt(u["!ref"]||"A1"),T=m?65536:16384;if(C.e.c>255||C.e.r>=T){if(n.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,T-1)}_e(s,2057,jf(t,16,n)),_e(s,13,Qa(1)),_e(s,12,Qa(100)),_e(s,15,da(!0)),_e(s,17,da(!1)),_e(s,16,es(.001)),_e(s,95,da(!0)),_e(s,42,da(!1)),_e(s,43,da(!1)),_e(s,130,Qa(1)),_e(s,128,$y()),_e(s,131,da(!1)),_e(s,132,da(!1)),m&&rb(s,u["!cols"]),_e(s,512,qy(C,n)),m&&(u["!links"]=[]);for(var y=C.s.r;y<=C.e.r;++y){S=ta(y);for(var _=C.s.c;_<=C.e.c;++_){y===C.s.r&&(x[_]=ia(_)),p=x[_]+S;var w=g?(u[y]||[])[_]:u[p];w&&(sb(s,w,y,_,n),m&&w.l&&u["!links"].push([p,w.l]))}}var k=h.CodeName||h.name||l;return m&&_e(s,574,Wy((f.Views||[])[0])),m&&(u["!merges"]||[]).length&&_e(s,229,aC(u["!merges"])),m&&nb(s,u),_e(s,442,Dg(k)),m&&tb(s,u),_e(s,10),s.end()}function lb(a,n,t){var s=Ca(),l=(a||{}).Workbook||{},u=l.Sheets||[],f=l.WBProps||{},h=t.biff==8,g=t.biff==5;if(_e(s,2057,jf(a,5,t)),t.bookType=="xla"&&_e(s,135),_e(s,225,h?Qa(1200):null),_e(s,193,ky(2)),g&&_e(s,191),g&&_e(s,192),_e(s,226),_e(s,92,Py("SheetJS",t)),_e(s,66,Qa(h?1200:1252)),h&&_e(s,353,Qa(0)),h&&_e(s,448),_e(s,317,cC(a.SheetNames.length)),h&&a.vbaraw&&_e(s,211),h&&a.vbaraw){var m=f.CodeName||"ThisWorkbook";_e(s,442,Dg(m))}_e(s,156,Qa(17)),_e(s,25,da(!1)),_e(s,18,da(!1)),_e(s,19,Qa(0)),h&&_e(s,431,da(!1)),h&&_e(s,444,Qa(0)),_e(s,61,Gy()),_e(s,64,da(!1)),_e(s,141,Qa(0)),_e(s,34,da(dw(a)=="true")),_e(s,14,da(!0)),h&&_e(s,439,da(!1)),_e(s,218,Qa(0)),Zw(s,a,t),eb(s,a.SSF,t),ab(s,t),h&&_e(s,352,da(!1));var p=s.end(),S=Ca();h&&_e(S,140,sC()),h&&t.Strings&&Yw(S,252,Hy(t.Strings)),_e(S,10);var x=S.end(),C=Ca(),T=0,y=0;for(y=0;y<a.SheetNames.length;++y)T+=(h?12:11)+(h?2:1)*a.SheetNames[y].length;var _=p.length+T+x.length;for(y=0;y<a.SheetNames.length;++y){var w=u[y]||{};_e(C,133,zy({pos:_,hs:w.Hidden||0,dt:0,name:a.SheetNames[y]},t)),_+=n[y].length}var k=C.end();if(T!=k.length)throw new Error("BS8 "+T+" != "+k.length);var D=[];return p.length&&D.push(p),k.length&&D.push(k),x.length&&D.push(x),Zt(D)}function cb(a,n){var t=n||{},s=[];a&&!a.SSF&&(a.SSF=Ea(Nt)),a&&a.SSF&&(Mo(),Do(a.SSF),t.revssf=jo(a.SSF),t.revssf[a.SSF[65535]]=0,t.ssf=a.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ff(t),t.cellXfs=[],Ar(t.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={});for(var l=0;l<a.SheetNames.length;++l)s[s.length]=ib(l,t,a);return s.unshift(lb(a,s,t)),Zt(s)}function ap(a,n){for(var t=0;t<=a.SheetNames.length;++t){var s=a.Sheets[a.SheetNames[t]];if(!(!s||!s["!ref"])){var l=Fa(s["!ref"]);l.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+a.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var u=n||{};switch(u.biff||2){case 8:case 5:return cb(a,n);case 4:case 3:case 2:return Qw(a,n)}throw new Error("invalid type "+u.bookType+" for BIFF")}function ob(a,n,t,s){for(var l=a["!merges"]||[],u=[],f=n.s.c;f<=n.e.c;++f){for(var h=0,g=0,m=0;m<l.length;++m)if(!(l[m].s.r>t||l[m].s.c>f)&&!(l[m].e.r<t||l[m].e.c<f)){if(l[m].s.r<t||l[m].s.c<f){h=-1;break}h=l[m].e.r-l[m].s.r+1,g=l[m].e.c-l[m].s.c+1;break}if(!(h<0)){var p=ot({r:t,c:f}),S=s.dense?(a[t]||[])[f]:a[p],x=S&&S.v!=null&&(S.h||K2(S.w||(Yn(S),S.w)||""))||"",C={};h>1&&(C.rowspan=h),g>1&&(C.colspan=g),s.editable?x='<span contenteditable="true">'+x+"</span>":S&&(C["data-t"]=S&&S.t||"z",S.v!=null&&(C["data-v"]=S.v),S.z!=null&&(C["data-z"]=S.z),S.l&&(S.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+S.l.Target+'">'+x+"</a>")),C.id=(s.id||"sjs")+"-"+p,u.push(Ee("td",x,C))}}var T="<tr>";return T+u.join("")+"</tr>"}var ub='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fb="</body></html>";function db(a,n,t){var s=[];return s.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function np(a,n){var t=n||{},s=t.header!=null?t.header:ub,l=t.footer!=null?t.footer:fb,u=[s],f=Fa(a["!ref"]);t.dense=Array.isArray(a),u.push(db(a,f,t));for(var h=f.s.r;h<=f.e.r;++h)u.push(ob(a,f,h,t));return u.push("</table>"+l),u.join("")}function rp(a,n,t){var s=t||{},l=0,u=0;if(s.origin!=null)if(typeof s.origin=="number")l=s.origin;else{var f=typeof s.origin=="string"?Ht(s.origin):s.origin;l=f.r,u=f.c}var h=n.getElementsByTagName("tr"),g=Math.min(s.sheetRows||1e7,h.length),m={s:{r:0,c:0},e:{r:l,c:u}};if(a["!ref"]){var p=Fa(a["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),l==-1&&(m.e.r=l=p.e.r+1)}var S=[],x=0,C=a["!rows"]||(a["!rows"]=[]),T=0,y=0,_=0,w=0,k=0,D=0;for(a["!cols"]||(a["!cols"]=[]);T<h.length&&y<g;++T){var b=h[T];if(yv(b)){if(s.display)continue;C[y]={hidden:!0}}var K=b.children;for(_=w=0;_<K.length;++_){var q=K[_];if(!(s.display&&yv(q))){var B=q.hasAttribute("data-v")?q.getAttribute("data-v"):q.hasAttribute("v")?q.getAttribute("v"):G2(q.innerHTML),Z=q.getAttribute("data-z")||q.getAttribute("z");for(x=0;x<S.length;++x){var L=S[x];L.s.c==w+u&&L.s.r<y+l&&y+l<=L.e.r&&(w=L.e.c+1-u,x=-1)}D=+q.getAttribute("colspan")||1,((k=+q.getAttribute("rowspan")||1)>1||D>1)&&S.push({s:{r:y+l,c:w+u},e:{r:y+l+(k||1)-1,c:w+u+(D||1)-1}});var X={t:"s",v:B},M=q.getAttribute("data-t")||q.getAttribute("t")||"";B!=null&&(B.length==0?X.t=M||"z":s.raw||B.trim().length==0||M=="s"||(B==="TRUE"?X={t:"b",v:!0}:B==="FALSE"?X={t:"b",v:!1}:isNaN(Gn(B))?isNaN(El(B).getDate())||(X={t:"d",v:ha(B)},s.cellDates||(X={t:"n",v:Ta(X.v)}),X.z=s.dateNF||Nt[14]):X={t:"n",v:Gn(B)})),X.z===void 0&&Z!=null&&(X.z=Z);var H="",ue=q.getElementsByTagName("A");if(ue&&ue.length)for(var be=0;be<ue.length&&!(ue[be].hasAttribute("href")&&(H=ue[be].getAttribute("href"),H.charAt(0)!="#"));++be);H&&H.charAt(0)!="#"&&(X.l={Target:H}),s.dense?(a[y+l]||(a[y+l]=[]),a[y+l][w+u]=X):a[ot({c:w+u,r:y+l})]=X,m.e.c<w+u&&(m.e.c=w+u),w+=D}}++y}return S.length&&(a["!merges"]=(a["!merges"]||[]).concat(S)),m.e.r=Math.max(m.e.r,y-1+l),a["!ref"]=It(m),y>=g&&(a["!fullref"]=It((m.e.r=h.length-T+y-1+l,m))),a}function sp(a,n){var t=n||{},s=t.dense?[]:{};return rp(s,a,n)}function hb(a,n){return as(sp(a,n),n)}function yv(a){var n="",t=mb(a);return t&&(n=t(a).getPropertyValue("display")),n||(n=a.style&&a.style.display),n==="none"}function mb(a){return a.ownerDocument.defaultView&&typeof a.ownerDocument.defaultView.getComputedStyle=="function"?a.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var vb=(function(){var a=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+wl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+a+"</office:document-styles>";return function(){return Rt+n}})(),Cv=(function(){var a=function(u){return ct(u).replace(/  +/g,function(f){return'<text:s text:c="'+f.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,s=function(u,f,h){var g=[];g.push('      <table:table table:name="'+ct(f.SheetNames[h])+`" table:style-name="ta1">
`);var m=0,p=0,S=Fa(u["!ref"]||"A1"),x=u["!merges"]||[],C=0,T=Array.isArray(u);if(u["!cols"])for(p=0;p<=S.e.c;++p)g.push("        <table:table-column"+(u["!cols"][p]?' table:style-name="co'+u["!cols"][p].ods+'"':"")+`></table:table-column>
`);var y="",_=u["!rows"]||[];for(m=0;m<S.s.r;++m)y=_[m]?' table:style-name="ro'+_[m].ods+'"':"",g.push("        <table:table-row"+y+`></table:table-row>
`);for(;m<=S.e.r;++m){for(y=_[m]?' table:style-name="ro'+_[m].ods+'"':"",g.push("        <table:table-row"+y+`>
`),p=0;p<S.s.c;++p)g.push(n);for(;p<=S.e.c;++p){var w=!1,k={},D="";for(C=0;C!=x.length;++C)if(!(x[C].s.c>p)&&!(x[C].s.r>m)&&!(x[C].e.c<p)&&!(x[C].e.r<m)){(x[C].s.c!=p||x[C].s.r!=m)&&(w=!0),k["table:number-columns-spanned"]=x[C].e.c-x[C].s.c+1,k["table:number-rows-spanned"]=x[C].e.r-x[C].s.r+1;break}if(w){g.push(t);continue}var b=ot({r:m,c:p}),K=T?(u[m]||[])[p]:u[b];if(K&&K.f&&(k["table:formula"]=ct(IE(K.f)),K.F&&K.F.slice(0,b.length)==b)){var q=Fa(K.F);k["table:number-matrix-columns-spanned"]=q.e.c-q.s.c+1,k["table:number-matrix-rows-spanned"]=q.e.r-q.s.r+1}if(!K){g.push(n);continue}switch(K.t){case"b":D=K.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=K.v?"true":"false";break;case"n":D=K.w||String(K.v||0),k["office:value-type"]="float",k["office:value"]=K.v||0;break;case"s":case"str":D=K.v==null?"":K.v,k["office:value-type"]="string";break;case"d":D=K.w||ha(K.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=ha(K.v).toISOString(),k["table:style-name"]="ce1";break;default:g.push(n);continue}var B=a(D);if(K.l&&K.l.Target){var Z=K.l.Target;Z=Z.charAt(0)=="#"?"#"+RE(Z.slice(1)):Z,Z.charAt(0)!="#"&&!Z.match(/^\w+:/)&&(Z="../"+Z),B=Ee("text:a",B,{"xlink:href":Z.replace(/&/g,"&amp;")})}g.push("          "+Ee("table:table-cell",Ee("text:p",B,{}),k)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},l=function(u,f){u.push(` <office:automatic-styles>
`),u.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),u.push(`   <number:month number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:day number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:year/>
`),u.push(`  </number:date-style>
`);var h=0;f.SheetNames.map(function(m){return f.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var p=0;p<m["!cols"].length;++p)if(m["!cols"][p]){var S=m["!cols"][p];if(S.width==null&&S.wpx==null&&S.wch==null)continue;kf(S),S.ods=h;var x=m["!cols"][p].wpx+"px";u.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),u.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),u.push(`  </style:style>
`),++h}}});var g=0;f.SheetNames.map(function(m){return f.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var p=0;p<m["!rows"].length;++p)if(m["!rows"][p]){m["!rows"][p].ods=g;var S=m["!rows"][p].hpx+"px";u.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),u.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+S+`"/>
`),u.push(`  </style:style>
`),++g}}}),u.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),u.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),u.push(`  </style:style>
`),u.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),u.push(` </office:automatic-styles>
`)};return function(f,h){var g=[Rt],m=wl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=wl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+m+p+`>
`),g.push(yg().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+m+`>
`),l(g,f),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var S=0;S!=f.SheetNames.length;++S)g.push(s(f.Sheets[f.SheetNames[S]],f,S));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function ip(a,n){if(n.bookType=="fods")return Cv(a,n);var t=Cf(),s="",l=[],u=[];return s="mimetype",Ge(t,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ge(t,s,Cv(a,n)),l.push([s,"text/xml"]),u.push([s,"ContentFile"]),s="styles.xml",Ge(t,s,vb(a,n)),l.push([s,"text/xml"]),u.push([s,"StylesFile"]),s="meta.xml",Ge(t,s,Rt+yg()),l.push([s,"text/xml"]),u.push([s,"MetadataFile"]),s="manifest.rdf",Ge(t,s,Ny(u)),l.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ge(t,s,wy(l)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Eo(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function gb(a){return typeof TextEncoder<"u"?new TextEncoder().encode(a):un(_l(a))}function pb(a,n){e:for(var t=0;t<=a.length-n.length;++t){for(var s=0;s<n.length;++s)if(a[t+s]!=n[s])continue e;return!0}return!1}function Nr(a){var n=a.reduce(function(l,u){return l+u.length},0),t=new Uint8Array(n),s=0;return a.forEach(function(l){t.set(l,s),s+=l.length}),t}function xb(a,n,t){var s=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,l=t/Math.pow(10,s-6176);a[n+15]|=s>>7,a[n+14]|=(s&127)<<1;for(var u=0;l>=1;++u,l/=256)a[n+u]=l&255;a[n+15]|=t>=0?0:128}function bl(a,n){var t=n?n[0]:0,s=a[t]&127;e:if(a[t++]>=128&&(s|=(a[t]&127)<<7,a[t++]<128||(s|=(a[t]&127)<<14,a[t++]<128)||(s|=(a[t]&127)<<21,a[t++]<128)||(s+=(a[t]&127)*Math.pow(2,28),++t,a[t++]<128)||(s+=(a[t]&127)*Math.pow(2,35),++t,a[t++]<128)||(s+=(a[t]&127)*Math.pow(2,42),++t,a[t++]<128)))break e;return n&&(n[0]=t),s}function it(a){var n=new Uint8Array(7);n[0]=a&127;var t=1;e:if(a>127){if(n[t-1]|=128,n[t]=a>>7&127,++t,a<=16383||(n[t-1]|=128,n[t]=a>>14&127,++t,a<=2097151)||(n[t-1]|=128,n[t]=a>>21&127,++t,a<=268435455)||(n[t-1]|=128,n[t]=a/256>>>21&127,++t,a<=34359738367)||(n[t-1]|=128,n[t]=a/65536>>>21&127,++t,a<=4398046511103))break e;n[t-1]|=128,n[t]=a/16777216>>>21&127,++t}return n.slice(0,t)}function si(a){var n=0,t=a[n]&127;e:if(a[n++]>=128){if(t|=(a[n]&127)<<7,a[n++]<128||(t|=(a[n]&127)<<14,a[n++]<128)||(t|=(a[n]&127)<<21,a[n++]<128))break e;t|=(a[n]&127)<<28}return t}function Lt(a){for(var n=[],t=[0];t[0]<a.length;){var s=t[0],l=bl(a,t),u=l&7;l=Math.floor(l/8);var f=0,h;if(l==0)break;switch(u){case 0:{for(var g=t[0];a[t[0]++]>=128;);h=a.slice(g,t[0])}break;case 5:f=4,h=a.slice(t[0],t[0]+f),t[0]+=f;break;case 1:f=8,h=a.slice(t[0],t[0]+f),t[0]+=f;break;case 2:f=bl(a,t),h=a.slice(t[0],t[0]+f),t[0]+=f;break;case 3:case 4:default:throw new Error("PB Type ".concat(u," for Field ").concat(l," at offset ").concat(s))}var m={data:h,type:u};n[l]==null?n[l]=[m]:n[l].push(m)}return n}function $t(a){var n=[];return a.forEach(function(t,s){t.forEach(function(l){l.data&&(n.push(it(s*8+l.type)),l.type==2&&n.push(it(l.data.length)),n.push(l.data))})}),Nr(n)}function ln(a){for(var n,t=[],s=[0];s[0]<a.length;){var l=bl(a,s),u=Lt(a.slice(s[0],s[0]+l));s[0]+=l;var f={id:si(u[1][0].data),messages:[]};u[2].forEach(function(h){var g=Lt(h.data),m=si(g[3][0].data);f.messages.push({meta:g,data:a.slice(s[0],s[0]+m)}),s[0]+=m}),(n=u[3])!=null&&n[0]&&(f.merge=si(u[3][0].data)>>>0>0),t.push(f)}return t}function Js(a){var n=[];return a.forEach(function(t){var s=[];s[1]=[{data:it(t.id),type:0}],s[2]=[],t.merge!=null&&(s[3]=[{data:it(+!!t.merge),type:0}]);var l=[];t.messages.forEach(function(f){l.push(f.data),f.meta[3]=[{type:0,data:it(f.data.length)}],s[2].push({data:$t(f.meta),type:2})});var u=$t(s);n.push(it(u.length)),n.push(u),l.forEach(function(f){return n.push(f)})}),Nr(n)}function Sb(a,n){if(a!=0)throw new Error("Unexpected Snappy chunk type ".concat(a));for(var t=[0],s=bl(n,t),l=[];t[0]<n.length;){var u=n[t[0]]&3;if(u==0){var f=n[t[0]++]>>2;if(f<60)++f;else{var h=f-59;f=n[t[0]],h>1&&(f|=n[t[0]+1]<<8),h>2&&(f|=n[t[0]+2]<<16),h>3&&(f|=n[t[0]+3]<<24),f>>>=0,f++,t[0]+=h}l.push(n.slice(t[0],t[0]+f)),t[0]+=f;continue}else{var g=0,m=0;if(u==1?(m=(n[t[0]]>>2&7)+4,g=(n[t[0]++]&224)<<3,g|=n[t[0]++]):(m=(n[t[0]++]>>2)+1,u==2?(g=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(g=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),l=[Nr(l)],g==0)throw new Error("Invalid offset 0");if(g>l[0].length)throw new Error("Invalid offset beyond length");if(m>=g)for(l.push(l[0].slice(-g)),m-=g;m>=l[l.length-1].length;)l.push(l[l.length-1]),m-=l[l.length-1].length;l.push(l[0].slice(-g,-g+m))}}var p=Nr(l);if(p.length!=s)throw new Error("Unexpected length: ".concat(p.length," != ").concat(s));return p}function cn(a){for(var n=[],t=0;t<a.length;){var s=a[t++],l=a[t]|a[t+1]<<8|a[t+2]<<16;t+=3,n.push(Sb(s,a.slice(t,t+l))),t+=l}if(t!==a.length)throw new Error("data is not a valid framed stream!");return Nr(n)}function qs(a){for(var n=[],t=0;t<a.length;){var s=Math.min(a.length-t,268435455),l=new Uint8Array(4);n.push(l);var u=it(s),f=u.length;n.push(u),s<=60?(f++,n.push(new Uint8Array([s-1<<2]))):s<=256?(f+=2,n.push(new Uint8Array([240,s-1&255]))):s<=65536?(f+=3,n.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(f+=4,n.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(f+=5,n.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),n.push(a.slice(t,t+s)),f+=s,l[0]=0,l[1]=f&255,l[2]=f>>8&255,l[3]=f>>16&255,t+=s}return Nr(n)}function cf(a,n){var t=new Uint8Array(32),s=Eo(t),l=12,u=0;switch(t[0]=5,a.t){case"n":t[1]=2,xb(t,l,a.v),u|=1,l+=16;break;case"b":t[1]=6,s.setFloat64(l,a.v?1:0,!0),u|=2,l+=8;break;case"s":if(n.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));t[1]=3,s.setUint32(l,n.indexOf(a.v),!0),u|=8,l+=4;break;default:throw"unsupported cell type "+a.t}return s.setUint32(8,u,!0),t.slice(0,l)}function of(a,n){var t=new Uint8Array(32),s=Eo(t),l=12,u=0;switch(t[0]=3,a.t){case"n":t[2]=2,s.setFloat64(l,a.v,!0),u|=32,l+=8;break;case"b":t[2]=6,s.setFloat64(l,a.v?1:0,!0),u|=32,l+=8;break;case"s":if(n.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));t[2]=3,s.setUint32(l,n.indexOf(a.v),!0),u|=16,l+=4;break;default:throw"unsupported cell type "+a.t}return s.setUint32(4,u,!0),t.slice(0,l)}function yr(a){var n=Lt(a);return bl(n[1][0].data)}function yb(a,n,t){var s,l,u,f;if(!((s=a[6])!=null&&s[0])||!((l=a[7])!=null&&l[0]))throw"Mutation only works on post-BNC storages!";var h=((f=(u=a[8])==null?void 0:u[0])==null?void 0:f.data)&&si(a[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var g=0,m=Eo(a[7][0].data),p=0,S=[],x=Eo(a[4][0].data),C=0,T=[],y=0;y<n.length;++y){if(n[y]==null){m.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}m.setUint16(y*2,p,!0),x.setUint16(y*2,C,!0);var _,w;switch(typeof n[y]){case"string":_=cf({t:"s",v:n[y]},t),w=of({t:"s",v:n[y]},t);break;case"number":_=cf({t:"n",v:n[y]},t),w=of({t:"n",v:n[y]},t);break;case"boolean":_=cf({t:"b",v:n[y]},t),w=of({t:"b",v:n[y]},t);break;default:throw new Error("Unsupported value "+n[y])}S.push(_),p+=_.length,T.push(w),C+=w.length,++g}for(a[2][0].data=it(g);y<a[7][0].data.length/2;++y)m.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return a[6][0].data=Nr(S),a[3][0].data=Nr(T),g}function Cb(a,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=a.Sheets[a.SheetNames[0]];a.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Fa(t["!ref"]);s.s.r=s.s.c=0;var l=!1;s.e.c>9&&(l=!0,s.e.c=9),s.e.r>49&&(l=!0,s.e.r=49),l&&console.error("The Numbers writer is currently limited to ".concat(It(s)));var u=wo(t,{range:s,header:1}),f=["~Sh33tJ5~"];u.forEach(function(V){return V.forEach(function(P){typeof P=="string"&&f.push(P)})});var h={},g=[],m=ht.read(n.numbers,{type:"base64"});m.FileIndex.map(function(V,P){return[V,m.FullPaths[P]]}).forEach(function(V){var P=V[0],Y=V[1];if(P.type==2&&P.name.match(/\.iwa/)){var ce=P.content,Ce=cn(ce),je=ln(Ce);je.forEach(function(we){g.push(we.id),h[we.id]={deps:[],location:Y,type:si(we.messages[0].meta[1][0].data)}})}}),g.sort(function(V,P){return V-P});var p=g.filter(function(V){return V>1}).map(function(V){return[V,it(V)]});m.FileIndex.map(function(V,P){return[V,m.FullPaths[P]]}).forEach(function(V){var P=V[0];if(V[1],!!P.name.match(/\.iwa/)){var Y=ln(cn(P.content));Y.forEach(function(ce){ce.messages.forEach(function(Ce){p.forEach(function(je){ce.messages.some(function(we){return si(we.meta[1][0].data)!=11006&&pb(we.data,je[1])})&&h[je[0]].deps.push(ce.id)})})})}});for(var S=ht.find(m,h[1].location),x=ln(cn(S.content)),C,T=0;T<x.length;++T){var y=x[T];y.id==1&&(C=y)}var _=yr(Lt(C.messages[0].data)[1][0].data);for(S=ht.find(m,h[_].location),x=ln(cn(S.content)),T=0;T<x.length;++T)y=x[T],y.id==_&&(C=y);for(_=yr(Lt(C.messages[0].data)[2][0].data),S=ht.find(m,h[_].location),x=ln(cn(S.content)),T=0;T<x.length;++T)y=x[T],y.id==_&&(C=y);for(_=yr(Lt(C.messages[0].data)[2][0].data),S=ht.find(m,h[_].location),x=ln(cn(S.content)),T=0;T<x.length;++T)y=x[T],y.id==_&&(C=y);var w=Lt(C.messages[0].data);{w[6][0].data=it(s.e.r+1),w[7][0].data=it(s.e.c+1);var k=yr(w[46][0].data),D=ht.find(m,h[k].location),b=ln(cn(D.content));{for(var K=0;K<b.length&&b[K].id!=k;++K);if(b[K].id!=k)throw"Bad ColumnRowUIDMapArchive";var q=Lt(b[K].messages[0].data);q[1]=[],q[2]=[],q[3]=[];for(var B=0;B<=s.e.c;++B){var Z=[];Z[1]=Z[2]=[{type:0,data:it(B+420690)}],q[1].push({type:2,data:$t(Z)}),q[2].push({type:0,data:it(B)}),q[3].push({type:0,data:it(B)})}q[4]=[],q[5]=[],q[6]=[];for(var L=0;L<=s.e.r;++L)Z=[],Z[1]=Z[2]=[{type:0,data:it(L+726270)}],q[4].push({type:2,data:$t(Z)}),q[5].push({type:0,data:it(L)}),q[6].push({type:0,data:it(L)});b[K].messages[0].data=$t(q)}D.content=qs(Js(b)),D.size=D.content.length,delete w[46];var X=Lt(w[4][0].data);{X[7][0].data=it(s.e.r+1);var M=Lt(X[1][0].data),H=yr(M[2][0].data);D=ht.find(m,h[H].location),b=ln(cn(D.content));{if(b[0].id!=H)throw"Bad HeaderStorageBucket";var ue=Lt(b[0].messages[0].data);for(L=0;L<u.length;++L){var be=Lt(ue[2][0].data);be[1][0].data=it(L),be[4][0].data=it(u[L].length),ue[2][L]={type:ue[2][0].type,data:$t(be)}}b[0].messages[0].data=$t(ue)}D.content=qs(Js(b)),D.size=D.content.length;var Se=yr(X[2][0].data);D=ht.find(m,h[Se].location),b=ln(cn(D.content));{if(b[0].id!=Se)throw"Bad HeaderStorageBucket";for(ue=Lt(b[0].messages[0].data),B=0;B<=s.e.c;++B)be=Lt(ue[2][0].data),be[1][0].data=it(B),be[4][0].data=it(s.e.r+1),ue[2][B]={type:ue[2][0].type,data:$t(be)};b[0].messages[0].data=$t(ue)}D.content=qs(Js(b)),D.size=D.content.length;var ee=yr(X[4][0].data);(function(){for(var V=ht.find(m,h[ee].location),P=ln(cn(V.content)),Y,ce=0;ce<P.length;++ce){var Ce=P[ce];Ce.id==ee&&(Y=Ce)}var je=Lt(Y.messages[0].data);{je[3]=[];var we=[];f.forEach(function(Ve,Kt){we[1]=[{type:0,data:it(Kt)}],we[2]=[{type:0,data:it(1)}],we[3]=[{type:2,data:gb(Ve)}],je[3].push({type:2,data:$t(we)})})}Y.messages[0].data=$t(je);var Ae=Js(P),Qe=qs(Ae);V.content=Qe,V.size=V.content.length})();var ge=Lt(X[3][0].data);{var ke=ge[1][0];delete ge[2];var Ne=Lt(ke.data);{var Le=yr(Ne[2][0].data);(function(){for(var V=ht.find(m,h[Le].location),P=ln(cn(V.content)),Y,ce=0;ce<P.length;++ce){var Ce=P[ce];Ce.id==Le&&(Y=Ce)}var je=Lt(Y.messages[0].data);{delete je[6],delete ge[7];var we=new Uint8Array(je[5][0].data);je[5]=[];for(var Ae=0,Qe=0;Qe<=s.e.r;++Qe){var Ve=Lt(we);Ae+=yb(Ve,u[Qe],f),Ve[1][0].data=it(Qe),je[5].push({data:$t(Ve),type:2})}je[1]=[{type:0,data:it(s.e.c+1)}],je[2]=[{type:0,data:it(s.e.r+1)}],je[3]=[{type:0,data:it(Ae)}],je[4]=[{type:0,data:it(s.e.r+1)}]}Y.messages[0].data=$t(je);var Kt=Js(P),We=qs(Kt);V.content=We,V.size=V.content.length})()}ke.data=$t(Ne)}X[3][0].data=$t(ge)}w[4][0].data=$t(X)}C.messages[0].data=$t(w);var G=Js(x),j=qs(G);return S.content=j,S.size=S.content.length,m}function Tb(a){return function(t){for(var s=0;s!=a.length;++s){var l=a[s];t[l[0]]===void 0&&(t[l[0]]=l[1]),l[2]==="n"&&(t[l[0]]=Number(t[l[0]]))}}}function Ff(a){Tb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function Eb(a,n){return n.bookType=="ods"?ip(a,n):n.bookType=="numbers"?Cb(a,n):n.bookType=="xlsb"?_b(a,n):wb(a,n)}function _b(a,n){ei=1024,a&&!a.SSF&&(a.SSF=Ea(Nt)),a&&a.SSF&&(Mo(),Do(a.SSF),n.revssf=jo(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,yl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var t=n.bookType=="xlsb"?"bin":"xml",s=zg.indexOf(n.bookType)>-1,l=pg();Ff(n=n||{});var u=Cf(),f="",h=0;if(n.cellXfs=[],Ar(n.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),f="docProps/core.xml",Ge(u,f,Cg(a.Props,n)),l.coreprops.push(f),lt(n.rels,2,f,tt.CORE_PROPS),f="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var g=[],m=0;m<a.SheetNames.length;++m)(a.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(a.SheetNames[m]);a.Props.SheetNames=g}for(a.Props.Worksheets=a.Props.SheetNames.length,Ge(u,f,Eg(a.Props)),l.extprops.push(f),lt(n.rels,3,f,tt.EXT_PROPS),a.Custprops!==a.Props&&aa(a.Custprops||{}).length>0&&(f="docProps/custom.xml",Ge(u,f,_g(a.Custprops)),l.custprops.push(f),lt(n.rels,4,f,tt.CUST_PROPS)),h=1;h<=a.SheetNames.length;++h){var p={"!id":{}},S=a.Sheets[a.SheetNames[h-1]],x=(S||{})["!type"]||"sheet";switch(x){case"chart":default:f="xl/worksheets/sheet"+h+"."+t,Ge(u,f,Nw(h-1,f,n,a,p)),l.sheets.push(f),lt(n.wbrels,-1,"worksheets/sheet"+h+"."+t,tt.WS[0])}if(S){var C=S["!comments"],T=!1,y="";C&&C.length>0&&(y="xl/comments"+h+"."+t,Ge(u,y,Mw(C,y)),l.comments.push(y),lt(p,-1,"../comments"+h+"."+t,tt.CMNT),T=!0),S["!legacy"]&&T&&Ge(u,"xl/drawings/vmlDrawing"+h+".vml",Kg(h,S["!comments"])),delete S["!comments"],delete S["!legacy"]}p["!id"].rId1&&Ge(u,Sg(f),ni(p))}return n.Strings!=null&&n.Strings.length>0&&(f="xl/sharedStrings."+t,Ge(u,f,Dw(n.Strings,f,n)),l.strs.push(f),lt(n.wbrels,-1,"sharedStrings."+t,tt.SST)),f="xl/workbook."+t,Ge(u,f,bw(a,f)),l.workbooks.push(f),lt(n.rels,1,f,tt.WB),f="xl/theme/theme1.xml",Ge(u,f,Lg(a.Themes,n)),l.themes.push(f),lt(n.wbrels,-1,"theme/theme1.xml",tt.THEME),f="xl/styles."+t,Ge(u,f,Aw(a,f,n)),l.styles.push(f),lt(n.wbrels,-1,"styles."+t,tt.STY),a.vbaraw&&s&&(f="xl/vbaProject.bin",Ge(u,f,a.vbaraw),l.vba.push(f),lt(n.wbrels,-1,"vbaProject.bin",tt.VBA)),f="xl/metadata."+t,Ge(u,f,jw(f)),l.metadata.push(f),lt(n.wbrels,-1,"metadata."+t,tt.XLMETA),Ge(u,"[Content_Types].xml",xg(l,n)),Ge(u,"_rels/.rels",ni(n.rels)),Ge(u,"xl/_rels/workbook."+t+".rels",ni(n.wbrels)),delete n.revssf,delete n.ssf,u}function wb(a,n){ei=1024,a&&!a.SSF&&(a.SSF=Ea(Nt)),a&&a.SSF&&(Mo(),Do(a.SSF),n.revssf=jo(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,yl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var t="xml",s=zg.indexOf(n.bookType)>-1,l=pg();Ff(n=n||{});var u=Cf(),f="",h=0;if(n.cellXfs=[],Ar(n.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),f="docProps/core.xml",Ge(u,f,Cg(a.Props,n)),l.coreprops.push(f),lt(n.rels,2,f,tt.CORE_PROPS),f="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var g=[],m=0;m<a.SheetNames.length;++m)(a.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(a.SheetNames[m]);a.Props.SheetNames=g}a.Props.Worksheets=a.Props.SheetNames.length,Ge(u,f,Eg(a.Props)),l.extprops.push(f),lt(n.rels,3,f,tt.EXT_PROPS),a.Custprops!==a.Props&&aa(a.Custprops||{}).length>0&&(f="docProps/custom.xml",Ge(u,f,_g(a.Custprops)),l.custprops.push(f),lt(n.rels,4,f,tt.CUST_PROPS));var p=["SheetJ5"];for(n.tcid=0,h=1;h<=a.SheetNames.length;++h){var S={"!id":{}},x=a.Sheets[a.SheetNames[h-1]],C=(x||{})["!type"]||"sheet";switch(C){case"chart":default:f="xl/worksheets/sheet"+h+"."+t,Ge(u,f,$g(h-1,n,a,S)),l.sheets.push(f),lt(n.wbrels,-1,"worksheets/sheet"+h+"."+t,tt.WS[0])}if(x){var T=x["!comments"],y=!1,_="";if(T&&T.length>0){var w=!1;T.forEach(function(k){k[1].forEach(function(D){D.T==!0&&(w=!0)})}),w&&(_="xl/threadedComments/threadedComment"+h+"."+t,Ge(u,_,aT(T,p,n)),l.threadedcomments.push(_),lt(S,-1,"../threadedComments/threadedComment"+h+"."+t,tt.TCMNT)),_="xl/comments"+h+"."+t,Ge(u,_,Pg(T)),l.comments.push(_),lt(S,-1,"../comments"+h+"."+t,tt.CMNT),y=!0}x["!legacy"]&&y&&Ge(u,"xl/drawings/vmlDrawing"+h+".vml",Kg(h,x["!comments"])),delete x["!comments"],delete x["!legacy"]}S["!id"].rId1&&Ge(u,Sg(f),ni(S))}return n.Strings!=null&&n.Strings.length>0&&(f="xl/sharedStrings."+t,Ge(u,f,kg(n.Strings,n)),l.strs.push(f),lt(n.wbrels,-1,"sharedStrings."+t,tt.SST)),f="xl/workbook."+t,Ge(u,f,ep(a)),l.workbooks.push(f),lt(n.rels,1,f,tt.WB),f="xl/theme/theme1.xml",Ge(u,f,Lg(a.Themes,n)),l.themes.push(f),lt(n.wbrels,-1,"theme/theme1.xml",tt.THEME),f="xl/styles."+t,Ge(u,f,Rg(a,n)),l.styles.push(f),lt(n.wbrels,-1,"styles."+t,tt.STY),a.vbaraw&&s&&(f="xl/vbaProject.bin",Ge(u,f,a.vbaraw),l.vba.push(f),lt(n.wbrels,-1,"vbaProject.bin",tt.VBA)),f="xl/metadata."+t,Ge(u,f,Bg()),l.metadata.push(f),lt(n.wbrels,-1,"metadata."+t,tt.XLMETA),p.length>1&&(f="xl/persons/person.xml",Ge(u,f,nT(p)),l.people.push(f),lt(n.wbrels,-1,"persons/person.xml",tt.PEOPLE)),Ge(u,"[Content_Types].xml",xg(l,n)),Ge(u,"_rels/.rels",ni(n.rels)),Ge(u,"xl/_rels/workbook."+t+".rels",ni(n.wbrels)),delete n.revssf,delete n.ssf,u}function bb(a,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":t=Vn(a.slice(0,12));break;case"binary":t=a;break;case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function lp(a,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return Dl(n.file,ht.write(a,{type:nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return ht.write(a,n)}function Nb(a,n){var t=Ea(n||{}),s=Eb(a,t);return Ab(s,t)}function Ab(a,n){var t={},s=nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(t.compression="DEFLATE"),n.password)t.type=s;else switch(n.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":t.type=s;break;default:throw new Error("Unrecognized type "+n.type)}var l=a.FullPaths?ht.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!n.compression}):a.generate(t);if(typeof Deno<"u"&&typeof l=="string"){if(n.type=="binary"||n.type=="base64")return l;l=new Uint8Array(Ao(l))}return n.password&&typeof encrypt_agile<"u"?lp(encrypt_agile(l,n.password),n):n.type==="file"?Dl(n.file,l):n.type=="string"?gl(l):l}function Db(a,n){var t=n||{},s=Ww(a,t);return lp(s,t)}function yn(a,n,t){t||(t="");var s=t+a;switch(n.type){case"base64":return Tl(_l(s));case"binary":return _l(s);case"string":return a;case"file":return Dl(n.file,s,"utf8");case"buffer":return nt?Xn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):yn(s,{type:"binary"}).split("").map(function(l){return l.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function Mb(a,n){switch(n.type){case"base64":return Tl(a);case"binary":return a;case"string":return a;case"file":return Dl(n.file,a,"binary");case"buffer":return nt?Xn(a,"binary"):a.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function lo(a,n){switch(n.type){case"string":case"base64":case"binary":for(var t="",s=0;s<a.length;++s)t+=String.fromCharCode(a[s]);return n.type=="base64"?Tl(t):n.type=="string"?gl(t):t;case"file":return Dl(n.file,a);case"buffer":return a;default:throw new Error("Unrecognized type "+n.type)}}function _o(a,n){r2(),vw(a);var t=Ea(n||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var s=_o(a,t);return t.type="array",Ao(s)}var l=0;if(t.sheet&&(typeof t.sheet=="number"?l=t.sheet:l=a.SheetNames.indexOf(t.sheet),!a.SheetNames[l]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return yn(Hw(a,t),t);case"slk":case"sylk":return yn(dC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"htm":case"html":return yn(np(a.Sheets[a.SheetNames[l]],t),t);case"txt":return Mb(cp(a.Sheets[a.SheetNames[l]],t),t);case"csv":return yn(Lf(a.Sheets[a.SheetNames[l]],t),t,"\uFEFF");case"dif":return yn(hC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"dbf":return lo(fC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"prn":return yn(mC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"rtf":return yn(CC.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"eth":return yn(jg.from_sheet(a.Sheets[a.SheetNames[l]],t),t);case"fods":return yn(ip(a,t),t);case"wk1":return lo(mv.sheet_to_wk1(a.Sheets[a.SheetNames[l]],t),t);case"wk3":return lo(mv.book_to_wk3(a,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),lo(ap(a,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Db(a,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Nb(a,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function jb(a){if(!a.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=a.file.slice(a.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(a.bookType=t.slice(1)),a.bookType=n[a.bookType]||a.bookType}}function kb(a,n,t){var s={};return s.type="file",s.file=n,jb(s),_o(a,s)}function Ub(a,n,t,s,l,u,f,h){var g=ta(t),m=h.defval,p=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),S=!0,x=l===1?[]:{};if(l!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!f||a[t])for(var C=n.s.c;C<=n.e.c;++C){var T=f?a[t][C]:a[s[C]+g];if(T===void 0||T.t===void 0){if(m===void 0)continue;u[C]!=null&&(x[u[C]]=m);continue}var y=T.v;switch(T.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+T.t)}if(u[C]!=null){if(y==null)if(T.t=="e"&&y===null)x[u[C]]=null;else if(m!==void 0)x[u[C]]=m;else if(p&&y===null)x[u[C]]=null;else continue;else x[u[C]]=p&&(T.t!=="n"||T.t==="n"&&h.rawNumbers!==!1)?y:Yn(T,y,h);y!=null&&(S=!1)}}return{row:x,isempty:S}}function wo(a,n){if(a==null||a["!ref"]==null)return[];var t={t:"n",v:0},s=0,l=1,u=[],f=0,h="",g={s:{r:0,c:0},e:{r:0,c:0}},m=n||{},p=m.range!=null?m.range:a["!ref"];switch(m.header===1?s=1:m.header==="A"?s=2:Array.isArray(m.header)?s=3:m.header==null&&(s=0),typeof p){case"string":g=yt(p);break;case"number":g=yt(a["!ref"]),g.s.r=p;break;default:g=p}s>0&&(l=0);var S=ta(g.s.r),x=[],C=[],T=0,y=0,_=Array.isArray(a),w=g.s.r,k=0,D={};_&&!a[w]&&(a[w]=[]);var b=m.skipHidden&&a["!cols"]||[],K=m.skipHidden&&a["!rows"]||[];for(k=g.s.c;k<=g.e.c;++k)if(!(b[k]||{}).hidden)switch(x[k]=ia(k),t=_?a[w][k]:a[x[k]+S],s){case 1:u[k]=k-g.s.c;break;case 2:u[k]=x[k];break;case 3:u[k]=m.header[k-g.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),h=f=Yn(t,null,m),y=D[f]||0,!y)D[f]=1;else{do h=f+"_"+y++;while(D[h]);D[f]=y,D[h]=1}u[k]=h}for(w=g.s.r+l;w<=g.e.r;++w)if(!(K[w]||{}).hidden){var q=Ub(a,g,w,x,s,u,_,m);(q.isempty===!1||(s===1?m.blankrows!==!1:m.blankrows))&&(C[T++]=q.row)}return C.length=T,C}var Tv=/"/g;function Ob(a,n,t,s,l,u,f,h){for(var g=!0,m=[],p="",S=ta(t),x=n.s.c;x<=n.e.c;++x)if(s[x]){var C=h.dense?(a[t]||[])[x]:a[s[x]+S];if(C==null)p="";else if(C.v!=null){g=!1,p=""+(h.rawNumbers&&C.t=="n"?C.v:Yn(C,null,h));for(var T=0,y=0;T!==p.length;++T)if((y=p.charCodeAt(T))===l||y===u||y===34||h.forceQuotes){p='"'+p.replace(Tv,'""')+'"';break}p=="ID"&&(p='"ID"')}else C.f!=null&&!C.F?(g=!1,p="="+C.f,p.indexOf(",")>=0&&(p='"'+p.replace(Tv,'""')+'"')):p="";m.push(p)}return h.blankrows===!1&&g?null:m.join(f)}function Lf(a,n){var t=[],s=n??{};if(a==null||a["!ref"]==null)return"";var l=yt(a["!ref"]),u=s.FS!==void 0?s.FS:",",f=u.charCodeAt(0),h=s.RS!==void 0?s.RS:`
`,g=h.charCodeAt(0),m=new RegExp((u=="|"?"\\|":u)+"+$"),p="",S=[];s.dense=Array.isArray(a);for(var x=s.skipHidden&&a["!cols"]||[],C=s.skipHidden&&a["!rows"]||[],T=l.s.c;T<=l.e.c;++T)(x[T]||{}).hidden||(S[T]=ia(T));for(var y=0,_=l.s.r;_<=l.e.r;++_)(C[_]||{}).hidden||(p=Ob(a,l,_,S,f,g,u,s),p!=null&&(s.strip&&(p=p.replace(m,"")),(p||s.blankrows!==!1)&&t.push((y++?h:"")+p)));return delete s.dense,t.join("")}function cp(a,n){n||(n={}),n.FS="	",n.RS=`
`;var t=Lf(a,n);return t}function Ib(a){var n="",t,s="";if(a==null||a["!ref"]==null)return[];var l=yt(a["!ref"]),u="",f=[],h,g=[],m=Array.isArray(a);for(h=l.s.c;h<=l.e.c;++h)f[h]=ia(h);for(var p=l.s.r;p<=l.e.r;++p)for(u=ta(p),h=l.s.c;h<=l.e.c;++h)if(n=f[h]+u,t=m?(a[p]||[])[h]:a[n],s="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;s=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)s=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)s=""+t.v;else if(t.t=="b")s=t.v?"TRUE":"FALSE";else if(t.w!==void 0)s="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?s="'"+t.v:s=""+t.v}}g[g.length]=n+"="+s}return g}function op(a,n,t){var s=t||{},l=+!s.skipHeader,u=a||{},f=0,h=0;if(u&&s.origin!=null)if(typeof s.origin=="number")f=s.origin;else{var g=typeof s.origin=="string"?Ht(s.origin):s.origin;f=g.r,h=g.c}var m,p={s:{c:0,r:0},e:{c:h,r:f+n.length-1+l}};if(u["!ref"]){var S=yt(u["!ref"]);p.e.c=Math.max(p.e.c,S.e.c),p.e.r=Math.max(p.e.r,S.e.r),f==-1&&(f=S.e.r+1,p.e.r=f+n.length-1+l)}else f==-1&&(f=0,p.e.r=n.length-1+l);var x=s.header||[],C=0;n.forEach(function(y,_){aa(y).forEach(function(w){(C=x.indexOf(w))==-1&&(x[C=x.length]=w);var k=y[w],D="z",b="",K=ot({c:h+C,r:f+_+l});m=Nl(u,K),k&&typeof k=="object"&&!(k instanceof Date)?u[K]=k:(typeof k=="number"?D="n":typeof k=="boolean"?D="b":typeof k=="string"?D="s":k instanceof Date?(D="d",s.cellDates||(D="n",k=Ta(k)),b=s.dateNF||Nt[14]):k===null&&s.nullError&&(D="e",k=0),m?(m.t=D,m.v=k,delete m.w,delete m.R,b&&(m.z=b)):u[K]=m={t:D,v:k},b&&(m.z=b))})}),p.e.c=Math.max(p.e.c,h+x.length-1);var T=ta(f);if(l)for(C=0;C<x.length;++C)u[ia(C+h)+T]={t:"s",v:x[C]};return u["!ref"]=It(p),u}function Rb(a,n){return op(null,a,n)}function Nl(a,n,t){if(typeof n=="string"){if(Array.isArray(a)){var s=Ht(n);return a[s.r]||(a[s.r]=[]),a[s.r][s.c]||(a[s.r][s.c]={t:"z"})}return a[n]||(a[n]={t:"z"})}return typeof n!="number"?Nl(a,ot(n)):Nl(a,ot({r:n,c:t||0}))}function Fb(a,n){if(typeof n=="number"){if(n>=0&&a.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=a.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Lb(){return{SheetNames:[],Sheets:{}}}function Bb(a,n,t,s){var l=1;if(!t)for(;l<=65535&&a.SheetNames.indexOf(t="Sheet"+l)!=-1;++l,t=void 0);if(!t||a.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&a.SheetNames.indexOf(t)>=0){var u=t.match(/(^.*?)(\d+)$/);l=u&&+u[2]||0;var f=u&&u[1]||t;for(++l;l<=65535&&a.SheetNames.indexOf(t=f+l)!=-1;++l);}if(Zg(t),a.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return a.SheetNames.push(t),a.Sheets[t]=n,t}function Kb(a,n,t){a.Workbook||(a.Workbook={}),a.Workbook.Sheets||(a.Workbook.Sheets=[]);var s=Fb(a,n);switch(a.Workbook.Sheets[s]||(a.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}a.Workbook.Sheets[s].Hidden=t}function Pb(a,n){return a.z=n,a}function up(a,n,t){return n?(a.l={Target:n},t&&(a.l.Tooltip=t)):delete a.l,a}function zb(a,n,t){return up(a,"#"+n,t)}function Hb(a,n,t){a.c||(a.c=[]),a.c.push({t:n,a:t||"SheetJS"})}function Gb(a,n,t,s){for(var l=typeof n!="string"?n:yt(n),u=typeof n=="string"?n:It(n),f=l.s.r;f<=l.e.r;++f)for(var h=l.s.c;h<=l.e.c;++h){var g=Nl(a,f,h);g.t="n",g.F=u,delete g.v,f==l.s.r&&h==l.s.c&&(g.f=t,s&&(g.D=!0))}return a}var Pn={encode_col:ia,encode_row:ta,encode_cell:ot,encode_range:It,decode_col:Nf,decode_row:bf,split_cell:ry,decode_cell:Ht,decode_range:Fa,format_cell:Yn,sheet_add_aoa:fg,sheet_add_json:op,sheet_add_dom:rp,aoa_to_sheet:oi,json_to_sheet:Rb,table_to_sheet:sp,table_to_book:hb,sheet_to_csv:Lf,sheet_to_txt:cp,sheet_to_json:wo,sheet_to_html:np,sheet_to_formulae:Ib,sheet_to_row_object_array:wo,sheet_get_cell:Nl,book_new:Lb,book_append_sheet:Bb,book_set_sheet_visibility:Kb,cell_set_number_format:Pb,cell_set_hyperlink:up,cell_set_internal_link:zb,cell_add_comment:Hb,sheet_set_array_formula:Gb,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class Wb{generateFileName(n){const s=new Date().toISOString().split("T")[0];let l="";if(n.dateRange.type==="custom"&&n.dateRange.startDate&&n.dateRange.endDate){const f=n.dateRange.startDate.toISOString().split("T")[0],h=n.dateRange.endDate.toISOString().split("T")[0];l=`_${f}_to_${h}`}else n.dateRange.type!=="custom"&&(l=`_${n.dateRange.type}`);const u=n.format==="csv"?"csv":"xlsx";return`crm_contacts_export_${s}${l}.${u}`}filterContactsByDateRange(n,t){if(t.type==="custom"&&t.startDate&&t.endDate)return n.filter(u=>{const f=new Date(u.createdAt);return f>=t.startDate&&f<=t.endDate});const s=new Date;let l;switch(t.type){case"daily":l=new Date(s.getTime()-1440*60*1e3);break;case"weekly":l=new Date(s.getTime()-10080*60*1e3);break;case"monthly":l=new Date(s.getTime()-720*60*60*1e3);break;case"yearly":l=new Date(s.getTime()-365*24*60*60*1e3);break;default:return n}return n.filter(u=>{const f=new Date(u.createdAt);return f>=l&&f<=s})}prepareExportData(n,t){return n.map(s=>{const l={};return t.forEach(u=>{switch(u){case"createdAt":case"updatedAt":l[this.getFieldDisplayName(u)]=zn(new Date(s[u]));break;default:l[this.getFieldDisplayName(u)]=s[u]}}),l})}getFieldDisplayName(n){return{id:"ID",createdAt:"Created Date",nama:"Name",nomorTelepon:"Phone Number",jenisKelamin:"Gender",alamat:"Address",provinsi:"Province",agama:"Religion",alasanMenghubungi:"Reason for Contact",sumber:"Source",prioritas:"Priority",statusKontak:"Contact Status",updatedAt:"Last Updated",createdBy:"Created By",history:"History"}[n]||n}convertToCSV(n){if(n.length===0)return"No data available for export";const t=Object.keys(n[0]),s=t.join(","),l=n.map(u=>t.map(f=>{const h=u[f];return typeof h=="string"&&(h.includes(",")||h.includes('"')||h.includes(`
`))?`"${h.replace(/"/g,'""')}"`:h||""}).join(","));return[s,...l].join(`
`)}convertToExcel(n){if(n.length===0){const u=Pn.aoa_to_sheet([["No data available for export"]]),f=Pn.book_new();return Pn.book_append_sheet(f,u,"Contacts"),_o(f,{bookType:"xlsx",type:"array"})}const t=Pn.json_to_sheet(n),s=Object.keys(n[0]).map(u=>{const f=Math.max(u.length,...n.map(h=>String(h[u]||"").length));return{wch:Math.min(f+2,50)}});t["!cols"]=s;const l=Pn.book_new();return Pn.book_append_sheet(l,t,"Contacts"),l.Props={Title:"CRM Contacts Export",Subject:"Contact Management Data",Author:"CRM System",CreatedDate:new Date},_o(l,{bookType:"xlsx",type:"array"})}downloadFile(n,t,s){const l=new Blob([n],{type:s}),u=URL.createObjectURL(l),f=document.createElement("a");f.href=u,f.download=t,f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),setTimeout(()=>URL.revokeObjectURL(u),100)}exportContacts(n,t){try{const s=this.filterContactsByDateRange(n,t.dateRange);if(s.length===0)throw new Error("No contacts found for the selected date range");const l=this.prepareExportData(s,t.includeFields),u=this.generateFileName(t);if(t.format==="csv"){const f=this.convertToCSV(l);this.downloadFile(f,u,"text/csv;charset=utf-8;")}else if(t.format==="excel"){const f=this.convertToExcel(l);this.downloadFile(f,u,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}}catch(s){throw console.error("Export error:",s),s}}getExportStats(n,t){const s=this.filterContactsByDateRange(n,t.dateRange);let l="All time";return t.dateRange.type==="custom"&&t.dateRange.startDate&&t.dateRange.endDate?l=`${t.dateRange.startDate.toLocaleDateString()} - ${t.dateRange.endDate.toLocaleDateString()}`:t.dateRange.type!=="custom"&&(l={daily:"Last 24 hours",weekly:"Last 7 days",monthly:"Last 30 days",yearly:"Last 365 days"}[t.dateRange.type]||"All time"),{totalContacts:n.length,filteredContacts:s.length,dateRange:l,fields:t.includeFields.map(u=>this.getFieldDisplayName(u))}}validateExportOptions(n){const t=[];return(!n.format||!["csv","excel"].includes(n.format))&&t.push("Invalid export format. Must be CSV or Excel."),(!n.includeFields||n.includeFields.length===0)&&t.push("At least one field must be selected for export."),n.dateRange.type==="custom"&&(!n.dateRange.startDate||!n.dateRange.endDate?t.push("Start date and end date are required for custom date range."):n.dateRange.startDate>n.dateRange.endDate&&t.push("Start date must be before end date.")),{isValid:t.length===0,errors:t}}getAvailableFormats(){return[{value:"csv",label:"CSV",description:"Comma-separated values file, compatible with Excel, Google Sheets, and other applications"},{value:"excel",label:"Excel (.xlsx)",description:"Native Microsoft Excel format with proper formatting, auto-sized columns, and metadata"}]}getAvailableDateRanges(){return[{value:"daily",label:"Last 24 Hours",description:"Contacts created in the last 24 hours"},{value:"weekly",label:"Last 7 Days",description:"Contacts created in the last week"},{value:"monthly",label:"Last 30 Days",description:"Contacts created in the last month"},{value:"yearly",label:"Last 365 Days",description:"Contacts created in the last year"},{value:"custom",label:"Custom Range",description:"Select specific start and end dates"}]}}const $s=new Wb,Vb=({contacts:a,isOpen:n,onClose:t,onExportComplete:s})=>{const[l,u]=z.useState({format:"csv",dateRange:{type:"monthly"},includeFields:[...ol]}),[f,h]=z.useState(!1),[g,m]=z.useState([]),[p,S]=z.useState(null);z.useEffect(()=>{if(n&&a.length>0)try{const b=$s.getExportStats(a,l);S(b)}catch(b){console.error("Error calculating export stats:",b)}},[l,a,n]),z.useEffect(()=>{n&&(m([]),h(!1))},[n]);const x=b=>{u(K=>({...K,format:b}))},C=b=>{u(K=>({...K,dateRange:{type:b}}))},T=(b,K)=>{if(!K)return;const q=new Date(K);u(B=>({...B,dateRange:{...B.dateRange,[b]:q}}))},y=b=>{u(K=>{const q=K.includeFields,B=q.includes(b)?q.filter(Z=>Z!==b):[...q,b];return{...K,includeFields:B}})},_=()=>{u(b=>({...b,includeFields:[...ol]}))},w=()=>{u(b=>({...b,includeFields:[]}))},k=async()=>{m([]);const b=$s.validateExportOptions(l);if(!b.isValid){m(b.errors);return}if(a.length===0){m(["No contacts available for export"]);return}h(!0);try{const K=$s.generateFileName(l);$s.exportContacts(a,l),s?.(K),t()}catch(K){const q=K instanceof Error?K.message:"Export failed";m([q])}finally{h(!1)}},D=b=>({id:"Contact ID",createdAt:"Created Date",nama:"Name",nomorTelepon:"Phone Number",jenisKelamin:"Gender",alamat:"Address",provinsi:"Province",agama:"Religion",alasanMenghubungi:"Reason for Contact",sumber:"Source",prioritas:"Priority",statusKontak:"Contact Status",updatedAt:"Last Updated",createdBy:"Created By",history:"History"})[b]||b;return n?o.jsx("div",{className:"export-modal-overlay",children:o.jsxs("div",{className:"export-modal",children:[o.jsxs("div",{className:"export-modal-header",children:[o.jsx("h2",{children:"Export Contacts"}),o.jsx("button",{onClick:t,className:"close-btn",disabled:f,children:""})]}),o.jsxs("div",{className:"export-modal-content",children:[g.length>0&&o.jsx("div",{className:"export-errors",children:g.map((b,K)=>o.jsx("div",{className:"error-message",children:b},K))}),o.jsxs("div",{className:"export-section",children:[o.jsx("h3",{children:"Export Format"}),o.jsx("div",{className:"format-options",children:$s.getAvailableFormats().map(b=>o.jsxs("label",{className:"format-option",children:[o.jsx("input",{type:"radio",name:"format",value:b.value,checked:l.format===b.value,onChange:()=>x(b.value),disabled:f}),o.jsxs("div",{className:"format-info",children:[o.jsx("span",{className:"format-label",children:b.label}),o.jsx("span",{className:"format-description",children:b.description})]})]},b.value))})]}),o.jsxs("div",{className:"export-section",children:[o.jsx("h3",{children:"Date Range"}),o.jsx("div",{className:"date-range-options",children:$s.getAvailableDateRanges().map(b=>o.jsxs("label",{className:"date-range-option",children:[o.jsx("input",{type:"radio",name:"dateRange",value:b.value,checked:l.dateRange.type===b.value,onChange:()=>C(b.value),disabled:f}),o.jsxs("div",{className:"range-info",children:[o.jsx("span",{className:"range-label",children:b.label}),o.jsx("span",{className:"range-description",children:b.description})]})]},b.value))}),l.dateRange.type==="custom"&&o.jsxs("div",{className:"custom-date-inputs",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"Start Date"}),o.jsx("input",{type:"date",value:l.dateRange.startDate?on(l.dateRange.startDate):"",onChange:b=>T("startDate",b.target.value),max:on(new Date),disabled:f})]}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"End Date"}),o.jsx("input",{type:"date",value:l.dateRange.endDate?on(l.dateRange.endDate):"",onChange:b=>T("endDate",b.target.value),max:on(new Date),min:l.dateRange.startDate?on(l.dateRange.startDate):void 0,disabled:f})]})]})]}),o.jsxs("div",{className:"export-section",children:[o.jsx("h3",{children:"Fields to Include"}),o.jsxs("div",{className:"field-selection-header",children:[o.jsxs("span",{children:[l.includeFields.length," of ",ol.length," fields selected"]}),o.jsxs("div",{className:"field-actions",children:[o.jsx("button",{onClick:_,className:"field-action-btn",disabled:f||l.includeFields.length===ol.length,children:"Select All"}),o.jsx("button",{onClick:w,className:"field-action-btn",disabled:f||l.includeFields.length===0,children:"Clear All"})]})]}),o.jsx("div",{className:"field-options",children:ol.map(b=>o.jsxs("label",{className:"field-option",children:[o.jsx("input",{type:"checkbox",checked:l.includeFields.includes(b),onChange:()=>y(b),disabled:f}),o.jsx("span",{className:"field-name",children:D(b)})]},b))})]}),p&&o.jsxs("div",{className:"export-stats",children:[o.jsx("h3",{children:"Export Preview"}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Total Contacts:"}),o.jsx("span",{className:"stat-value",children:p.totalContacts})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Contacts to Export:"}),o.jsx("span",{className:"stat-value",children:p.filteredContacts})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Date Range:"}),o.jsx("span",{className:"stat-value",children:p.dateRange})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-label",children:"Fields:"}),o.jsxs("span",{className:"stat-value",children:[p.fields.length," selected"]})]})]})]})]}),o.jsxs("div",{className:"export-modal-footer",children:[o.jsx("button",{onClick:t,className:"cancel-btn",disabled:f,children:"Cancel"}),o.jsx("button",{onClick:k,className:"export-btn",disabled:f||l.includeFields.length===0||p&&p.filteredContacts===0,children:f?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"export-spinner"}),"Exporting..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),"Export ",p?.filteredContacts||0," Contacts"]})})]})]})}):null},fp=({contacts:a,variant:n="primary",size:t="medium",disabled:s=!1,className:l=""})=>{const[u,f]=z.useState(!1),[h,g]=z.useState(null),{canExportData:m}=Vt(),p=()=>{if(!m()){alert("You do not have permission to export data");return}if(a.length===0){alert("No contacts available to export");return}f(!0)},S=y=>{g({filename:y,timestamp:new Date});const _=`Export completed successfully!
File: ${y}`;alert(_)},x=()=>{switch(n){case"icon":return"";case"secondary":return"Export";default:return`Export ${a.length} Contacts`}},C=()=>"",T=s||!m()||a.length===0;return o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:p,disabled:T,className:`export-button ${n} ${t} ${l}`,title:m()?a.length===0?"No contacts available to export":`Export ${a.length} contacts`:"You do not have permission to export data",children:[o.jsx("span",{className:"export-icon",children:C()}),n!=="icon"&&o.jsx("span",{className:"export-text",children:x()}),a.length>0&&n==="primary"&&o.jsx("span",{className:"contact-count",children:a.length})]}),h&&o.jsxs("div",{className:"last-export-info",children:[o.jsx("span",{className:"export-success-icon",children:""}),o.jsxs("span",{className:"export-info-text",children:["Last export: ",h.filename," at ",h.timestamp.toLocaleTimeString()]})]}),o.jsx(Vb,{contacts:a,isOpen:u,onClose:()=>f(!1),onExportComplete:S})]})},ii="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3c!--%20White%20rounded%20rectangle%20background%20--%3e%3crect%20x='2'%20y='6'%20width='36'%20height='28'%20rx='8'%20ry='8'%20fill='white'/%3e%3c!--%20Black%20figure%20with%20raised%20arms%20--%3e%3cg%20transform='translate(20,%2020)'%3e%3c!--%20Head%20--%3e%3ccircle%20cx='0'%20cy='-6'%20r='3'%20fill='black'/%3e%3c!--%20Body%20(V-shape%20torso)%20--%3e%3cpath%20d='M-4%20-2%20L0%202%20L4%20-2%20L2%206%20L-2%206%20Z'%20fill='black'/%3e%3c!--%20Left%20arm%20raised%20--%3e%3cpath%20d='M-4%20-2%20L-8%20-8%20L-6%20-10%20L-2%20-4'%20fill='black'/%3e%3c!--%20Right%20arm%20raised%20--%3e%3cpath%20d='M4%20-2%20L8%20-8%20L6%20-10%20L2%20-4'%20fill='black'/%3e%3c!--%20Legs%20--%3e%3cpath%20d='M-2%206%20L-3%2012%20L-1%2012%20L0%206'%20fill='black'/%3e%3cpath%20d='M2%206%20L3%2012%20L1%2012%20L0%206'%20fill='black'/%3e%3c/g%3e%3c/svg%3e";class Yb{STORAGE_KEY="crm_branding_config";MAX_FILE_SIZE=2*1024*1024;SUPPORTED_FORMATS=["image/png","image/jpeg","image/jpg","image/svg+xml","image/webp"];getCurrentLogo(){try{const n=localStorage.getItem(this.STORAGE_KEY);if(n){const t=JSON.parse(n);return t.logoMetadata.uploadDate=new Date(t.logoMetadata.uploadDate),t}}catch(n){console.warn("Failed to load branding config from localStorage:",n)}return this.getDefaultConfig()}getDefaultConfig(){return{logoUrl:ii,logoType:"default",logoMetadata:{filename:"default-logo.svg",originalName:"default-logo.svg",size:0,format:"image/svg+xml",uploadDate:new Date,uploadedBy:"system"},fallbackLogo:ii}}async updateLogo(n,t){const s=this.validateLogoFile(n);if(!s.isValid)throw new Error(`Logo validation failed: ${s.errors.join(", ")}`);try{const l=await this.fileToBase64(n),u=await this.getImageDimensions(l),f={logoUrl:l,logoType:"custom",logoMetadata:{filename:`custom-logo-${Date.now()}.${this.getFileExtension(n.name)}`,originalName:n.name,size:n.size,format:n.type,dimensions:u,uploadDate:new Date,uploadedBy:t},fallbackLogo:ii};return localStorage.setItem(this.STORAGE_KEY,JSON.stringify(f)),f}catch(l){throw console.error("Failed to update logo:",l),new Error("Failed to process logo file. Please try again.")}}resetToDefault(){const n=this.getDefaultConfig();return localStorage.removeItem(this.STORAGE_KEY),n}validateLogoFile(n){const t=[];return this.SUPPORTED_FORMATS.includes(n.type)||t.push("Unsupported file format. Supported formats: PNG, JPG, SVG, WebP"),n.size>this.MAX_FILE_SIZE&&t.push(`File size too large. Maximum size: ${this.MAX_FILE_SIZE/(1024*1024)}MB`),n.size===0&&t.push("File is empty"),(!n.name||n.name.trim()==="")&&t.push("Invalid file name"),{isValid:t.length===0,errors:t}}fileToBase64(n){return new Promise((t,s)=>{const l=new FileReader;l.onload=()=>{typeof l.result=="string"?t(l.result):s(new Error("Failed to convert file to base64"))},l.onerror=()=>s(new Error("Failed to read file")),l.readAsDataURL(n)})}getImageDimensions(n){return new Promise((t,s)=>{const l=new Image;l.onload=()=>{t({width:l.width,height:l.height})},l.onerror=()=>s(new Error("Failed to load image")),l.src=n})}getFileExtension(n){return n.split(".").pop()?.toLowerCase()||"png"}getLogoHistory(){try{const n=localStorage.getItem(`${this.STORAGE_KEY}_history`);return n?JSON.parse(n):[]}catch{return[]}}clearBrandingData(){localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(`${this.STORAGE_KEY}_history`)}}const ml=new Yb,Xb=({variant:a="header",size:n="auto",className:t="",alt:s="Company Logo",onClick:l})=>{const[u,f]=z.useState(ii),[h,g]=z.useState(!0);z.useEffect(()=>{const S=()=>{try{const T=ml.getCurrentLogo();f(T.logoUrl)}catch(T){console.warn("Failed to load logo, using default:",T),f(ii)}finally{g(!1)}};S();const x=T=>{T.key==="crm_branding_config"&&S()};window.addEventListener("storage",x);const C=()=>{S()};return window.addEventListener("logoUpdated",C),()=>{window.removeEventListener("storage",x),window.removeEventListener("logoUpdated",C)}},[]);const m=["logo",`logo--${a}`,`logo--${n}`,h?"logo--loading":"",t].filter(Boolean).join(" "),p=()=>{console.warn("Logo failed to load, falling back to default"),f(ii)};return h?o.jsx("div",{className:m,children:o.jsx("div",{className:"logo__placeholder"})}):o.jsx("div",{className:m,onClick:l,children:o.jsx("img",{src:u,alt:s,className:"logo__image",role:"img","aria-label":"Company branding logo",onError:p})})},Jb=({currentView:a,onViewChange:n})=>{const{currentUser:t,logout:s,hasPermission:l}=Vt(),[u,f]=z.useState(!1),h=()=>{window.confirm("Are you sure you want to logout?")&&s()},g=x=>{n(x),f(!1)},m=()=>{f(!u)},p=()=>{f(!1)};z.useEffect(()=>{const x=()=>{window.innerWidth>1024&&f(!1)};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const S=[{id:"dashboard",label:"Dashboard",icon:"",view:"dashboard"},{id:"contacts",label:"Contacts",icon:"",view:"contacts"},{id:"add-contact",label:"Add Contact",icon:"",view:"add-contact"},{id:"service-tracking",label:"Service Tracking",icon:"",view:"service-tracking"},...l("Admin")?[{id:"users",label:"User Management",icon:"",view:"users"}]:[]];return o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"mobile-nav-toggle",onClick:m,"aria-label":"Toggle navigation menu",children:u?"":""}),o.jsx("div",{className:`mobile-nav-overlay ${u?"active":""}`,onClick:p}),o.jsxs("nav",{className:`navigation ${u?"mobile-open":""}`,children:[o.jsx("div",{className:"nav-header",children:o.jsxs("div",{className:"nav-logo",children:[o.jsx(Xb,{variant:"header",size:"auto",alt:"Hopeline Care Logo"}),o.jsxs("div",{className:"nav-logo-text",children:[o.jsx("h1",{children:"Hopeline Care"}),o.jsx("span",{children:"Contact Management"})]})]})}),o.jsx("div",{className:"nav-menu",children:S.map(x=>o.jsxs("button",{onClick:()=>g(x.view),className:`nav-item ${a===x.view?"active":""}`,children:[o.jsx("span",{className:"nav-icon",children:x.icon}),o.jsx("span",{className:"nav-label",children:x.label})]},x.id))}),o.jsxs("div",{className:"nav-user",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("div",{className:"user-avatar",children:t?.username.charAt(0).toUpperCase()}),o.jsxs("div",{className:"user-details",children:[o.jsx("div",{className:"user-name",children:t?.username}),o.jsx("div",{className:"user-role",children:t?.role}),o.jsxs("div",{className:"device-info",children:[Ke.getDeviceInfo().deviceType," Device"]})]})]}),o.jsxs("div",{className:"user-permissions",children:[o.jsxs("div",{className:"permission-item",children:[o.jsx("span",{className:"permission-label",children:"Manage Contacts:"}),o.jsx("span",{className:`permission-status ${l("Editor")?"allowed":"denied"}`,children:l("Editor")?"":""})]}),o.jsxs("div",{className:"permission-item",children:[o.jsx("span",{className:"permission-label",children:"Manage Users:"}),o.jsx("span",{className:`permission-status ${l("Admin")?"allowed":"denied"}`,children:l("Admin")?"":""})]})]}),o.jsx("div",{className:"nav-export",children:o.jsx(fp,{contacts:Ke.getContacts(),variant:"secondary",size:"small"})}),o.jsxs("button",{onClick:h,className:"logout-btn",children:[o.jsx("span",{children:""}),"Logout"]})]})]})]})},sa={MANAGE_USERS:"manage_users",MANAGE_CONTACTS:"manage_contacts",EXPORT_DATA:"export_data",DELETE_CONTACTS:"delete_contacts",VIEW_ALL_CONTACTS:"view_all_contacts",VIEW_OWN_CONTACTS:"view_own_contacts",EXPORT_ALL_DATA:"export_all_data",EXPORT_OWN_DATA:"export_own_data",VIEW_ALL_SERVICES:"view_all_services",VIEW_OWN_SERVICES:"view_own_services",EDIT_SETTINGS:"edit_settings"},qb={Admin:[sa.MANAGE_USERS,sa.MANAGE_CONTACTS,sa.EXPORT_DATA,sa.EXPORT_ALL_DATA,sa.DELETE_CONTACTS,sa.VIEW_ALL_CONTACTS,sa.VIEW_ALL_SERVICES,sa.EDIT_SETTINGS],Editor:[sa.MANAGE_CONTACTS,sa.EXPORT_OWN_DATA,sa.VIEW_OWN_CONTACTS,sa.VIEW_OWN_SERVICES]},bo=(a,n)=>a?qb[a.role].includes(n):!1,uf=a=>bo(a,sa.DELETE_CONTACTS),co=(a,n)=>a?a.role==="Admin"?!0:a.role==="Editor"?a.username===n:!1:!1,$b=(a,n)=>a?a.role==="Admin"?!0:a.role==="Editor"?a.username===n:!1:!1,Qb=a=>bo(a,sa.VIEW_ALL_CONTACTS),Ev=a=>bo(a,sa.EXPORT_OWN_DATA)&&!bo(a,sa.EXPORT_ALL_DATA),dp=(a,n)=>n?Qb(n)?a:a.filter(t=>co(n,t.createdBy)):[],hp=(a,n)=>n?n.role==="Admin"?a:a.filter(t=>$b(n,t.userId)):[],mp=(a,n)=>n?n.role==="Admin"?a:a.filter(t=>t.userId===n.username):[],Bf=(a,n)=>n?n.role==="Admin"?a:a.filter(t=>t.username===n.username):[],Kf=a=>a?.role==="Admin",vp=a=>!a||a.role==="Admin"?"all":a.username,Zb=(a,n)=>!n||n.role==="Admin"?a:{...a,contacts:a.contacts?dp(a.contacts,n):[],services:a.services?hp(a.services,n):[],sessions:a.sessions?mp(a.sessions,n):[]},eN={filters:{},contacts:[],isLoading:!1,error:null},tN=(a,n)=>{switch(n.type){case"SET_LOADING":return{...a,isLoading:n.payload};case"SET_ERROR":return{...a,error:n.payload,isLoading:!1};case"SET_CONTACTS":const t=WS(n.payload);return{...a,contacts:t,isLoading:!1,error:null};case"UPDATE_FILTER":const s={...a.filters,[n.payload.key]:n.payload.value};return Object.keys(s).forEach(l=>{const u=s[l];(u===""||u===null||u===void 0||Array.isArray(u)&&u.length===0)&&delete s[l]}),{...a,filters:s};case"CLEAR_FILTERS":return{...a,filters:{}};default:return a}},gp=z.createContext(void 0),aN=({children:a})=>{const[n,t]=z.useReducer(tN,eN),{currentUser:s}=Vt(),l=z.useMemo(()=>{if(!n.contacts.length)return[];if(!s)return[];const D=dp(n.contacts,s);return GS(D,n.filters)},[n.contacts,n.filters,s]);z.useEffect(()=>{u()},[s]);const u=async()=>{t({type:"SET_LOADING",payload:!0});try{const D=Ke.getContacts();t({type:"SET_CONTACTS",payload:D})}catch(D){const b=D instanceof Error?D.message:"Failed to load contacts";t({type:"SET_ERROR",payload:b})}},f=(D,b)=>{t({type:"UPDATE_FILTER",payload:{key:D,value:b}})},h=()=>{t({type:"CLEAR_FILTERS"})},g=()=>{},m=()=>{t({type:"CLEAR_FILTERS"})},p=()=>{u()},S=Object.keys(n.filters).length>0,x=l.length,C=n.contacts.length,T=l.length,y=Object.entries(n.filters).map(([D,b])=>Array.isArray(b)?`${D}: ${b.join(", ")}`:`${D}: ${b}`),_=(D,b)=>{const K=new Date;switch(D){case"recent":const q=new Date(K.getTime()-6048e5);f("dateRange",{startDate:q,endDate:K});break;case"thisWeek":const B=new Date(K.setDate(K.getDate()-K.getDay()));f("dateRange",{startDate:B,endDate:new Date});break;case"thisMonth":const Z=new Date(K.getFullYear(),K.getMonth(),1);f("dateRange",{startDate:Z,endDate:new Date});break;case"byStatus":b&&f("statusKontak",[b]);break}},w=D=>{f("globalSearch",D)},k={filters:n.filters,filteredContacts:l,isLoading:n.isLoading,error:n.error,hasActiveFilters:S,filterCount:x,filterSummary:y,totalContacts:C,filteredCount:T,updateFilter:f,clearFilters:h,applyFilters:g,resetFilters:m,refreshContacts:p,applyQuickFilter:_,searchContacts:w};return o.jsx(gp.Provider,{value:k,children:a})},di=()=>{const a=z.useContext(gp);if(!a)throw new Error("useFilter must be used within a FilterProvider");return a},nN=({history:a,isExpanded:n=!1,maxEntries:t=5})=>{const[s,l]=z.useState(n),[u,f]=z.useState(!1),h=[...a].sort((T,y)=>new Date(y.timestamp).getTime()-new Date(T.timestamp).getTime()),g=u?h:h.slice(0,t),m=h.length>t,p=T=>{const y=new Date(T),w=new Date().getTime()-y.getTime(),k=Math.floor(w/(1e3*60*60*24)),D=Math.floor(w/(1e3*60*60)),b=Math.floor(w/(1e3*60));return b<1?"Baru saja":b<60?`${b} menit yang lalu`:D<24?`${D} jam yang lalu`:k<7?`${k} hari yang lalu`:y.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},S=T=>{switch(T){case"created":return"";case"updated":return"";case"status_changed":return"";default:return""}},x=T=>{switch(T){case"created":return"success";case"updated":return"info";case"status_changed":return"warning";default:return"default"}},C=T=>{const y=Ke.getUserByUsername(T);if(y)return y.username;const _=Ke.getUserById(T);return _?_.username:T||"Unknown"};return!a||a.length===0?o.jsx("div",{className:"contact-history empty",children:o.jsx("p",{className:"empty-message",children:"Belum ada riwayat perubahan"})}):o.jsxs("div",{className:"contact-history",children:[o.jsx("div",{className:"history-header",children:o.jsxs("button",{className:"history-toggle",onClick:()=>l(!s),"aria-expanded":s,children:[o.jsx("span",{className:"toggle-icon",children:s?"":""}),o.jsxs("span",{className:"history-title",children:["Riwayat Perubahan (",h.length,")"]})]})}),s&&o.jsxs("div",{className:"history-content",children:[o.jsx("div",{className:"history-timeline",children:g.map((T,y)=>o.jsxs("div",{className:"history-entry",children:[o.jsxs("div",{className:"entry-marker",children:[o.jsx("span",{className:`entry-icon ${x(T.action)}`,children:S(T.action)}),y<g.length-1&&o.jsx("div",{className:"entry-line"})]}),o.jsxs("div",{className:"entry-content",children:[o.jsxs("div",{className:"entry-header",children:[o.jsx("span",{className:"entry-user",children:C(T.updatedBy)}),o.jsx("span",{className:"entry-time",children:p(T.timestamp)})]}),o.jsxs("div",{className:"entry-details",children:[T.notes&&o.jsx("p",{className:"entry-notes",children:T.notes}),T.field&&T.oldValue&&T.newValue&&o.jsxs("div",{className:"entry-change",children:[o.jsxs("span",{className:"field-name",children:[T.field,":"]}),o.jsxs("div",{className:"value-change",children:[o.jsxs("span",{className:"old-value",children:['"',T.oldValue,'"']}),o.jsx("span",{className:"arrow",children:""}),o.jsxs("span",{className:"new-value",children:['"',T.newValue,'"']})]})]})]})]})]},T.id))}),m&&o.jsx("div",{className:"history-actions",children:o.jsx("button",{className:"show-more-btn",onClick:()=>f(!u),children:u?"Tampilkan lebih sedikit":`Tampilkan ${h.length-t} lainnya`})})]})]})},_v=({history:a,maxEntries:n=3})=>{const t=[...a].sort((h,g)=>new Date(g.timestamp).getTime()-new Date(h.timestamp).getTime()),s=t.slice(0,n);if(s.length===0)return o.jsx("span",{className:"history-compact empty",children:"Belum ada riwayat"});const l=s[0],u=h=>{const g=Ke.getUserByUsername(h);if(g)return g.username;const m=Ke.getUserById(h);return m?m.username:h||"Unknown"},f=h=>{const g=new Date(h),p=new Date().getTime()-g.getTime(),S=Math.floor(p/(1e3*60*60*24)),x=Math.floor(p/(1e3*60*60));return x<1?"Baru saja":x<24?`${x}j`:S<30?`${S}h`:g.toLocaleDateString("id-ID",{day:"numeric",month:"short"})};return o.jsxs("div",{className:"history-compact",children:[o.jsxs("span",{className:"last-update",children:["Terakhir diubah oleh ",u(l.updatedBy),"  ",f(l.timestamp)]}),t.length>1&&o.jsxs("span",{className:"history-count",children:["+",t.length-1," perubahan lainnya"]})]})};class rN{formatPhoneNumber(n){let t=n.replace(/\D/g,"");return t.startsWith("0")?t="62"+t.substring(1):t.startsWith("8")?t="62"+t:t.startsWith("62")||(t="62"+t),t}generateWhatsAppURL(n,t){const s=this.formatPhoneNumber(n),l="https://wa.me/";if(t){const u=encodeURIComponent(t);return`${l}${s}?text=${u}`}return`${l}${s}`}isValidPhoneNumber(n){if(!n)return!1;const t=n.replace(/\D/g,"");return t.length<10||t.length>15?!1:t.startsWith("62")||t.startsWith("0")||t.startsWith("8")}openWhatsApp(n,t){const s=this.generateWhatsAppURL(n,t);window.open(s,"_blank","noopener,noreferrer")}getMessageTemplates(){return[{id:"follow_up_1",name:"Follow Up - General",message:"Halo {name}, terima kasih telah menghubungi Hopeline Care. Apakah ada yang bisa kami bantu lebih lanjut?",category:"follow_up",variables:["name"]},{id:"follow_up_2",name:"Follow Up - Service",message:"Halo {name}, bagaimana kabar Anda setelah layanan kemarin? Apakah ada yang ingin Anda sampaikan?",category:"follow_up",variables:["name"]},{id:"appointment_reminder",name:"Appointment Reminder",message:"Halo {name}, ini pengingat untuk janji temu Anda pada {date} pukul {time}. Mohon konfirmasi kehadiran Anda.",category:"appointment",variables:["name","date","time"]},{id:"service_completion",name:"Service Completion",message:"Halo {name}, terima kasih telah menggunakan layanan Hopeline Care. Semoga Anda merasa terbantu. Jangan ragu untuk menghubungi kami lagi.",category:"service_completion",variables:["name"]},{id:"welcome_message",name:"Welcome Message",message:"Selamat datang di Hopeline Care, {name}! Kami siap membantu Anda. Silakan sampaikan apa yang bisa kami bantu.",category:"general",variables:["name"]},{id:"check_in",name:"Check In",message:"Halo {name}, kami ingin menanyakan kabar Anda. Bagaimana perasaan Anda hari ini?",category:"follow_up",variables:["name"]}]}processTemplate(n,t){let s=n.message;return n.variables.forEach(l=>{const u=`{${l}}`,f=t[l]||u;s=s.replace(new RegExp(u,"g"),f)}),s}getMessageHistory(n){try{const t=localStorage.getItem(`whatsapp_history_${n}`);return t?JSON.parse(t).map(l=>({...l,sentAt:new Date(l.sentAt)})):[]}catch(t){return console.error("Error loading WhatsApp history:",t),[]}}saveMessageToHistory(n){try{const t={...n,id:this.generateMessageId(),sentAt:new Date},s=this.getMessageHistory(n.contactId),l=[t,...s].slice(0,50);localStorage.setItem(`whatsapp_history_${n.contactId}`,JSON.stringify(l))}catch(t){console.error("Error saving WhatsApp history:",t)}}generateMessageId(){return`wa_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}sendMessage(n,t,s,l,u){if(!this.isValidPhoneNumber(t))throw new Error("Invalid phone number format");this.openWhatsApp(t,s),this.saveMessageToHistory({contactId:n,phoneNumber:this.formatPhoneNumber(t),message:s,template:u,sentBy:l})}getMessageStats(n){try{const t=Object.keys(localStorage).filter(p=>p.startsWith("whatsapp_history_"));let s=0,l=0;const u=new Map,f=new Set,h=new Date,g=new Date(h.getFullYear(),h.getMonth(),1);t.forEach(p=>{const S=p.replace("whatsapp_history_","");this.getMessageHistory(S).forEach(C=>{if(s++,f.add(S),C.sentAt>=g&&l++,C.template){const T=u.get(C.template)||0;u.set(C.template,T+1)}})});const m=Array.from(u.entries()).map(([p,S])=>({template:p,count:S})).sort((p,S)=>S.count-p.count).slice(0,5);return{totalMessages:s,messagesThisMonth:l,topTemplates:m,activeContacts:f.size}}catch(t){return console.error("Error calculating WhatsApp stats:",t),{totalMessages:0,messagesThisMonth:0,topTemplates:[],activeContacts:0}}}}const Cn=new rN,{formatPhoneNumber:WN,generateWhatsAppURL:VN,openWhatsApp:YN,getMessageTemplates:XN,processTemplate:JN,isValidPhoneNumber:qN,sendMessage:$N,getMessageHistory:QN,getMessageStats:ZN}=Cn;class $r{static instance;constructor(){}static getInstance(){return $r.instance||($r.instance=new $r),$r.instance}addServiceEntry(n){const t={...n,id:Zs(),createdAt:new Date,updatedAt:new Date};this.validateServiceEntry(t);const s=this.getAllServices();return s.push(t),this.saveServices(s),this.updateServiceMetrics(n.contactId,n.userId),t}getAllServices(){try{const n=localStorage.getItem(Zc.SERVICES);return n?JSON.parse(n).map(s=>({...s,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)})):[]}catch(n){return console.error("Error loading services:",n),[]}}getServicesByContact(n){return this.getAllServices().filter(t=>t.contactId===n)}getServicesByUser(n){return this.getAllServices().filter(t=>t.userId===n)}getServicesByDate(n){return this.getAllServices().filter(t=>t.date===n)}getServicesByContactAndUser(n,t){return this.getAllServices().filter(s=>s.contactId===n&&s.userId===t)}updateServiceEntry(n,t){const s=this.getAllServices(),l=s.findIndex(f=>f.id===n);if(l===-1)return null;const u={...s[l],...t,updatedAt:new Date};return this.validateServiceEntry(u),s[l]=u,this.saveServices(s),this.updateServiceMetrics(u.contactId,u.userId),u}deleteServiceEntry(n){const t=this.getAllServices(),s=t.findIndex(u=>u.id===n);if(s===-1)return!1;const l=t[s];return t.splice(s,1),this.saveServices(t),this.updateServiceMetrics(l.contactId,l.userId),!0}getServiceMetrics(n,t){const s=this.getServicesByContactAndUser(n,t);return s.length===0?null:this.calculateServiceMetrics(n,t,s)}getAllServiceMetrics(){const n=this.getAllServices(),t=new Map;return n.forEach(s=>{const l=`${s.contactId}-${s.userId}`;if(!t.has(l)){const u=this.calculateServiceMetrics(s.contactId,s.userId,this.getServicesByContactAndUser(s.contactId,s.userId));t.set(l,u)}}),Array.from(t.values())}getContactServiceSummary(n){const t=this.getServicesByContact(n),s=new Set(t.map(m=>m.date)),l=t.reduce((m,p)=>m+p.duration,0),u=new Set(t.map(m=>m.userId)).size,h=t.sort((m,p)=>new Date(p.createdAt).getTime()-new Date(m.createdAt).getTime())[0],g=this.calculateMonthlyTrend(t);return{contactId:n,totalServiceDays:s.size,totalServiceHours:Math.round(l/60*100)/100,activeUsers:u,lastServiceDate:h?h.createdAt:new Date(0),lastServiceUser:h?h.userId:"",monthlyTrend:g}}saveServices(n){try{localStorage.setItem(Zc.SERVICES,JSON.stringify(n))}catch(t){throw console.error("Error saving services:",t),new Error("Failed to save service data")}}validateServiceEntry(n){const t=Cr;if(n.duration<0)throw new Error("Service duration cannot be negative");if(n.duration===0&&n.serviceType!=="WhatsApp Chat")throw new Error("Service duration must be greater than 0 for non-chat services");if(n.duration>t.maxDurationPerSession)throw new Error(`Service duration cannot exceed ${t.maxDurationPerSession} minutes per session`);const s=new Date(n.date),l=new Date,u=new Date;if(u.setDate(l.getDate()-t.maxPastDate),s>l)throw new Error("Cannot log services for future dates");if(s<u)throw new Error(`Cannot log services older than ${t.maxPastDate} days`);if(n.serviceType!=="WhatsApp Chat"&&this.getServicesByDate(n.date).filter(g=>g.contactId===n.contactId&&g.userId===n.userId&&g.id!==n.id&&g.serviceType!=="WhatsApp Chat").reduce((g,m)=>g+m.duration,0)+n.duration>t.maxDurationPerDay)throw new Error(`Total daily service duration cannot exceed ${t.maxDurationPerDay} minutes`)}calculateServiceMetrics(n,t,s){if(s.length===0)return{contactId:n,userId:t,serviceCount:0,totalDuration:0,firstService:new Date,lastService:new Date,averageDuration:0,servicesThisMonth:0,durationThisMonth:0};const u=new Set(s.map(_=>_.date)).size,f=s.reduce((_,w)=>_+w.duration,0),h=s.sort((_,w)=>new Date(_.createdAt).getTime()-new Date(w.createdAt).getTime()),g=h[0].createdAt,m=h[h.length-1].createdAt,p=Math.round(f/u),S=new Date;S.setDate(1),S.setHours(0,0,0,0);const x=s.filter(_=>new Date(_.createdAt)>=S),T=new Set(x.map(_=>_.date)).size,y=x.reduce((_,w)=>_+w.duration,0);return{contactId:n,userId:t,serviceCount:u,totalDuration:f,firstService:g,lastService:m,averageDuration:p,servicesThisMonth:T,durationThisMonth:y}}calculateMonthlyTrend(n){const t=new Map,s=[];for(let l=5;l>=0;l--){const u=new Date;u.setMonth(u.getMonth()-l);const f=u.toISOString().slice(0,7);s.push(f),t.set(f,{serviceCount:new Set,duration:0})}return n.forEach(l=>{const u=l.date.slice(0,7);if(t.has(u)){const f=t.get(u);f.serviceCount.add(l.date),f.duration+=l.duration}}),s.map(l=>({month:l,serviceCount:t.get(l).serviceCount.size,duration:t.get(l).duration}))}updateServiceMetrics(n,t){}clearAllServices(){localStorage.removeItem(Zc.SERVICES),localStorage.removeItem(Zc.SERVICE_METRICS)}exportServiceData(){return{services:this.getAllServices(),metrics:this.getAllServiceMetrics()}}importServiceData(n){n.services.forEach(t=>this.validateServiceEntry(t)),this.saveServices(n.services)}initializeDemoServiceData(){if(this.getAllServices().length>0)return;console.log("Initializing demo service data...");const t=[],s=new Date,l=["demo-1","demo-2","demo-3","demo-4"],u=["admin","editor"],f=["Konseling","Follow Up","Konsultasi","Terapi","Assessment"],h=["Sesi konseling individual","Follow up progress klien","Konsultasi masalah keluarga","Terapi trauma","Assessment awal","Sesi lanjutan","Evaluasi progress","Konseling kelompok"];for(let g=0;g<30;g++){const m=new Date(s);if(m.setDate(s.getDate()-g),m.getDay()===0||m.getDay()===6)continue;const p=Math.floor(Math.random()*4);for(let S=0;S<p;S++){const x=l[Math.floor(Math.random()*l.length)],C=u[Math.floor(Math.random()*u.length)],T=f[Math.floor(Math.random()*f.length)],y=h[Math.floor(Math.random()*h.length)],_=30+Math.floor(Math.random()*151);t.push({contactId:x,userId:C,date:m.toISOString().split("T")[0],duration:_,serviceType:T,description:y})}}t.forEach(g=>{this.addServiceEntry(g)}),console.log(`Added ${t.length} demo service entries`)}}const Wt=$r.getInstance(),sN=Object.freeze(Object.defineProperty({__proto__:null,ServiceStorage:$r,serviceStorage:Wt},Symbol.toStringTag,{value:"Module"})),gf=({contact:a,variant:n="primary",showTemplates:t=!0,className:s=""})=>{const{currentUser:l}=Vt(),[u,f]=z.useState(!1),[h,g]=z.useState(""),[m,p]=z.useState(null),[S,x]=z.useState(!1),C=Cn.getMessageTemplates(),T=(D,b)=>{if(l)try{const K=new Date().toISOString().split("T")[0];Wt.addServiceEntry({contactId:a.id,userId:l.username,date:K,duration:0,serviceType:"WhatsApp Chat",description:`${D}: ${b.substring(0,100)}${b.length>100?"...":""}`}),console.log("WhatsApp service recorded:",{contact:a.nama,user:l.username,type:D,date:K})}catch(K){console.error("Error recording WhatsApp service:",K)}},y=()=>{if(!Cn.isValidPhoneNumber(a.nomorTelepon)){alert("Nomor telepon tidak valid untuk WhatsApp");return}try{const D=`Halo ${a.nama}, saya dari Hopeline Care.`;Cn.sendMessage(a.id,a.nomorTelepon,D,l?.username||"Unknown","quick_message"),T("Quick Message",D)}catch(D){console.error("Error sending WhatsApp message:",D),alert("Gagal membuka WhatsApp. Periksa nomor telepon.")}},_=()=>{if(m){x(!0);try{const D={name:a.nama,date:new Date().toLocaleDateString("id-ID"),time:new Date().toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})},b=Cn.processTemplate(m,D);Cn.sendMessage(a.id,a.nomorTelepon,b,l?.username||"Unknown",m.id),T(`Template: ${m.name}`,b),f(!1),p(null)}catch(D){console.error("Error sending template message:",D),alert("Gagal mengirim pesan. Periksa nomor telepon.")}finally{x(!1)}}},w=()=>{if(h.trim()){x(!0);try{Cn.sendMessage(a.id,a.nomorTelepon,h,l?.username||"Unknown","custom_message"),T("Custom Message",h),f(!1),g("")}catch(D){console.error("Error sending custom message:",D),alert("Gagal mengirim pesan. Periksa nomor telepon.")}finally{x(!1)}}},k=()=>{const D=Cn.isValidPhoneNumber(a.nomorTelepon);switch(n){case"icon":return o.jsx("button",{onClick:t?()=>f(!0):y,disabled:!D,className:`whatsapp-btn whatsapp-btn-icon ${s}`,title:D?"Kirim WhatsApp":"Nomor telepon tidak valid",children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.516"})})});case"secondary":return o.jsxs("button",{onClick:t?()=>f(!0):y,disabled:!D,className:`whatsapp-btn whatsapp-btn-secondary ${s}`,children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.516"})}),"WhatsApp"]});default:return o.jsxs("button",{onClick:t?()=>f(!0):y,disabled:!D,className:`whatsapp-btn whatsapp-btn-primary ${s}`,children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.516"})}),"Kirim WhatsApp"]})}};return o.jsxs(o.Fragment,{children:[k(),u&&o.jsx("div",{className:"whatsapp-modal-overlay",onClick:()=>f(!1),children:o.jsxs("div",{className:"whatsapp-modal",onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("h3",{children:["Kirim WhatsApp ke ",a.nama]}),o.jsx("button",{onClick:()=>f(!1),className:"close-btn",children:""})]}),o.jsxs("div",{className:"modal-content",children:[o.jsx("div",{className:"contact-info",children:o.jsxs("span",{className:"phone-number",children:[" ",Cn.formatPhoneNumber(a.nomorTelepon)]})}),o.jsx("div",{className:"quick-actions",children:o.jsx("button",{onClick:y,className:"quick-action-btn",disabled:S,children:" Chat Langsung"})}),o.jsxs("div",{className:"templates-section",children:[o.jsx("h4",{children:"Template Pesan"}),o.jsx("div",{className:"templates-grid",children:C.map(D=>o.jsxs("div",{className:`template-card ${m?.id===D.id?"selected":""}`,onClick:()=>p(D),children:[o.jsx("div",{className:"template-name",children:D.name}),o.jsx("div",{className:"template-preview",children:Cn.processTemplate(D,{name:a.nama,date:new Date().toLocaleDateString("id-ID"),time:"14:00"})})]},D.id))}),m&&o.jsx("button",{onClick:_,disabled:S,className:"send-template-btn",children:S?"Mengirim...":"Kirim Template"})]}),o.jsxs("div",{className:"custom-message-section",children:[o.jsx("h4",{children:"Pesan Kustom"}),o.jsx("textarea",{value:h,onChange:D=>g(D.target.value),placeholder:"Tulis pesan kustom...",className:"custom-message-input",rows:3}),o.jsx("button",{onClick:w,disabled:!h.trim()||S,className:"send-custom-btn",children:S?"Mengirim...":"Kirim Pesan Kustom"})]})]})]})})]})},iN=({searchQuery:a,onCancel:n})=>{const s=(u=>{const f=u.trim();return/^[\d\s\-\+\(\)]+$/.test(f)&&f.length>=8?{nama:"",nomorTelepon:f.replace(/\s/g,"")}:{nama:f,nomorTelepon:""}})(a),l=()=>{n(),window.dispatchEvent(new CustomEvent("navigateToAddContact",{detail:s}))};return o.jsxs("div",{className:"quick-add-contact",children:[o.jsx("div",{className:"quick-add-header",children:o.jsxs("div",{className:"search-result-info",children:[o.jsx("span",{className:"search-icon",children:""}),o.jsxs("div",{className:"search-text",children:[o.jsxs("strong",{children:['"',a,'"']})," tidak ditemukan"]})]})}),o.jsxs("div",{className:"quick-add-content",children:[o.jsxs("div",{className:"parsed-data-preview",children:[o.jsx("h4",{children:"Data yang terdeteksi:"}),o.jsxs("div",{className:"data-preview",children:[s.nama&&o.jsxs("div",{className:"data-item",children:[o.jsx("span",{className:"data-label",children:"Nama:"}),o.jsx("span",{className:"data-value",children:s.nama})]}),s.nomorTelepon&&o.jsxs("div",{className:"data-item",children:[o.jsx("span",{className:"data-label",children:"Nomor Telepon:"}),o.jsx("span",{className:"data-value",children:s.nomorTelepon})]})]})]}),o.jsxs("div",{className:"quick-add-actions",children:[o.jsxs("button",{onClick:l,className:"quick-add-btn primary",children:[o.jsx("span",{children:""}),"Tambah Contact"]}),o.jsxs("button",{onClick:n,className:"quick-add-btn cancel",children:[o.jsx("span",{children:""}),"Batal"]})]}),o.jsx("div",{className:"quick-add-info",children:o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Tambah Contact:"})," Buka form lengkap untuk menambah contact dengan semua field yang diperlukan"]})})]})]})},lN=({onContactSelect:a,onContactEdit:n,onContactDelete:t})=>{const[s,l]=z.useState("createdAt"),[u,f]=z.useState("desc"),[h,g]=z.useState(1),[m]=z.useState(10),[p,S]=z.useState(!1),{currentUser:x}=Vt(),{filteredContacts:C,isLoading:T,refreshContacts:y,filters:_}=di();z.useEffect(()=>{y()},[y]);const w=z.useMemo(()=>{const M=[...C];return M.sort((H,ue)=>{let be=H[s],Se=ue[s];if(s==="createdAt"||s==="updatedAt"){const ee=new Date(be).getTime(),ge=new Date(Se).getTime();return u==="asc"?ee<ge?-1:ee>ge?1:0:ee>ge?-1:ee<ge?1:0}return typeof be=="string"&&typeof Se=="string"&&(be=be.toLowerCase(),Se=Se.toLowerCase()),be===void 0&&(be=""),Se===void 0&&(Se=""),u==="asc"?be<Se?-1:be>Se?1:0:be>Se?-1:be<Se?1:0}),M},[C,s,u]);z.useEffect(()=>{const M=_.globalSearch&&_.globalSearch.trim().length>0,H=w.length===0;S(!!(M&&H&&!T))},[_.globalSearch,w.length,T]);const k=Math.ceil(w.length/m),D=(h-1)*m,b=w.slice(D,D+m),K=M=>{s===M?f(u==="asc"?"desc":"asc"):(l(M),f("asc"))},q=async M=>{if(!uf(x)){alert("You do not have permission to delete contacts");return}const H=C.find(Se=>Se.id===M);if(!H){alert("Contact not found");return}if(!co(x,H.createdBy)){alert("You can only delete contacts that you created");return}const ue=` KONFIRMASI HAPUS KONTAK

Apakah Anda yakin ingin menghapus kontak berikut?

 Nama: ${H.nama}
 Telepon: ${H.nomorTelepon||"Tidak ada"}
 Provinsi: ${H.provinsi||"Tidak ada"}
 Status: ${H.statusKontak}
 Prioritas: ${H.prioritas}
 Dibuat: ${H.createdAt?ef(new Date(H.createdAt)):"Tidak diketahui"}

 PERINGATAN:
 Kontak ini akan dihapus secara permanen
 Semua riwayat perubahan akan hilang
 Data layanan terkait akan terpengaruh
 Tindakan ini TIDAK DAPAT dibatalkan

Ketik "HAPUS" untuk konfirmasi atau "Batal" untuk membatalkan.`;if(prompt(ue)==="HAPUS")try{Ke.deleteContact(M),y(),t?.(M)}catch(Se){console.error("Error deleting contact:",Se),alert("Failed to delete contact")}},B=M=>s!==M?"":u==="asc"?"":"",Z=M=>({"New Contact":"#e74c3c","In Progress":"#f39c12","Follow Up":"#3498db",Completed:"#27ae60"})[M]||"#95a5a6",L=()=>{S(!1)},X=()=>{S(!1)};return T?o.jsx("div",{className:"contact-list-loading",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading contacts..."})]})}):o.jsxs("div",{className:"contact-list",children:[o.jsxs("div",{className:"contact-list-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h2",{children:"Contact Management"}),o.jsx("div",{className:"contact-list-stats",children:o.jsxs("span",{children:["Showing: ",w.length," contacts"]})})]}),o.jsx("div",{className:"header-actions",children:o.jsx(fp,{contacts:w,variant:"primary",size:"medium"})})]}),p?o.jsx(iN,{searchQuery:_.globalSearch||"",onContactAdded:L,onCancel:X}):w.length===0?o.jsx("div",{className:"no-contacts",children:o.jsx("p",{children:"No contacts found matching current filters"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"contact-table-container",children:o.jsxs("table",{className:"contact-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsxs("th",{onClick:()=>K("nama"),className:"sortable",children:["Nama ",B("nama")]}),o.jsxs("th",{onClick:()=>K("nomorTelepon"),className:"sortable",children:["Telepon ",B("nomorTelepon")]}),o.jsxs("th",{onClick:()=>K("provinsi"),className:"sortable",children:["Provinsi ",B("provinsi")]}),o.jsxs("th",{onClick:()=>K("sumber"),className:"sortable",children:["Sumber ",B("sumber")]}),o.jsxs("th",{onClick:()=>K("prioritas"),className:"sortable",children:["Prioritas ",B("prioritas")]}),o.jsxs("th",{onClick:()=>K("statusKontak"),className:"sortable",children:["Status ",B("statusKontak")]}),o.jsxs("th",{onClick:()=>K("createdAt"),className:"sortable",children:["Created ",B("createdAt")]}),o.jsx("th",{children:"Actions"})]})}),o.jsx("tbody",{children:b.map(M=>o.jsxs("tr",{className:"contact-row",children:[o.jsx("td",{className:"contact-name",children:o.jsxs("div",{className:"name-with-history",children:[o.jsx("strong",{children:M.nama}),o.jsx(_v,{history:M.history||[],maxEntries:1})]})}),o.jsx("td",{className:"contact-phone",children:M.nomorTelepon||"-"}),o.jsx("td",{className:"contact-city",children:M.provinsi||"-"}),o.jsx("td",{className:"contact-sumber",children:o.jsx("span",{className:"sumber-badge",children:M.sumber||"Lainnya"})}),o.jsx("td",{className:"contact-priority",children:o.jsx("span",{className:`priority-badge priority-${(M.prioritas||"sedang").toLowerCase()}`,children:M.prioritas||"Sedang"})}),o.jsx("td",{children:o.jsx("span",{className:"status-badge",style:{backgroundColor:Z(M.statusKontak)},children:M.statusKontak})}),o.jsx("td",{className:"contact-date",children:M.createdAt?ef(new Date(M.createdAt)):"No Date"}),o.jsxs("td",{className:"contact-actions",children:[o.jsx(gf,{contact:M,variant:"icon",showTemplates:!1,className:"contact-list-whatsapp"}),o.jsx("button",{onClick:()=>a?.(M),className:"action-btn view-btn",title:"View Details",children:""}),o.jsx("button",{onClick:()=>n?.(M),className:"action-btn edit-btn",title:"Edit Contact",children:""}),uf(x)&&co(x,M.createdBy)&&o.jsx("button",{onClick:()=>q(M.id),className:"action-btn delete-btn",title:"Delete Contact",children:""})]})]},M.id))})]})}),o.jsx("div",{className:"contact-cards",children:b.map(M=>o.jsxs("div",{className:"contact-card",children:[o.jsxs("div",{className:"contact-card-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"contact-card-name",children:M.nama}),o.jsx("div",{className:"contact-card-phone",children:M.nomorTelepon||"No Phone"})]}),o.jsxs("div",{className:"contact-card-badges",children:[o.jsx("span",{className:"status-badge",style:{backgroundColor:Z(M.statusKontak)},children:M.statusKontak}),o.jsx("span",{className:`priority-badge priority-${(M.prioritas||"sedang").toLowerCase()}`,children:M.prioritas||"Sedang"})]})]}),o.jsxs("div",{className:"contact-card-body",children:[o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"Provinsi"}),o.jsx("div",{className:"contact-card-value",children:M.provinsi||"-"})]}),o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"Sumber"}),o.jsx("div",{className:"contact-card-value",children:o.jsx("span",{className:"sumber-badge",children:M.sumber||"Lainnya"})})]}),o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"Created"}),o.jsx("div",{className:"contact-card-value",children:M.createdAt?ef(new Date(M.createdAt)):"No Date"})]}),o.jsxs("div",{className:"contact-card-field",children:[o.jsx("div",{className:"contact-card-label",children:"History"}),o.jsx("div",{className:"contact-card-value",children:o.jsx(_v,{history:M.history||[],maxEntries:1})})]})]}),o.jsxs("div",{className:"contact-card-actions",children:[o.jsx(gf,{contact:M,variant:"button",showTemplates:!1,size:"small"}),o.jsx("button",{onClick:()=>a?.(M),className:"action-btn view-btn",children:" View"}),o.jsx("button",{onClick:()=>n?.(M),className:"action-btn edit-btn",children:" Edit"}),uf(x)&&co(x,M.createdBy)&&o.jsx("button",{onClick:()=>q(M.id),className:"action-btn delete-btn",children:" Delete"})]})]},M.id))}),k>1&&o.jsxs("div",{className:"pagination",children:[o.jsx("button",{onClick:()=>g(M=>Math.max(M-1,1)),disabled:h===1,className:"pagination-btn",children:"Previous"}),o.jsxs("div",{className:"pagination-info",children:["Page ",h," of ",k]}),o.jsx("button",{onClick:()=>g(M=>Math.min(M+1,k)),disabled:h===k,className:"pagination-btn",children:"Next"})]})]})]})},cN=()=>{const[a,n]=z.useState([]),[t,s]=z.useState(!0);z.useEffect(()=>{const p=()=>{try{s(!0);const C=Ke.getContacts();n(C)}catch(C){console.error("Error loading contacts for suggestions:",C),n([])}finally{s(!1)}};p();const S=C=>{C.key==="crm_contacts"&&p()},x=()=>{p()};return window.addEventListener("storage",S),window.addEventListener("contactsUpdated",x),()=>{window.removeEventListener("storage",S),window.removeEventListener("contactsUpdated",x)}},[]);const l=z.useMemo(()=>{if(t||a.length===0)return{names:[],phoneNumbers:[]};const p=new Set,S=new Set;a.forEach(T=>{T.nama&&T.nama.trim()&&p.add(T.nama.trim()),T.nomorTelepon&&T.nomorTelepon.trim()&&S.add(T.nomorTelepon.trim())});const x=Array.from(p).sort((T,y)=>T.toLowerCase().localeCompare(y.toLowerCase())),C=Array.from(S).sort();return{names:x,phoneNumbers:C}},[a,t]);return{suggestions:l,isLoading:t,isNameDuplicate:p=>p.trim()?l.names.some(S=>S.toLowerCase()===p.toLowerCase()):!1,isPhoneNumberDuplicate:p=>p.trim()?l.phoneNumbers.some(S=>S===p.trim()):!1,findContactByName:p=>{if(p.trim())return a.find(S=>S.nama.toLowerCase()===p.toLowerCase())},findContactByPhoneNumber:p=>{if(p.trim())return a.find(S=>S.nomorTelepon===p.trim())},getSimilarContacts:(p,S)=>{if(!p.trim())return[];const x=p.toLowerCase();return a.filter(C=>(C[S]?.toLowerCase()||"").includes(x))},refreshSuggestions:()=>{window.dispatchEvent(new CustomEvent("contactsUpdated"))}}},ff=({id:a,value:n,onChange:t,suggestions:s,placeholder:l,className:u="",disabled:f=!1,type:h="text",maxLength:g,autoComplete:m="off",autoCorrect:p="off",autoCapitalize:S="none",spellCheck:x=!1,showDuplicateWarning:C=!0,excludeFromDuplicateCheck:T})=>{const[y,_]=z.useState([]),[w,k]=z.useState(!1),[D,b]=z.useState(-1),[K,q]=z.useState(!1),B=z.useRef(null),Z=z.useRef(null),L=z.useCallback(Ne=>Ne.trim()?s.filter(G=>G.toLowerCase().includes(Ne.toLowerCase())).sort((G,j)=>{const V=G.toLowerCase().startsWith(Ne.toLowerCase()),P=j.toLowerCase().startsWith(Ne.toLowerCase());return V&&!P?-1:!V&&P?1:G.localeCompare(j)}):[],[s]);z.useEffect(()=>{const Ne=L(n);_(Ne),k(Ne.length>0&&n.trim().length>0),b(-1)},[n,s,L]);const X=Ne=>{K||t(Ne.target.value)},M=()=>{q(!0)},H=Ne=>{q(!1),t(Ne.currentTarget.value)},ue=Ne=>{if(!(!w||y.length===0))switch(Ne.key){case"ArrowDown":Ne.preventDefault(),b(Le=>Le<y.length-1?Le+1:0);break;case"ArrowUp":Ne.preventDefault(),b(Le=>Le>0?Le-1:y.length-1);break;case"Enter":Ne.preventDefault(),D>=0&&be(y[D]);break;case"Escape":k(!1),b(-1);break;case"Tab":k(!1),b(-1);break}},be=Ne=>{t(Ne),k(!1),b(-1),B.current?.focus()},Se=()=>{n.trim()&&y.length>0&&k(!0)},ee=()=>{setTimeout(()=>{Z.current?.contains(document.activeElement)||(k(!1),b(-1))},150)},ge=Ne=>{be(Ne)},ke=C&&n.trim()&&s.some(Ne=>Ne.toLowerCase()===n.toLowerCase()&&Ne.toLowerCase()!==T?.toLowerCase());return o.jsxs("div",{className:"autocomplete-container",children:[o.jsx("input",{ref:B,id:a,type:h,value:n,onChange:X,onCompositionStart:M,onCompositionEnd:H,onKeyDown:ue,onFocus:Se,onBlur:ee,placeholder:l,className:`${u} ${ke?"duplicate-warning":""}`,disabled:f,maxLength:g,autoComplete:m,autoCorrect:p,autoCapitalize:S,spellCheck:x}),w&&y.length>0&&o.jsxs("div",{ref:Z,className:"suggestions-dropdown",children:[y.slice(0,5).map((Ne,Le)=>o.jsxs("div",{className:`suggestion-item ${Le===D?"active":""} ${Ne.toLowerCase()===n.toLowerCase()?"exact-match":""}`,onClick:()=>ge(Ne),onMouseEnter:()=>b(Le),children:[o.jsx("span",{className:"suggestion-text",children:Ne}),C&&Ne.toLowerCase()===n.toLowerCase()&&Ne.toLowerCase()!==T?.toLowerCase()&&o.jsx("span",{className:"duplicate-badge",children:"Sudah Ada"})]},Ne)),y.length>5&&o.jsxs("div",{className:"suggestions-more",children:["+",y.length-5," lainnya..."]})]}),ke&&C&&o.jsx("div",{className:"duplicate-warning-text",children:" Data ini sudah ada dalam kontak"})]})},hi={Aceh:{"Kabupaten Aceh Barat":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Barat Daya":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Besar":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Jaya":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Selatan":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Singkil":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Tamiang":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Tengah":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Tenggara":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Timur":{mission:"NSM",uni:"WIUM"},"Kabupaten Aceh Utara":{mission:"NSM",uni:"WIUM"},"Kabupaten Bener Meriah":{mission:"NSM",uni:"WIUM"},"Kabupaten Bireuen":{mission:"NSM",uni:"WIUM"},"Kabupaten Gayo Lues":{mission:"NSM",uni:"WIUM"},"Kabupaten Nagan Raya":{mission:"NSM",uni:"WIUM"},"Kabupaten Pidie":{mission:"NSM",uni:"WIUM"},"Kabupaten Pidie Jaya":{mission:"NSM",uni:"WIUM"},"Kabupaten Simeulue":{mission:"NSM",uni:"WIUM"},"Kota Banda Aceh":{mission:"NSM",uni:"WIUM"},"Kota Langsa":{mission:"NSM",uni:"WIUM"},"Kota Lhokseumawe":{mission:"NSM",uni:"WIUM"},"Kota Sabang":{mission:"NSM",uni:"WIUM"},"Kota Subulussalam":{mission:"NSM",uni:"WIUM"}},"Sumatera Utara":{"Kabupaten Asahan":{mission:"NSM",uni:"WIUM"},"Kabupaten Batu Bara":{mission:"NSM",uni:"WIUM"},"Kabupaten Dairi":{mission:"NSM",uni:"WIUM"},"Kabupaten Deli Serdang":{mission:"NSM",uni:"WIUM"},"Kabupaten Humbang Hasundutan":{mission:"CSM",uni:"WIUM"},"Kabupaten Karo":{mission:"NSM",uni:"WIUM"},"Kabupaten Labuhanbatu":{mission:"NSM",uni:"WIUM"},"Kabupaten Labuhanbatu Selatan":{mission:"NSM",uni:"WIUM"},"Kabupaten Labuhanbatu Utara":{mission:"NSM",uni:"WIUM"},"Kabupaten Langkat":{mission:"NSM",uni:"WIUM"},"Kabupaten Mandailing Natal":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias Barat":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Nias Utara":{mission:"CSM",uni:"WIUM"},"Kabupaten Padang Lawas":{mission:"NSM",uni:"WIUM"},"Kabupaten Padang Lawas Utara":{mission:"NSM",uni:"WIUM"},"Kabupaten Pakpak Bharat":{mission:"NSM",uni:"WIUM"},"Kabupaten Samosir":{mission:"NSM",uni:"WIUM"},"Kabupaten Serdang Bedagai":{mission:"NSM",uni:"WIUM"},"Kabupaten Simalungun":{mission:"NSM",uni:"WIUM"},"Kabupaten Tapanuli Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Tapanuli Tengah":{mission:"CSM",uni:"WIUM"},"Kabupaten Tapanuli Utara":{mission:"CSM",uni:"WIUM"},"Kabupaten Toba":{mission:"NSM",uni:"WIUM"},"Kota Binjai":{mission:"NSM",uni:"WIUM"},"Kota Gunungsitoli":{mission:"NSM",uni:"WIUM"},"Kota Medan":{mission:"NSM",uni:"WIUM"},"Kota Padangsidimpuan":{mission:"NSM",uni:"WIUM"},"Kota Pematangsiantar":{mission:"NSM",uni:"WIUM"},"Kota Sibolga":{mission:"NSM",uni:"WIUM"},"Kota Tanjungbalai":{mission:"NSM",uni:"WIUM"},"Kota Tebing Tinggi":{mission:"NSM",uni:"WIUM"}},"Sumatera Barat":{"Kabupaten Agam":{mission:"CSM",uni:"WIUM"},"Kabupaten Dharmasraya":{mission:"CSM",uni:"WIUM"},"Kabupaten Kepulauan Mentawai":{mission:"CSM",uni:"WIUM"},"Kabupaten Lima Puluh Kota":{mission:"CSM",uni:"WIUM"},"Kabupaten Padang Pariaman":{mission:"CSM",uni:"WIUM"},"Kabupaten Pasaman":{mission:"CSM",uni:"WIUM"},"Kabupaten Pasaman Barat":{mission:"CSM",uni:"WIUM"},"Kabupaten Pesisir Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Sijunjung":{mission:"CSM",uni:"WIUM"},"Kabupaten Solok":{mission:"CSM",uni:"WIUM"},"Kabupaten Solok Selatan":{mission:"CSM",uni:"WIUM"},"Kabupaten Tanah Datar":{mission:"CSM",uni:"WIUM"},"Kota Bukittinggi":{mission:"CSM",uni:"WIUM"},"Kota Padang":{mission:"CSM",uni:"WIUM"},"Kota Padang Panjang":{mission:"CSM",uni:"WIUM"},"Kota Pariaman":{mission:"CSM",uni:"WIUM"},"Kota Payakumbuh":{mission:"CSM",uni:"WIUM"},"Kota Sawahlunto":{mission:"CSM",uni:"WIUM"},"Kota Solok":{mission:"CSM",uni:"WIUM"}},Riau:{"Kabupaten Kampar":{mission:"CSM",uni:"WIUM"},"Kabupaten Indragiri Hulu":{mission:"CSM",uni:"WIUM"},"Kabupaten Bengkalis":{mission:"CSM",uni:"WIUM"},"Kabupaten Indragiri Hilir":{mission:"CSM",uni:"WIUM"},"Kabupaten Pelalawan":{mission:"CSM",uni:"WIUM"},"Kabupaten Rokan Hulu":{mission:"CSM",uni:"WIUM"},"Kabupaten Rokan Hilir":{mission:"CSM",uni:"WIUM"},"Kabupaten Siak":{mission:"CSM",uni:"WIUM"},"Kabupaten Kuantan Singingi":{mission:"CSM",uni:"WIUM"},"Kabupaten Kepulauan Meranti":{mission:"CSM",uni:"WIUM"},"Kota Pekanbaru":{mission:"CSM",uni:"WIUM"},"Kota Dumai":{mission:"CSM",uni:"WIUM"}},"Kepulauan Riau":{"Kabupaten Bintan":{mission:"CSM",uni:"WIUM"},"Kabupaten Karimun":{mission:"CSM",uni:"WIUM"},"Kabupaten Natuna":{mission:"CSM",uni:"WIUM"},"Kabupaten Lingga":{mission:"CSM",uni:"WIUM"},"Kabupaten Kepulauan Anambas":{mission:"CSM",uni:"WIUM"},"Kota Batam":{mission:"CSM",uni:"WIUM"},"Kota Tanjung Pinang":{mission:"CSM",uni:"WIUM"}},Jambi:{"Kabupaten Kerinci":{mission:"SSM",uni:"WIUM"},"Kabupaten Merangin":{mission:"SSM",uni:"WIUM"},"Kabupaten Sarolangun":{mission:"SSM",uni:"WIUM"},"Kabupaten Batanghari":{mission:"SSM",uni:"WIUM"},"Kabupaten Muaro Jambi":{mission:"SSM",uni:"WIUM"},"Kabupaten Tanjung Jabung Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Tanjung Jabung Timur":{mission:"SSM",uni:"WIUM"},"Kabupaten Bungo":{mission:"SSM",uni:"WIUM"},"Kabupaten Tebo":{mission:"SSM",uni:"WIUM"},"Kota Jambi":{mission:"SSM",uni:"WIUM"},"Kota Sungai Penuh":{mission:"SSM",uni:"WIUM"}},"Sumatera Selatan":{"Kabupaten Ogan Komering Ulu":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Komering Ilir":{mission:"SSM",uni:"WIUM"},"Kabupaten Muara Enim":{mission:"SSM",uni:"WIUM"},"Kabupaten Lahat":{mission:"SSM",uni:"WIUM"},"Kabupaten Musi Rawas":{mission:"SSM",uni:"WIUM"},"Kabupaten Musi Banyuasin":{mission:"SSM",uni:"WIUM"},"Kabupaten Banyuasin":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Komering Ulu Timur":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Komering Ulu Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Ogan Ilir":{mission:"SSM",uni:"WIUM"},"Kabupaten Empat Lawang":{mission:"SSM",uni:"WIUM"},"Kabupaten Penukal Abab Lematang Ilir":{mission:"SSM",uni:"WIUM"},"Kabupaten Musi Rawas Utara":{mission:"SSM",uni:"WIUM"},"Kota Palembang":{mission:"SSM",uni:"WIUM"},"Kota Pagar Alam":{mission:"SSM",uni:"WIUM"},"Kota Lubuk Linggau":{mission:"SSM",uni:"WIUM"},"Kota Prabumulih":{mission:"SSM",uni:"WIUM"}},"Kepulauan Bangka Belitung":{"Kabupaten Bangka":{mission:"SSM",uni:"WIUM"},"Kabupaten Belitung":{mission:"SSM",uni:"WIUM"},"Kabupaten Bangka Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Bangka Tengah":{mission:"SSM",uni:"WIUM"},"Kabupaten Bangka Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Belitung Timur":{mission:"SSM",uni:"WIUM"},"Kota Pangkal Pinang":{mission:"SSM",uni:"WIUM"}},Bengkulu:{"Kabupaten Bengkulu Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Rejang Lebong":{mission:"SSM",uni:"WIUM"},"Kabupaten Bengkulu Utara":{mission:"SSM",uni:"WIUM"},"Kabupaten Kaur":{mission:"SSM",uni:"WIUM"},"Kabupaten Seluma":{mission:"SSM",uni:"WIUM"},"Kabupaten Muko Muko":{mission:"SSM",uni:"WIUM"},"Kabupaten Lebong":{mission:"SSM",uni:"WIUM"},"Kabupaten Kepahiang":{mission:"SSM",uni:"WIUM"},"Kabupaten Bengkulu Tengah":{mission:"SSM",uni:"WIUM"},"Kota Bengkulu":{mission:"SSM",uni:"WIUM"}},Lampung:{"Kabupaten Lampung Selatan":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Tengah":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Utara":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Tulang Bawang":{mission:"SSM",uni:"WIUM"},"Kabupaten Tanggamus":{mission:"SSM",uni:"WIUM"},"Kabupaten Lampung Timur":{mission:"SSM",uni:"WIUM"},"Kabupaten Way Kanan":{mission:"SSM",uni:"WIUM"},"Kabupaten Pesawaran":{mission:"SSM",uni:"WIUM"},"Kabupaten Pringsewu":{mission:"SSM",uni:"WIUM"},"Kabupaten Mesuji":{mission:"SSM",uni:"WIUM"},"Kabupaten Tulang Bawang Barat":{mission:"SSM",uni:"WIUM"},"Kabupaten Pesisir Barat":{mission:"SSM",uni:"WIUM"},"Kota Bandar Lampung":{mission:"SSM",uni:"WIUM"},"Kota Metro":{mission:"SSM",uni:"WIUM"}},Banten:{"Kabupaten Pandeglang":{mission:"JBC",uni:"WIUM"},"Kabupaten Lebak":{mission:"JBC",uni:"WIUM"},"Kabupaten Tangerang":{mission:"JBC",uni:"WIUM"},"Kabupaten Serang":{mission:"JBC",uni:"WIUM"},"Kota Tangerang":{mission:"JBC",uni:"WIUM"},"Kota Cilegon":{mission:"JBC",uni:"WIUM"},"Kota Serang":{mission:"JBC",uni:"WIUM"},"Kota Tangerang Selatan":{mission:"JBC",uni:"WIUM"}},Jakarta:{"Kepulauan Seribu":{mission:"JBC",uni:"WIUM"},"Jakarta Utara":{mission:"JBC",uni:"WIUM"},"Jakarta Barat":{mission:"JBC",uni:"WIUM"},"Jakarta Pusat":{mission:"JC",uni:"CIUM"},"Jakarta Selatan":{mission:"JC",uni:"CIUM"},"Jakarta Timur":{mission:"JC",uni:"CIUM"}},"Jawa Barat":{Depok:{mission:"JC",uni:"CIUM"},Bekasi:{mission:"JC",uni:"CIUM"},Bogor:{mission:"JC",uni:"CIUM"},Karawang:{mission:"JC",uni:"CIUM"},Sukabumi:{mission:"JC",uni:"CIUM"},Purwakarta:{mission:"JC",uni:"CIUM"},"Kabupaten Cianjur":{mission:"WJC",uni:"CIUM"},"Kabupaten Bandung":{mission:"WJC",uni:"CIUM"},"Kabupaten Garut":{mission:"WJC",uni:"CIUM"},"Kabupaten Tasikmalaya":{mission:"WJC",uni:"CIUM"},"Kabupaten Ciamis":{mission:"WJC",uni:"CIUM"},"Kabupaten Kuningan":{mission:"WJC",uni:"CIUM"},"Kabupaten Cirebon":{mission:"WJC",uni:"CIUM"},"Kabupaten Majalengka":{mission:"WJC",uni:"CIUM"},"Kabupaten Sumedang":{mission:"WJC",uni:"CIUM"},"Kabupaten Indramayu":{mission:"WJC",uni:"CIUM"},"Kabupaten Subang":{mission:"WJC",uni:"CIUM"},"Kabupaten Karawang":{mission:"WJC",uni:"CIUM"},"Kabupaten Bandung Barat":{mission:"WJC",uni:"CIUM"},"Kabupaten Pangandaran":{mission:"WJC",uni:"CIUM"},"Kota Bandung":{mission:"WJC",uni:"CIUM"},"Kota Cirebon":{mission:"WJC",uni:"CIUM"},"Kota Cimahi":{mission:"WJC",uni:"CIUM"},"Kota Tasikmalaya":{mission:"WJC",uni:"CIUM"},"Kota Banjar":{mission:"WJC",uni:"CIUM"}}},oN=()=>Object.keys(hi).sort(),uN=a=>{const n=hi[a];return n?Object.keys(n).sort():[]},fN=(a,n)=>{const t=hi[a];if(!t)return"";const s=t[n];return s?s.mission:""},dN=(a,n)=>{const t=hi[a];if(!t)return"";const s=t[n];return s?s.uni:""},hN=(a,n)=>{const t=hi[a];if(!t)return null;const s=t[n];return s?{provinsi:a,kabKota:n,mission:s.mission,uni:s.uni}:null};Object.assign(hi,{"Jawa Tengah":{"Kabupaten Cilacap":{mission:"CJM",uni:"CIUM"},"Kabupaten Banyumas":{mission:"CJM",uni:"CIUM"},"Kabupaten Purbalingga":{mission:"CJM",uni:"CIUM"},"Kabupaten Banjarnegara":{mission:"CJM",uni:"CIUM"},"Kabupaten Kebumen":{mission:"CJM",uni:"CIUM"},"Kabupaten Purworejo":{mission:"CJM",uni:"CIUM"},"Kabupaten Wonosobo":{mission:"CJM",uni:"CIUM"},"Kabupaten Magelang":{mission:"CJM",uni:"CIUM"},"Kabupaten Boyolali":{mission:"CJM",uni:"CIUM"},"Kabupaten Klaten":{mission:"CJM",uni:"CIUM"},"Kabupaten Sukoharjo":{mission:"CJM",uni:"CIUM"},"Kabupaten Wonogiri":{mission:"CJM",uni:"CIUM"},"Kabupaten Karanganyar":{mission:"CJM",uni:"CIUM"},"Kabupaten Sragen":{mission:"CJM",uni:"CIUM"},"Kabupaten Grobogan":{mission:"CJM",uni:"CIUM"},"Kabupaten Blora":{mission:"CJM",uni:"CIUM"},"Kabupaten Rembang":{mission:"CJM",uni:"CIUM"},"Kabupaten Pati":{mission:"CJM",uni:"CIUM"},"Kabupaten Kudus":{mission:"CJM",uni:"CIUM"},"Kabupaten Jepara":{mission:"CJM",uni:"CIUM"},"Kabupaten Demak":{mission:"CJM",uni:"CIUM"},"Kabupaten Semarang":{mission:"CJM",uni:"CIUM"},"Kabupaten Temanggung":{mission:"CJM",uni:"CIUM"},"Kabupaten Kendal":{mission:"CJM",uni:"CIUM"},"Kabupaten Batang":{mission:"CJM",uni:"CIUM"},"Kabupaten Pekalongan":{mission:"CJM",uni:"CIUM"},"Kabupaten Pemalang":{mission:"CJM",uni:"CIUM"},"Kabupaten Tegal":{mission:"CJM",uni:"CIUM"},"Kabupaten Brebes":{mission:"CJM",uni:"CIUM"},"Kota Magelang":{mission:"CJM",uni:"CIUM"},"Kota Surakarta":{mission:"CJM",uni:"CIUM"},"Kota Salatiga":{mission:"CJM",uni:"CIUM"},"Kota Semarang":{mission:"CJM",uni:"CIUM"},"Kota Pekalongan":{mission:"CJM",uni:"CIUM"},"Kota Tegal":{mission:"CJM",uni:"CIUM"}},"DI Yogyakarta":{"Kabupaten Kulon Progo":{mission:"CJM",uni:"CIUM"},"Kabupaten Bantul":{mission:"CJM",uni:"CIUM"},"Kabupaten Gunungkidul":{mission:"CJM",uni:"CIUM"},"Kabupaten Sleman":{mission:"CJM",uni:"CIUM"},"Kota Yogyakarta":{mission:"CJM",uni:"CIUM"}},"Jawa Timur":{"Kabupaten Pacitan":{mission:"EJC",uni:"CIUM"},"Kabupaten Ponorogo":{mission:"EJC",uni:"CIUM"},"Kabupaten Trenggalek":{mission:"EJC",uni:"CIUM"},"Kabupaten Tulungagung":{mission:"EJC",uni:"CIUM"},"Kabupaten Blitar":{mission:"EJC",uni:"CIUM"},"Kabupaten Kediri":{mission:"EJC",uni:"CIUM"},"Kabupaten Malang":{mission:"EJC",uni:"CIUM"},"Kabupaten Lumajang":{mission:"EJC",uni:"CIUM"},"Kabupaten Jember":{mission:"EJC",uni:"CIUM"},"Kabupaten Banyuwangi":{mission:"EJC",uni:"CIUM"},"Kabupaten Bondowoso":{mission:"EJC",uni:"CIUM"},"Kabupaten Situbondo":{mission:"EJC",uni:"CIUM"},"Kabupaten Probolinggo":{mission:"EJC",uni:"CIUM"},"Kabupaten Pasuruan":{mission:"EJC",uni:"CIUM"},"Kabupaten Sidoarjo":{mission:"EJC",uni:"CIUM"},"Kabupaten Mojokerto":{mission:"EJC",uni:"CIUM"},"Kabupaten Jombang":{mission:"EJC",uni:"CIUM"},"Kabupaten Nganjuk":{mission:"EJC",uni:"CIUM"},"Kabupaten Madiun":{mission:"EJC",uni:"CIUM"},"Kabupaten Magetan":{mission:"EJC",uni:"CIUM"},"Kabupaten Ngawi":{mission:"EJC",uni:"CIUM"},"Kabupaten Bojonegoro":{mission:"EJC",uni:"CIUM"},"Kabupaten Tuban":{mission:"EJC",uni:"CIUM"},"Kabupaten Lamongan":{mission:"EJC",uni:"CIUM"},"Kabupaten Gresik":{mission:"EJC",uni:"CIUM"},"Kabupaten Bangkalan":{mission:"EJC",uni:"CIUM"},"Kabupaten Sampang":{mission:"EJC",uni:"CIUM"},"Kabupaten Pamekasan":{mission:"EJC",uni:"CIUM"},"Kabupaten Sumenep":{mission:"EJC",uni:"CIUM"},"Kota Kediri":{mission:"EJC",uni:"CIUM"},"Kota Blitar":{mission:"EJC",uni:"CIUM"},"Kota Malang":{mission:"EJC",uni:"CIUM"},"Kota Probolinggo":{mission:"EJC",uni:"CIUM"},"Kota Pasuruan":{mission:"EJC",uni:"CIUM"},"Kota Mojokerto":{mission:"EJC",uni:"CIUM"},"Kota Madiun":{mission:"EJC",uni:"CIUM"},"Kota Surabaya":{mission:"EJC",uni:"CIUM"},"Kota Batu":{mission:"EJC",uni:"CIUM"}},Bali:{"Kabupaten Jembrana":{mission:"EJC",uni:"CIUM"},"Kabupaten Tabanan":{mission:"EJC",uni:"CIUM"},"Kabupaten Badung":{mission:"EJC",uni:"CIUM"},"Kabupaten Gianyar":{mission:"EJC",uni:"CIUM"},"Kabupaten Klungkung":{mission:"EJC",uni:"CIUM"},"Kabupaten Bangli":{mission:"EJC",uni:"CIUM"},"Kabupaten Karangasem":{mission:"EJC",uni:"CIUM"},"Kabupaten Buleleng":{mission:"EJC",uni:"CIUM"},"Kota Denpasar":{mission:"EJC",uni:"CIUM"}},"Nusa Tenggara Barat":{"Kabupaten Lombok Barat":{mission:"EJC",uni:"CIUM"},"Kabupaten Lombok Tengah":{mission:"EJC",uni:"CIUM"},"Kabupaten Lombok Timur":{mission:"EJC",uni:"CIUM"},"Kabupaten Sumbawa":{mission:"EJC",uni:"CIUM"},"Kabupaten Dompu":{mission:"EJC",uni:"CIUM"},"Kabupaten Bima":{mission:"EJC",uni:"CIUM"},"Kabupaten Sumbawa Barat":{mission:"EJC",uni:"CIUM"},"Kabupaten Lombok Utara":{mission:"EJC",uni:"CIUM"},"Kota Mataram":{mission:"EJC",uni:"CIUM"},"Kota Bima":{mission:"EJC",uni:"CIUM"}},"Nusa Tenggara Timur":{"Kabupaten Kupang":{mission:"NTM",uni:"CIUM"},"Kabupaten Timor Tengah Selatan":{mission:"NTM",uni:"CIUM"},"Kabupaten Timor Tengah Utara":{mission:"NTM",uni:"CIUM"},"Kabupaten Belu":{mission:"NTM",uni:"CIUM"},"Kabupaten Alor":{mission:"NTM",uni:"CIUM"},"Kabupaten Flores Timur":{mission:"NTM",uni:"CIUM"},"Kabupaten Sikka":{mission:"NTM",uni:"CIUM"},"Kabupaten Ende":{mission:"NTM",uni:"CIUM"},"Kabupaten Ngada":{mission:"NTM",uni:"CIUM"},"Kabupaten Manggarai":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Timur":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Barat":{mission:"NTM",uni:"CIUM"},"Kabupaten Lembata":{mission:"NTM",uni:"CIUM"},"Kabupaten Rote Ndao":{mission:"NTM",uni:"CIUM"},"Kabupaten Manggarai Barat":{mission:"NTM",uni:"CIUM"},"Kabupaten Nagekeo":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Tengah":{mission:"NTM",uni:"CIUM"},"Kabupaten Sumba Barat Daya":{mission:"NTM",uni:"CIUM"},"Kabupaten Manggarai Timur":{mission:"NTM",uni:"CIUM"},"Kabupaten Sabu Raijua":{mission:"NTM",uni:"CIUM"},"Kabupaten Malaka":{mission:"NTM",uni:"CIUM"},"Kota Kupang":{mission:"NTM",uni:"CIUM"}},"Kalimantan Barat":{"Kabupaten Sambas":{mission:"WKR",uni:"CIUM"},"Kabupaten Mempawah":{mission:"WKR",uni:"CIUM"},"Kabupaten Sanggau":{mission:"WKR",uni:"CIUM"},"Kabupaten Ketapang":{mission:"WKR",uni:"CIUM"},"Kabupaten Sintang":{mission:"WKR",uni:"CIUM"},"Kabupaten Kapuas Hulu":{mission:"WKR",uni:"CIUM"},"Kabupaten Bengkayang":{mission:"WKR",uni:"CIUM"},"Kabupaten Landak":{mission:"WKR",uni:"CIUM"},"Kabupaten Sekadau":{mission:"WKR",uni:"CIUM"},"Kabupaten Melawi":{mission:"WKR",uni:"CIUM"},"Kabupaten Kayong Utara":{mission:"WKR",uni:"CIUM"},"Kabupaten Kubu Raya":{mission:"WKR",uni:"CIUM"},"Kota Pontianak":{mission:"WKR",uni:"CIUM"},"Kota Singkawang":{mission:"WKR",uni:"CIUM"}},"Kalimantan Tengah":{"Kabupaten Kotawaringin Barat":{mission:"EKM",uni:"CIUM"},"Kabupaten Kotawaringin Timur":{mission:"EKM",uni:"CIUM"},"Kabupaten Kapuas":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Selatan":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Utara":{mission:"EKM",uni:"CIUM"},"Kabupaten Katingan":{mission:"EKM",uni:"CIUM"},"Kabupaten Seruyan":{mission:"EKM",uni:"CIUM"},"Kabupaten Sukamara":{mission:"EKM",uni:"CIUM"},"Kabupaten Lamandau":{mission:"EKM",uni:"CIUM"},"Kabupaten Gunung Mas":{mission:"EKM",uni:"CIUM"},"Kabupaten Pulang Pisau":{mission:"EKM",uni:"CIUM"},"Kabupaten Murung Raya":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Timur":{mission:"EKM",uni:"CIUM"},"Kota Palangkaraya":{mission:"EKM",uni:"CIUM"}},"Kalimantan Selatan":{"Kabupaten Tanah Laut":{mission:"EKM",uni:"CIUM"},"Kabupaten Kotabaru":{mission:"EKM",uni:"CIUM"},"Kabupaten Banjar":{mission:"EKM",uni:"CIUM"},"Kabupaten Barito Kuala":{mission:"EKM",uni:"CIUM"},"Kabupaten Tapin":{mission:"EKM",uni:"CIUM"},"Kabupaten Hulu Sungai Selatan":{mission:"EKM",uni:"CIUM"},"Kabupaten Hulu Sungai Tengah":{mission:"EKM",uni:"CIUM"},"Kabupaten Hulu Sungai Utara":{mission:"EKM",uni:"CIUM"},"Kabupaten Tabalong":{mission:"EKM",uni:"CIUM"},"Kabupaten Tanah Bumbu":{mission:"EKM",uni:"CIUM"},"Kabupaten Balangan":{mission:"EKM",uni:"CIUM"},"Kota Banjarmasin":{mission:"EKM",uni:"CIUM"},"Kota Banjarbaru":{mission:"EKM",uni:"CIUM"}},"Kalimantan Timur":{"Kabupaten Paser":{mission:"EKM",uni:"CIUM"},"Kabupaten Kutai Kartanegara":{mission:"EKM",uni:"CIUM"},"Kabupaten Berau":{mission:"EKM",uni:"CIUM"},"Kabupaten Kutai Barat":{mission:"EKM",uni:"CIUM"},"Kabupaten Kutai Timur":{mission:"EKM",uni:"CIUM"},"Kabupaten Penajam Paser Utara":{mission:"EKM",uni:"CIUM"},"Kabupaten Mahakam Ulu":{mission:"EKM",uni:"CIUM"},"Kota Balikpapan":{mission:"EKM",uni:"CIUM"},"Kota Samarinda":{mission:"EKM",uni:"CIUM"},"Kota Bontang":{mission:"EKM",uni:"CIUM"}},"Kalimantan Utara":{"Kabupaten Bulungan":{mission:"EKM",uni:"CIUM"},"Kabupaten Malinau":{mission:"EKM",uni:"CIUM"},"Kabupaten Nunukan":{mission:"EKM",uni:"CIUM"},"Kabupaten Tana Tidung":{mission:"EKM",uni:"CIUM"},"Kota Tarakan":{mission:"EKM",uni:"CIUM"}},Gorontalo:{Gorontalo:{mission:"BMGM",uni:"EIUC"},Boalemo:{mission:"BMGM",uni:"EIUC"},"Bone Bolango":{mission:"BMGM",uni:"EIUC"},"Gorontalo Utara":{mission:"BMGM",uni:"EIUC"},Pohuwato:{mission:"BMGM",uni:"EIUC"}},"Maluku Utara":{Ternate:{mission:"MNMC",uni:"EIUC"},"Tidore Kepulauan":{mission:"MNMC",uni:"EIUC"},"Halmahera Barat":{mission:"MNMC",uni:"EIUC"},"Halmahera Selatan":{mission:"MNMC",uni:"EIUC"},"Halmahera Tengah":{mission:"MNMC",uni:"EIUC"},"Halmahera Timur":{mission:"MNMC",uni:"EIUC"},"Halmahera Utara":{mission:"MNMC",uni:"EIUC"},"Kepulauan Sula":{mission:"MNMC",uni:"EIUC"},"Pulau Morotai":{mission:"MNMC",uni:"EIUC"},"Pulau Taliabu":{mission:"MNMC",uni:"EIUC"}},Maluku:{Ambon:{mission:"MM",uni:"EIUC"},Tual:{mission:"MM",uni:"EIUC"},Buru:{mission:"MM",uni:"EIUC"},"Buru Selatan":{mission:"MM",uni:"EIUC"},"Kepulauan Aru":{mission:"MM",uni:"EIUC"},"Kepulauan Tanimbar":{mission:"MM",uni:"EIUC"},"Maluku Barat Daya":{mission:"MM",uni:"EIUC"},"Maluku Tengah":{mission:"MM",uni:"EIUC"},"Maluku Tenggara":{mission:"MM",uni:"EIUC"},"Seram Bagian Barat":{mission:"MM",uni:"EIUC"},"Seram Bagian Timur":{mission:"MM",uni:"EIUC"}},"Papua Barat Daya":{"Sorong (Kota)":{mission:"SPM",uni:"EIUC"},Maybrat:{mission:"SPM",uni:"EIUC"},"Raja Ampat":{mission:"SPM",uni:"EIUC"},"Sorong (Kabupaten)":{mission:"SPM",uni:"EIUC"},"Sorong Selatan":{mission:"SPM",uni:"EIUC"},Tambrauw:{mission:"SPM",uni:"EIUC"}},Papua:{Jayapura:{mission:"PM",uni:"EIUC"},"Biak Numfor":{mission:"PM",uni:"EIUC"},"Jayapura (Kabupaten)":{mission:"PM",uni:"EIUC"},Keerom:{mission:"PM",uni:"EIUC"},"Kepulauan Yapen":{mission:"PM",uni:"EIUC"},"Mamberamo Raya":{mission:"PM",uni:"EIUC"},Sarmi:{mission:"PM",uni:"EIUC"},Supiori:{mission:"PM",uni:"EIUC"},Waropen:{mission:"PM",uni:"EIUC"}},"Papua Barat":{Fakfak:{mission:"WPM",uni:"EIUC"},Kaimana:{mission:"WPM",uni:"EIUC"},Manokwari:{mission:"WPM",uni:"EIUC"},"Manokwari Selatan":{mission:"WPM",uni:"EIUC"},"Pegunungan Arfak":{mission:"WPM",uni:"EIUC"},"Teluk Bintuni":{mission:"WPM",uni:"EIUC"},"Teluk Wondama":{mission:"WPM",uni:"EIUC"}},"Sulawesi Tengah":{Palu:{mission:"CSM",uni:"EIUC"},Banggai:{mission:"CSM",uni:"EIUC"},"Banggai Kepulauan":{mission:"CSM",uni:"EIUC"},"Banggai Laut":{mission:"CSM",uni:"EIUC"},Buol:{mission:"CSM",uni:"EIUC"},Donggala:{mission:"CSM",uni:"EIUC"},Morowali:{mission:"CSM",uni:"EIUC"},"Morowali Utara":{mission:"CSM",uni:"EIUC"},"Parigi Moutong":{mission:"CSM",uni:"EIUC"},Poso:{mission:"CSM",uni:"EIUC"},Sigi:{mission:"CSM",uni:"EIUC"},"Tojo Una Una":{mission:"CSM",uni:"EIUC"},Tolitoli:{mission:"CSM",uni:"EIUC"}},"Sulawesi Tenggara":{Baubau:{mission:"SSC",uni:"EIUC"},Tenggari:{mission:"SSC",uni:"EIUC"},Bombana:{mission:"SSC",uni:"EIUC"},Buton:{mission:"SSC",uni:"EIUC"},"Buton Selatan":{mission:"SSC",uni:"EIUC"},"Buton Tengah":{mission:"SSC",uni:"EIUC"},"Buton Utara":{mission:"SSC",uni:"EIUC"},Kolaka:{mission:"SSC",uni:"EIUC"},"Kolaka Timur":{mission:"SSC",uni:"EIUC"},"Kolaka Utara":{mission:"SSC",uni:"EIUC"},Konawe:{mission:"SSC",uni:"EIUC"},"Konawe Kepulauan":{mission:"SSC",uni:"EIUC"},"Konawe Selatan":{mission:"SSC",uni:"EIUC"},"Konawe Utara":{mission:"SSC",uni:"EIUC"},Muna:{mission:"SSC",uni:"EIUC"},"Muna Barat Wakatobi":{mission:"SSC",uni:"EIUC"}},"Sulawesi Utara":{Bitung:{mission:"NMBM",uni:"EIUC"},"Minahasa Utara":{mission:"NMBM",uni:"EIUC"},Manado:{mission:"MNMC",uni:"EIUC"},Kotamobagu:{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow":{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow Selatan":{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow Timur":{mission:"BMGM",uni:"EIUC"},"Bolaang Mongondow Utara":{mission:"BMGM",uni:"EIUC"},"Kepulauan Sangihe":{mission:"NIM",uni:"EIUC"},"Kepulauan Siau Tagulandang Biaro":{mission:"NIM",uni:"EIUC"},"Kepulauan Talaud":{mission:"NIM",uni:"EIUC"},Minahasa:{mission:"MC",uni:"EIUC"},"Minahasa Selatan":{mission:"MC",uni:"EIUC"},"Minahasa Tenggara":{mission:"MC",uni:"EIUC"},Tomohon:{mission:"MC",uni:"EIUC"}},"Papua Pegunungan":{Jayawijaya:{mission:"PM",uni:"EIUC"},"Lanny Jaya":{mission:"PM",uni:"EIUC"},"Mamberamo Tengah":{mission:"PM",uni:"EIUC"},Nduga:{mission:"PM",uni:"EIUC"},"Pegunungan Bintang":{mission:"PM",uni:"EIUC"},Tolikara:{mission:"PM",uni:"EIUC"},Yahukimo:{mission:"PM",uni:"EIUC"},Yalimo:{mission:"PM",uni:"EIUC"}},"Papua Selatan":{Asmat:{mission:"PM",uni:"EIUC"},"Boven Digoel":{mission:"PM",uni:"EIUC"},Mappi:{mission:"PM",uni:"EIUC"},Merauke:{mission:"PM",uni:"EIUC"}},"Papua Tengah":{Deiyai:{mission:"CPM",uni:"EIUC"},Dogiyai:{mission:"CPM",uni:"EIUC"},"Intan Jaya":{mission:"CPM",uni:"EIUC"},Mimika:{mission:"CPM",uni:"EIUC"},Nabire:{mission:"CPM",uni:"EIUC"},Paniai:{mission:"CPM",uni:"EIUC"},Puncak:{mission:"CPM",uni:"EIUC"},"Puncak Jaya":{mission:"CPM",uni:"EIUC"}},"Sulawesi Selatan":{Makassar:{mission:"SSC",uni:"EIUC"},Palopo:{mission:"LTTM",uni:"EIUC"},Parepare:{mission:"SSC",uni:"EIUC"},Bantaeng:{mission:"SSC",uni:"EIUC"},Barru:{mission:"SSC",uni:"EIUC"},Bone:{mission:"SSC",uni:"EIUC"},Bulukumba:{mission:"SSC",uni:"EIUC"},Enrekang:{mission:"SSC",uni:"EIUC"},Gowa:{mission:"SSC",uni:"EIUC"},Jeneponto:{mission:"SSC",uni:"EIUC"},"Kepulauan Selayar":{mission:"SSC",uni:"EIUC"},Luwu:{mission:"LTTM",uni:"EIUC"},"Luwu Timur":{mission:"LTTM",uni:"EIUC"},"Luwu Utara":{mission:"LTTM",uni:"EIUC"},Maros:{mission:"SSC",uni:"EIUC"},"Pangkajene Dan Kepulauan":{mission:"SSC",uni:"EIUC"},Pinrang:{mission:"SSC",uni:"EIUC"},"Sidenreng Rappang":{mission:"SSC",uni:"EIUC"},Sinjai:{mission:"SSC",uni:"EIUC"},Soppeng:{mission:"SSC",uni:"EIUC"},Takalar:{mission:"SSC",uni:"EIUC"},"Tana Toraja":{mission:"LTTM",uni:"EIUC"},"Toraja Utara":{mission:"LTTM",uni:"EIUC"},Wajo:{mission:"SSC",uni:"EIUC"}}});const mN=({initialProvinsi:a="",initialKabKota:n="",onChange:t}={})=>{const[s,l]=z.useState(a),[u,f]=z.useState(n),[h,g]=z.useState(""),[m,p]=z.useState(""),S=oN(),x=s?uN(s):[];z.useEffect(()=>{if(s&&u){const D=fN(s,u),b=dN(s,u);g(D),p(b),t&&t({provinsi:s,kabKota:u,mission:D,uni:b})}else g(""),p(""),t&&t({provinsi:s,kabKota:u,mission:"",uni:""})},[s,u,t]);const C=z.useCallback(D=>{l(D),f(""),g(""),p("")},[]),T=z.useCallback(D=>{f(D)},[]),y=z.useCallback(()=>{l(""),f(""),g(""),p("")},[]),_=z.useCallback(D=>{D.provinsi&&l(D.provinsi),D.kabKota&&f(D.kabKota)},[]),w=s&&u&&h&&m,k=hN(s,u);return{provinsi:s,kabKota:u,mission:h,uni:m,provinsiOptions:S,kabKotaOptions:x,handleProvinsiChange:C,handleKabKotaChange:T,reset:y,setInitialValues:_,isValid:w,territoryInfo:k,selection:{provinsi:s,kabKota:u,mission:h,uni:m}}},wv=({id:a,value:n,options:t,onChange:s,placeholder:l="Pilih atau ketik untuk mencari...",disabled:u=!1,className:f="",error:h=!1,label:g,required:m=!1})=>{const[p,S]=z.useState(!1),[x,C]=z.useState(""),[T,y]=z.useState(-1),_=z.useRef(null),w=z.useRef(null),k=t.filter(L=>L.toLowerCase().includes(x.toLowerCase())),D=L=>{const X=L.target.value;C(X),S(!0),y(-1);const M=t.find(H=>H.toLowerCase()===X.toLowerCase());M&&M!==n?s(M):!M&&n&&s("")},b=L=>{s(L),C(""),S(!1),y(-1),_.current?.blur()},K=L=>{if(!p){(L.key==="Enter"||L.key==="ArrowDown")&&(S(!0),y(0),L.preventDefault());return}switch(L.key){case"ArrowDown":L.preventDefault(),y(X=>X<k.length-1?X+1:0);break;case"ArrowUp":L.preventDefault(),y(X=>X>0?X-1:k.length-1);break;case"Enter":L.preventDefault(),T>=0&&k[T]&&b(k[T]);break;case"Escape":S(!1),C(""),y(-1),_.current?.blur();break}},q=()=>{u||(S(!0),C(""))},B=()=>{setTimeout(()=>{w.current?.contains(document.activeElement)||(S(!1),C(""),y(-1))},150)};z.useEffect(()=>{const L=X=>{_.current&&!_.current.contains(X.target)&&w.current&&!w.current.contains(X.target)&&(S(!1),C(""),y(-1))};return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[]),z.useEffect(()=>{if(T>=0&&w.current){const L=w.current.children[T];L&&L.scrollIntoView({block:"nearest",behavior:"smooth"})}},[T]);const Z=p?x:n;return o.jsxs("div",{className:`searchable-select ${f}`,children:[g&&o.jsxs("label",{htmlFor:a,className:"searchable-select-label",children:[g," ",m&&o.jsx("span",{className:"required",children:"*"})]}),o.jsxs("div",{className:"searchable-select-container",children:[o.jsx("input",{ref:_,id:a,type:"text",value:Z,onChange:D,onFocus:q,onBlur:B,onKeyDown:K,placeholder:l,disabled:u,className:`searchable-select-input ${h?"error":""}`,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1}),o.jsx("div",{className:"searchable-select-arrow",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",className:p?"rotated":"",children:o.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),p&&o.jsx("div",{ref:w,className:"searchable-select-dropdown",children:k.length>0?k.map((L,X)=>o.jsx("div",{className:`searchable-select-option ${X===T?"highlighted":""} ${L===n?"selected":""}`,onClick:()=>b(L),onMouseEnter:()=>y(X),children:L},L)):o.jsxs("div",{className:"searchable-select-no-results",children:['Tidak ditemukan "',x,'"']})})]})]})},vN=({initialProvinsi:a,initialKabKota:n,onChange:t,disabled:s=!1,className:l="",showLabels:u=!0,errors:f={}})=>{const{provinsi:h,kabKota:g,mission:m,uni:p,provinsiOptions:S,kabKotaOptions:x,handleProvinsiChange:C,handleKabKotaChange:T}=mN({initialProvinsi:a,initialKabKota:n,onChange:t});return o.jsxs("div",{className:`territory-selector ${l}`,children:[o.jsxs("div",{className:"territory-field",children:[o.jsx(wv,{id:"provinsi",value:h,options:S,onChange:C,placeholder:"Pilih atau ketik nama provinsi...",disabled:s,className:f.provinsi?"error":"",error:!!f.provinsi,label:u?"Provinsi":void 0,required:u}),f.provinsi&&o.jsx("span",{className:"error-message",children:f.provinsi})]}),o.jsxs("div",{className:"territory-field",children:[o.jsx(wv,{id:"kabKota",value:g,options:x,onChange:T,placeholder:h?"Pilih atau ketik nama kab/kota...":"Pilih provinsi dulu",disabled:s||!h,className:f.kabKota?"error":"",error:!!f.kabKota,label:u?"Kab/Kota":void 0,required:u}),f.kabKota&&o.jsx("span",{className:"error-message",children:f.kabKota})]}),o.jsxs("div",{className:"territory-field",children:[u&&o.jsx("label",{htmlFor:"mission",className:"territory-label",children:"Mission"}),o.jsx("input",{id:"mission",type:"text",value:m,className:`territory-input auto-selected ${f.mission?"error":""}`,disabled:!0,placeholder:g?"Auto-selected":"Pilih Kab/Kota dulu",readOnly:!0}),f.mission&&o.jsx("span",{className:"error-message",children:f.mission}),m&&o.jsx("span",{className:"help-text",children:"Otomatis dipilih berdasarkan Kab/Kota"})]}),o.jsxs("div",{className:"territory-field",children:[u&&o.jsx("label",{htmlFor:"uni",className:"territory-label",children:"Uni"}),o.jsx("input",{id:"uni",type:"text",value:p,className:`territory-input auto-selected ${f.uni?"error":""}`,disabled:!0,placeholder:g?"Auto-selected":"Pilih Kab/Kota dulu",readOnly:!0}),f.uni&&o.jsx("span",{className:"error-message",children:f.uni}),p&&o.jsxs("span",{className:"help-text",children:[p==="WIUM"&&"Western Indonesia Union Mission",p==="CIUM"&&"Central Indonesia Union Mission",p==="EIUC"&&"Eastern Indonesia Union Conference"]})]}),h&&g&&m&&p&&o.jsxs("div",{className:"territory-summary",children:[o.jsxs("div",{className:"summary-item",children:[o.jsx("span",{className:"summary-label",children:"Wilayah:"}),o.jsxs("span",{className:"summary-value",children:[h,"  ",g]})]}),o.jsxs("div",{className:"summary-item",children:[o.jsx("span",{className:"summary-label",children:"Organisasi:"}),o.jsxs("span",{className:"summary-value",children:[m," (",p,")"]})]})]})]})};class gN{STORAGE_KEY="crm_service_sessions";getSessions(){try{const n=localStorage.getItem(this.STORAGE_KEY);return n?JSON.parse(n).map(s=>({...s,startTime:new Date(s.startTime),endTime:s.endTime?new Date(s.endTime):void 0})):[]}catch(n){return console.error("Error loading service sessions:",n),[]}}saveSessions(n){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(n))}catch(t){console.error("Error saving service sessions:",t)}}startSession(n,t){const s=new Date,l={id:`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,contactId:n,userId:t,startTime:s,status:"active",serviceDate:s.toISOString().split("T")[0],serviceHour:s.getHours()},u=this.getSessions(),f=[],h=u.map(g=>{if(g.userId===t&&g.status==="active"){const m=s,p=Math.floor((m.getTime()-g.startTime.getTime())/1e3),S=Math.round(p/60),x={...g,status:"completed",endTime:m,duration:p};if(f.push(x),S>0)try{Wt.addServiceEntry({contactId:g.contactId,userId:g.userId,date:g.serviceDate,duration:S,serviceType:"Timer Session (Auto-stopped)",description:`Auto-stopped when starting new service (${Math.floor(S/60)}h ${S%60}m)`}),console.log(`Auto-stopped and recorded service for contact ${g.contactId}: ${S} minutes`)}catch(C){console.error("Failed to create service entry for auto-stopped session:",C)}return x}return g});return f.forEach(g=>{window.dispatchEvent(new CustomEvent("serviceAutoStopped",{detail:{session:g,newContactId:n,userId:t}}))}),h.push(l),this.saveSessions(h),window.dispatchEvent(new CustomEvent("serviceStarted",{detail:{session:l,autoStoppedCount:f.length}})),l}endSession(n){const t=this.getSessions(),s=t.findIndex(m=>m.id===n);if(s===-1)return null;const l=t[s],u=new Date,f=Math.floor((u.getTime()-l.startTime.getTime())/1e3),h=Math.round(f/60),g={...l,endTime:u,duration:f,status:"completed"};if(t[s]=g,this.saveSessions(t),h>0)try{Wt.addServiceEntry({contactId:l.contactId,userId:l.userId,date:l.serviceDate,duration:h,serviceType:"Timer Session",description:`Automatic entry from service timer (${Math.floor(h/60)}h ${h%60}m)`}),window.dispatchEvent(new CustomEvent("serviceAdded",{detail:{contactId:l.contactId,userId:l.userId}}))}catch(m){console.error("Failed to create service entry from timer session:",m)}return window.dispatchEvent(new CustomEvent("serviceEnded",{detail:{session:g,contactId:l.contactId,userId:l.userId,duration:f}})),g}getActiveSession(n){return this.getSessions().find(s=>s.userId===n&&s.status==="active")||null}getActiveSessions(){return this.getSessions().filter(t=>t.status==="active")}getActiveSessionForContact(n,t){return this.getSessions().find(l=>l.contactId===n&&l.userId===t&&l.status==="active")||null}getSessionsForContact(n){return this.getSessions().filter(s=>s.contactId===n&&s.status==="completed").sort((s,l)=>l.startTime.getTime()-s.startTime.getTime())}getSessionsForUser(n){return this.getSessions().filter(s=>s.userId===n).sort((s,l)=>l.startTime.getTime()-s.startTime.getTime())}pauseSession(n){const t=this.getSessions(),s=t.findIndex(l=>l.id===n);return s===-1?null:(t[s]={...t[s],status:"paused"},this.saveSessions(t),t[s])}resumeSession(n){const t=this.getSessions(),s=t.findIndex(l=>l.id===n);return s===-1?null:(t[s]={...t[s],status:"active"},this.saveSessions(t),t[s])}getTodaySessions(n){const t=new Date().toISOString().split("T")[0];return this.getSessions().filter(l=>l.userId===n&&l.serviceDate===t)}getTodayServiceTime(n){return this.getTodaySessions(n).reduce((s,l)=>l.status==="completed"&&l.duration?s+l.duration:s,0)}getServiceStats(n,t=7){const s=new Date;s.setDate(s.getDate()-t);const l=this.getSessions().filter(h=>h.userId===n&&h.status==="completed"&&h.startTime>=s),u=l.reduce((h,g)=>h+(g.duration||0),0),f=new Set(l.map(h=>h.contactId)).size;return{totalSessions:l.length,totalTime:u,averageTime:l.length>0?Math.round(u/l.length):0,contactsServed:f}}recoverOrphanedSessions(){const n=this.getSessions(),t=new Date,s=480*60*1e3,l=[],u=n.map(f=>{if(f.status==="active"){const h=t.getTime()-f.startTime.getTime();if(h>s){const g=Math.floor(h/1e3),m=Math.round(g/60),p={...f,status:"completed",endTime:t,duration:g};if(l.push(p),m>0)try{Wt.addServiceEntry({contactId:f.contactId,userId:f.userId,date:f.serviceDate,duration:Math.min(m,480),serviceType:"Timer Session (Recovered)",description:`Recovered from system crash/disconnect (${Math.floor(m/60)}h ${m%60}m)`}),console.log(`Recovered orphaned session for contact ${f.contactId}: ${m} minutes`)}catch(S){console.error("Failed to create service entry for recovered session:",S)}return p}}return f});return l.length>0&&(this.saveSessions(u),window.dispatchEvent(new CustomEvent("sessionsRecovered",{detail:{recoveredSessions:l}})),console.log(`Recovered ${l.length} orphaned service sessions`)),l}initializeRecovery(){this.recoverOrphanedSessions(),setInterval(()=>{this.recoverOrphanedSessions()},300*1e3),window.addEventListener("beforeunload",()=>{this.handleBeforeUnload()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&setTimeout(()=>{this.recoverOrphanedSessions()},1e3)})}handleBeforeUnload(){if(this.getActiveSessions().length>0){const s=this.getSessions().map(l=>l.status==="active"?{...l,lastActivity:new Date}:l);this.saveSessions(s)}}forceCompleteAllActiveSessions(n){const t=this.getSessions(),s=new Date,l=[],u=t.map(f=>{if(f.status==="active"&&(!n||f.userId===n)){const h=Math.floor((s.getTime()-f.startTime.getTime())/1e3),g=Math.round(h/60),m={...f,status:"completed",endTime:s,duration:h};if(l.push(m),g>0)try{Wt.addServiceEntry({contactId:f.contactId,userId:f.userId,date:f.serviceDate,duration:g,serviceType:"Timer Session (Force Completed)",description:`Force completed session (${Math.floor(g/60)}h ${g%60}m)`})}catch(p){console.error("Failed to create service entry for force completed session:",p)}return m}return f});return l.length>0&&(this.saveSessions(u),window.dispatchEvent(new CustomEvent("sessionsForceCompleted",{detail:{completedSessions:l}}))),l}}const Bt=new gN,pN=a=>{const{currentUser:n}=Vt(),[t,s]=z.useState(null),[l,u]=z.useState(0),[f,h]=z.useState(!1);z.useEffect(()=>{if(!n)return;Bt.initializeRecovery();const w=a?Bt.getActiveSessionForContact(a,n.username):Bt.getActiveSession(n.username);if(s(w),w){const q=Math.floor((Date.now()-w.startTime.getTime())/1e3);u(q)}const k=q=>{const{recoveredSessions:B}=q.detail;if(console.log("Sessions recovered:",B),B.length>0){const Z=`${B.length} service session(s) recovered from system interruption`;console.info(Z)}},D=q=>{const{session:B}=q.detail;console.log("Service auto-stopped:",B);const Z=Math.round((B.duration||0)/60);if(Z>0){const L=`Previous service (${Z}m) auto-stopped and recorded`;console.info(L)}},b=q=>{const{session:B,contactId:Z}=q.detail;console.log("Service ended:",B),(!a||Z===a)&&(s(null),u(0))},K=q=>{const{session:B}=q.detail;console.log("Service started:",B),(!a||B.contactId===a)&&(s(B),u(0))};return window.addEventListener("sessionsRecovered",k),window.addEventListener("serviceAutoStopped",D),window.addEventListener("serviceEnded",b),window.addEventListener("serviceStarted",K),()=>{window.removeEventListener("sessionsRecovered",k),window.removeEventListener("serviceAutoStopped",D),window.removeEventListener("serviceEnded",b),window.removeEventListener("serviceStarted",K)}},[n,a]),z.useEffect(()=>{if(!t||t.status!=="active")return;const w=setInterval(()=>{const k=Math.floor((Date.now()-t.startTime.getTime())/1e3);u(k)},1e3);return()=>clearInterval(w)},[t]);const g=z.useCallback(async w=>{if(!n)return null;h(!0);try{const k=Bt.startSession(w||a||"",n.username);return s(k),u(0),k}catch(k){return console.error("Error starting service:",k),null}finally{h(!1)}},[n,a]),m=z.useCallback(async()=>{if(!t||!n)return null;h(!0);try{const w=Bt.endSession(t.id);return s(null),u(0),w}catch(w){return console.error("Error ending service:",w),null}finally{h(!1)}},[t,n]),p=z.useCallback(async()=>{if(!t)return null;try{const w=Bt.pauseSession(t.id);return s(w),w}catch(w){return console.error("Error pausing service:",w),null}},[t]),S=z.useCallback(async()=>{if(!t)return null;try{const w=Bt.resumeSession(t.id);return s(w),w}catch(w){return console.error("Error resuming service:",w),null}},[t]),x=z.useCallback(w=>{const k=Math.floor(w/3600),D=Math.floor(w%3600/60),b=w%60;return k>0?`${k.toString().padStart(2,"0")}:${D.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`:`${D.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`},[]),C=z.useCallback(()=>a?Bt.getSessionsForContact(a):[],[a]),T=z.useCallback(()=>{if(!n)return{totalTime:0,sessionCount:0};const w=Bt.getTodaySessions(n.username),k=Bt.getTodayServiceTime(n.username);return{totalTime:k,sessionCount:w.length,formattedTime:x(k)}},[n,x]),y=z.useCallback(()=>{if(!n)return[];const w=Bt.forceCompleteAllActiveSessions(n.username);return w.length>0&&(s(null),u(0),console.log(`Force completed ${w.length} active sessions`)),w},[n]),_=z.useCallback(()=>{const w=Bt.recoverOrphanedSessions();if(w.length>0&&n){const k=a?Bt.getActiveSessionForContact(a,n.username):Bt.getActiveSession(n.username);if(s(k),k){const D=Math.floor((Date.now()-k.startTime.getTime())/1e3);u(D)}else u(0)}return w},[n,a]);return{activeSession:t,elapsedTime:l,isLoading:f,isActive:t?.status==="active",isPaused:t?.status==="paused",startService:g,endService:m,pauseService:p,resumeService:S,forceCompleteAllSessions:y,triggerRecovery:_,formatElapsedTime:()=>x(l),getServiceHistory:C,getTodayStats:T,canStart:!t&&!!n,canEnd:!!t&&t.status==="active",canPause:!!t&&t.status==="active",canResume:!!t&&t.status==="paused"}},xN=({contactId:a,contactName:n,onServiceStart:t,onServiceEnd:s,className:l=""})=>{const[u,f]=z.useState(null),{activeSession:h,isLoading:g,isActive:m,startService:p,endService:S,pauseService:x,resumeService:C,formatElapsedTime:T,canStart:y,canEnd:_,canPause:w,canResume:k,getTodayStats:D,forceCompleteAllSessions:b,triggerRecovery:K}=pN(a);z.useEffect(()=>{const M=be=>{const{session:Se}=be.detail,ee=Math.round((Se.duration||0)/60);ee>0&&(f(`Previous service (${ee}m) auto-stopped and recorded`),setTimeout(()=>f(null),5e3))},H=be=>{const{recoveredSessions:Se}=be.detail;Se.length>0&&(f(`${Se.length} service session(s) recovered from interruption`),setTimeout(()=>f(null),5e3))},ue=be=>{const{session:Se,contactId:ee}=be.detail;if(ee===a){const ge=Math.round((Se.duration||0)/60);ge>0&&(f(`Service completed (${ge}m) and recorded`),setTimeout(()=>f(null),5e3))}};return window.addEventListener("serviceAutoStopped",M),window.addEventListener("sessionsRecovered",H),window.addEventListener("serviceEnded",ue),()=>{window.removeEventListener("serviceAutoStopped",M),window.removeEventListener("sessionsRecovered",H),window.removeEventListener("serviceEnded",ue)}},[]);const q=async()=>{await p(a)&&t?.()},B=async()=>{const M=await S();M&&M.duration&&s?.(M.duration)},Z=async()=>{await x()},L=async()=>{await C()},X=D();return o.jsxs("div",{className:`service-timer-widget ${l}`,children:[o.jsxs("div",{className:"service-timer-header",children:[o.jsxs("div",{className:"service-timer-title",children:[o.jsx("span",{className:"timer-icon",children:""}),o.jsx("h3",{children:"Service Tracking"})]}),o.jsxs("div",{className:"service-timer-subtitle",children:["Melayani: ",o.jsx("strong",{children:n})]})]}),o.jsxs("div",{className:"service-timer-content",children:[h?o.jsxs("div",{className:"timer-active-state",children:[o.jsx("div",{className:"timer-display",children:o.jsxs("div",{className:"timer-main",children:[o.jsx("span",{className:"timer-text",children:T()}),o.jsxs("div",{className:`timer-status ${m?"active":"paused"}`,children:[m&&o.jsx("div",{className:"pulse-indicator"}),o.jsx("span",{className:"status-text",children:m?"Sedang Melayani":"Dijeda"})]})]})}),o.jsx("div",{className:"timer-controls",children:m?o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:Z,disabled:g||!w,className:"service-btn pause-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Jeda"]}),o.jsxs("button",{onClick:B,disabled:g||!_,className:"service-btn end-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Selesai"]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:L,disabled:g||!k,className:"service-btn resume-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Lanjutkan"]}),o.jsxs("button",{onClick:B,disabled:g,className:"service-btn end-btn",children:[o.jsx("span",{className:"btn-icon",children:""}),"Selesai"]})]})})]}):o.jsxs("div",{className:"timer-start-state",children:[o.jsxs("div",{className:"timer-display-placeholder",children:[o.jsx("span",{className:"timer-text",children:"00:00"}),o.jsx("span",{className:"timer-label",children:"Siap untuk memulai pelayanan"})]}),o.jsx("button",{onClick:q,disabled:g||!y,className:"service-btn start-btn",children:g?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"loading-spinner",children:""}),"Memulai..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"btn-icon",children:""}),"Mulai Pelayanan"]})})]}),u&&o.jsxs("div",{className:"timer-notification",children:[o.jsx("span",{className:"notification-icon",children:""}),o.jsx("span",{className:"notification-text",children:u}),o.jsx("button",{onClick:()=>f(null),className:"notification-close",children:""})]}),o.jsxs("div",{className:"timer-stats",children:[o.jsxs("div",{className:"stats-item",children:[o.jsx("span",{className:"stats-label",children:"Hari ini:"}),o.jsx("span",{className:"stats-value",children:X.formattedTime})]}),o.jsxs("div",{className:"stats-item",children:[o.jsx("span",{className:"stats-label",children:"Sesi:"}),o.jsx("span",{className:"stats-value",children:X.sessionCount})]})]}),o.jsxs("div",{className:"timer-emergency-actions",children:[o.jsx("button",{onClick:()=>{K().length===0&&(f("No sessions to recover"),setTimeout(()=>f(null),3e3))},className:"emergency-btn recovery-btn",title:"Manually trigger session recovery",children:" Recovery"}),o.jsx("button",{onClick:()=>{const M=b();M.length>0?(f(`Force completed ${M.length} active sessions`),setTimeout(()=>f(null),5e3)):(f("No active sessions to complete"),setTimeout(()=>f(null),3e3))},className:"emergency-btn force-complete-btn",title:"Force complete all active sessions",children:" Force Stop All"})]})]})]})},SN=({contact:a,onSave:n,onCancel:t,mode:s="create",initialData:l})=>{const[u,f]=z.useState({nama:l?.nama||"",nomorTelepon:l?.nomorTelepon||"",jenisKelamin:"Laki-laki",usia:"",profesi:"",statusPernikahan:"",mediaKomunikasi:"",alamat:"",provinsi:"",kabKota:"",mission:"",uni:"",agama:"",subAgama:"",alasanMenghubungi:"",sumber:"",prioritas:"Urgent",statusKontak:"New Contact"}),[h,g]=z.useState({}),[m,p]=z.useState(!1),[S,x]=z.useState(!1),[C,T]=z.useState(s),[y,_]=z.useState(a||null),{currentUser:w}=Vt(),{suggestions:k,isNameDuplicate:D,isPhoneNumberDuplicate:b}=cN();z.useEffect(()=>{a&&s==="edit"&&Bt.getActiveSessionForContact(a.id,w?.username||"")&&(_(a),T("service"))},[a,s]),z.useEffect(()=>{f(a&&s==="edit"?{nama:a.nama,nomorTelepon:a.nomorTelepon||"",jenisKelamin:a.jenisKelamin||"Laki-laki",usia:a.usia?String(a.usia):"",profesi:a.profesi||"",statusPernikahan:a.statusPernikahan||"",mediaKomunikasi:a.mediaKomunikasi||"",alamat:a.alamat,provinsi:a.provinsi||"",kabKota:a.kabKota||"",mission:a.mission||"",uni:a.uni||"",agama:a.agama,subAgama:a.subAgama||"",alasanMenghubungi:a.alasanMenghubungi,sumber:a.sumber||"",prioritas:a.prioritas||"Urgent",statusKontak:a.statusKontak}:{nama:"",nomorTelepon:"",jenisKelamin:"Laki-laki",usia:"",profesi:"",statusPernikahan:"",mediaKomunikasi:"",alamat:"",provinsi:"",kabKota:"",mission:"",uni:"",agama:"",subAgama:"",alasanMenghubungi:"",sumber:"",prioritas:"Urgent",statusKontak:"New Contact"}),g({}),x(!1)},[a,s]),z.useEffect(()=>{l&&s==="create"&&!a&&f(M=>({...M,nama:l.nama||M.nama,nomorTelepon:l.nomorTelepon||M.nomorTelepon}))},[l,s,a]);const K=z.useCallback((M,H)=>{f(ue=>{if(ue[M]===H)return ue;const be={...ue,[M]:H};return M==="agama"&&(H==="Protestan"?be.subAgama="":H?be.subAgama=H:be.subAgama=""),be}),x(!0),g(ue=>{if(!ue[M])return ue;const be={...ue};return delete be[M],be})},[]),q=z.useCallback(M=>{f(H=>({...H,provinsi:M.provinsi,kabKota:M.kabKota,mission:M.mission,uni:M.uni})),x(!0),g(H=>{const ue={...H};return delete ue.provinsi,delete ue.kabKota,delete ue.mission,delete ue.uni,ue})},[]),B=()=>{const M={};if(u.nama.trim()?u.nama.length>100?M.nama="Nama must be less than 100 characters":s==="create"&&D(u.nama)&&(M.nama="Nama ini sudah ada dalam kontak"):M.nama="Nama is required",u.nomorTelepon.trim()?u.nomorTelepon.length>20?M.nomorTelepon="Nomor telepon must be less than 20 characters":s==="create"&&b(u.nomorTelepon)&&(M.nomorTelepon="Nomor telepon ini sudah ada dalam kontak"):M.nomorTelepon="Nomor telepon is required",u.usia.trim()){const H=parseInt(u.usia);(isNaN(H)||H<1||H>120)&&(M.usia="Usia must be between 1 and 120")}return u.profesi.trim()&&u.profesi.length>100&&(M.profesi="Profesi must be less than 100 characters"),u.alamat.trim()&&u.alamat.length>200&&(M.alamat="Alamat must be less than 200 characters"),u.provinsi&&!u.kabKota&&(M.kabKota="Kab/Kota harus dipilih setelah memilih provinsi"),u.agama.trim()&&u.agama.length>50&&(M.agama="Agama must be less than 50 characters"),u.alasanMenghubungi.trim()&&u.alasanMenghubungi.length>500&&(M.alasanMenghubungi="Alasan menghubungi must be less than 500 characters"),u.jenisKelamin||(M.jenisKelamin="Jenis kelamin is required"),u.prioritas||(M.prioritas="Prioritas is required"),u.statusKontak||(M.statusKontak="Status kontak is required"),g(M),Object.keys(M).length===0},Z=async M=>{if(M.preventDefault(),!!B()){if(!w){alert("You must be logged in to save contacts");return}p(!0);try{let H;if(s==="edit"&&a||C==="edit"&&y){const ue=a||y;Ke.updateContactWithHistory(ue.id,{...u,usia:u.usia?parseInt(u.usia):void 0,statusPernikahan:u.statusPernikahan||void 0,mediaKomunikasi:u.mediaKomunikasi||void 0,mission:u.mission||void 0,kabKota:u.kabKota||void 0,uni:u.uni||void 0,sumber:u.sumber},w.username),H=Ke.getContactById(ue.id)||ue,window.dispatchEvent(new CustomEvent("contactsUpdated"))}else{const ue=new ti(u.nama,u.nomorTelepon,u.jenisKelamin,u.alamat,u.provinsi,u.agama,u.alasanMenghubungi,u.sumber,u.prioritas,u.statusKontak,w.username,u.usia?parseInt(u.usia):void 0,u.profesi||void 0,u.statusPernikahan||void 0,u.mediaKomunikasi||void 0,u.mission||void 0,u.subAgama||void 0,u.kabKota||void 0,u.uni||void 0);Ke.addContact(ue.toObject()),H=ue.toObject(),window.dispatchEvent(new CustomEvent("contactsUpdated"))}s==="create"?(_(H),T("service"),f({nama:H.nama,nomorTelepon:H.nomorTelepon||"",jenisKelamin:H.jenisKelamin||"Laki-laki",usia:H.usia?String(H.usia):"",profesi:H.profesi||"",statusPernikahan:H.statusPernikahan||"",mediaKomunikasi:H.mediaKomunikasi||"",alamat:H.alamat||"",provinsi:H.provinsi||"",kabKota:H.kabKota||"",mission:H.mission||"",uni:H.uni||"",agama:H.agama||"",subAgama:H.subAgama||"",alasanMenghubungi:H.alasanMenghubungi||"",sumber:H.sumber||"",prioritas:H.prioritas||"Urgent",statusKontak:H.statusKontak||"New Contact"}),x(!1),alert(`Contact "${H.nama}" berhasil disimpan! Siap untuk memulai pelayanan.`)):C==="edit"&&y?(_(H),T("service"),f({nama:H.nama,nomorTelepon:H.nomorTelepon||"",jenisKelamin:H.jenisKelamin||"Laki-laki",usia:H.usia?String(H.usia):"",profesi:H.profesi||"",statusPernikahan:H.statusPernikahan||"",mediaKomunikasi:H.mediaKomunikasi||"",alamat:H.alamat||"",provinsi:H.provinsi||"",kabKota:H.kabKota||"",mission:H.mission||"",uni:H.uni||"",agama:H.agama||"",subAgama:H.subAgama||"",alasanMenghubungi:H.alasanMenghubungi||"",sumber:H.sumber||"",prioritas:H.prioritas||"Urgent",statusKontak:H.statusKontak||"New Contact"}),x(!1),alert(`Contact "${H.nama}" berhasil diupdate! Kembali ke service mode.`)):n?.(H)}catch(H){console.error("Error saving contact:",H),alert("Failed to save contact. Please try again.")}finally{p(!1)}}},L=()=>{S?window.confirm("You have unsaved changes. Are you sure you want to cancel?")&&t?.():t?.()},X=(M,H)=>{const ue=u[M].length,be=ue>H*.8;return o.jsxs("span",{className:`character-count ${be?"near-limit":""}`,children:[ue,"/",H]})};return o.jsxs("div",{className:"contact-form-container",children:[o.jsxs("div",{className:"contact-form-header",children:[o.jsx("h2",{children:C==="service"?"Service Mode":s==="edit"?"Edit Contact":"Add New Contact"}),o.jsx("p",{children:C==="service"?`Ready to serve ${y?.nama||"contact"}`:s==="edit"?"Update the contact information below":"Fill in the details to add a new contact"})]}),o.jsxs("form",{onSubmit:Z,className:"contact-form",children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"nama",className:"form-label",children:["Nama ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx(ff,{id:"nama",value:u.nama,onChange:M=>K("nama",M),suggestions:k.names,className:`form-input ${h.nama?"error":""}`,placeholder:"Enter full name",disabled:m,maxLength:100,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:!1,excludeFromDuplicateCheck:a?.nama||y?.nama}),o.jsxs("div",{className:"form-meta",children:[h.nama&&o.jsx("span",{className:"error-message",children:h.nama}),X("nama",100)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"nomorTelepon",className:"form-label",children:["Nomor Telepon ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx(ff,{id:"nomorTelepon",type:"tel",value:u.nomorTelepon,onChange:M=>K("nomorTelepon",M),suggestions:k.phoneNumbers,className:`form-input ${h.nomorTelepon?"error":""}`,placeholder:"Enter phone number",disabled:m,maxLength:20,autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:!1,excludeFromDuplicateCheck:a?.nomorTelepon||y?.nomorTelepon}),o.jsxs("div",{className:"form-meta",children:[h.nomorTelepon&&o.jsx("span",{className:"error-message",children:h.nomorTelepon}),X("nomorTelepon",20)]})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"jenisKelamin",className:"form-label",children:"Jenis Kelamin"}),o.jsx("select",{id:"jenisKelamin",value:u.jenisKelamin,onChange:M=>K("jenisKelamin",M.target.value),className:`form-select ${h.jenisKelamin?"error":""}`,disabled:m,children:Av.map(M=>o.jsx("option",{value:M,children:M},M))}),o.jsx("div",{className:"form-meta",children:h.jenisKelamin&&o.jsx("span",{className:"error-message",children:h.jenisKelamin})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"usia",className:"form-label",children:"Usia"}),o.jsx("input",{id:"usia",type:"number",value:u.usia,onChange:M=>K("usia",M.target.value),className:`form-input ${h.usia?"error":""}`,placeholder:"Enter age (optional)",disabled:m,min:"1",max:"120",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),o.jsx("div",{className:"form-meta",children:h.usia&&o.jsx("span",{className:"error-message",children:h.usia})})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"profesi",className:"form-label",children:"Profesi"}),o.jsx("input",{id:"profesi",type:"text",value:u.profesi,onChange:M=>K("profesi",M.target.value),className:`form-input ${h.profesi?"error":""}`,placeholder:"Enter profession (optional)",disabled:m,maxLength:100,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:"false"}),o.jsxs("div",{className:"form-meta",children:[h.profesi&&o.jsx("span",{className:"error-message",children:h.profesi}),X("profesi",100)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"statusPernikahan",className:"form-label",children:"Status Pernikahan"}),o.jsxs("select",{id:"statusPernikahan",value:u.statusPernikahan,onChange:M=>K("statusPernikahan",M.target.value),className:`form-select ${h.statusPernikahan?"error":""}`,disabled:m,children:[o.jsx("option",{value:"",children:"Pilih Status Pernikahan"}),PS.map(M=>o.jsx("option",{value:M,children:M},M))]}),o.jsx("div",{className:"form-meta",children:h.statusPernikahan&&o.jsx("span",{className:"error-message",children:h.statusPernikahan})})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"mediaKomunikasi",className:"form-label",children:"Media Komunikasi"}),o.jsxs("select",{id:"mediaKomunikasi",value:u.mediaKomunikasi,onChange:M=>K("mediaKomunikasi",M.target.value),className:`form-select ${h.mediaKomunikasi?"error":""}`,disabled:m,children:[o.jsx("option",{value:"",children:"Pilih Media Komunikasi"}),zS.map(M=>o.jsx("option",{value:M,children:M},M))]}),o.jsx("div",{className:"form-meta",children:h.mediaKomunikasi&&o.jsx("span",{className:"error-message",children:h.mediaKomunikasi})})]}),o.jsx("div",{className:"form-group territory-group",children:o.jsx(vN,{initialProvinsi:u.provinsi,initialKabKota:u.kabKota,onChange:q,disabled:m,errors:{provinsi:h.provinsi,kabKota:h.kabKota,mission:h.mission,uni:h.uni},className:"horizontal"})})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"agama",className:"form-label",children:"Agama"}),o.jsxs("select",{id:"agama",value:u.agama,onChange:M=>K("agama",M.target.value),className:`form-select ${h.agama?"error":""}`,disabled:m,children:[o.jsx("option",{value:"",children:"Pilih Agama"}),BS.map(M=>o.jsx("option",{value:M,children:M},M))]}),o.jsx("div",{className:"form-meta",children:h.agama&&o.jsx("span",{className:"error-message",children:h.agama})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"subAgama",className:"form-label",children:u.agama==="Protestan"?"Gereja":"Sub Agama"}),u.agama==="Protestan"?o.jsx(ff,{id:"subAgama",value:u.subAgama,onChange:M=>K("subAgama",M),suggestions:KS,className:`form-input ${h.subAgama?"error":""}`,placeholder:"Cari nama gereja...",disabled:m,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:!1,showDuplicateWarning:!1}):o.jsx("input",{id:"subAgama",type:"text",value:u.subAgama,onChange:M=>K("subAgama",M.target.value),className:`form-input ${h.subAgama?"error":""}`,placeholder:u.agama?u.agama:"Pilih agama terlebih dahulu",disabled:m||!u.agama,readOnly:!!(u.agama&&u.agama!=="Protestan"),autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:!1}),o.jsxs("div",{className:"form-meta",children:[h.subAgama&&o.jsx("span",{className:"error-message",children:h.subAgama}),u.agama==="Protestan"&&o.jsx("span",{className:"help-text",children:"Ketik untuk mencari gereja Protestan"})]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"alamat",className:"form-label",children:"Alamat"}),o.jsx("textarea",{id:"alamat",value:u.alamat,onChange:M=>K("alamat",M.target.value),className:`form-textarea ${h.alamat?"error":""}`,placeholder:"Enter complete address (optional)",disabled:m,rows:3,maxLength:200,autoComplete:"off",autoCorrect:"off",autoCapitalize:"words",spellCheck:"false"}),o.jsxs("div",{className:"form-meta",children:[h.alamat&&o.jsx("span",{className:"error-message",children:h.alamat}),X("alamat",200)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"alasanMenghubungi",className:"form-label",children:"Alasan Menghubungi"}),o.jsx("textarea",{id:"alasanMenghubungi",value:u.alasanMenghubungi,onChange:M=>K("alasanMenghubungi",M.target.value),className:`form-textarea ${h.alasanMenghubungi?"error":""}`,placeholder:"Enter reason for contact (optional)",disabled:m,rows:4,maxLength:500,autoComplete:"off",autoCorrect:"off",autoCapitalize:"sentences",spellCheck:"false"}),o.jsxs("div",{className:"form-meta",children:[h.alasanMenghubungi&&o.jsx("span",{className:"error-message",children:h.alasanMenghubungi}),X("alasanMenghubungi",500)]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"sumber",className:"form-label",children:"Sumber"}),o.jsxs("select",{id:"sumber",value:u.sumber,onChange:M=>K("sumber",M.target.value),className:`form-select ${h.sumber?"error":""}`,disabled:m,children:[o.jsx("option",{value:"",children:"Pilih Sumber"}),Mv.map(M=>o.jsx("option",{value:M,children:M},M))]}),o.jsx("div",{className:"form-meta",children:h.sumber&&o.jsx("span",{className:"error-message",children:h.sumber})})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"prioritas",className:"form-label",children:"Prioritas"}),o.jsx("select",{id:"prioritas",value:u.prioritas,onChange:M=>K("prioritas",M.target.value),className:`form-select ${h.prioritas?"error":""}`,disabled:m,children:Dv.map(M=>o.jsx("option",{value:M,children:M},M))}),o.jsx("div",{className:"form-meta",children:h.prioritas&&o.jsx("span",{className:"error-message",children:h.prioritas})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"statusKontak",className:"form-label",children:"Status Kontak"}),o.jsx("select",{id:"statusKontak",value:u.statusKontak,onChange:M=>K("statusKontak",M.target.value),className:`form-select ${h.statusKontak?"error":""}`,disabled:m,children:Tr.map(M=>o.jsx("option",{value:M,children:M},M))}),o.jsx("div",{className:"form-meta",children:h.statusKontak&&o.jsx("span",{className:"error-message",children:h.statusKontak})})]})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",onClick:L,className:"btn btn-secondary",disabled:m,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:m||!S,children:m?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"button-spinner"}),s==="edit"?"Updating...":"Saving..."]}):s==="edit"?"Update Contact":"Save Contact"})]})]}),(C==="service"||s==="edit"&&y)&&y&&o.jsx(xN,{contactId:y.id,contactName:y.nama,onServiceStart:()=>{console.log("Service started for:",y.nama)},onServiceEnd:M=>{console.log("Service ended for:",y.nama,"Duration:",M,"seconds")}}),C==="service"&&y&&o.jsxs("div",{className:"service-mode-actions",children:[o.jsx("button",{type:"button",onClick:()=>{y&&f({nama:y.nama,nomorTelepon:y.nomorTelepon||"",jenisKelamin:y.jenisKelamin||"Laki-laki",usia:y.usia?String(y.usia):"",profesi:y.profesi||"",statusPernikahan:y.statusPernikahan||"",mediaKomunikasi:y.mediaKomunikasi||"",alamat:y.alamat||"",provinsi:y.provinsi||"",kabKota:y.kabKota||"",mission:y.mission||"",uni:y.uni||"",agama:y.agama||"",subAgama:y.subAgama||"",alasanMenghubungi:y.alasanMenghubungi||"",sumber:y.sumber||"",prioritas:y.prioritas||"Urgent",statusKontak:y.statusKontak||"New Contact"}),T("edit")},className:"btn btn-secondary",children:" Edit Contact Info"}),o.jsx("button",{type:"button",onClick:t,className:"btn btn-outline",children:" Back to Contacts"})]})]})},yN=({contactId:a,onServiceLogged:n,onCancel:t,initialDate:s=new Date})=>{const{currentUser:l}=Vt(),[u,f]=z.useState(!1),[h,g]=z.useState({}),[m,p]=z.useState(!1),S=b=>{const K=b.getFullYear(),q=(b.getMonth()+1).toString().padStart(2,"0"),B=b.getDate().toString().padStart(2,"0");return`${K}-${q}-${B}`},[x,C]=z.useState({duration:"",customDuration:"",date:S(s)}),T=z.useCallback(b=>{C(K=>({...K,duration:String(b)})),p(!1),g(K=>({...K,duration:""}))},[]),y=z.useCallback(()=>{p(b=>{const K=!b;return C(K?q=>({...q,duration:""}):q=>({...q,customDuration:""})),K}),g(b=>({...b,duration:""}))},[]),_=z.useCallback((b,K)=>{C(q=>({...q,[b]:K})),g(q=>({...q,[b]:""}))},[]),w=()=>{const b={},K=parseInt(m?x.customDuration:x.duration);if(!K||isNaN(K)||K<=0?b.duration="Please select or enter a valid duration":K>Cr.maxDurationPerSession&&(b.duration=`Duration cannot exceed ${Cr.maxDurationPerSession/60} hours per session`),!x.date)b.date="Service date is required";else{const q=new Date(x.date),B=new Date,Z=new Date;Z.setDate(B.getDate()-Cr.maxPastDate),q>B?b.date="Cannot log services for future dates":q<Z&&(b.date=`Cannot log services older than ${Cr.maxPastDate} days`)}if(!b.duration&&!b.date&&K)try{Wt.getServicesByDate(x.date).filter(Z=>Z.contactId===a&&Z.userId===l?.id).reduce((Z,L)=>Z+L.duration,0)+K>Cr.maxDurationPerDay&&(b.duration=`Total daily service duration cannot exceed ${Cr.maxDurationPerDay/60} hours`)}catch(q){console.error("Error validating daily duration:",q)}return g(b),Object.keys(b).length===0},k=async b=>{if(b.preventDefault(),!!w()){f(!0);try{const K=parseInt(m?x.customDuration:x.duration);if(!l)throw new Error("User not authenticated");const q={contactId:a,userId:l.id,date:x.date,duration:K},B=Wt.addServiceEntry(q);n(B),C({duration:"",customDuration:"",date:S(new Date)}),p(!1)}catch(K){console.error("Error logging service:",K),g({submit:K instanceof Error?K.message:"Failed to log service"})}finally{f(!1)}}},D=b=>{if(b<60)return`${b} min`;const K=Math.floor(b/60),q=b%60;return q>0?`${K}h ${q}m`:`${K}h`};return o.jsxs("form",{onSubmit:k,className:"service-entry-form",children:[o.jsxs("div",{className:"form-header",children:[o.jsx("h3",{children:"Log Service Activity"}),o.jsx("p",{children:"Record time spent serving this contact"})]}),h.submit&&o.jsx("div",{className:"error-banner",children:h.submit}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{className:"form-label",children:["Service Date ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{type:"date",value:x.date,onChange:b=>_("date",b.target.value),className:`form-input ${h.date?"error":""}`,disabled:u,max:S(new Date)}),h.date&&o.jsx("span",{className:"error-message",children:h.date})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{className:"form-label",children:["Service Duration ",o.jsx("span",{className:"required",children:"*"})]}),!m&&o.jsx("div",{className:"quick-duration-buttons",children:HS.map(b=>o.jsx("button",{type:"button",onClick:()=>T(b.value),className:`duration-btn ${x.duration===String(b.value)?"active":""}`,disabled:u,children:b.label},b.value))}),m&&o.jsxs("div",{className:"custom-duration-input",children:[o.jsx("input",{type:"number",value:x.customDuration,onChange:b=>_("customDuration",b.target.value),className:`form-input ${h.duration?"error":""}`,placeholder:"Enter minutes",min:"1",max:Cr.maxDurationPerSession,disabled:u}),o.jsx("span",{className:"input-suffix",children:"minutes"})]}),o.jsx("button",{type:"button",onClick:y,className:"toggle-custom-btn",disabled:u,children:m?"Use Quick Options":"Enter Custom Duration"}),h.duration&&o.jsx("span",{className:"error-message",children:h.duration}),(x.duration||x.customDuration)&&o.jsxs("div",{className:"duration-preview",children:["Duration: ",D(m?parseInt(x.customDuration)||0:parseInt(x.duration)||0)]})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",onClick:t,className:"btn btn-secondary",disabled:u,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?"Logging Service...":"Log Service"})]})]})},CN=({isOpen:a,contactId:n,contactName:t,onClose:s,onServiceLogged:l})=>{const u=z.useCallback(g=>{g.key==="Escape"&&s()},[s]),f=z.useCallback(g=>{g.target===g.currentTarget&&s()},[s]),h=z.useCallback(g=>{l(g),s()},[l,s]);return z.useEffect(()=>(a?(document.addEventListener("keydown",u),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",u),document.body.style.overflow="unset"),()=>{document.removeEventListener("keydown",u),document.body.style.overflow="unset"}),[a,u]),a?o.jsx("div",{className:"service-modal-overlay",onClick:f,children:o.jsxs("div",{className:"service-modal-container",children:[o.jsxs("div",{className:"service-modal-header",children:[o.jsxs("div",{className:"modal-title",children:[o.jsx("h2",{children:"Log Service"}),o.jsxs("p",{children:["Contact: ",o.jsx("strong",{children:t})]})]}),o.jsx("button",{onClick:s,className:"modal-close-btn","aria-label":"Close modal",children:""})]}),o.jsx("div",{className:"service-modal-content",children:o.jsx(yN,{contactId:n,onServiceLogged:h,onCancel:s})})]})}):null},TN=({contactId:a,onDateClick:n})=>{const[t,s]=z.useState(new Date),[l,u]=z.useState([]),[f,h]=z.useState([]),g=z.useCallback(()=>{const w=Wt.getServicesByContact(a);h(w)},[a]),m=z.useCallback(()=>{const w=t.getFullYear(),k=t.getMonth(),D=new Date(w,k,1),b=new Date(w,k+1,0),K=new Date(D);K.setDate(K.getDate()-D.getDay());const q=new Date(b);q.setDate(q.getDate()+(6-b.getDay()));const B=[],Z=new Date;Z.setHours(0,0,0,0);const L=new Map;f.forEach(M=>{const H=M.date;L.has(H)||L.set(H,[]),L.get(H).push(M)});const X=new Date(K);for(;X<=q;){const M=X.getFullYear(),H=X.getMonth()+1,ue=X.getDate(),be=`${M}-${H.toString().padStart(2,"0")}-${ue.toString().padStart(2,"0")}`,Se=L.get(be)||[],ee=Se.reduce((ke,Ne)=>ke+Ne.duration,0),ge={date:be,day:X.getDate(),isCurrentMonth:X.getMonth()===k,isToday:X.getTime()===Z.getTime(),hasService:Se.length>0,serviceCount:Se.length,totalDuration:ee,services:Se};B.push(ge),X.setDate(X.getDate()+1)}u(B)},[t,f]);z.useEffect(()=>{g()},[g]),z.useEffect(()=>{const w=()=>{g()};return window.addEventListener("serviceAdded",w),window.addEventListener("serviceUpdated",w),window.addEventListener("serviceDeleted",w),()=>{window.removeEventListener("serviceAdded",w),window.removeEventListener("serviceUpdated",w),window.removeEventListener("serviceDeleted",w)}},[g]),z.useEffect(()=>{m()},[m]);const p=()=>{s(w=>{const k=new Date(w);return k.setMonth(k.getMonth()-1),k})},S=()=>{s(w=>{const k=new Date(w);return k.setMonth(k.getMonth()+1),k})},x=()=>{s(new Date)},C=w=>{w.hasService&&n&&n(w.date,w.services)},T=w=>{if(w<60)return`${w}m`;const k=Math.floor(w/60),D=w%60;return D>0?`${k}h${D}m`:`${k}h`},y=t.toLocaleDateString("en-US",{month:"long",year:"numeric"}),_=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return o.jsxs("div",{className:"service-calendar",children:[o.jsxs("div",{className:"calendar-header",children:[o.jsxs("div",{className:"calendar-navigation",children:[o.jsx("button",{onClick:p,className:"nav-btn",title:"Previous month",children:""}),o.jsx("h3",{className:"month-year",children:y}),o.jsx("button",{onClick:S,className:"nav-btn",title:"Next month",children:""})]}),o.jsx("button",{onClick:x,className:"today-btn",children:"Today"})]}),o.jsxs("div",{className:"calendar-grid",children:[_.map(w=>o.jsx("div",{className:"week-day-header",children:w},w)),l.map((w,k)=>o.jsxs("div",{className:`calendar-day ${w.isCurrentMonth?"":"other-month"} ${w.isToday?"today":""} ${w.hasService?"has-service":""}`,onClick:()=>C(w),title:w.hasService?`${w.serviceCount} service${w.serviceCount>1?"s":""}, ${T(w.totalDuration)}`:void 0,children:[o.jsx("span",{className:"day-number",children:w.day}),w.hasService&&o.jsxs("div",{className:"service-indicator",children:[o.jsx("div",{className:"service-dot"}),o.jsx("span",{className:"service-count",children:w.serviceCount})]})]},k))]}),o.jsxs("div",{className:"calendar-legend",children:[o.jsxs("div",{className:"legend-item",children:[o.jsx("div",{className:"legend-dot"}),o.jsx("span",{children:"Service day"})]}),o.jsxs("div",{className:"legend-item",children:[o.jsx("div",{className:"legend-today"}),o.jsx("span",{children:"Today"})]})]})]})};class EN{generateFileName(n){const s=new Date().toISOString().split("T")[0];let l="";if(n.dateRange.type==="custom"&&n.dateRange.startDate&&n.dateRange.endDate){const h=n.dateRange.startDate.toISOString().split("T")[0],g=n.dateRange.endDate.toISOString().split("T")[0];l=`_${h}_to_${g}`}else l=`_${n.dateRange.type}`;let u="";if(n.filters.userId){const g=Ke.getUsers().find(m=>m.id===n.filters.userId);g&&(u=`_user_${g.username}`)}const f=n.format==="csv"?"csv":"xlsx";return`service_report_${n.reportType}_${s}${l}${u}.${f}`}filterServicesByDateRange(n,t){if(t.type==="custom"&&t.startDate&&t.endDate){const f=t.startDate.toISOString().split("T")[0],h=t.endDate.toISOString().split("T")[0];return n.filter(g=>g.date>=f&&g.date<=h)}const s=new Date;let l;switch(t.type){case"daily":l=new Date(s.getTime()-1440*60*1e3);break;case"weekly":l=new Date(s.getTime()-10080*60*1e3);break;case"monthly":l=new Date(s.getTime()-720*60*60*1e3);break;case"quarterly":l=new Date(s.getTime()-2160*60*60*1e3);break;case"yearly":l=new Date(s.getTime()-365*24*60*60*1e3);break;default:return n}const u=l.toISOString().split("T")[0];return n.filter(f=>f.date>=u)}getServiceReportData(n){let t=Wt.getAllServices();t=this.filterServicesByDateRange(t,n.dateRange),n.filters.userId&&(t=t.filter(x=>x.userId===n.filters.userId)),n.filters.contactId&&(t=t.filter(x=>x.contactId===n.filters.contactId));const s=new Set(t.map(x=>x.contactId)),u=Ke.getContacts().filter(x=>s.has(x.id)),f=Wt.getAllServiceMetrics().filter(x=>t.some(T=>T.contactId===x.contactId&&T.userId===x.userId)),h=new Set(t.map(x=>x.date)),g=new Set(t.map(x=>x.userId)),m=new Set(t.map(x=>x.contactId)),p=t.reduce((x,C)=>x+C.duration,0),S={totalServices:t.length,totalDuration:p,totalServiceDays:h.size,activeUsers:g.size,activeContacts:m.size,averageDurationPerService:t.length>0?Math.round(p/t.length):0,averageDurationPerDay:h.size>0?Math.round(p/h.size):0};return{services:t,contacts:u,metrics:f,summary:S}}formatDuration(n){if(n<60)return`${n} min`;const t=Math.floor(n/60),s=n%60;return s>0?`${t}h ${s}m`:`${t}h`}exportDetailedReport(n){const t=this.getServiceReportData(n),s=t.services.filter(x=>x.serviceType==="WhatsApp Chat"),l=t.services.filter(x=>x.serviceType!=="WhatsApp Chat"),u=new Map;t.services.forEach(x=>{if(!u.has(x.contactId)){const C=t.services.filter(D=>D.contactId===x.contactId),T=C.filter(D=>D.serviceType==="WhatsApp Chat"),y=C.filter(D=>D.serviceType!=="WhatsApp Chat"),_=new Set(y.map(D=>D.date)),w=new Set(T.map(D=>D.date)),k=y.reduce((D,b)=>D+b.duration,0);u.set(x.contactId,{totalServiceDays:_.size,totalServiceTime:k,totalChatCount:T.length,chatDays:w.size})}});const f=l.map(x=>{const C=t.contacts.find(_=>_.id===x.contactId),T=u.get(x.contactId),y={"Service Type":"Call Service","Service Date":x.date,"Contact ID":x.contactId,"Contact Name":C?.nama||"Unknown","User ID":x.userId,"Duration (minutes)":x.duration,"Duration (formatted)":this.formatDuration(x.duration),"Service Description":x.description||x.serviceType||"","Contact Total Call Days":T?.totalServiceDays||0,"Contact Total Call Time (minutes)":T?.totalServiceTime||0,"Contact Total Call Time (formatted)":this.formatDuration(T?.totalServiceTime||0),"Service Created":zn(x.createdAt)};return n.filters.includeContactInfo&&C&&(y["Contact Phone"]=C.nomorTelepon||"",y["Contact Address"]=C.alamat||"",y["Contact Status"]=C.statusKontak||"",y["Contact Priority"]=C.prioritas||"",y["Contact Source"]=C.sumber||""),y}),h=s.map(x=>{const C=t.contacts.find(_=>_.id===x.contactId),T=u.get(x.contactId),y={"Service Type":"WhatsApp Chat","Service Date":x.date,"Contact ID":x.contactId,"Contact Name":C?.nama||"Unknown","User ID":x.userId,"Duration (minutes)":"N/A (Chat)","Duration (formatted)":"Chat","Service Description":x.description||"WhatsApp Chat","Contact Total Chat Count":T?.totalChatCount||0,"Contact Chat Days":T?.chatDays||0,"Service Created":zn(x.createdAt)};return n.filters.includeContactInfo&&C&&(y["Contact Phone"]=C.nomorTelepon||"",y["Contact Address"]=C.alamat||"",y["Contact Status"]=C.statusKontak||"",y["Contact Priority"]=C.prioritas||"",y["Contact Source"]=C.sumber||""),y}),g=[...f.length>0?[{"Service Type":"=== CALL SERVICES ===","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":"","Duration (formatted)":"","Service Description":"","Service Created":""},...f]:[],...h.length>0?[{"Service Type":"=== WHATSAPP CHAT SERVICES ===","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":"","Duration (formatted)":"","Service Description":"","Service Created":""},...h]:[]],m={"Service Type":"--- CALL SERVICES SUMMARY ---","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":l.reduce((x,C)=>x+C.duration,0),"Duration (formatted)":this.formatDuration(l.reduce((x,C)=>x+C.duration,0)),"Service Description":`${l.length} call services`,"Service Created":""},p={"Service Type":"--- CHAT SERVICES SUMMARY ---","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":"N/A (Chat)","Duration (formatted)":"Chat","Service Description":`${s.length} chat interactions`,"Service Created":""},S={"Service Type":"--- OVERALL SUMMARY ---","Service Date":"","Contact ID":"","Contact Name":"","User ID":"","Duration (minutes)":`${l.reduce((x,C)=>x+C.duration,0)} (calls only)`,"Duration (formatted)":`${this.formatDuration(l.reduce((x,C)=>x+C.duration,0))} + ${s.length} chats`,"Service Description":`${t.services.length} total services (${l.length} calls + ${s.length} chats)`,"Service Created":""};n.filters.includeContactInfo&&[m,p,S].forEach(x=>{x["Contact Phone"]="",x["Contact Address"]="",x["Contact Status"]="",x["Contact Priority"]="",x["Contact Source"]=""}),g.push(m,p,S),this.exportData(g,n,"Detailed Service Report")}exportSummaryReport(n){const t=this.getServiceReportData(n),s=t.services.filter(T=>T.serviceType==="WhatsApp Chat"),l=t.services.filter(T=>T.serviceType!=="WhatsApp Chat"),u=new Map;t.services.forEach(T=>{const y=t.contacts.find(k=>k.id===T.contactId),_=T.contactId;u.has(_)||u.set(_,{contactId:T.contactId,contactName:y?.nama||"Unknown",totalCallServices:0,totalChatServices:0,totalCallDuration:0,callServiceDays:0,chatServiceDays:0,activeUsers:0,firstService:T.date,lastService:T.date});const w=u.get(_);T.serviceType==="WhatsApp Chat"?w.totalChatServices++:(w.totalCallServices++,w.totalCallDuration+=T.duration),T.date<w.firstService&&(w.firstService=T.date),T.date>w.lastService&&(w.lastService=T.date)}),u.forEach((T,y)=>{const _=l.filter(q=>q.contactId===y),w=s.filter(q=>q.contactId===y),k=t.services.filter(q=>q.contactId===y),D=new Set(_.map(q=>q.date)),b=new Set(w.map(q=>q.date)),K=new Set(k.map(q=>q.userId));T.callServiceDays=D.size,T.chatServiceDays=b.size,T.activeUsers=K.size});const f=Array.from(u.values()).map(T=>({"Contact ID":T.contactId,"Contact Name":T.contactName,"Call Services":T.totalCallServices,"Chat Services":T.totalChatServices,"Total Services":T.totalCallServices+T.totalChatServices,"Call Service Days":T.callServiceDays,"Chat Service Days":T.chatServiceDays,"Call Duration (minutes)":T.totalCallDuration,"Call Duration (formatted)":this.formatDuration(T.totalCallDuration),"Chat Frequency":`${T.totalChatServices} interactions`,"Active Users":T.activeUsers,"Average Call Duration":T.totalCallServices>0?Math.round(T.totalCallDuration/T.totalCallServices):0,"Average Call Duration per Day":T.callServiceDays>0?Math.round(T.totalCallDuration/T.callServiceDays):0,"Average Chats per Day":T.chatServiceDays>0?Math.round(T.totalChatServices/T.chatServiceDays*100)/100:0,"First Service":T.firstService,"Last Service":T.lastService})),h=f.reduce((T,y)=>T+y["Call Services"],0),g=f.reduce((T,y)=>T+y["Chat Services"],0),m=f.reduce((T,y)=>T+y["Call Duration (minutes)"],0),p=f.reduce((T,y)=>T+y["Call Service Days"],0),S=f.reduce((T,y)=>T+y["Chat Service Days"],0),C={"Contact ID":`--- OVERALL SUMMARY${n.filters.userId?` (Filtered by User: ${Ke.getUsers().find(T=>T.id===n.filters.userId)?.username||"Unknown"})`:""} ---`,"Contact Name":"","Call Services":h,"Chat Services":g,"Total Services":h+g,"Call Service Days":p,"Chat Service Days":S,"Call Duration (minutes)":m,"Call Duration (formatted)":this.formatDuration(m),"Chat Frequency":`${g} total interactions`,"Active Users":t.summary.activeUsers,"Average Call Duration":h>0?Math.round(m/h):0,"Average Call Duration per Day":p>0?Math.round(m/p):0,"Average Chats per Day":S>0?Math.round(g/S*100)/100:0,"First Service":"","Last Service":""};f.push(C),this.exportData(f,n,"Service Summary Report")}exportAnalyticsReport(n){const t=this.getServiceReportData(n),l=[{"Report Type":"Overall Summary","Filter Applied":`User: ${n.filters.userId?Ke.getUsers().find(g=>g.id===n.filters.userId)?.username||"Unknown User":"All Users"}`,"Total Services":t.summary.totalServices,"Total Service Days":t.summary.totalServiceDays,"Total Duration (minutes)":t.summary.totalDuration,"Total Duration (formatted)":this.formatDuration(t.summary.totalDuration),"Active Users":t.summary.activeUsers,"Active Contacts":t.summary.activeContacts,"Average Duration per Service":t.summary.averageDurationPerService,"Average Duration per Day":t.summary.averageDurationPerDay,"Report Generated":zn(new Date)}],u=new Map;t.services.forEach(g=>{u.has(g.userId)||u.set(g.userId,{userId:g.userId,totalServices:0,totalDuration:0,serviceDays:0,contactsServed:0});const m=u.get(g.userId);m.totalServices++,m.totalDuration+=g.duration}),u.forEach((g,m)=>{const p=t.services.filter(C=>C.userId===m),S=new Set(p.map(C=>C.date)),x=new Set(p.map(C=>C.contactId));g.serviceDays=S.size,g.contactsServed=x.size});const f=Array.from(u.values()).map(g=>({"User ID":g.userId,"Total Services":g.totalServices,"Service Days":g.serviceDays,"Total Duration (minutes)":g.totalDuration,"Total Duration (formatted)":this.formatDuration(g.totalDuration),"Contacts Served":g.contactsServed,"Average Duration per Service":Math.round(g.totalDuration/g.totalServices),"Average Duration per Day":Math.round(g.totalDuration/g.serviceDays),"Services per Day":Math.round(g.totalServices/g.serviceDays*100)/100})),h=[...l,{"Report Type":"--- USER PERFORMANCE ---"},...f];this.exportData(h,n,"Service Analytics Report")}exportData(n,t,s){const l=this.generateFileName(t);t.format==="csv"?this.exportToCSV(n,l):this.exportToExcel(n,l,s)}exportToCSV(n,t){if(n.length===0){alert("No data to export");return}const s=Object.keys(n[0]),l=[s.join(","),...n.map(g=>s.map(m=>{const p=g[m];return typeof p=="string"&&(p.includes(",")||p.includes('"'))?`"${p.replace(/"/g,'""')}"`:p}).join(","))].join(`
`),u=new Blob([l],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a"),h=URL.createObjectURL(u);f.setAttribute("href",h),f.setAttribute("download",t),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}exportToExcel(n,t,s){if(n.length===0){alert("No data to export");return}const l=Pn.json_to_sheet(n),u=Pn.book_new();Pn.book_append_sheet(u,l,s);const f=Object.keys(n[0]).map(h=>({wch:Math.max(h.length,...n.map(g=>String(g[h]||"").length))}));l["!cols"]=f,kb(u,t)}exportWeeklyReport(){this.exportSummaryReport({format:"excel",reportType:"summary",dateRange:{type:"weekly"},filters:{includeContactInfo:!0}})}exportMonthlyReport(){this.exportAnalyticsReport({format:"excel",reportType:"analytics",dateRange:{type:"monthly"},filters:{includeContactInfo:!0}})}exportCustomReport(n,t,s){this.exportDetailedReport({format:"excel",reportType:"detailed",dateRange:{type:"custom",startDate:n,endDate:t},filters:{userId:s,includeContactInfo:!0}})}}const fl=new EN,_N=({isOpen:a,onClose:n})=>{const{currentUser:t}=Vt(),[s,l]=z.useState({format:"excel",reportType:"summary",dateRange:{type:"monthly"},filters:{includeContactInfo:!0}}),[u,f]=z.useState(!1),[h,g]=z.useState([]);z.useEffect(()=>{if(a&&t){const S=Ke.getUsers(),x=Bf(S,t);g(x);const C=vp(t);l(T=>({...T,filters:{...T.filters,userId:C!=="all"?C:void 0}}))}},[a,t]);const m=async()=>{if(s.dateRange.type==="custom"){if(!s.dateRange.startDate||!s.dateRange.endDate){alert("Please select both start and end dates for custom range.");return}if(s.dateRange.startDate>s.dateRange.endDate){alert("Start date must be before end date.");return}}f(!0);try{switch(s.reportType){case"detailed":fl.exportDetailedReport(s);break;case"summary":fl.exportSummaryReport(s);break;case"analytics":fl.exportAnalyticsReport(s);break}n()}catch(S){console.error("Export error:",S),alert("Export failed. Please try again.")}finally{f(!1)}},p=S=>{f(!0);try{S==="weekly"?fl.exportWeeklyReport():fl.exportMonthlyReport(),n()}catch(x){console.error("Quick export error:",x),alert("Export failed. Please try again.")}finally{f(!1)}};return a?o.jsx("div",{className:"service-export-modal-overlay",onClick:n,children:o.jsxs("div",{className:"service-export-modal",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Export Service Reports"}),s.filters.userId&&o.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"#666"},children:["Filtered by: ",h.find(S=>S.id===s.filters.userId)?.username||"Unknown User"]})]}),o.jsx("button",{onClick:n,className:"close-btn",children:""})]}),o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"quick-export-section",children:[o.jsx("h3",{children:"Quick Export"}),o.jsxs("div",{className:"quick-export-buttons",children:[o.jsx("button",{onClick:()=>p("weekly"),disabled:u,className:"quick-export-btn",children:" Weekly Summary"}),o.jsx("button",{onClick:()=>p("monthly"),disabled:u,className:"quick-export-btn",children:" Monthly Analytics"})]})]}),o.jsx("div",{className:"divider",children:"OR"}),o.jsxs("div",{className:"custom-export-section",children:[o.jsx("h3",{children:"Custom Export"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Report Type:"}),o.jsxs("select",{value:s.reportType,onChange:S=>l(x=>({...x,reportType:S.target.value})),children:[o.jsx("option",{value:"detailed",children:"Detailed Report"}),o.jsx("option",{value:"summary",children:"Summary Report"}),o.jsx("option",{value:"analytics",children:"Analytics Report"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Date Range:"}),o.jsxs("select",{value:s.dateRange.type,onChange:S=>l(x=>({...x,dateRange:{type:S.target.value}})),children:[o.jsx("option",{value:"daily",children:"Last 24 Hours"}),o.jsx("option",{value:"weekly",children:"Last Week"}),o.jsx("option",{value:"monthly",children:"Last Month"}),o.jsx("option",{value:"quarterly",children:"Last Quarter"}),o.jsx("option",{value:"yearly",children:"Last Year"}),o.jsx("option",{value:"custom",children:"Custom Range"})]})]}),s.dateRange.type==="custom"&&o.jsxs("div",{className:"custom-date-range",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Start Date:"}),o.jsx("input",{type:"date",value:s.dateRange.startDate?s.dateRange.startDate.toISOString().split("T")[0]:"",onChange:S=>{const x=S.target.value?new Date(S.target.value):void 0;l(C=>({...C,dateRange:{...C.dateRange,startDate:x}}))},max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"End Date:"}),o.jsx("input",{type:"date",value:s.dateRange.endDate?s.dateRange.endDate.toISOString().split("T")[0]:"",onChange:S=>{const x=S.target.value?new Date(S.target.value):void 0;l(C=>({...C,dateRange:{...C.dateRange,endDate:x}}))},max:new Date().toISOString().split("T")[0],min:s.dateRange.startDate?s.dateRange.startDate.toISOString().split("T")[0]:void 0})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Format:"}),o.jsxs("select",{value:s.format,onChange:S=>l(x=>({...x,format:S.target.value})),children:[o.jsx("option",{value:"excel",children:"Excel (.xlsx)"}),o.jsx("option",{value:"csv",children:"CSV (.csv)"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Filter by User:"}),o.jsxs("select",{value:s.filters.userId||"",onChange:S=>l(x=>({...x,filters:{...x.filters,userId:S.target.value||void 0}})),disabled:Ev(t),children:[Kf(t)&&o.jsx("option",{value:"",children:"All Users"}),h.map(S=>o.jsxs("option",{value:S.id,children:[S.username," (",S.role,")"]},S.id))]}),Ev(t)&&o.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"#666"},children:"You can only export your own data"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:s.filters.includeContactInfo||!1,onChange:S=>l(x=>({...x,filters:{...x.filters,includeContactInfo:S.target.checked}}))}),"Include Contact Information"]})})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{onClick:n,disabled:u,className:"btn-secondary",children:"Cancel"}),o.jsx("button",{onClick:m,disabled:u,className:"btn-primary",children:u?"Exporting...":"Export Report"})]})]})}):null},wN=({onFilterChange:a,initialFilters:n})=>{const[t,s]=z.useState({period:"all",...n}),[l,u]=z.useState(!1);z.useEffect(()=>{const S=new Date;let x,C;switch(t.period){case"week":x=new Date(S),x.setDate(S.getDate()-7),C=new Date(S);break;case"month":x=new Date(S),x.setMonth(S.getMonth()-1),C=new Date(S);break;case"quarter":x=new Date(S),x.setMonth(S.getMonth()-3),C=new Date(S);break;case"year":x=new Date(S),x.setFullYear(S.getFullYear()-1),C=new Date(S);break;case"custom":x=t.startDate,C=t.endDate,u(!0);break;case"all":default:x=void 0,C=void 0,u(!1);break}const T={...t,startDate:x,endDate:C};a(T)},[t.period,t.startDate,t.endDate]);const f=S=>{s(x=>({...x,period:S})),u(S==="custom")},h=(S,x)=>{if(x){const C=new Date(x);s(T=>({...T,[S]:C}))}},g=S=>S.toISOString().split("T")[0],m=()=>{if(t.period==="all")return"Semua Waktu";if(!t.startDate||!t.endDate)return"";const S=t.startDate.toLocaleDateString("id-ID"),x=t.endDate.toLocaleDateString("id-ID");return`${S} - ${x}`},p=()=>{s({period:"all"}),u(!1)};return o.jsxs("div",{className:"contact-service-filter",children:[o.jsxs("div",{className:"filter-header",children:[o.jsx("span",{className:"filter-label",children:"Filter Periode:"}),o.jsx("button",{onClick:p,className:"clear-btn",title:"Reset ke semua waktu",children:""})]}),o.jsxs("div",{className:"filter-controls",children:[o.jsxs("div",{className:"period-buttons",children:[o.jsx("button",{className:`period-btn ${t.period==="all"?"active":""}`,onClick:()=>f("all"),children:"Semua"}),o.jsx("button",{className:`period-btn ${t.period==="week"?"active":""}`,onClick:()=>f("week"),children:"7 Hari"}),o.jsx("button",{className:`period-btn ${t.period==="month"?"active":""}`,onClick:()=>f("month"),children:"30 Hari"}),o.jsx("button",{className:`period-btn ${t.period==="quarter"?"active":""}`,onClick:()=>f("quarter"),children:"3 Bulan"}),o.jsx("button",{className:`period-btn ${t.period==="year"?"active":""}`,onClick:()=>f("year"),children:"1 Tahun"}),o.jsx("button",{className:`period-btn ${t.period==="custom"?"active":""}`,onClick:()=>f("custom"),children:"Custom"})]}),l&&o.jsxs("div",{className:"custom-dates",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"Dari:"}),o.jsx("input",{type:"date",value:t.startDate?g(t.startDate):"",onChange:S=>h("startDate",S.target.value),className:"date-input"})]}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{children:"Sampai:"}),o.jsx("input",{type:"date",value:t.endDate?g(t.endDate):"",onChange:S=>h("endDate",S.target.value),className:"date-input"})]})]})]}),t.period!=="all"&&o.jsx("div",{className:"filter-summary",children:o.jsx("span",{className:"summary-text",children:m()})})]})},bN=({contact:a,onEdit:n,onDelete:t,onClose:s})=>{const{hasPermission:l}=Vt(),[u,f]=z.useState(!1),[h,g]=z.useState(!1),[m,p]=z.useState(null),[S,x]=z.useState(null),[C,T]=z.useState({period:"all"}),y=z.useCallback(()=>{const X=Wt.getContactServiceSummary(a.id);p(X)},[a.id]),_=z.useCallback(()=>{if(!m){x(null);return}if(C.period==="all"){x(m);return}const X=Wt.getServicesByContact(a.id);let M=X;if(C.startDate&&C.endDate){const G=C.startDate,j=C.endDate;M=X.filter(V=>{const P=new Date(V.date);return P>=G&&P<=j})}const H=new Set(M.map(G=>G.date)).size,ue=M.reduce((G,j)=>G+j.duration,0)/60,be=new Set(M.map(G=>G.userId)).size,Se=M.sort((G,j)=>new Date(j.date).getTime()-new Date(G.date).getTime())[0],ee=Se?new Date(Se.date):void 0,ge=Se?.userId,ke=new Map;M.forEach(G=>{const j=new Date(G.date),V=`${j.getFullYear()}-${(j.getMonth()+1).toString().padStart(2,"0")}`;ke.has(V)||ke.set(V,{serviceCount:new Set,duration:0}),ke.get(V).serviceCount.add(G.date),ke.get(V).duration+=G.duration});const Ne=Array.from(ke.entries()).sort(([G],[j])=>G.localeCompare(j)).slice(-6).map(([G,j])=>({month:G,serviceCount:j.serviceCount.size,duration:j.duration})),Le={contactId:a.id,totalServiceDays:H,totalServiceHours:ue,activeUsers:be,monthlyTrend:Ne};ee&&(Le.lastServiceDate=ee),ge&&(Le.lastServiceUser=ge),x(Le)},[a.id,m,C]);z.useEffect(()=>{y()},[y]),z.useEffect(()=>{_()},[_]),z.useEffect(()=>{const X=()=>{y()};return window.addEventListener("serviceAdded",X),window.addEventListener("serviceUpdated",X),window.addEventListener("serviceDeleted",X),()=>{window.removeEventListener("serviceAdded",X),window.removeEventListener("serviceUpdated",X),window.removeEventListener("serviceDeleted",X)}},[y]);const w=()=>{if(!l("Admin")){alert("Only administrators can delete contacts");return}window.confirm(`Are you sure you want to delete ${a.nama}?`)&&t?.(a.id)},k=()=>{f(!0)},D=X=>{console.log("Service logged:",X)},b=X=>{T(X)},K=X=>{if(X===0)return"0h";if(X<1)return`${Math.round(X*60)}m`;const M=Math.floor(X),H=Math.round((X-M)*60);return H>0?`${M}h ${H}m`:`${M}h`},q=X=>({"New Contact":"#e74c3c","In Progress":"#f39c12","Follow Up":"#3498db",Completed:"#27ae60"})[X]||"#95a5a6",B=X=>X,Z=()=>{const X=new Date,M=new Date(a.createdAt),H=Math.abs(X.getTime()-M.getTime()),ue=Math.ceil(H/(1e3*60*60*24));return ue===1?"1 day ago":ue<30?`${ue} days ago`:ue<365?`${Math.floor(ue/30)} months ago`:`${Math.floor(ue/365)} years ago`},L=()=>{const X=new Date,M=new Date(a.updatedAt);return Math.abs(X.getTime()-M.getTime())/(1e3*60*60)<=24};return o.jsxs("div",{className:"contact-detail-overlay",children:[o.jsxs("div",{className:"contact-detail-container",children:[o.jsxs("div",{className:"contact-detail-header",children:[o.jsxs("div",{className:"contact-detail-title",children:[o.jsx("h2",{children:a.nama}),o.jsxs("div",{className:"contact-status-info",children:[o.jsx("span",{className:"status-badge large",style:{backgroundColor:q(a.statusKontak)},children:B(a.statusKontak)}),L()&&o.jsx("span",{className:"recently-updated",children:"Recently Updated"})]})]}),o.jsx("button",{onClick:s,className:"close-btn",title:"Close",children:""})]}),o.jsxs("div",{className:"contact-detail-content",children:[o.jsxs("div",{className:"contact-info-grid",children:[o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Personal Information"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Full Name"}),o.jsx("div",{className:"info-value",children:a.nama})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Gender"}),o.jsx("div",{className:"info-value",children:a.jenisKelamin||"Not specified"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Religion"}),o.jsx("div",{className:"info-value",children:a.agama})]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Contact Information"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Phone Number"}),o.jsx("div",{className:"info-value",children:a.nomorTelepon||"Not provided"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Address"}),o.jsx("div",{className:"info-value address",children:a.alamat})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Provinsi"}),o.jsx("div",{className:"info-value",children:a.provinsi||"Not specified"})]})]})]}),o.jsxs("div",{className:"info-section full-width",children:[o.jsx("h3",{children:"Contact Reason & Source"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Reason for Contact"}),o.jsx("div",{className:"info-value reason",children:a.alasanMenghubungi})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Sumber"}),o.jsx("div",{className:"info-value",children:o.jsx("span",{className:"sumber-badge",children:a.sumber||"Lainnya"})})]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Priority & Status"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Priority"}),o.jsx("div",{className:"info-value",children:o.jsx("span",{className:`priority-badge priority-${a.prioritas?.toLowerCase()||"sedang"}`,children:a.prioritas||"Sedang"})})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Current Status"}),o.jsx("div",{className:"info-value",children:o.jsx("span",{className:"status-badge",style:{backgroundColor:q(a.statusKontak)},children:a.statusKontak})})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Contact Age"}),o.jsx("div",{className:"info-value",children:Z()})]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{children:"Timestamps"}),o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Created"}),o.jsx("div",{className:"info-value timestamp",children:zn(new Date(a.createdAt))})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("label",{children:"Last Updated"}),o.jsx("div",{className:"info-value timestamp",children:zn(new Date(a.updatedAt))})]})]})]})]}),o.jsxs("div",{className:"contact-metadata",children:[o.jsxs("div",{className:"metadata-item",children:[o.jsx("span",{className:"metadata-label",children:"Contact ID:"}),o.jsx("span",{className:"metadata-value",children:a.id})]}),o.jsxs("div",{className:"metadata-item",children:[o.jsx("span",{className:"metadata-label",children:"Created by:"}),o.jsx("span",{className:"metadata-value",children:a.createdBy})]})]}),o.jsx(nN,{history:a.history||[],isExpanded:!1,maxEntries:5}),o.jsxs("div",{className:"service-tracking-section",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h3",{children:"Service Tracking"}),o.jsxs("div",{className:"service-actions",children:[o.jsxs("button",{onClick:()=>g(!0),className:"export-service-btn",title:"Export service reports",children:[o.jsx("span",{children:""}),"Export Reports"]}),o.jsxs("button",{onClick:k,className:"log-service-btn",title:"Log new service activity",children:[o.jsx("span",{children:""}),"Log Service"]})]})]}),o.jsx(wN,{onFilterChange:b,initialFilters:C}),S&&S.totalServiceDays>0&&o.jsxs("div",{className:"service-summary",children:[o.jsxs("div",{className:"service-stats",children:[o.jsxs("div",{className:"stat-item",children:[o.jsx("div",{className:"stat-value",children:S.totalServiceDays}),o.jsx("div",{className:"stat-label",children:"Service Days"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("div",{className:"stat-value",children:K(S.totalServiceHours)}),o.jsx("div",{className:"stat-label",children:"Total Time"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("div",{className:"stat-value",children:S.activeUsers}),o.jsx("div",{className:"stat-label",children:"Active Users"})]})]}),S.lastServiceDate&&o.jsxs("div",{className:"last-service-info",children:[o.jsx("span",{className:"last-service-label",children:"Last Service:"}),o.jsx("span",{className:"last-service-date",children:zn(S.lastServiceDate)}),S.lastServiceUser&&o.jsxs("span",{className:"last-service-user",children:["by ",S.lastServiceUser]})]}),S.monthlyTrend&&S.monthlyTrend.length>0&&o.jsxs("div",{className:"monthly-trend",children:[o.jsx("h4",{children:"Recent Activity (Last 6 Months)"}),o.jsx("div",{className:"trend-chart",children:S.monthlyTrend.map(X=>o.jsxs("div",{className:"trend-bar",children:[o.jsx("div",{className:"trend-fill",style:{height:`${Math.max(5,X.serviceCount/Math.max(...S.monthlyTrend.map(M=>M.serviceCount))*100)}%`},title:`${X.month}: ${X.serviceCount} days, ${K(X.duration)}`}),o.jsx("div",{className:"trend-label",children:new Date(X.month+"-01").toLocaleDateString("en-US",{month:"short"})})]},X.month))})]})]}),(!S||S.totalServiceDays===0)&&o.jsxs("div",{className:"no-service-data",children:[o.jsx("p",{children:"No service activities recorded yet."}),o.jsx("p",{children:'Click "Log Service" to start tracking service time for this contact.'})]})]}),o.jsxs("div",{className:"service-calendar-section",children:[o.jsx("h4",{children:"Service Calendar"}),o.jsx("p",{children:"Highlighted dates show when services were provided to this contact"}),o.jsx(TN,{contactId:a.id,onDateClick:(X,M)=>{console.log("Date clicked:",X,"Services:",M)}})]})]}),o.jsxs("div",{className:"contact-detail-actions",children:[o.jsx(gf,{contact:a,variant:"primary",showTemplates:!0,className:"whatsapp-action-btn"}),o.jsxs("button",{onClick:()=>n?.(a),className:"action-btn edit-btn",children:[o.jsx("span",{children:""}),"Edit Contact"]}),l("Admin")&&o.jsxs("button",{onClick:w,className:"action-btn delete-btn",children:[o.jsx("span",{children:""}),"Delete Contact"]}),o.jsx("button",{onClick:s,className:"action-btn close-btn-secondary",children:"Close"})]})]}),u&&o.jsx(CN,{isOpen:u,contactId:a.id,contactName:a.nama,onClose:()=>f(!1),onServiceLogged:D}),h&&o.jsx(_N,{isOpen:h,onClose:()=>g(!1)})]})},NN=({onLogoUpdate:a,maxFileSize:n=2*1024*1024,acceptedFormats:t=["image/png","image/jpeg","image/jpg","image/svg+xml","image/webp"],showPreview:s=!0})=>{const[l,u]=z.useState(!1),[f,h]=z.useState(!1),[g,m]=z.useState(null),[p,S]=z.useState(null),[x,C]=z.useState(null),[T,y]=z.useState(ml.getCurrentLogo()),_=z.useRef(null),{currentUser:w}=Vt(),k=z.useCallback(()=>{S(null),C(null)},[]),D=z.useCallback(async H=>{if(!w){S("You must be logged in to upload logos");return}k(),h(!0);try{const ue=ml.validateLogoFile(H);if(!ue.isValid){S(ue.errors.join(", "));return}if(s){const Se=new FileReader;Se.onload=ee=>{m(ee.target?.result)},Se.readAsDataURL(H)}const be=await ml.updateLogo(H,w.id);y(be),C(`Logo updated successfully! File: ${H.name}`),a?.(be),window.dispatchEvent(new CustomEvent("logoUpdated"))}catch(ue){const be=ue instanceof Error?ue.message:"Failed to upload logo";S(be),m(null)}finally{h(!1)}},[w,a,s,k]),b=z.useCallback(H=>{H.preventDefault(),u(!0)},[]),K=z.useCallback(H=>{H.preventDefault(),u(!1)},[]),q=z.useCallback(H=>{H.preventDefault(),u(!1);const ue=Array.from(H.dataTransfer.files);ue.length>0&&D(ue[0])},[D]),B=z.useCallback(H=>{const ue=H.target.files;ue&&ue.length>0&&D(ue[0])},[D]),Z=z.useCallback(()=>{_.current?.click()},[]),L=z.useCallback(()=>{if(!w){S("You must be logged in to reset logo");return}if(window.confirm("Are you sure you want to reset to the default logo?")){k();const H=ml.resetToDefault();y(H),m(null),C("Logo reset to default successfully!"),a?.(H),window.dispatchEvent(new CustomEvent("logoUpdated"))}},[w,a,k]),X=H=>{if(H===0)return"0 Bytes";const ue=1024,be=["Bytes","KB","MB"],Se=Math.floor(Math.log(H)/Math.log(ue));return parseFloat((H/Math.pow(ue,Se)).toFixed(2))+" "+be[Se]},M=H=>new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(H);return o.jsxs("div",{className:"logo-uploader",children:[o.jsxs("div",{className:"logo-uploader__header",children:[o.jsx("h3",{children:"Logo Management"}),o.jsx("p",{children:"Upload a new logo for your application. Supported formats: PNG, JPG, SVG, WebP"})]}),o.jsxs("div",{className:"logo-uploader__current",children:[o.jsx("h4",{children:"Current Logo"}),o.jsxs("div",{className:"current-logo-display",children:[o.jsx("img",{src:T.logoUrl,alt:"Current Logo",className:"current-logo-image"}),o.jsxs("div",{className:"current-logo-info",children:[o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"Type:"}),o.jsx("span",{className:"value",children:T.logoType==="default"?"Default":"Custom"})]}),o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"File:"}),o.jsx("span",{className:"value",children:T.logoMetadata.originalName})]}),T.logoMetadata.size>0&&o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"Size:"}),o.jsx("span",{className:"value",children:X(T.logoMetadata.size)})]}),o.jsxs("div",{className:"logo-info-item",children:[o.jsx("span",{className:"label",children:"Updated:"}),o.jsx("span",{className:"value",children:M(T.logoMetadata.uploadDate)})]})]})]})]}),o.jsxs("div",{className:`logo-uploader__dropzone ${l?"dragging":""} ${f?"uploading":""}`,onDragOver:b,onDragLeave:K,onDrop:q,children:[o.jsx("input",{ref:_,type:"file",accept:t.join(","),onChange:B,className:"logo-uploader__input",disabled:f}),f?o.jsxs("div",{className:"upload-progress",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Uploading logo..."})]}):o.jsxs("div",{className:"upload-content",children:[o.jsx("div",{className:"upload-icon",children:""}),o.jsxs("p",{className:"upload-text",children:["Drag and drop your logo here, or"," ",o.jsx("button",{type:"button",className:"browse-button",onClick:Z,children:"browse files"})]}),o.jsxs("p",{className:"upload-hint",children:["Maximum file size: ",X(n)]})]})]}),s&&g&&o.jsxs("div",{className:"logo-uploader__preview",children:[o.jsx("h4",{children:"Preview"}),o.jsx("div",{className:"preview-container",children:o.jsx("img",{src:g,alt:"Logo Preview",className:"preview-image"})})]}),p&&o.jsxs("div",{className:"logo-uploader__message logo-uploader__message--error",children:[o.jsx("span",{className:"message-icon",children:""}),o.jsx("span",{className:"message-text",children:p}),o.jsx("button",{className:"message-close",onClick:k,children:""})]}),x&&o.jsxs("div",{className:"logo-uploader__message logo-uploader__message--success",children:[o.jsx("span",{className:"message-icon",children:""}),o.jsx("span",{className:"message-text",children:x}),o.jsx("button",{className:"message-close",onClick:k,children:""})]}),o.jsxs("div",{className:"logo-uploader__actions",children:[o.jsx("button",{type:"button",className:"btn btn-secondary",onClick:L,disabled:f||T.logoType==="default",children:"Reset to Default"}),o.jsx("button",{type:"button",className:"btn btn-primary",onClick:Z,disabled:f,children:f?"Uploading...":"Choose New Logo"})]}),o.jsxs("div",{className:"logo-uploader__guidelines",children:[o.jsx("h4",{children:"Logo Guidelines"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Recommended size: 200x100 pixels or 1:1 ratio (square)"}),o.jsx("li",{children:"Supported formats: PNG, JPG, SVG, WebP"}),o.jsxs("li",{children:["Maximum file size: ",X(n)]}),o.jsx("li",{children:"For best results, use SVG format for scalability"}),o.jsx("li",{children:"Ensure logo has good contrast against dark backgrounds"})]})]})]})},AN=()=>{const[a,n]=z.useState([]),[t,s]=z.useState(!1),[l,u]=z.useState(null),[f,h]=z.useState("users"),[g,m]=z.useState({username:"",password:"",confirmPassword:"",role:"Editor"}),[p,S]=z.useState({}),[x,C]=z.useState(!1),{currentUser:T,hasPermission:y}=Vt();z.useEffect(()=>{_()},[]);const _=()=>{const L=Ke.getUsers();n(L)},w=()=>{if(window.confirm(` Are you sure you want to clear all demo data?

This will remove:
 All demo contacts
 All service data
 All demo history

Users and settings will be preserved.

This action cannot be undone!`))try{Ke.clearDemoData(),alert(` Demo data cleared successfully!

The application now starts with clean data for testing.`),window.location.reload()}catch(X){console.error("Error clearing demo data:",X),alert(" Error clearing demo data. Please try again.")}},k=()=>{m({username:"",password:"",confirmPassword:"",role:"Editor"}),S({}),u(null),s(!1)},D=()=>{const L={};return g.username.trim()?g.username.length<3?L.username="Username must be at least 3 characters":g.username.length>20?L.username="Username must be less than 20 characters":a.find(M=>M.username.toLowerCase()===g.username.toLowerCase()&&M.id!==l?.id)&&(L.username="Username already exists"):L.username="Username is required",(!l||g.password)&&(g.password?g.password.length<4&&(L.password="Password must be at least 4 characters"):L.password="Password is required",g.password!==g.confirmPassword&&(L.confirmPassword="Passwords do not match")),g.role||(L.role="Role is required"),S(L),Object.keys(L).length===0},b=(L,X)=>{m(M=>({...M,[L]:X})),p[L]&&S(M=>({...M,[L]:""}))},K=async L=>{if(L.preventDefault(),!!D()){C(!0);try{if(l){const X={...l,username:g.username.trim(),role:g.role};Ke.updateUser(l.id,X),g.password&&Ke.addUserCredential(g.username.trim(),g.password)}else{const X={id:Zs(),username:g.username.trim(),role:g.role,createdAt:new Date};Ke.addUser(X),Ke.addUserCredential(g.username.trim(),g.password)}_(),k()}catch(X){console.error("Error saving user:",X),alert("Failed to save user. Please try again.")}finally{C(!1)}}},q=L=>{u(L),m({username:L.username,password:"",confirmPassword:"",role:L.role}),s(!0)},B=L=>{if(L.id===T?.id){alert("You cannot delete your own account");return}if(window.confirm(`Are you sure you want to delete user "${L.username}"?`))try{Ke.deleteUser(L.id),Ke.removeUserCredential(L.username),_()}catch(X){console.error("Error deleting user:",X),alert("Failed to delete user. Please try again.")}},Z=L=>new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(L));return y("Admin")?o.jsxs("div",{className:"user-management",children:[o.jsx("div",{className:"user-management-header",children:o.jsxs("div",{className:"header-left",children:[o.jsx("h2",{children:"Admin Panel"}),o.jsx("p",{children:"Manage users, settings, and branding"})]})}),o.jsxs("div",{className:"tab-navigation",children:[o.jsxs("button",{className:`tab-button ${f==="users"?"active":""}`,onClick:()=>h("users"),children:[o.jsx("span",{children:""}),"User Management"]}),o.jsxs("button",{className:`tab-button ${f==="branding"?"active":""}`,onClick:()=>h("branding"),children:[o.jsx("span",{children:""}),"Logo & Branding"]})]}),f==="users"&&o.jsxs("div",{className:"tab-content",children:[o.jsx(jv,{onSyncComplete:_}),o.jsxs("div",{className:"section-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h3",{children:"User Management"}),o.jsx("p",{children:"Manage user accounts and permissions"})]}),o.jsxs("div",{className:"header-actions",children:[o.jsxs("button",{onClick:w,className:"btn btn-warning",title:"Clear all demo data for clean testing",children:[o.jsx("span",{children:""}),"Clear Demo Data"]}),o.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary",disabled:t,children:[o.jsx("span",{children:""}),"Add New User"]})]})]}),t&&o.jsxs("div",{className:"user-form-container",children:[o.jsxs("div",{className:"user-form-header",children:[o.jsx("h3",{children:l?"Edit User":"Add New User"}),o.jsx("button",{onClick:k,className:"close-btn",type:"button",children:""})]}),o.jsxs("form",{onSubmit:K,className:"user-form",children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"username",className:"form-label",children:["Username ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"username",type:"text",value:g.username,onChange:L=>b("username",L.target.value),className:`form-input ${p.username?"error":""}`,placeholder:"Enter username",disabled:x,autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),p.username&&o.jsx("span",{className:"error-message",children:p.username})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"role",className:"form-label",children:["Role ",o.jsx("span",{className:"required",children:"*"})]}),o.jsxs("select",{id:"role",value:g.role,onChange:L=>b("role",L.target.value),className:`form-select ${p.role?"error":""}`,disabled:x,children:[o.jsx("option",{value:"Editor",children:"Editor"}),o.jsx("option",{value:"Admin",children:"Admin"})]}),p.role&&o.jsx("span",{className:"error-message",children:p.role})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"password",className:"form-label",children:[l?"New Password (leave blank to keep current)":"Password",!l&&o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"password",type:"password",value:g.password,onChange:L=>b("password",L.target.value),className:`form-input ${p.password?"error":""}`,placeholder:l?"Leave blank to keep current password":"Enter password",disabled:x,autoComplete:"new-password",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),p.password&&o.jsx("span",{className:"error-message",children:p.password})]}),o.jsxs("div",{className:"form-group",children:[o.jsxs("label",{htmlFor:"confirmPassword",className:"form-label",children:["Confirm Password",(!l||g.password)&&o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"confirmPassword",type:"password",value:g.confirmPassword,onChange:L=>b("confirmPassword",L.target.value),className:`form-input ${p.confirmPassword?"error":""}`,placeholder:"Confirm password",disabled:x,autoComplete:"new-password",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),p.confirmPassword&&o.jsx("span",{className:"error-message",children:p.confirmPassword})]})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",onClick:k,className:"btn btn-secondary",disabled:x,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x,children:x?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"button-spinner"}),l?"Updating...":"Creating..."]}):l?"Update User":"Create User"})]})]})]}),o.jsxs("div",{className:"users-list",children:[o.jsxs("div",{className:"users-stats",children:[o.jsxs("span",{children:["Total Users: ",a.length]}),o.jsxs("span",{children:["Admins: ",a.filter(L=>L.role==="Admin").length]}),o.jsxs("span",{children:["Editors: ",a.filter(L=>L.role==="Editor").length]})]}),o.jsx("div",{className:"users-table-container",children:o.jsxs("table",{className:"users-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Username"}),o.jsx("th",{children:"Role"}),o.jsx("th",{children:"Created"}),o.jsx("th",{children:"Actions"})]})}),o.jsx("tbody",{children:a.map(L=>o.jsxs("tr",{className:L.id===T?.id?"current-user":"",children:[o.jsx("td",{className:"user-username",children:o.jsxs("div",{className:"username-with-indicator",children:[o.jsx("strong",{children:L.username}),L.id===T?.id&&o.jsx("span",{className:"current-user-badge",children:"You"})]})}),o.jsx("td",{children:o.jsx("span",{className:`role-badge ${L.role.toLowerCase()}`,children:L.role})}),o.jsx("td",{className:"user-created",children:Z(L.createdAt)}),o.jsxs("td",{className:"user-actions",children:[o.jsx("button",{onClick:()=>q(L),className:"action-btn edit-btn",title:"Edit User",children:""}),L.id!==T?.id&&o.jsx("button",{onClick:()=>B(L),className:"action-btn delete-btn",title:"Delete User",children:""})]})]},L.id))})]})})]})]}),f==="branding"&&o.jsxs("div",{className:"tab-content",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{className:"header-left",children:[o.jsx("h3",{children:"Logo & Branding"}),o.jsx("p",{children:"Customize your application's logo and branding"})]})}),o.jsx(NN,{showPreview:!0,onLogoUpdate:L=>{console.log("Logo updated:",L)}})]})]}):o.jsxs("div",{className:"user-management-unauthorized",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:"Only administrators can manage users."})]})};class DN{getDateRange(n){const t=new Date,s=new Date(t);let l;switch(n.type){case"today":l=new Date(t),l.setHours(0,0,0,0),s.setHours(23,59,59,999);break;case"week":l=new Date(t),l.setDate(t.getDate()-7);break;case"month":l=new Date(t),l.setMonth(t.getMonth()-1);break;case"quarter":l=new Date(t),l.setMonth(t.getMonth()-3);break;case"year":l=new Date(t),l.setFullYear(t.getFullYear()-1);break;case"custom":return l=n.startDate||new Date(t.getTime()-720*60*60*1e3),{startDate:l,endDate:n.endDate||s};default:l=new Date(t),l.setMonth(t.getMonth()-1)}return{startDate:l,endDate:s}}async calculateContactMetrics(n={type:"month"}){try{const t=Ke.getContacts(),{startDate:s,endDate:l}=this.getDateRange(n),u=l.getTime()-s.getTime(),f=new Date(s.getTime()-u),h=new Date(s.getTime()-1),g=t.filter(y=>{const _=new Date(y.createdAt);return _>=s&&_<=l}).length,m=t.filter(y=>{const _=new Date(y.createdAt);return _>=f&&_<=h}).length,p=m>0?Math.round((g-m)/m*100):g>0?100:0,S=t.filter(y=>y.statusKontak==="Completed").length,x=t.length>0?Math.round(S/t.length*100):0,C=t.filter(y=>y.statusKontak==="In Progress"||y.statusKontak==="Follow Up").length,T=t.filter(y=>y.prioritas==="Urgent"&&y.statusKontak!=="Completed").length;return{newContactsThisMonth:g,newContactsGrowth:p,conversionRate:x,activeContacts:C,urgentContacts:T,totalContacts:t.length}}catch(t){throw console.error("Error calculating contact metrics:",t),new Error("Failed to calculate contact metrics")}}async calculateServiceMetrics(n={type:"month"}){try{const t=Wt.getAllServices(),s=Ke.getContacts(),{startDate:l,endDate:u}=this.getDateRange(n),f=u.getTime()-l.getTime(),h=new Date(l.getTime()-f),g=new Date(l.getTime()-1),m=t.filter(K=>{const q=new Date(K.date);return q>=l&&q<=u}),p=t.filter(K=>{const q=new Date(K.date);return q>=h&&q<=g}),S=m.reduce((K,q)=>K+q.duration,0),x=Math.round(S/60*100)/100,C=p.reduce((K,q)=>K+q.duration,0),T=Math.round(C/60*100)/100,y=T>0?Math.round((x-T)/T*100):x>0?100:0,w=new Set(m.map(K=>K.date)).size,k=new Set(m.map(K=>K.contactId)),D=k.size>0?Math.round(S/k.size):0,b=s.length>0?Math.round(k.size/s.length*100):0;return{totalServiceHoursThisMonth:x,serviceHoursGrowth:y,activeServiceDays:w,averageServiceTimePerContact:D,serviceCoverage:b,totalServiceSessions:m.length}}catch(t){throw console.error("Error calculating service metrics:",t),new Error("Failed to calculate service metrics")}}async calculateContactDistribution(){try{const n=Ke.getContacts(),t=n.length,s=new Map,l=new Map,u=new Map,f=new Map;n.forEach(S=>{s.set(S.statusKontak,(s.get(S.statusKontak)||0)+1),l.set(S.prioritas,(l.get(S.prioritas)||0)+1),u.set(S.sumber,(u.get(S.sumber)||0)+1),f.set(S.provinsi,(f.get(S.provinsi)||0)+1)});const h=Array.from(s.entries()).map(([S,x])=>({status:S,count:x,percentage:t>0?Math.round(x/t*100):0})),g=Array.from(l.entries()).map(([S,x])=>({priority:S,count:x,percentage:t>0?Math.round(x/t*100):0})),m=Array.from(u.entries()).map(([S,x])=>({source:S,count:x,percentage:t>0?Math.round(x/t*100):0})).sort((S,x)=>x.count-S.count).slice(0,3),p=Array.from(f.entries()).map(([S,x])=>({province:S,count:x,percentage:t>0?Math.round(x/t*100):0})).sort((S,x)=>x.count-S.count).slice(0,5);return{byStatus:h,byPriority:g,bySource:m,byProvince:p}}catch(n){throw console.error("Error calculating contact distribution:",n),new Error("Failed to calculate contact distribution")}}async calculateTeamPerformance(n={type:"month"}){try{const t=Wt.getAllServices(),s=Ke.getContacts(),l=Ke.getUsers(),{startDate:u,endDate:f}=this.getDateRange(n),h=t.filter(T=>{const y=new Date(T.date);return y>=u&&y<=f}),g=new Map,m=new Map;h.forEach(T=>{const y=g.get(T.userId)||0,_=m.get(T.userId)||0;g.set(T.userId,y+T.duration/60),m.set(T.userId,_+1)});let p={userId:"",username:"N/A",serviceHours:0};for(const[T,y]of g.entries())if(y>p.serviceHours){const _=l.find(w=>w.id===T);p={userId:T,username:_?.username||"Unknown",serviceHours:Math.round(y*100)/100}}const S=new Map;s.forEach(T=>{const y=new Date(T.createdAt);if(y>=u&&y<=f){const _=S.get(T.createdBy)||0;S.set(T.createdBy,_+1)}});let x={userId:"",username:"N/A",contactsCreated:0};for(const[T,y]of S.entries())if(y>x.contactsCreated){const _=l.find(w=>w.id===T);x={userId:T,username:_?.username||"Unknown",contactsCreated:y}}const C=Array.from(g.entries()).map(([T,y])=>{const _=l.find(D=>D.id===T),w=m.get(T)||0,k=w>0?Math.round(y*60/w):0;return{userId:T,username:_?.username||"Unknown",averageServiceTime:k,totalServices:w}}).sort((T,y)=>y.totalServices-T.totalServices);return{mostActiveUser:p,topContactCreator:x,userEfficiency:C}}catch(t){throw console.error("Error calculating team performance:",t),new Error("Failed to calculate team performance")}}async generateAlerts(){try{const n=Ke.getContacts(),t=Wt.getAllServices(),s=new Date,l=[],u=new Date(s.getTime()-720*60*60*1e3),f=n.filter(C=>new Date(C.updatedAt)<u&&C.statusKontak!=="Completed");f.length>0&&l.push({id:"stale_contacts",type:"stale_contacts",title:"Stale Contacts",description:`${f.length} contacts have no activity for more than 30 days`,count:f.length,severity:f.length>10?"high":"medium",actionUrl:"/contacts?filter=stale",createdAt:s});const h=new Date(s.getTime()-10080*60*1e3),g=n.filter(C=>{const T=new Date(C.updatedAt);return C.statusKontak==="Follow Up"&&T<h});g.length>0&&l.push({id:"overdue_followups",type:"overdue_followups",title:"Overdue Follow-ups",description:`${g.length} contacts in Follow Up status for more than 7 days`,count:g.length,severity:g.length>5?"critical":"high",actionUrl:"/contacts?filter=overdue_followup",createdAt:s});const m=n.filter(C=>C.prioritas==="Urgent"&&C.statusKontak!=="In Progress"&&C.statusKontak!=="Completed");m.length>0&&l.push({id:"urgent_pending",type:"urgent_pending",title:"Urgent Contacts Pending",description:`${m.length} urgent priority contacts are not in progress`,count:m.length,severity:"critical",actionUrl:"/contacts?filter=urgent_pending",createdAt:s});const p=new Date(s.getTime()-336*60*60*1e3),S=new Set(t.filter(C=>new Date(C.date)>=p).map(C=>C.contactId)),x=n.filter(C=>C.statusKontak==="In Progress"&&!S.has(C.id));return x.length>0&&l.push({id:"service_gaps",type:"service_gaps",title:"Service Gaps",description:`${x.length} active contacts without service in 14 days`,count:x.length,severity:"medium",actionUrl:"/contacts?filter=service_gaps",createdAt:s}),l.sort((C,T)=>{const y={critical:4,high:3,medium:2,low:1};return y[T.severity]-y[C.severity]})}catch(n){throw console.error("Error generating alerts:",n),new Error("Failed to generate alerts")}}async calculateTrends(){try{const n=Ke.getContacts(),t=Wt.getAllServices(),s=[];for(let f=5;f>=0;f--){const h=new Date;h.setMonth(h.getMonth()-f);const g=new Date(h.getFullYear(),h.getMonth(),1),m=new Date(h.getFullYear(),h.getMonth()+1,0),p=n.filter(y=>{const _=new Date(y.createdAt);return _>=g&&_<=m}).length,S=new Date(h.getFullYear(),h.getMonth()-1,1),x=new Date(h.getFullYear(),h.getMonth(),0),C=n.filter(y=>{const _=new Date(y.createdAt);return _>=S&&_<=x}).length,T=C>0?Math.round((p-C)/C*100):p>0?100:0;s.push({month:h.toISOString().slice(0,7),count:p,growth:T})}const l=[];for(let f=29;f>=0;f--){const h=new Date;h.setDate(h.getDate()-f);const g=h.toISOString().split("T")[0],m=t.filter(S=>S.date===g),p=Math.round(m.reduce((S,x)=>S+x.duration,0)/60*100)/100;l.push({date:g,serviceHours:p,sessionCount:m.length})}const u=[];for(let f=5;f>=0;f--){const h=new Date;h.setMonth(h.getMonth()-f),u.push({month:h.toISOString().slice(0,7),newToProgress:3,progressToComplete:7})}return{contactCreationTrend:s,serviceActivityTrend:l,statusProgressionTrend:u}}catch(n){throw console.error("Error calculating trends:",n),new Error("Failed to calculate trends")}}async getDashboardData(n={type:"month"}){try{const[t,s,l,u,f,h]=await Promise.all([this.calculateContactMetrics(n),this.calculateServiceMetrics(n),this.calculateContactDistribution(),this.calculateTeamPerformance(n),this.calculateTrends(),this.generateAlerts()]);return{contactMetrics:t,serviceMetrics:s,contactDistribution:l,teamMetrics:u,trends:f,alerts:h,isLoading:!1,error:null,lastUpdated:new Date}}catch(t){throw console.error("Error getting dashboard data:",t),t}}}const MN=new DN,jN=(a={type:"month"})=>{const[n,t]=z.useState({contactMetrics:{newContactsThisMonth:0,newContactsGrowth:0,conversionRate:0,activeContacts:0,urgentContacts:0,totalContacts:0},serviceMetrics:{totalServiceHoursThisMonth:0,serviceHoursGrowth:0,activeServiceDays:0,averageServiceTimePerContact:0,serviceCoverage:0,totalServiceSessions:0},contactDistribution:{byStatus:[],byPriority:[],bySource:[],byProvince:[]},teamMetrics:{mostActiveUser:{userId:"",username:"N/A",serviceHours:0},topContactCreator:{userId:"",username:"N/A",contactsCreated:0},userEfficiency:[]},trends:{contactCreationTrend:[],serviceActivityTrend:[],statusProgressionTrend:[]},alerts:[],isLoading:!0,error:null,lastUpdated:new Date}),[s,l]=z.useState(!1),[u,f]=z.useState(0),h=z.useMemo(()=>a,[a.type,a.startDate?.getTime(),a.endDate?.getTime()]),g=z.useCallback(async(S=!0)=>{try{S?t(C=>({...C,isLoading:!0,error:null})):l(!0);const x=await MN.getDashboardData(h);t(x),f(0)}catch(x){console.error("Error fetching dashboard data:",x);const C=x instanceof Error?x.message:"Failed to load dashboard data";t(T=>({...T,isLoading:!1,error:C}))}finally{l(!1)}},[h]),m=z.useCallback(async()=>{u<3&&(f(S=>S+1),await g())},[g,u]),p=z.useCallback(async()=>{await g(!1)},[g]);return z.useEffect(()=>{g()},[g]),z.useEffect(()=>{const S=setInterval(()=>{!n.isLoading&&!s&&p()},3e5);return()=>clearInterval(S)},[p,n.isLoading,s]),{...n,isRefreshing:s,retryCount:u,refresh:p,retry:m,canRetry:u<3}},kN=(a={type:"month"})=>{const[n,t]=z.useState(a),s=z.useCallback(f=>{t(f)},[]),l=z.useCallback(f=>{t({type:f})},[]),u=z.useCallback((f,h)=>{t({type:"custom",startDate:f,endDate:h})},[]);return{timeRange:n,updateTimeRange:s,setPresetRange:l,setCustomRange:u}},UN=({metrics:a,isLoading:n,onCardClick:t})=>{const s=u=>{t&&t(u)},l=u=>{const f=u>=0,h=f?"":"",g=f?"positive":"negative";return o.jsxs("span",{className:`growth ${g}`,children:[h," ",Math.abs(u),"%"]})};return n?o.jsxs("div",{className:"contact-pipeline-card loading",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("div",{className:"skeleton-text title"}),o.jsx("div",{className:"skeleton-icon"})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]})]})]}):o.jsxs("div",{className:"contact-pipeline-card",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("h3",{children:"Contact Pipeline"}),o.jsx("span",{className:"card-icon",role:"img","aria-label":"Contacts",children:""})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item clickable",onClick:()=>s("new_contacts"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&s("new_contacts")},"aria-label":`New contacts this month: ${a.newContactsThisMonth}`,children:[o.jsx("span",{className:"metric-label",children:"New Contacts This Month"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.newContactsThisMonth}),l(a.newContactsGrowth)]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>s("conversion_rate"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&s("conversion_rate")},"aria-label":`Conversion rate: ${a.conversionRate}%`,children:[o.jsx("span",{className:"metric-label",children:"Conversion Rate"}),o.jsxs("div",{className:"metric-value",children:[o.jsxs("span",{className:"value",children:[a.conversionRate,"%"]}),o.jsx("div",{className:"conversion-bar",children:o.jsx("div",{className:"conversion-fill",style:{width:`${Math.min(a.conversionRate,100)}%`}})})]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>s("active_contacts"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&s("active_contacts")},"aria-label":`Active contacts: ${a.activeContacts}`,children:[o.jsx("span",{className:"metric-label",children:"Active Contacts"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.activeContacts}),o.jsx("span",{className:"metric-subtitle",children:"In Progress + Follow Up"})]})]}),o.jsxs("div",{className:`metric-item urgent clickable ${a.urgentContacts>0?"has-urgent":""}`,onClick:()=>s("urgent_contacts"),role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&s("urgent_contacts")},"aria-label":`Urgent contacts: ${a.urgentContacts}`,children:[o.jsxs("span",{className:"metric-label",children:[o.jsx("span",{className:"urgent-icon",children:""}),"Urgent Contacts"]}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.urgentContacts}),a.urgentContacts>0&&o.jsx("span",{className:"urgent-badge",children:"Needs Attention"})]})]})]}),o.jsx("div",{className:"card-footer",children:o.jsxs("div",{className:"total-contacts",children:[o.jsx("span",{className:"total-label",children:"Total Contacts:"}),o.jsx("span",{className:"total-value",children:a.totalContacts})]})})]})},ON=({metrics:a,isLoading:n,onCardClick:t})=>{const s=f=>{t&&t(f)},l=f=>{const h=f>=0,g=h?"":"",m=h?"positive":"negative";return o.jsxs("span",{className:`growth ${m}`,children:[g," ",Math.abs(f),"%"]})},u=f=>{if(f<60)return`${f}min`;const h=Math.floor(f/60),g=f%60;return g>0?`${h}h ${g}m`:`${h}h`};return n?o.jsxs("div",{className:"service-performance-card loading",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("div",{className:"skeleton-text title"}),o.jsx("div",{className:"skeleton-icon"})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]}),o.jsxs("div",{className:"metric-item",children:[o.jsx("div",{className:"skeleton-text label"}),o.jsx("div",{className:"skeleton-text value"})]})]})]}):o.jsxs("div",{className:"service-performance-card",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("h3",{children:"Service Performance"}),o.jsx("span",{className:"card-icon",role:"img","aria-label":"Performance",children:""})]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"metric-item clickable",onClick:()=>s("service_hours"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&s("service_hours")},"aria-label":`Service hours this month: ${a.totalServiceHoursThisMonth} hours`,children:[o.jsx("span",{className:"metric-label",children:"Service Hours This Month"}),o.jsxs("div",{className:"metric-value",children:[o.jsxs("span",{className:"value",children:[a.totalServiceHoursThisMonth,"h"]}),l(a.serviceHoursGrowth)]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>s("active_days"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&s("active_days")},"aria-label":`Active service days: ${a.activeServiceDays} days`,children:[o.jsx("span",{className:"metric-label",children:"Active Service Days"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:a.activeServiceDays}),o.jsx("span",{className:"metric-subtitle",children:"Days with activity"})]})]}),o.jsxs("div",{className:"metric-item clickable",onClick:()=>s("avg_time"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&s("avg_time")},"aria-label":`Average service time per contact: ${u(a.averageServiceTimePerContact)}`,children:[o.jsx("span",{className:"metric-label",children:"Avg Service Time"}),o.jsxs("div",{className:"metric-value",children:[o.jsx("span",{className:"value",children:u(a.averageServiceTimePerContact)}),o.jsx("span",{className:"metric-subtitle",children:"Per contact"})]})]}),o.jsxs("div",{className:"metric-item coverage clickable",onClick:()=>s("coverage"),role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&s("coverage")},"aria-label":`Service coverage: ${a.serviceCoverage}%`,children:[o.jsxs("span",{className:"metric-label",children:[o.jsx("span",{className:"coverage-icon",children:""}),"Service Coverage"]}),o.jsxs("div",{className:"metric-value",children:[o.jsxs("span",{className:"value",children:[a.serviceCoverage,"%"]}),o.jsx("div",{className:"coverage-bar",children:o.jsx("div",{className:"coverage-fill",style:{width:`${Math.min(a.serviceCoverage,100)}%`}})})]})]})]}),o.jsx("div",{className:"card-footer",children:o.jsxs("div",{className:"session-info",children:[o.jsxs("div",{className:"session-stat",children:[o.jsx("span",{className:"session-label",children:"Total Sessions:"}),o.jsx("span",{className:"session-value",children:a.totalServiceSessions})]}),o.jsxs("div",{className:"session-stat",children:[o.jsx("span",{className:"session-label",children:"Avg per Day:"}),o.jsx("span",{className:"session-value",children:a.activeServiceDays>0?Math.round(a.totalServiceSessions/a.activeServiceDays*10)/10:0})]})]})})]})},bv=({className:a,onNavigate:n})=>{const{currentUser:t}=Vt(),{timeRange:s,setPresetRange:l,setCustomRange:u}=kN(),f=jN(s),h=z.useMemo(()=>Zb(f,t),[f,t]),[g,m]=z.useState(!1),[p,S]=z.useState(""),[x,C]=z.useState(""),T=b=>{b==="custom"?m(!0):(m(!1),l(b))},y=()=>{p&&x&&(u(new Date(p),new Date(x)),m(!1))},_=b=>{if(n)switch(b){case"new_contacts":n("contacts",{dateRange:s,filter:"new_this_month"});break;case"conversion_rate":n("contacts",{statusFilter:["Completed"],showConversionAnalysis:!0});break;case"active_contacts":n("contacts",{statusFilter:["In Progress","Follow Up"]});break;case"urgent_contacts":n("contacts",{priorityFilter:["Urgent"],statusFilter:["New Contact","In Progress","Follow Up"]});break;default:n("contacts")}},w=b=>{if(n)switch(b){case"service_hours":n("service-tracking",{dateRange:s,view:"hours_analysis"});break;case"active_days":n("service-tracking",{dateRange:s,view:"daily_activity"});break;case"avg_time":n("service-tracking",{view:"efficiency_analysis"});break;case"coverage":n("service-tracking",{view:"coverage_analysis"});break;default:n("service-tracking")}},k=b=>{if(n)switch(b){case"stale_contacts":n("contacts",{filter:"stale",daysInactive:30});break;case"overdue_followups":n("contacts",{statusFilter:["Follow Up"],filter:"overdue",daysOverdue:7});break;case"urgent_pending":n("contacts",{priorityFilter:["Urgent"],statusFilter:["New Contact","Follow Up"]});break;case"service_gaps":n("contacts",{statusFilter:["In Progress"],filter:"no_recent_service",daysWithoutService:14});break;default:n("contacts")}},D=b=>new Intl.DateTimeFormat("id-ID",{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}).format(b);return h.error?o.jsx("div",{className:`dashboard ${a||""}`,children:o.jsx("div",{className:"dashboard-error",children:o.jsxs("div",{className:"error-content",children:[o.jsx("h2",{children:" Error Loading Dashboard"}),o.jsx("p",{children:h.error}),h.canRetry&&o.jsxs("button",{onClick:h.retry,className:"btn btn-primary",children:["Retry (",3-h.retryCount," attempts left)"]})]})})}):o.jsxs("div",{className:`dashboard ${a||""}`,children:[o.jsxs("div",{className:"dashboard-header",children:[o.jsxs("div",{className:"header-content",children:[o.jsxs("div",{className:"welcome-section",children:[o.jsx("h1",{children:"Dashboard"}),o.jsxs("p",{children:["Welcome back, ",t?.username||"User","!"]}),!h.isLoading&&o.jsxs("span",{className:"last-updated",children:["Last updated: ",D(h.lastUpdated),h.isRefreshing&&o.jsx("span",{className:"refreshing",children:"  Refreshing..."})]})]}),o.jsxs("div",{className:"header-controls",children:[o.jsxs("div",{className:"time-range-selector",children:[o.jsx("label",{htmlFor:"timeRange",children:"Time Period:"}),o.jsxs("select",{id:"timeRange",value:s.type,onChange:b=>T(b.target.value),disabled:h.isLoading||h.isRefreshing,children:[o.jsx("option",{value:"today",children:"Today"}),o.jsx("option",{value:"week",children:"Last Week"}),o.jsx("option",{value:"month",children:"Last Month"}),o.jsx("option",{value:"quarter",children:"Last Quarter"}),o.jsx("option",{value:"year",children:"Last Year"}),o.jsx("option",{value:"custom",children:"Custom Range"})]}),h.isRefreshing&&o.jsx("span",{className:"loading-indicator",children:"Updating..."})]}),o.jsx("button",{onClick:h.refresh,disabled:h.isLoading||h.isRefreshing,className:"refresh-btn",title:"Refresh Dashboard",children:h.isRefreshing?"":""})]})]}),g&&o.jsxs("div",{className:"custom-date-picker",children:[o.jsxs("div",{className:"date-inputs",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"startDate",children:"Start Date:"}),o.jsx("input",{id:"startDate",type:"date",value:p,onChange:b=>S(b.target.value),max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"endDate",children:"End Date:"}),o.jsx("input",{id:"endDate",type:"date",value:x,onChange:b=>C(b.target.value),min:p,max:new Date().toISOString().split("T")[0]})]})]}),o.jsxs("div",{className:"date-actions",children:[o.jsx("button",{onClick:()=>m(!1),className:"btn btn-secondary",children:"Cancel"}),o.jsx("button",{onClick:y,disabled:!p||!x,className:"btn btn-primary",children:"Apply"})]})]})]}),o.jsx("div",{className:"dashboard-content",children:h.isLoading?o.jsx("div",{className:"dashboard-loading",children:o.jsxs("div",{className:"loading-grid",children:[o.jsxs("div",{className:"hero-metrics-skeleton",children:[o.jsx("div",{className:"skeleton-card large"}),o.jsx("div",{className:"skeleton-card large"})]}),o.jsxs("div",{className:"secondary-metrics-skeleton",children:[o.jsx("div",{className:"skeleton-card medium"}),o.jsx("div",{className:"skeleton-card medium"})]}),o.jsxs("div",{className:"charts-skeleton",children:[o.jsx("div",{className:"skeleton-card chart"}),o.jsx("div",{className:"skeleton-card chart"})]}),o.jsxs("div",{className:"alerts-skeleton",children:[o.jsx("div",{className:"skeleton-card small"}),o.jsx("div",{className:"skeleton-card small"}),o.jsx("div",{className:"skeleton-card small"})]})]})}):o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("section",{className:"hero-metrics-section",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Key Performance Indicators"})}),o.jsxs("div",{className:"hero-metrics-grid",children:[o.jsx(UN,{metrics:h.contactMetrics,isLoading:h.isLoading,onCardClick:_}),o.jsx(ON,{metrics:h.serviceMetrics,isLoading:h.isLoading,onCardClick:w})]})]}),h.alerts.length>0&&o.jsxs("section",{className:"alerts-section",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h2",{children:"Action Required"}),o.jsxs("span",{className:"alert-count",children:[h.alerts.length," items"]})]}),o.jsx("div",{className:"alerts-grid",children:h.alerts.slice(0,4).map(b=>o.jsxs("div",{className:`alert-card ${b.severity}`,children:[o.jsxs("div",{className:"alert-header",children:[o.jsx("span",{className:"alert-title",children:b.title}),o.jsx("span",{className:"alert-count",children:b.count})]}),o.jsx("p",{className:"alert-description",children:b.description}),o.jsx("button",{className:"alert-action",onClick:()=>k(b.type),children:"View Details"})]},b.id))})]}),o.jsxs("section",{className:"coming-soon-section",children:[o.jsxs("div",{className:"coming-soon-card",children:[o.jsx("h3",{children:" Advanced Analytics"}),o.jsx("p",{children:"Detailed charts and trend analysis coming soon..."})]}),o.jsxs("div",{className:"coming-soon-card",children:[o.jsx("h3",{children:" Team Performance"}),o.jsx("p",{children:"Individual and team metrics coming soon..."})]})]})]})})]})},IN=({onFilterChange:a,initialFilters:n,contacts:t=[],users:s=[]})=>{const{currentUser:l}=Vt(),[u,f]=z.useState({period:"month",...n}),[h,g]=z.useState(!1);z.useEffect(()=>{const _=new Date;let w,k=new Date(_);switch(u.period){case"day":w=new Date(_),w.setHours(0,0,0,0),k.setHours(23,59,59,999);break;case"week":w=new Date(_),w.setDate(_.getDate()-_.getDay()),w.setHours(0,0,0,0),k=new Date(w),k.setDate(w.getDate()+6),k.setHours(23,59,59,999);break;case"month":w=new Date(_.getFullYear(),_.getMonth(),1),k=new Date(_.getFullYear(),_.getMonth()+1,0),k.setHours(23,59,59,999);break;case"quarter":const b=Math.floor(_.getMonth()/3);w=new Date(_.getFullYear(),b*3,1),k=new Date(_.getFullYear(),b*3+3,0),k.setHours(23,59,59,999);break;case"year":w=new Date(_.getFullYear(),0,1),k=new Date(_.getFullYear(),11,31),k.setHours(23,59,59,999);break;case"custom":w=u.startDate||new Date(_.getFullYear(),_.getMonth(),1),k=u.endDate||new Date,g(!0);break;default:w=new Date(_.getFullYear(),_.getMonth(),1),k=new Date}const D={...u,startDate:w,endDate:k};a(D)},[u.period,u.startDate,u.endDate,u.contactId,u.userId,u.serviceType]);const m=_=>{f(w=>({...w,period:_})),g(_==="custom")},p=_=>{f(w=>({...w,contactId:_||void 0}))},S=_=>{f(w=>({...w,userId:_||void 0}))},x=(_,w)=>{if(w){const k=new Date(w);f(D=>({...D,[_]:k}))}},C=_=>_.toISOString().split("T")[0],T=()=>{if(!u.startDate||!u.endDate)return"";const _=u.startDate.toLocaleDateString("id-ID"),w=u.endDate.toLocaleDateString("id-ID");return u.period==="day"?_:`${_} - ${w}`},y=()=>{f({period:"month"}),g(!1)};return o.jsxs("div",{className:"service-filter",children:[o.jsxs("div",{className:"filter-header",children:[o.jsx("h4",{children:"Filter Pelayanan"}),o.jsx("button",{onClick:y,className:"clear-filters-btn",children:"Reset"})]}),o.jsxs("div",{className:"filter-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Periode Waktu:"}),o.jsxs("select",{value:u.period,onChange:_=>m(_.target.value),className:"filter-select",children:[o.jsx("option",{value:"day",children:"Hari Ini"}),o.jsx("option",{value:"week",children:"Minggu Ini"}),o.jsx("option",{value:"month",children:"Bulan Ini"}),o.jsx("option",{value:"quarter",children:"Kuartal Ini"}),o.jsx("option",{value:"year",children:"Tahun Ini"}),o.jsx("option",{value:"custom",children:"Custom Range"})]})]}),t.length>0&&o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Contact:"}),o.jsxs("select",{value:u.contactId||"",onChange:_=>p(_.target.value),className:"filter-select",children:[o.jsx("option",{value:"",children:"Semua Contact"}),t.map(_=>o.jsx("option",{value:_.id,children:_.nama},_.id))]})]}),s.length>0&&o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"User:"}),Kf(l)?o.jsxs("select",{value:u.userId||"",onChange:_=>S(_.target.value),className:"filter-select",children:[o.jsx("option",{value:"",children:"Semua User"}),s.map(_=>o.jsx("option",{value:_.username,children:_.username},_.username))]}):o.jsxs("div",{className:"filter-select locked-display",children:[o.jsx("span",{className:"locked-user-text",children:l?.username}),o.jsx("span",{className:"lock-icon-inline",children:""})]})]})]}),h&&o.jsxs("div",{className:"filter-row custom-dates",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Tanggal Mulai:"}),o.jsx("input",{type:"date",value:u.startDate?C(u.startDate):"",onChange:_=>x("startDate",_.target.value),className:"filter-input"})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Tanggal Akhir:"}),o.jsx("input",{type:"date",value:u.endDate?C(u.endDate):"",onChange:_=>x("endDate",_.target.value),className:"filter-input"})]})]}),o.jsxs("div",{className:"filter-summary",children:[o.jsx("span",{className:"summary-label",children:"Periode:"}),o.jsx("span",{className:"summary-value",children:T()}),u.contactId&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"summary-separator",children:""}),o.jsxs("span",{className:"summary-value",children:["Contact: ",t.find(_=>_.id===u.contactId)?.nama]})]}),u.userId&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"summary-separator",children:""}),o.jsxs("span",{className:"summary-value",children:["User: ",u.userId]})]})]})]})},RN=({filters:a})=>{const{currentUser:n}=Vt(),[t,s]=z.useState(null),[l,u]=z.useState(!1),[f,h]=z.useState([]),[g,m]=z.useState("summary");z.useEffect(()=>{const C=Ke.getContacts();h(C)},[]),z.useEffect(()=>{if(!(!a.startDate||!a.endDate)){u(!0);try{let C=Wt.getAllServices();C=hp(C,n);let y=C.filter(M=>{const H=new Date(M.date);return H>=a.startDate&&H<=a.endDate});a.contactId&&(y=y.filter(M=>M.contactId===a.contactId)),a.userId&&(y=y.filter(M=>M.userId===a.userId)),a.serviceType&&(y=y.filter(M=>M.serviceType?.toLowerCase().includes(a.serviceType.toLowerCase())||M.description?.toLowerCase().includes(a.serviceType.toLowerCase())));const _=y.length,w=y.reduce((M,H)=>M+H.duration,0),D=new Set(y.map(M=>M.date)).size,K=new Set(y.map(M=>M.contactId)).size,q=_>0?w/_:0,B=new Map,Z=new Map,L=new Map;y.forEach(M=>{B.has(M.contactId)||B.set(M.contactId,[]),B.get(M.contactId).push(M),Z.has(M.userId)||Z.set(M.userId,[]),Z.get(M.userId).push(M),L.has(M.date)||L.set(M.date,[]),L.get(M.date).push(M)}),s({services:y,totalServices:_,totalDuration:w,totalServiceDays:D,contactsServed:K,averageDurationPerService:q,servicesByContact:B,servicesByUser:Z,servicesByDate:L})}catch(C){console.error("Error generating service report:",C)}finally{u(!1)}}},[a]);const p=C=>{if(C===0)return"Chat";if(C<60)return`${C} menit`;const T=Math.floor(C/60),y=C%60;return y>0?`${T}j ${y}m`:`${T} jam`},S=C=>f.find(y=>y.id===C)?.nama||"Unknown Contact",x=()=>{if(!a.startDate||!a.endDate)return"";const C=a.startDate.toLocaleDateString("id-ID"),T=a.endDate.toLocaleDateString("id-ID");return a.period==="day"?`Hari: ${C}`:`Periode: ${C} - ${T}`};return l?o.jsx("div",{className:"service-report loading",children:o.jsxs("div",{className:"loading-spinner",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Memuat laporan..."})]})}):t?o.jsxs("div",{className:"service-report",children:[o.jsxs("div",{className:"report-header",children:[o.jsxs("div",{className:"report-title",children:[o.jsx("h3",{children:"Laporan Pelayanan"}),o.jsx("p",{className:"report-period",children:x()})]}),o.jsxs("div",{className:"view-mode-selector",children:[o.jsx("button",{className:`view-btn ${g==="summary"?"active":""}`,onClick:()=>m("summary"),children:"Ringkasan"}),o.jsx("button",{className:`view-btn ${g==="detailed"?"active":""}`,onClick:()=>m("detailed"),children:"Detail"}),o.jsx("button",{className:`view-btn ${g==="calendar"?"active":""}`,onClick:()=>m("calendar"),children:"Kalender"})]})]}),o.jsxs("div",{className:"report-metrics",children:[o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:t.totalServices}),o.jsx("div",{className:"metric-label",children:"Total Pelayanan"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:p(t.totalDuration)}),o.jsx("div",{className:"metric-label",children:"Total Waktu"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:t.totalServiceDays}),o.jsx("div",{className:"metric-label",children:"Hari Pelayanan"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:t.contactsServed}),o.jsx("div",{className:"metric-label",children:"Contact Dilayani"})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"metric-value",children:p(Math.round(t.averageDurationPerService))}),o.jsx("div",{className:"metric-label",children:"Rata-rata per Pelayanan"})]})]}),g==="summary"&&o.jsxs("div",{className:"report-content",children:[o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Pelayanan per Contact"}),o.jsx("div",{className:"contact-services-list",children:Array.from(t.servicesByContact.entries()).sort(([,C],[,T])=>T.length-C.length).slice(0,10).map(([C,T])=>{const y=T.reduce((_,w)=>_+w.duration,0);return o.jsxs("div",{className:"contact-service-item",children:[o.jsxs("div",{className:"contact-info",children:[o.jsx("span",{className:"contact-name",children:S(C)}),o.jsxs("span",{className:"service-count",children:[T.length," pelayanan"]})]}),o.jsx("div",{className:"service-duration",children:p(y)})]},C)})})]}),o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Pelayanan per User"}),o.jsx("div",{className:"user-services-list",children:Array.from(t.servicesByUser.entries()).sort(([,C],[,T])=>T.length-C.length).map(([C,T])=>{const y=T.reduce((_,w)=>_+w.duration,0);return o.jsxs("div",{className:"user-service-item",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("span",{className:"user-name",children:C}),o.jsxs("span",{className:"service-count",children:[T.length," pelayanan"]})]}),o.jsx("div",{className:"service-duration",children:p(y)})]},C)})})]})]}),g==="detailed"&&o.jsx("div",{className:"report-content",children:o.jsxs("div",{className:"detailed-services",children:[o.jsxs("h4",{children:["Detail Pelayanan (",t.services.length,")"]}),o.jsxs("div",{className:"services-table",children:[o.jsxs("div",{className:"table-header",children:[o.jsx("div",{className:"col-date",children:"Tanggal"}),o.jsx("div",{className:"col-contact",children:"Contact"}),o.jsx("div",{className:"col-user",children:"User"}),o.jsx("div",{className:"col-duration",children:"Durasi"}),o.jsx("div",{className:"col-description",children:"Deskripsi"})]}),o.jsx("div",{className:"table-body",children:t.services.sort((C,T)=>new Date(T.date).getTime()-new Date(C.date).getTime()).map(C=>o.jsxs("div",{className:"table-row",children:[o.jsx("div",{className:"col-date",children:zn(new Date(C.date))}),o.jsx("div",{className:"col-contact",children:S(C.contactId)}),o.jsx("div",{className:"col-user",children:C.userId}),o.jsx("div",{className:"col-duration",children:p(C.duration)}),o.jsx("div",{className:"col-description",children:C.description||"-"})]},C.id))})]})]})}),g==="calendar"&&o.jsx("div",{className:"report-content",children:o.jsxs("div",{className:"calendar-view",children:[o.jsx("h4",{children:"Kalender Pelayanan"}),o.jsx("div",{className:"calendar-services",children:Array.from(t.servicesByDate.entries()).sort(([C],[T])=>new Date(T).getTime()-new Date(C).getTime()).map(([C,T])=>{const y=T.reduce((_,w)=>_+w.duration,0);return o.jsxs("div",{className:"calendar-day-item",children:[o.jsxs("div",{className:"day-header",children:[o.jsx("span",{className:"day-date",children:zn(new Date(C))}),o.jsxs("span",{className:"day-summary",children:[T.length," pelayanan  ",p(y)]})]}),o.jsx("div",{className:"day-services",children:T.map(_=>o.jsxs("div",{className:"day-service-item",children:[o.jsx("span",{className:"service-contact",children:S(_.contactId)}),o.jsxs("span",{className:"service-user",children:["by ",_.userId]}),o.jsx("span",{className:"service-duration",children:p(_.duration)})]},_.id))})]},C)})})]})}),t.services.length===0&&o.jsx("div",{className:"no-data",children:o.jsx("p",{children:"Tidak ada data pelayanan untuk periode yang dipilih"})})]}):o.jsx("div",{className:"service-report empty",children:o.jsx("p",{children:"Pilih filter untuk melihat laporan pelayanan"})})},FN=()=>{const{currentUser:a}=Vt(),[n,t]=z.useState("today"),[s,l]=z.useState(()=>vp(a)),[,u]=z.useState(0);IS.useEffect(()=>{u(w=>w+1)},[a?.role,a?.username]);const f=Ke.getUsers(),h=Bf(f,a),g=Bt.getSessions(),m=z.useMemo(()=>{let w=g.filter(b=>b.status==="completed");w=mp(w,a),a?.username==="editor"?w=w.filter(b=>b.userId==="editor"):a?.role==="Admin"&&s!=="all"&&(w=w.filter(b=>b.userId===s));const k=new Date,D=k.toISOString().split("T")[0];switch(n){case"today":w=w.filter(q=>q.serviceDate===D);break;case"week":const b=new Date(k.getTime()-10080*60*1e3);w=w.filter(q=>new Date(q.startTime)>=b);break;case"month":const K=new Date(k.getTime()-720*60*60*1e3);w=w.filter(q=>new Date(q.startTime)>=K);break}return w.sort((b,K)=>K.startTime.getTime()-b.startTime.getTime())},[g,n,s]),p=z.useMemo(()=>{const w=m.length,k=m.reduce((K,q)=>K+(q.duration||0),0),D=new Set(m.map(K=>K.contactId)).size,b=w>0?Math.round(k/w):0;return{totalSessions:w,totalTime:k,uniqueContacts:D,averageTime:b}},[m]),S=z.useMemo(()=>{const w=m.reduce((k,D)=>{const b=D.serviceDate;return k[b]||(k[b]=[]),k[b].push(D),k},{});return Object.entries(w).sort(([k],[D])=>D.localeCompare(k))},[m]),x=w=>{const k=Math.floor(w/3600),D=Math.floor(w%3600/60),b=w%60;return k>0?`${k}h ${D}m ${b}s`:`${D}m ${b}s`},C=w=>new Intl.DateTimeFormat("id-ID",{hour:"2-digit",minute:"2-digit"}).format(w),T=w=>{const k=new Date(w);return new Intl.DateTimeFormat("id-ID",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}).format(k)},y=w=>Ke.getContactById(w)?.nama||"Unknown Contact",_=w=>h.find(D=>D.username===w)?.username||w;return o.jsxs("div",{className:"service-session-report",children:[o.jsxs("div",{className:"report-header",children:[o.jsx("h2",{children:" Service Session Report"}),o.jsx("p",{children:"Laporan detail aktivitas pelayanan dan durasi waktu"}),o.jsxs("div",{className:"permission-indicator",children:[o.jsx("span",{className:"permission-icon",children:a?.role==="Admin"?"":""}),o.jsx("span",{className:"permission-text",children:a?.role==="Admin"?"Admin: Akses semua data user":`Editor: Hanya data ${a?.username}`})]}),o.jsxs("div",{className:"integration-info",children:[o.jsx("span",{className:"info-icon",children:""}),o.jsx("span",{children:"Timer sessions otomatis tersimpan ke Log Service dan Service Calendar"})]})]}),o.jsxs("div",{className:"report-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Periode:"}),o.jsxs("select",{value:n,onChange:w=>t(w.target.value),className:"filter-select",children:[o.jsx("option",{value:"today",children:"Hari Ini"}),o.jsx("option",{value:"week",children:"7 Hari Terakhir"}),o.jsx("option",{value:"month",children:"30 Hari Terakhir"}),o.jsx("option",{value:"all",children:"Semua Waktu"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"User:"}),Kf(a)?o.jsxs("select",{value:s,onChange:w=>l(w.target.value),className:"filter-select",children:[o.jsx("option",{value:"all",children:"Semua User"}),h.map(w=>o.jsxs("option",{value:w.username,children:[w.username," ",w.username===a?.username?"(You)":""]},w.username))]}):o.jsxs("div",{className:"filter-select locked-display",children:[o.jsxs("span",{className:"locked-user-text",children:[a?.username," (You)"]}),o.jsx("span",{className:"lock-icon-inline",children:""})]})]})]}),o.jsxs("div",{className:"report-stats",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:p.totalSessions}),o.jsx("div",{className:"stat-label",children:"Total Sesi"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:x(p.totalTime)}),o.jsx("div",{className:"stat-label",children:"Total Waktu"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:p.uniqueContacts}),o.jsx("div",{className:"stat-label",children:"Contact Dilayani"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:x(p.averageTime)}),o.jsx("div",{className:"stat-label",children:"Rata-rata Durasi"})]})]}),o.jsx("div",{className:"sessions-report",children:S.length===0?o.jsxs("div",{className:"no-sessions",children:[o.jsx("div",{className:"no-sessions-icon",children:""}),o.jsx("h3",{children:"Tidak ada data sesi"}),o.jsx("p",{children:"Belum ada sesi pelayanan untuk periode yang dipilih"})]}):S.map(([w,k])=>o.jsxs("div",{className:"date-group",children:[o.jsxs("div",{className:"date-header",children:[o.jsx("h3",{children:T(w)}),o.jsxs("div",{className:"date-stats",children:[o.jsxs("span",{children:[k.length," sesi"]}),o.jsx("span",{children:x(k.reduce((D,b)=>D+(b.duration||0),0))})]})]}),o.jsx("div",{className:"sessions-list",children:k.map(D=>o.jsxs("div",{className:"session-card",children:[o.jsxs("div",{className:"session-header",children:[o.jsxs("div",{className:"session-contact",children:[o.jsx("strong",{children:y(D.contactId)}),o.jsxs("span",{className:"session-user",children:["oleh ",_(D.userId)]})]}),o.jsx("div",{className:"session-duration",children:x(D.duration||0)})]}),o.jsx("div",{className:"session-details",children:o.jsxs("div",{className:"session-time",children:[o.jsx("span",{className:"time-start",children:C(D.startTime)}),o.jsx("span",{className:"time-separator",children:""}),o.jsx("span",{className:"time-end",children:D.endTime?C(D.endTime):"Ongoing"})]})})]},D.id))})]},w))})]})},LN=()=>{const{currentUser:a}=Vt(),[n,t]=z.useState("sessions"),[s,l]=z.useState({period:"month"}),[u,f]=z.useState([]),[h,g]=z.useState([]);z.useEffect(()=>{const p=Ke.getContacts();f(p);const S=Ke.getUsers(),x=Bf(S,a);g(x)},[a]);const m=p=>{l(p)};return o.jsxs("div",{className:"service-tracking",children:[o.jsxs("div",{className:"service-tracking-header",children:[o.jsxs("div",{className:"header-content",children:[o.jsx("h1",{children:"Service Tracking"}),o.jsx("p",{children:"Monitor dan analisis pelayanan yang diberikan kepada contacts"}),o.jsxs("div",{className:"unified-system-info",children:[o.jsx("span",{className:"system-icon",children:""}),o.jsx("span",{children:"Unified System: Timer Sessions, Manual Log Service, dan Service Calendar terintegrasi"})]})]}),o.jsxs("div",{className:"service-tabs",children:[o.jsx("button",{onClick:()=>t("sessions"),className:`tab-btn ${n==="sessions"?"active":""}`,children:" Service Sessions"}),o.jsx("button",{onClick:()=>t("manual"),className:`tab-btn ${n==="manual"?"active":""}`,children:" Manual Reports"})]})]}),o.jsx("div",{className:"service-tracking-content",children:n==="sessions"?o.jsx(FN,{}):o.jsxs(o.Fragment,{children:[o.jsx(IN,{onFilterChange:m,initialFilters:s,contacts:u,users:h}),o.jsx(RN,{filters:s})]})})]})},BN=({onReturnToService:a})=>{const[n,t]=z.useState(null),[s,l]=z.useState(null),[u,f]=z.useState(0),[h,g]=z.useState(!1),{currentUser:m}=Vt();z.useEffect(()=>{const y=()=>{if(!m)return;const w=Bt.getActiveSession(m.username);if(w){t(w);const k=Ke.getContactById(w.contactId);l(k);const D=new Date,b=new Date(w.startTime),K=Math.floor((D.getTime()-b.getTime())/1e3);f(K)}else t(null),l(null),f(0)};y();const _=setInterval(y,1e3);return()=>clearInterval(_)},[m]);const p=y=>{const _=Math.floor(y/3600),w=Math.floor(y%3600/60),k=y%60;return _>0?`${_.toString().padStart(2,"0")}:${w.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`:`${w.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`},S=y=>y>3600?"critical":y>1800?"warning":"normal",x=()=>{n&&a(n.contactId)},C=()=>{n&&window.confirm("Apakah Anda yakin ingin mengakhiri pelayanan ini?")&&(Bt.endSession(n.id),t(null),l(null),f(0))};if(!n||!s)return null;const T=S(u);return o.jsxs("div",{className:`active-service-banner ${T} ${h?"minimized":""}`,children:[o.jsxs("div",{className:"banner-content",children:[!h&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"service-info",children:[o.jsxs("div",{className:"service-status",children:[o.jsx("span",{className:"status-indicator",children:""}),o.jsx("span",{className:"status-text",children:"Pelayanan Aktif"})]}),o.jsxs("div",{className:"contact-info",children:[o.jsx("span",{className:"contact-name",children:s.nama}),o.jsx("span",{className:"contact-phone",children:s.nomorTelepon})]}),o.jsxs("div",{className:"service-duration",children:[o.jsx("span",{className:"duration-label",children:"Durasi:"}),o.jsx("span",{className:"duration-time",children:p(u)})]})]}),o.jsxs("div",{className:"banner-actions",children:[o.jsxs("button",{onClick:x,className:"btn btn-primary btn-sm",title:"Kembali ke Service Mode",children:[o.jsx("span",{children:""}),"Kembali ke Pelayanan"]}),o.jsxs("button",{onClick:C,className:"btn btn-danger btn-sm",title:"Akhiri Pelayanan",children:[o.jsx("span",{children:""}),"Akhiri"]})]})]}),o.jsx("button",{onClick:()=>g(!h),className:"minimize-btn",title:h?"Expand Banner":"Minimize Banner",children:h?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"status-indicator-mini",children:""}),o.jsx("span",{className:"duration-mini",children:p(u)}),o.jsx("span",{children:""})]}):o.jsx("span",{children:""})})]}),T==="warning"&&!h&&o.jsx("div",{className:"warning-message",children:" Pelayanan sudah berjalan lebih dari 30 menit"}),T==="critical"&&!h&&o.jsx("div",{className:"critical-message",children:" Pelayanan sudah berjalan lebih dari 1 jam! Pertimbangkan untuk mengakhiri."})]})},KN=()=>{const{filters:a,updateFilter:n}=di(),[t,s]=z.useState(""),[l,u]=z.useState(""),[f,h]=z.useState(!0),[g,m]=z.useState("");z.useEffect(()=>{a.dateRange?(s(on(a.dateRange.startDate)),u(on(a.dateRange.endDate))):(s(""),u(""))},[a.dateRange]);const p=(_,w)=>{if(!_&&!w)return m(""),h(!0),!0;if(_&&!w)return m("Please select an end date"),h(!1),!1;if(!_&&w)return m("Please select a start date"),h(!1),!1;const k=new Date(_),D=new Date(w);return k>D?(m("Start date must be before end date"),h(!1),!1):k>new Date?(m("Start date cannot be in the future"),h(!1),!1):(m(""),h(!0),!0)},S=_=>{s(_),p(_,l)&&(_&&l?n("dateRange",{startDate:new Date(_),endDate:new Date(l)}):!_&&!l&&n("dateRange",void 0))},x=_=>{u(_),p(t,_)&&(t&&_?n("dateRange",{startDate:new Date(t),endDate:new Date(_)}):!t&&!_&&n("dateRange",void 0))},C=()=>{s(""),u(""),m(""),h(!0),n("dateRange",void 0)},T=_=>{const w=new Date,k=new Date(w.getTime()-_*24*60*60*1e3),D=on(k),b=on(w);s(D),u(b),m(""),h(!0),n("dateRange",{startDate:k,endDate:w})},y=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90},{label:"Last 365 days",days:365}];return o.jsxs("div",{className:"date-range-picker",children:[o.jsxs("div",{className:"date-inputs",children:[o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"start-date",children:"From"}),o.jsx("input",{id:"start-date",type:"date",value:t,onChange:_=>S(_.target.value),className:`date-input ${f?"":"error"}`,max:on(new Date)})]}),o.jsx("div",{className:"date-separator",children:"to"}),o.jsxs("div",{className:"date-input-group",children:[o.jsx("label",{htmlFor:"end-date",children:"To"}),o.jsx("input",{id:"end-date",type:"date",value:l,onChange:_=>x(_.target.value),className:`date-input ${f?"":"error"}`,max:on(new Date),min:t})]}),(t||l)&&o.jsx("button",{onClick:C,className:"clear-dates-btn",title:"Clear dates",children:""})]}),g&&o.jsx("div",{className:"date-error",children:g}),o.jsxs("div",{className:"date-presets",children:[o.jsx("span",{className:"presets-label",children:"Quick select:"}),o.jsx("div",{className:"preset-buttons",children:y.map(_=>o.jsx("button",{onClick:()=>T(_.days),className:"preset-btn",children:_.label},_.days))})]}),a.dateRange&&o.jsxs("div",{className:"date-summary",children:[o.jsx("span",{className:"summary-label",children:"Selected range:"}),o.jsxs("span",{className:"summary-value",children:[a.dateRange.startDate.toLocaleDateString()," - ",a.dateRange.endDate.toLocaleDateString()]})]})]})},PN=()=>{const{filters:a,updateFilter:n}=di(),[t,s]=z.useState(!1),l=z.useRef(null),u=a.statusKontak||[];z.useEffect(()=>{const x=C=>{l.current&&!l.current.contains(C.target)&&s(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const f=x=>{const C=u;let T;C.includes(x)?T=C.filter(y=>y!==x):T=[...C,x],n("statusKontak",T.length>0?T:void 0)},h=()=>{n("statusKontak",[...Tr])},g=()=>{n("statusKontak",void 0)},m=x=>({"New Contact":"#e74c3c","In Progress":"#f39c12","Follow Up":"#3498db",Completed:"#27ae60"})[x]||"#95a5a6",p=x=>x,S=()=>u.length===0?"Select status...":u.length===1?p(u[0]):u.length===Tr.length?"All statuses":`${u.length} statuses selected`;return o.jsxs("div",{className:"status-filter",ref:l,children:[o.jsxs("button",{onClick:()=>s(!t),className:`status-select-btn ${t?"open":""} ${u.length>0?"has-selection":""}`,children:[o.jsx("span",{className:"select-text",children:S()}),o.jsx("span",{className:"select-arrow",children:t?"":""})]}),t&&o.jsxs("div",{className:"status-dropdown",children:[o.jsxs("div",{className:"dropdown-header",children:[o.jsx("span",{className:"dropdown-title",children:"Select Status"}),o.jsxs("div",{className:"dropdown-actions",children:[o.jsx("button",{onClick:h,className:"action-btn select-all",disabled:u.length===Tr.length,children:"All"}),o.jsx("button",{onClick:g,className:"action-btn clear-all",disabled:u.length===0,children:"None"})]})]}),o.jsx("div",{className:"status-options",children:Tr.map(x=>o.jsxs("label",{className:`status-option ${u.includes(x)?"selected":""}`,children:[o.jsx("input",{type:"checkbox",checked:u.includes(x),onChange:()=>f(x),className:"status-checkbox"}),o.jsxs("div",{className:"status-info",children:[o.jsx("span",{className:"status-indicator",style:{backgroundColor:m(x)}}),o.jsx("span",{className:"status-name",children:p(x)}),o.jsxs("span",{className:"status-code",children:["(",x,")"]})]})]},x))}),u.length>0&&o.jsx("div",{className:"dropdown-footer",children:o.jsxs("div",{className:"selected-summary",children:[u.length," of ",Tr.length," selected"]})})]}),u.length>0&&o.jsx("div",{className:"selected-status-tags",children:u.map(x=>o.jsxs("span",{className:"status-tag",style:{backgroundColor:m(x)},children:[p(x),o.jsx("button",{onClick:()=>f(x),className:"remove-status-btn",children:""})]},x))})]})},dl=({field:a,placeholder:n="Enter search term...",value:t,debounceMs:s=150,minLength:l=1})=>{const{updateFilter:u}=di(),[f,h]=z.useState(t),[g,m]=z.useState(!1),p=z.useCallback(VS(y=>{(y.length>=l||y.length===0)&&u(a,y||void 0)},s),[a,u,l,s]);z.useEffect(()=>{g||h(t)},[t,g]);const S=y=>{h(y),p(y)},x=()=>{h(""),u(a,void 0)},C=y=>{y.key==="Enter"&&(y.preventDefault(),u(a,f||void 0)),y.key==="Escape"&&x()},T=y=>({nama:"Name",nomorTelepon:"Phone Number",alamat:"Address",provinsi:"Province",agama:"Religion",alasanMenghubungi:"Reason for Contact",dateRange:"Date Range"})[y]||y.toString();return o.jsxs("div",{className:`text-filter ${g?"focused":""} ${f?"has-value":""}`,children:[o.jsxs("div",{className:"input-container",children:[o.jsx("input",{type:"text",value:f,onChange:y=>S(y.target.value),onFocus:()=>m(!0),onBlur:()=>m(!1),onKeyDown:C,placeholder:n,className:"filter-input","aria-label":`Filter by ${T(a)}`,autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),o.jsxs("div",{className:"input-actions",children:[f&&o.jsx("button",{onClick:x,className:"clear-btn",title:"Clear filter",type:"button",children:""}),o.jsx("div",{className:"search-icon",children:""})]})]}),f&&f.length<l&&o.jsxs("div",{className:"filter-hint",children:["Enter at least ",l," character",l>1?"s":""," to search"]}),f&&f.length>=l&&o.jsxs("div",{className:"filter-status",children:["Filtering by ",T(a).toLowerCase(),': "',f,'"']})]})},Nv=({placeholder:a="Search by name or phone number...",className:n=""})=>{const{filters:t,updateFilter:s}=di(),[l,u]=z.useState(t.globalSearch||""),[f,h]=z.useState(!1),g=z.useRef(void 0),m=z.useCallback(y=>{g.current&&window.clearTimeout(g.current),g.current=window.setTimeout(()=>{const _=y.trim();s("globalSearch",_||void 0)},200)},[s]);z.useEffect(()=>()=>{g.current&&window.clearTimeout(g.current)},[]),z.useEffect(()=>{u(t.globalSearch||"")},[t.globalSearch]);const p=z.useCallback(y=>{if(f)return;const _=y.target.value;u(w=>w===_?w:_),m(_)},[f,m]),S=z.useCallback(()=>{h(!0)},[]),x=z.useCallback(y=>{h(!1);const _=y.currentTarget.value;u(w=>w===_?w:_),m(_)},[m]),C=z.useCallback(()=>{u(""),s("globalSearch",void 0)},[s]),T=z.useCallback(y=>{y.key==="Escape"&&C()},[C]);return o.jsxs("div",{className:`global-search-filter ${n}`,children:[o.jsxs("div",{className:"search-input-container",children:[o.jsx("div",{className:"search-icon",children:""}),o.jsx("input",{type:"text",value:l,onChange:p,onCompositionStart:S,onCompositionEnd:x,onKeyDown:T,placeholder:a,className:"search-input",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false"}),l&&o.jsx("button",{onClick:C,className:"clear-search-btn",type:"button","aria-label":"Clear search",children:""})]}),l&&o.jsx("div",{className:"search-info",children:o.jsxs("span",{className:"search-hint",children:["Searching in: ",o.jsx("strong",{children:"Name"})," and ",o.jsx("strong",{children:"Phone Number"})]})})]})},zN=({isCollapsed:a=!1,onToggle:n})=>{const{filters:t,clearFilters:s,hasActiveFilters:l,filterCount:u,filterSummary:f,applyQuickFilter:h,totalContacts:g,filteredCount:m}=di(),[p,S]=z.useState("basic"),x=(T,y)=>{h(T,y)},C=[{label:"Recent (24h)",action:()=>x("recent")},{label:"This Week",action:()=>x("thisWeek")},{label:"This Month",action:()=>x("thisMonth")},{label:"New Contact",action:()=>x("byStatus","New Contact")},{label:"In Progress",action:()=>x("byStatus","In Progress")},{label:"Follow Up",action:()=>x("byStatus","Follow Up")},{label:"Completed",action:()=>x("byStatus","Completed")}];return o.jsxs("div",{className:`filter-panel ${a?"collapsed":"expanded"}`,children:[o.jsxs("div",{className:"filter-header",children:[o.jsxs("div",{className:"filter-title",children:[o.jsx("h3",{children:"Filters"}),l&&o.jsxs("span",{className:"filter-count",children:[u," active"]})]}),o.jsxs("div",{className:"filter-actions",children:[l&&o.jsx("button",{onClick:s,className:"clear-filters-btn",children:"Clear All"}),n&&o.jsx("button",{onClick:n,className:"toggle-btn",children:a?"":""})]})]}),!a&&o.jsxs("div",{className:"filter-content",children:[o.jsxs("div",{className:"filter-stats",children:[o.jsxs("span",{className:"results-count",children:["Showing ",m," of ",g," contacts"]}),l&&o.jsx("div",{className:"filter-summary",children:f.map((T,y)=>o.jsx("span",{className:"filter-tag",children:T},y))})]}),o.jsxs("div",{className:"filter-tabs",children:[o.jsx("button",{onClick:()=>S("basic"),className:`tab-btn ${p==="basic"?"active":""}`,children:"Basic"}),o.jsx("button",{onClick:()=>S("advanced"),className:`tab-btn ${p==="advanced"?"active":""}`,children:"Advanced"}),o.jsx("button",{onClick:()=>S("quick"),className:`tab-btn ${p==="quick"?"active":""}`,children:"Quick Filters"})]}),o.jsxs("div",{className:"filter-body",children:[p==="basic"&&o.jsxs("div",{className:"basic-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Search Contacts"}),o.jsx(Nv,{placeholder:"Search by name or phone number..."})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Contact Status"}),o.jsx(PN,{})]})]}),p==="advanced"&&o.jsxs("div",{className:"advanced-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Global Search"}),o.jsx(Nv,{placeholder:"Search by name or phone number..."})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Date Range"}),o.jsx(KN,{})]}),o.jsxs("div",{className:"filter-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Address"}),o.jsx(dl,{field:"alamat",placeholder:"Search by address...",value:t.alamat||""})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Religion"}),o.jsx(dl,{field:"agama",placeholder:"Search by religion...",value:t.agama||""})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Reason for Contact"}),o.jsx(dl,{field:"alasanMenghubungi",placeholder:"Search by reason...",value:t.alasanMenghubungi||""})]}),!t.globalSearch&&o.jsxs("div",{className:"individual-search-note",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Note:"})," Individual name/phone search available when global search is empty"]}),o.jsxs("div",{className:"filter-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Name Only"}),o.jsx(dl,{field:"nama",placeholder:"Search by name only...",value:t.nama||""})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Phone Only"}),o.jsx(dl,{field:"nomorTelepon",placeholder:"Search by phone only...",value:t.nomorTelepon||""})]})]})]})]}),p==="quick"&&o.jsxs("div",{className:"quick-filters",children:[o.jsx("div",{className:"quick-filter-grid",children:C.map((T,y)=>o.jsx("button",{onClick:T.action,className:"quick-filter-btn",children:T.label},y))}),o.jsx("div",{className:"quick-filter-info",children:o.jsx("p",{children:"Quick filters provide instant filtering options for common use cases."})})]})]})]})]})},HN=({initialView:a="dashboard"})=>{const[n,t]=z.useState(a),[s,l]=z.useState(null),[u,f]=z.useState(null),[h,g]=z.useState(!1),[m,p]=z.useState(null);z.useEffect(()=>{const K=q=>{p(q.detail),t("add-contact"),f(null)};return window.addEventListener("navigateToAddContact",K),()=>{window.removeEventListener("navigateToAddContact",K)}},[]);const S=K=>{t(K),l(null),f(null),g(!1),K!=="add-contact"&&p(null)},x=K=>{l(K),g(!0)},C=K=>{f(K),t("add-contact")},T=()=>{g(!1),l(null)},y=K=>{u&&(f(null),t("contacts")),!u&&K&&p(null)},_=()=>{f(null),p(null),t("contacts")},w=()=>{g(!1),l(null)},k=(K,q)=>{switch(console.log("Dashboard navigation:",K,q),K){case"contacts":t("contacts");break;case"service-tracking":console.log("Service tracking navigation not yet implemented");break;default:t("contacts")}},D=K=>{const q=Ke.getContactById(K);q&&(f(q),t("add-contact"),p(null),g(!1),l(null))},b=()=>{switch(n){case"dashboard":return o.jsx(bv,{onNavigate:k});case"contacts":return o.jsx(aN,{children:o.jsxs("div",{className:"contacts-with-filters",children:[o.jsx(zN,{}),o.jsx(lN,{onContactSelect:x,onContactEdit:C,onContactDelete:T})]})});case"add-contact":return o.jsx(SN,{contact:u,mode:u?"edit":"create",onSave:y,onCancel:_,initialData:m});case"service-tracking":return o.jsx(LN,{});case"users":return o.jsx(AN,{});default:return o.jsx(bv,{onNavigate:k})}};return o.jsxs("div",{className:"main-layout",children:[o.jsx(BN,{onReturnToService:D}),o.jsx(Jb,{currentView:n,onViewChange:S}),o.jsx("main",{className:"main-content",children:b()}),h&&s&&o.jsx(bN,{contact:s,onEdit:C,onDelete:T,onClose:w})]})};function GN(){return z.useEffect(()=>{Ke.initializeStorage(),Bt.initializeRecovery(),console.log("CRM Application initialized with recovery system")},[]),o.jsx(ZS,{children:o.jsx(t2,{children:o.jsx(HN,{})})})}OS.createRoot(document.getElementById("root")).render(o.jsx(GN,{}));
